{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhigang/Desktop/styd/web/src/views/pages/shop/product/course/manage/small-course/add#/create-group-course.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/pages/shop/product/course/manage/small-course/add#/create-group-course.vue","mtime":1600926556389},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js","mtime":1591062572376}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { AddService } from '../add.service'\nimport { MessageService } from '@/services/message.service'\nimport { UserService } from '@/services/user.service'\nimport { ruleOptions } from '../form.config'\nimport { PatternService } from '@/services/pattern.service'\nimport CardBgRadio from '@/views/biz-components/card-bg-radio/card-bg-radio'\nimport StEditor from '@/views/components/editor#/editor.vue'\n\nexport default {\n  name: 'create-group-course',\n  serviceInject() {\n    return {\n      addService: AddService,\n      messageService: MessageService,\n      userService: UserService,\n      pattern: PatternService\n    }\n  },\n  rxState() {\n    return {\n      loading: this.addService.loading$,\n      rangeList: this.addService.rangeList$,\n      isAllowLeave: this.addService.isAllowLeave$\n    }\n  },\n  bem: {\n    b: 'create-group-course'\n  },\n  components: {\n    CardBgRadio,\n    StEditor\n  },\n  data(vm) {\n    const form = this.$stForm.create()\n    const decorators = form.decorators(ruleOptions)\n    return {\n      form,\n      decorators,\n      bg_image: {\n        image_id: 0,\n        image_key: '',\n        image_url: '',\n        index: 1\n      },\n      isShowLeaveContent: false\n    }\n  },\n  methods: {\n    save(e) {\n      e.preventDefault()\n      this.form.validate().then(values => {\n        values.course_begin_time = values.date[0].format('YYYY-MM-DD')\n        values.course_end_time = values.date[1].format('YYYY-MM-DD')\n        values.small_course_type = this.$route.query.type\n        values.image = this.bg_image\n        values.img_type = this.bg_image.index\n        if (!this.isShowLeaveContent) {\n          delete values.leave_hours\n          delete values.leave_limit\n        }\n        if (this.bg_image.index === 0) {\n          values.img_type = 3\n          if (!this.bg_image.image_url) {\n            this.messageService.error({\n              content: '请上传图片'\n            })\n            return\n          }\n        }\n        delete values.date\n        this.addService.addGroup(values).subscribe(res => {\n          this.messageService.success({\n            content: '提交成功'\n          })\n          this.$emit('goNext', res.course_id)\n        })\n      })\n    },\n    onLimitChange(e) {\n      this.isShowLeaveContent = e.target.value === 1\n    },\n    onCourseTypeChange(category_id) {\n      this.form.setFieldsValue({\n        category_id\n      })\n    },\n    onCourseNameChange(e) {\n      this.$emit('onCourseNameChange', e.target.value)\n    },\n    disabledDate(current) {\n      return (\n        current &&\n        current.format('YYYY-MM-DD') <\n          moment()\n            .add(1, 'day')\n            .format('YYYY-MM-DD')\n      )\n    }\n  }\n}\n",{"version":3,"sources":["create-group-course.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyMA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"create-group-course.vue","sourceRoot":"src/views/pages/shop/product/course/manage/small-course/add#","sourcesContent":["<template>\n  <st-form :form=\"form\" class=\"page-create-container\" labelWidth=\"130px\">\n    <a-row :gutter=\"8\">\n      <a-col :lg=\"14\" :xs=\"22\">\n        <st-form-item required>\n          <template slot=\"label\">{{ $c('small_course') }}名称</template>\n          <a-input\n            placeholder=\"支持输入1~30个字的课程名称\"\n            maxlength=\"30\"\n            v-decorator=\"decorators.course_name\"\n            @change=\"onCourseNameChange\"\n          />\n        </st-form-item>\n      </a-col>\n    </a-row>\n    <a-row :gutter=\"8\">\n      <a-col :lg=\"14\" :xs=\"22\">\n        <st-form-item label=\"适用范围\" required>\n          <a-select\n            @change=\"onCourseTypeChange\"\n            mode=\"multiple\"\n            v-decorator=\"decorators.scope_application\"\n            placeholder=\"请选择适用范围\"\n          >\n            <a-select-option disabled :value=\"-1\" v-if=\"rangeList.length === 0\">\n              <span class=\"color-text-light\">尚未设置,请去品牌设置</span>\n            </a-select-option>\n            <a-select-option\n              v-else\n              v-for=\"item in rangeList\"\n              :key=\"item.id\"\n              :value=\"item.id\"\n            >\n              {{ item.setting_name }}\n            </a-select-option>\n          </a-select>\n        </st-form-item>\n      </a-col>\n    </a-row>\n    <a-row :gutter=\"8\">\n      <a-col :lg=\"14\" :xs=\"22\">\n        <st-form-item label=\"开班时间\" required>\n          <a-range-picker\n            style=\"width: 100%;\"\n            :disabledDate=\"disabledDate\"\n            format=\"YYYY-MM-DD\"\n            v-decorator=\"decorators.date\"\n          ></a-range-picker>\n        </st-form-item>\n      </a-col>\n    </a-row>\n    <a-row :gutter=\"8\" style=\"height: 56px; overflow: hidden;\">\n      <a-col :lg=\"14\" :xs=\"22\">\n        <st-form-item required>\n          <template slot=\"label\">\n            人数限制\n            <st-help-tooltip id=\"TSXBK001\" />\n          </template>\n          <div :class=\"b('num-limit')\">\n            <a-form-item class=\"page-a-form\">\n              <st-input-number\n                placeholder=\"请输入人数下限\"\n                v-decorator=\"decorators.num_min\"\n                :min=\"1\"\n                :max=\"49\"\n              >\n                <template slot=\"addonAfter\">\n                  人\n                </template>\n              </st-input-number>\n            </a-form-item>\n            <span>~</span>\n            <a-form-item class=\"page-a-form\">\n              <st-input-number\n                placeholder=\"请输入人数上限\"\n                v-decorator=\"decorators.num_max\"\n                :min=\"1\"\n                :max=\"50\"\n              >\n                <template slot=\"addonAfter\">\n                  人\n                </template>\n              </st-input-number>\n            </a-form-item>\n          </div>\n        </st-form-item>\n      </a-col>\n    </a-row>\n    <a-row :gutter=\"8\">\n      <a-col :lg=\"14\" :xs=\"22\">\n        <st-form-item label=\"总课时\" required>\n          <st-input-number\n            placeholder=\"请输入总课时\"\n            v-decorator=\"decorators.course_times\"\n            :min=\"1\"\n            :max=\"99999\"\n          >\n            <template slot=\"addonAfter\">\n              节\n            </template>\n          </st-input-number>\n        </st-form-item>\n      </a-col>\n    </a-row>\n    <!-- 固定约课有的表单 -->\n    <a-row :gutter=\"8\" v-show=\"$route.query.type === '1'\">\n      <a-col :lg=\"14\" :xs=\"22\">\n        <st-form-item label=\"请假限制\" required type=\"text\">\n          <template slot=\"label\">\n            请假限制\n            <st-help-tooltip id=\"TSXBK002\" />\n          </template>\n          <a-radio-group\n            v-decorator=\"decorators.is_leave\"\n            @change=\"onLimitChange\"\n          >\n            <a-radio\n              v-for=\"(item, index) in isAllowLeave\"\n              :key=\"index\"\n              :value=\"item.value\"\n            >\n              {{ item.label }}\n            </a-radio>\n          </a-radio-group>\n          <st-pop-container\n            offset=\"122px\"\n            class=\"mg-t8\"\n            v-show=\"isShowLeaveContent\"\n          >\n            <div class=\"mg-b8\">\n              <span class=\"mg-r8\">允许请假时间,上课前</span>\n              <st-input-number\n                :min=\"1\"\n                :max=\"72\"\n                v-decorator=\"decorators.leave_hours\"\n                style=\"width: 128px;\"\n              >\n                <template slot=\"addonAfter\">\n                  h\n                </template>\n              </st-input-number>\n            </div>\n            <div>\n              <span class=\"mg-r8\">请假上限节数</span>\n              <st-input-number\n                :min=\"1\"\n                v-decorator=\"decorators.leave_limit\"\n                style=\"width: 178px;\"\n              >\n                <template slot=\"addonAfter\">\n                  节\n                </template>\n              </st-input-number>\n            </div>\n          </st-pop-container>\n        </st-form-item>\n      </a-col>\n    </a-row>\n    <!-- 自主约课有的表单内容 -->\n    <a-row :gutter=\"8\" v-show=\"$route.query.type === '2'\">\n      <a-col :lg=\"14\" :xs=\"22\">\n        <st-form-item label=\"约课规则\" required type=\"text\">\n          每周最大约课节数\n          <st-input-number\n            style=\"width: 100px;\"\n            v-decorator=\"decorators.appointment_rights\"\n          >\n            <template slot=\"addonAfter\">\n              节\n            </template>\n          </st-input-number>\n        </st-form-item>\n      </a-col>\n    </a-row>\n    <a-row :gutter=\"8\">\n      <a-col :lg=\"22\" :xs=\"22\">\n        <st-form-item label=\"背景图\" required type=\"text\">\n          <card-bg-radio isSmallCourse v-model=\"bg_image\" />\n        </st-form-item>\n      </a-col>\n    </a-row>\n    <a-row :gutter=\"8\">\n      <a-col :span=\"18\">\n        <st-form-item label=\"课程介绍\">\n          <st-editor v-decorator=\"decorators.description\"></st-editor>\n        </st-form-item>\n      </a-col>\n    </a-row>\n    <a-row :gutter=\"8\">\n      <a-col :lg=\"14\" :xs=\"22\">\n        <st-form-item labelFix>\n          <st-button type=\"primary\" @click=\"save\" :loading=\"loading.addGroup\">\n            保存，开始设置{{ $c('coach') }}信息\n          </st-button>\n        </st-form-item>\n      </a-col>\n    </a-row>\n  </st-form>\n</template>\n\n<script>\nimport { AddService } from '../add.service'\nimport { MessageService } from '@/services/message.service'\nimport { UserService } from '@/services/user.service'\nimport { ruleOptions } from '../form.config'\nimport { PatternService } from '@/services/pattern.service'\nimport CardBgRadio from '@/views/biz-components/card-bg-radio/card-bg-radio'\nimport StEditor from '@/views/components/editor#/editor.vue'\n\nexport default {\n  name: 'create-group-course',\n  serviceInject() {\n    return {\n      addService: AddService,\n      messageService: MessageService,\n      userService: UserService,\n      pattern: PatternService\n    }\n  },\n  rxState() {\n    return {\n      loading: this.addService.loading$,\n      rangeList: this.addService.rangeList$,\n      isAllowLeave: this.addService.isAllowLeave$\n    }\n  },\n  bem: {\n    b: 'create-group-course'\n  },\n  components: {\n    CardBgRadio,\n    StEditor\n  },\n  data(vm) {\n    const form = this.$stForm.create()\n    const decorators = form.decorators(ruleOptions)\n    return {\n      form,\n      decorators,\n      bg_image: {\n        image_id: 0,\n        image_key: '',\n        image_url: '',\n        index: 1\n      },\n      isShowLeaveContent: false\n    }\n  },\n  methods: {\n    save(e) {\n      e.preventDefault()\n      this.form.validate().then(values => {\n        values.course_begin_time = values.date[0].format('YYYY-MM-DD')\n        values.course_end_time = values.date[1].format('YYYY-MM-DD')\n        values.small_course_type = this.$route.query.type\n        values.image = this.bg_image\n        values.img_type = this.bg_image.index\n        if (!this.isShowLeaveContent) {\n          delete values.leave_hours\n          delete values.leave_limit\n        }\n        if (this.bg_image.index === 0) {\n          values.img_type = 3\n          if (!this.bg_image.image_url) {\n            this.messageService.error({\n              content: '请上传图片'\n            })\n            return\n          }\n        }\n        delete values.date\n        this.addService.addGroup(values).subscribe(res => {\n          this.messageService.success({\n            content: '提交成功'\n          })\n          this.$emit('goNext', res.course_id)\n        })\n      })\n    },\n    onLimitChange(e) {\n      this.isShowLeaveContent = e.target.value === 1\n    },\n    onCourseTypeChange(category_id) {\n      this.form.setFieldsValue({\n        category_id\n      })\n    },\n    onCourseNameChange(e) {\n      this.$emit('onCourseNameChange', e.target.value)\n    },\n    disabledDate(current) {\n      return (\n        current &&\n        current.format('YYYY-MM-DD') <\n          moment()\n            .add(1, 'day')\n            .format('YYYY-MM-DD')\n      )\n    }\n  }\n}\n</script>\n"]}]}