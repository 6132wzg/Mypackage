{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js!/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhigang/Desktop/styd/web/src/views/pages/brand/app/plugin/discount/components#/discount-form.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/pages/brand/app/plugin/discount/components#/discount-form.vue","mtime":1600926556097},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js","mtime":1591062572376}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { MessageService } from '@/services/message.service';\nimport ProductSetting from \"../../components#/product-setting.vue\";\nimport FormMixin from \"../../components#/form.mixin\";\nimport { merge } from 'lodash';\nimport moment from 'moment';\nimport { ruleOptions } from \"./discount-form.config\";\nexport default {\n  name: 'BrandAppPluginDiscountAdd',\n  mixins: [FormMixin],\n  components: {\n    ProductSetting: ProductSetting\n  },\n  props: {\n    form: {\n      type: Object,\n      default: function _default() {\n        return {};\n      }\n    }\n  },\n  serviceInject: function serviceInject() {\n    return {\n      messageService: MessageService\n    };\n  },\n  data: function data() {\n    return {};\n  },\n  // 数据源与表单数据之间格式转换\n  computed: {\n    decorators: function decorators() {\n      return this.form.decorators(ruleOptions);\n    },\n    startTime: {\n      get: function get() {\n        return this.formValue.start_time ? moment(this.formValue.start_time) : undefined;\n      },\n      set: function set(value) {\n        this.formValue.start_time = value.format('YYYY-MM-DD HH:mm:ss');\n      }\n    },\n    endTime: {\n      get: function get() {\n        return this.formValue.end_time ? moment(this.formValue.end_time) : undefined;\n      },\n      set: function set(value) {\n        this.formValue.end_time = value.format('YYYY-MM-DD HH:mm:ss');\n      }\n    },\n    isLimitStock: {\n      get: function get() {\n        return this.formValue.is_limit_stock ? true : false;\n      },\n      set: function set(value) {\n        var _this = this;\n\n        this.formValue.is_limit_stock = value ? 1 : 0;\n        this.$nextTick(function () {\n          if (!value) {\n            _this.form.validateFields(['stock_num'], {\n              force: true\n            });\n\n            _this.form.setFieldsValue({\n              stock_num: 0\n            });\n          }\n        });\n      }\n    },\n    isLimitBuy: {\n      get: function get() {\n        return this.formValue.is_limit_buy ? true : false;\n      },\n      set: function set(value) {\n        var _this2 = this;\n\n        this.formValue.is_limit_buy = value ? 1 : 0;\n        this.$nextTick(function () {\n          if (!value) {\n            _this2.form.validateFields(['buy_num'], {\n              force: true\n            });\n\n            _this2.form.setFieldsValue({\n              buy_num: 0\n            });\n          }\n        });\n      }\n    },\n    dateRange: {\n      get: function get() {\n        var start = this.formValue.start_time ? moment(this.formValue.start_time) : undefined;\n        var end = this.formValue.end_time ? moment(this.formValue.end_time) : undefined;\n        return [start, end];\n      },\n      set: function set(value) {\n        this.formValue.start_time = value[0] ? value[0].format('YYYY-MM-DD HH:mm:ss') : undefined;\n        this.formValue.end_time = value[1] ? value[1].format('YYYY-MM-DD HH:mm:ss') : undefined;\n      }\n    }\n  },\n  mounted: function mounted() {},\n  methods: {\n    moment: moment,\n    // 自定义的数据格式校验\n    validate: function validate() {\n      var _this3 = this;\n\n      return new Promise(function (resolve, reject) {\n        _this3.form.validateFieldsAndScroll(function (err, values) {\n          resolve(!err);\n        });\n      });\n    },\n    // 以下方法为日期选择范围控制\n    range: function range(start, end) {\n      var result = [];\n\n      for (var i = start; i < end; i++) {\n        result.push(i);\n      }\n\n      return result;\n    },\n    // disabledEndDate(newEndValue) {\n    //   return newEndValue.format('YYYY-MM-DD') < moment().format('YYYY-MM-DD')\n    // },\n    disabledEndTime: function disabledEndTime() {\n      var _this4 = this;\n\n      var hour = 0;\n      var min = 0;\n      var sec = 0;\n\n      if (moment(this.formValue.start_time).format('YYYY-MM-DD') === moment(this.formValue.end_time).format('YYYY-MM-DD')) {\n        hour = moment(this.formValue.start_time).hours();\n\n        if (moment(this.formValue.start_time).format('YYYY-MM-DD HH') === moment(this.formValue.end_time).format('YYYY-MM-DD HH')) {\n          min = moment(this.formValue.start_time).minutes();\n        }\n\n        if (moment(this.formValue.start_time).format('YYYY-MM-DD HH:mm') === moment(this.formValue.end_time).format('YYYY-MM-DD HH:mm')) {\n          sec = moment(this.formValue.start_time).seconds() + 1;\n        }\n      }\n\n      return {\n        disabledHours: function disabledHours() {\n          return _this4.range(0, hour);\n        },\n        disabledMinutes: function disabledMinutes() {\n          return _this4.range(0, min);\n        },\n        disabledSeconds: function disabledSeconds() {\n          return _this4.range(0, sec);\n        }\n      };\n    }\n  }\n};",{"version":3,"sources":["discount-form.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <st-form class=\"mg-t8\" :form=\"form\" labelWidth=\"125px\">\n    <st-form-item required label=\"活动名称\">\n      <st-input\n        v-decorator=\"decorators.activity_name\"\n        placeholder=\"请输入活动名称\"\n        style=\"width: 470px\"\n        @change=\"formValueChange('activity_name', $event, formValue)\"\n        :maxLength=\"30\"\n      ></st-input>\n    </st-form-item>\n    <!-- 商品选择、商品优惠设置 -->\n    <product-setting\n      discountPriceLabel=\"优惠价(元)\"\n      v-model=\"formValue\"\n      :formCheck=\"formCheck\"\n      :form=\"form\"\n      :isEdit=\"isEdit\"\n      :isSubmit=\"isSubmit\"\n      @submit=\"onSubmit\"\n    ></product-setting>\n    <st-form-item required label=\"活动时间\">\n      <st-range-picker\n        v-decorator=\"decorators.dateRange\"\n        :options=\"{\n          start: {\n            showTime: {\n              format: 'HH:mm:ss'\n            },\n            format: 'YYYY-MM-DD HH:mm:ss'\n          },\n          end: {\n            showTime: {\n              format: 'HH:mm:ss'\n            },\n            format: 'YYYY-MM-DD HH:mm:ss',\n            disabledDateTime: disabledEndTime\n          }\n        }\"\n        @change=\"formValueChange('dateRange', $event)\"\n      />\n    </st-form-item>\n    <st-form-item label=\"活动库存\">\n      <a-checkbox v-model=\"isLimitStock\">限制库存</a-checkbox>\n      <st-input-number\n        style=\"width: 150px\"\n        class=\"mg-l12\"\n        v-decorator=\"decorators.stock_num\"\n        :min=\"1\"\n        :max=\"99999\"\n        :disabled=\"!formValue.is_limit_stock\"\n        @change=\"formValueChange('stock_num', $event, formValue)\"\n      ></st-input-number>\n    </st-form-item>\n    <st-form-item label=\"单人购买限制\">\n      <a-checkbox v-model=\"isLimitBuy\">限制购买</a-checkbox>\n      <st-input-number\n        style=\"width: 150px; padding: 0\"\n        class=\"mg-l12\"\n        v-decorator=\"decorators.buy_num\"\n        :min=\"1\"\n        :max=\"999\"\n        :disabled=\"!formValue.is_limit_buy\"\n        @change=\"formValueChange('buy_num', $event, formValue)\"\n      >\n        <span slot=\"addonAfter\">笔订单</span>\n      </st-input-number>\n    </st-form-item>\n    <st-form-item label=\"备注\">\n      <st-textarea\n        style=\"min-width: 540px\"\n        placeholder=\"备注内容仅商家可见\"\n        v-model=\"formValue.description\"\n        :autosize=\"{ minRows: 2, maxRows: 3 }\"\n        :maxlength=\"200\"\n      ></st-textarea>\n    </st-form-item>\n    <slot></slot>\n  </st-form>\n</template>\n<script>\nimport { MessageService } from '@/services/message.service'\nimport ProductSetting from '../../components#/product-setting.vue'\nimport FormMixin from '../../components#/form.mixin'\nimport { merge } from 'lodash'\nimport moment from 'moment'\nimport { ruleOptions } from './discount-form.config'\nexport default {\n  name: 'BrandAppPluginDiscountAdd',\n  mixins: [FormMixin],\n  components: {\n    ProductSetting\n  },\n  props: {\n    form: {\n      type: Object,\n      default: () => {\n        return {}\n      }\n    }\n  },\n  serviceInject() {\n    return {\n      messageService: MessageService\n    }\n  },\n  data() {\n    return {}\n  },\n  // 数据源与表单数据之间格式转换\n  computed: {\n    decorators() {\n      return this.form.decorators(ruleOptions)\n    },\n    startTime: {\n      get() {\n        return this.formValue.start_time\n          ? moment(this.formValue.start_time)\n          : undefined\n      },\n      set(value) {\n        this.formValue.start_time = value.format('YYYY-MM-DD HH:mm:ss')\n      }\n    },\n    endTime: {\n      get() {\n        return this.formValue.end_time\n          ? moment(this.formValue.end_time)\n          : undefined\n      },\n      set(value) {\n        this.formValue.end_time = value.format('YYYY-MM-DD HH:mm:ss')\n      }\n    },\n    isLimitStock: {\n      get() {\n        return this.formValue.is_limit_stock ? true : false\n      },\n      set(value) {\n        this.formValue.is_limit_stock = value ? 1 : 0\n        this.$nextTick(() => {\n          if (!value) {\n            this.form.validateFields(['stock_num'], { force: true })\n            this.form.setFieldsValue({ stock_num: 0 })\n          }\n        })\n      }\n    },\n    isLimitBuy: {\n      get() {\n        return this.formValue.is_limit_buy ? true : false\n      },\n      set(value) {\n        this.formValue.is_limit_buy = value ? 1 : 0\n        this.$nextTick(() => {\n          if (!value) {\n            this.form.validateFields(['buy_num'], { force: true })\n            this.form.setFieldsValue({ buy_num: 0 })\n          }\n        })\n      }\n    },\n    dateRange: {\n      get() {\n        const start = this.formValue.start_time\n          ? moment(this.formValue.start_time)\n          : undefined\n        const end = this.formValue.end_time\n          ? moment(this.formValue.end_time)\n          : undefined\n        return [start, end]\n      },\n      set(value) {\n        this.formValue.start_time = value[0]\n          ? value[0].format('YYYY-MM-DD HH:mm:ss')\n          : undefined\n        this.formValue.end_time = value[1]\n          ? value[1].format('YYYY-MM-DD HH:mm:ss')\n          : undefined\n      }\n    }\n  },\n  mounted() {},\n  methods: {\n    moment,\n    // 自定义的数据格式校验\n    validate() {\n      return new Promise((resolve, reject) => {\n        this.form.validateFieldsAndScroll((err, values) => {\n          resolve(!err)\n        })\n      })\n    },\n    // 以下方法为日期选择范围控制\n    range(start, end) {\n      const result = []\n      for (let i = start; i < end; i++) {\n        result.push(i)\n      }\n      return result\n    },\n    // disabledEndDate(newEndValue) {\n    //   return newEndValue.format('YYYY-MM-DD') < moment().format('YYYY-MM-DD')\n    // },\n    disabledEndTime() {\n      let hour = 0\n      let min = 0\n      let sec = 0\n      if (\n        moment(this.formValue.start_time).format('YYYY-MM-DD') ===\n        moment(this.formValue.end_time).format('YYYY-MM-DD')\n      ) {\n        hour = moment(this.formValue.start_time).hours()\n        if (\n          moment(this.formValue.start_time).format('YYYY-MM-DD HH') ===\n          moment(this.formValue.end_time).format('YYYY-MM-DD HH')\n        ) {\n          min = moment(this.formValue.start_time).minutes()\n        }\n        if (\n          moment(this.formValue.start_time).format('YYYY-MM-DD HH:mm') ===\n          moment(this.formValue.end_time).format('YYYY-MM-DD HH:mm')\n        ) {\n          sec = moment(this.formValue.start_time).seconds() + 1\n        }\n      }\n      return {\n        disabledHours: () => this.range(0, hour),\n        disabledMinutes: () => this.range(0, min),\n        disabledSeconds: () => this.range(0, sec)\n      }\n    }\n  }\n}\n</script>\n"],"sourceRoot":"src/views/pages/brand/app/plugin/discount/components#"}]}