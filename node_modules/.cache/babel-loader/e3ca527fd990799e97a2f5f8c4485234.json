{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js!/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhigang/Desktop/styd/web/src/views/biz-modals/sold/course/scope.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/biz-modals/sold/course/scope.vue","mtime":1600926555958},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js","mtime":1591062572376}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es7.array.includes\";\nimport \"core-js/modules/es6.string.includes\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { ScopeService } from \"./scope.service\";\nimport { ruleOptions } from \"./scope.config\";\nimport { BATCH_TYPE, BATCH_INFO } from '@/constants/common/batch-operation';\nimport { cloneDeep, remove, every, filter, reduce, forEach, find, intersection } from 'lodash-es';\nexport default {\n  name: 'ModalSoldCourseScope',\n  bem: {\n    add: 'page-shop-add-range-package',\n    basic: 'page-shop-add-basic-package',\n    b: 'modal-sold-course-scope'\n  },\n  serviceProviders: function serviceProviders() {\n    return [ScopeService];\n  },\n  serviceInject: function serviceInject() {\n    return {\n      scopeService: ScopeService\n    };\n  },\n  rxState: function rxState() {\n    return {\n      list_num: this.scopeService.list_num$,\n      loading: this.scopeService.loading$,\n      coachList: this.scopeService.coachList$,\n      teamCourseList: this.scopeService.teamCourseList$,\n      teamCourseTreeList: this.scopeService.teamCourseTreeList$,\n      personalCourseList: this.scopeService.personalCourseList$,\n      personalCourseTreeList: this.scopeService.personalCourseTreeList$\n    };\n  },\n  props: {\n    ids: {\n      type: Array,\n      required: true\n    },\n    searchQuery: {\n      type: Object\n    }\n  },\n  mounted: function mounted() {\n    this.scopeService.init(this.searchQuery).subscribe();\n  },\n  data: function data() {\n    var form = this.$stForm.create();\n    var decorators = form.decorators(ruleOptions);\n    return {\n      bacthTeamReduceTimes: 0,\n      bacthPersonalReduceTimes: 0,\n      expandedKeys: [],\n      autoExpandParent: true,\n      teamCourseIds: [],\n      expandedKeysCourse: [],\n      autoExpandParentCourse: true,\n      teamCourseList: [],\n      searchCourseValue: '',\n      teamChildrenIds: [],\n      personalCourseIds: [],\n      expandedKeysPersonal: [],\n      autoExpandParentPersonal: true,\n      searchPersonalValue: '',\n      personalChildrenIds: [],\n      BATCH_TYPE: BATCH_TYPE,\n      BATCH_INFO: BATCH_INFO,\n      form: form,\n      decorators: decorators,\n      show: false,\n      batch_type: BATCH_TYPE.SELECTED,\n      teamCheckAll: false,\n      personalCheckAll: false,\n      coachAllOperationDropdownIsShow: false,\n      personalAllOperationCoachList: [],\n      personalAllOperationCoachTotal: 0\n    };\n  },\n  computed: {\n    teamCourseShowList: function teamCourseShowList() {\n      var _this = this;\n\n      return this.teamCourseList.filter(function (item) {\n        return _this.teamChildrenIds.includes(item.id);\n      });\n    },\n    personalCourseShowList: function personalCourseShowList() {\n      var _this2 = this;\n\n      var cocahes = [];\n      var total = 0;\n      this.coachList.forEach(function (item) {\n        cocahes.push(item.id);\n        total += item.coach_number;\n      });\n      return this.personalCourseList.filter(function (item) {\n        // if (this.personalCourseIds.includes(item.id)) {\n        if (_this2.personalChildrenIds.includes(item.id)) {\n          item.coachGradeList = cocahes;\n          item.coach = total;\n          return item;\n        }\n      });\n    },\n    helpText: function helpText() {\n      return this.list_num > this.BATCH_INFO.LIMIT_NUM ? this.BATCH_INFO.ERROR_TIP : '';\n    },\n    helpShow: function helpShow() {\n      return this.list_num > this.BATCH_INFO.LIMIT_NUM;\n    },\n    operateDataNum: function operateDataNum() {\n      return this.batch_type === this.BATCH_TYPE.SELECTED ? this.ids.length : this.list_num;\n    }\n  },\n  methods: {\n    onBlurPersonalReduceTimes: function onBlurPersonalReduceTimes() {\n      this.bacthPersonalReduceTimes = '';\n    },\n    onChangePersonalReduceTimes: function onChangePersonalReduceTimes(value) {\n      if (!this.personalCheckAll) return;\n      this.personalCourseList = this.personalCourseList.map(function (item) {\n        item.course_weight = value;\n        return item;\n      });\n    },\n    onBlurTeamReduceTimes: function onBlurTeamReduceTimes() {\n      this.bacthTeamReduceTimes = '';\n    },\n    onChangeTeamReduceTimes: function onChangeTeamReduceTimes(value) {\n      if (!this.teamCheckAll) return;\n      this.teamCourseList = this.teamCourseList.map(function (item) {\n        item.course_weight = value;\n        return item;\n      });\n    },\n    getPopupContainer: function getPopupContainer() {\n      return document.getElementsByClassName('modal-sold-course-scope')[0];\n    },\n    onTeamTree: function onTeamTree() {\n      var _this3 = this;\n\n      this.teamChildrenIds = this.teamCourseIds.filter(function (i) {\n        return !find(_this3.teamCourseTreeList, {\n          id: i\n        });\n      });\n      this.teamCourseIds.forEach(function (i, index) {\n        var item = find(_this3.teamCourseTreeList, {\n          id: i\n        });\n\n        if (item) {\n          var isExist = item.children.filter(function (childrenItem) {\n            return _this3.teamCourseIds.includes(childrenItem.id);\n          });\n\n          if (isExist.length <= 0) {\n            _this3.teamCourseIds.splice(index, 1);\n          } else if (isExist.length !== item.children.length) {\n            var _index = _this3.teamCourseIds.indexOf(item.id);\n\n            _this3.teamCourseIds.splice(_index, 1);\n          }\n        }\n      });\n    },\n    onPersonalTree: function onPersonalTree() {\n      var _this4 = this;\n\n      this.personalChildrenIds = this.personalCourseIds.filter(function (i) {\n        return !find(_this4.personalCourseTreeList, {\n          id: i\n        });\n      });\n      this.personalCourseIds.forEach(function (i, index) {\n        var item = find(_this4.personalCourseTreeList, {\n          id: i\n        });\n\n        if (item) {\n          var isExist = [];\n          if (item.children) isExist = item.children.filter(function (childrenItem) {\n            return _this4.personalCourseIds.includes(childrenItem.id);\n          });\n\n          if (isExist.length <= 0) {\n            _this4.personalCourseIds.splice(index, 1);\n          } else if (isExist.length !== item.children.length) {\n            var _index2 = _this4.personalCourseIds.indexOf(item.id);\n\n            _this4.personalCourseIds.splice(_index2, 1);\n          }\n        }\n      });\n    },\n    coachItemChange: function coachItemChange(item, index) {\n      var arr = this.coachList.filter(function (i) {\n        return item.coachGradeList.includes(i.id);\n      });\n      var total = 0;\n      arr.forEach(function (i) {\n        total += i.coach_number;\n      });\n      item.coach = total;\n    },\n    onClickDeleteTeam: function onClickDeleteTeam(i, index) {\n      this.teamCourseIds = this.teamCourseIds.filter(function (item) {\n        return item !== i.id;\n      });\n      this.onTeamTree();\n    },\n    onClickDeletePersonal: function onClickDeletePersonal(i, index) {\n      this.personalCourseIds = this.personalCourseIds.filter(function (item) {\n        return item !== i.id;\n      });\n      this.onPersonalTree();\n    },\n    checkAllChange: function checkAllChange(type) {\n      var _this5 = this;\n\n      if (type === 'team') {\n        this.teamCheckAll = !this.teamCheckAll;\n        this.teamCourseShowList.forEach(function (item) {\n          item.checked = _this5.teamCheckAll;\n        });\n      }\n\n      if (type === 'personal') {\n        this.personalCheckAll = !this.personalCheckAll;\n        this.personalCourseShowList.forEach(function (item) {\n          item.checked = _this5.personalCheckAll;\n        });\n      }\n    },\n    removeCourseItems: function removeCourseItems(type) {\n      if (type === 'team') {\n        if (this.teamCheckAll) {\n          this.teamCourseIds = [];\n          this.teamCheckAll = false;\n          this.onTeamTree();\n        }\n      }\n\n      if (type === 'personal') {\n        if (this.personalCheckAll) {\n          this.personalCourseIds = [];\n          this.personalCheckAll = false;\n          this.onPersonalTree();\n        }\n      }\n    },\n    filterCourseList: function filterCourseList(e) {\n      var _this6 = this;\n\n      var value = e.target.value;\n      var expandedKeysCourse = this.teamCourseList.map(function (item) {\n        if (item.name.indexOf(value) > -1) {\n          return _this6.getParentKey(item.name, cloneDeep(_this6.teamCourseTreeList));\n        }\n\n        return null;\n      }).filter(function (item, i, self) {\n        return item && self.indexOf(item) === i;\n      });\n      Object.assign(this, {\n        expandedKeysCourse: expandedKeysCourse,\n        searchCourseValue: value,\n        autoExpandParentCourse: true\n      });\n    },\n    filterPersonalList: function filterPersonalList(e) {\n      var _this7 = this;\n\n      var value = e.target.value;\n      var expandedKeysPersonal = this.personalCourseList.map(function (item) {\n        if (item.name.indexOf(value) > -1) {\n          return _this7.getParentKey(item.name, cloneDeep(_this7.personalCourseTreeList));\n        }\n\n        return null;\n      }).filter(function (item, i, self) {\n        return item && self.indexOf(item) === i;\n      });\n      Object.assign(this, {\n        expandedKeysPersonal: expandedKeysPersonal,\n        searchPersonalValue: value,\n        autoExpandParentPersonal: true\n      });\n    },\n    getParentKey: function getParentKey(key, tree) {\n      var parentKey;\n\n      for (var i = 0; i < tree.length; i++) {\n        var node = tree[i];\n\n        if (node.children) {\n          if (node.children.some(function (item) {\n            return item.name === key;\n          })) {\n            parentKey = node.key;\n          } else if (this.getParentKey(key, node.children)) {\n            parentKey = this.getParentKey(key, node.children);\n          }\n        }\n      }\n\n      return parentKey;\n    },\n    onExpandCourse: function onExpandCourse(expandedKeys) {\n      this.expandedKeysCourse = expandedKeys;\n      this.autoExpandParentCourse = false;\n    },\n    onExpandPersonal: function onExpandPersonal(expandedKeys) {\n      this.expandedKeysPersonal = expandedKeys;\n      this.autoExpandParentPersonal = false;\n    },\n    coachAllChange: function coachAllChange() {\n      var _this8 = this;\n\n      var arr = this.coachList.filter(function (i) {\n        return _this8.personalAllOperationCoachList.includes(i.id);\n      });\n      var total = 0;\n      arr.forEach(function (i) {\n        total += i.coach_number;\n      });\n      this.personalAllOperationCoachTotal = total;\n    },\n    coachAllOperationOk: function coachAllOperationOk() {\n      var _this9 = this;\n\n      var arr = this.coachList.filter(function (i) {\n        return _this9.personalAllOperationCoachList.includes(i.id);\n      });\n      var total = 0;\n      arr.forEach(function (i) {\n        total += i.coach_number;\n      });\n      this.personalCourseShowList.forEach(function (item) {\n        item.coachGradeList = cloneDeep(_this9.personalAllOperationCoachList);\n        item.coach = total;\n      }); // 清空\n\n      this.personalAllOperationCoachList = [];\n      this.personalAllOperationCoachTotal = 0; // 收起\n\n      this.coachAllOperationDropdownIsShow = false;\n    },\n    onSubmit: function onSubmit() {\n      var _this10 = this;\n\n      this.form.validate().then(function (values) {\n        var arrPersonal = [];\n        var arrTeam = [];\n\n        _this10.personalCourseShowList.forEach(function (item) {\n          arrPersonal.push({\n            id: item.id,\n            level_ids: item.coachGradeList,\n            course_weight: +item.course_weight\n          });\n        });\n\n        _this10.teamCourseShowList.forEach(function (item) {\n          arrTeam.push({\n            id: item.id,\n            course_weight: +item.course_weight\n          });\n        });\n\n        _this10.scopeService.changePackageRange({\n          batch_type: _this10.batch_type,\n          sold_ids: _this10.ids,\n          conditions: _this10.searchQuery,\n          range_teams: arrTeam,\n          range_personals: arrPersonal\n        }).subscribe(function (res) {\n          _this10.$emit('success');\n\n          _this10.show = false;\n        });\n      });\n    }\n  }\n};",{"version":3,"sources":["scope.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqaA,SAAA,YAAA;AACA,SAAA,WAAA;AACA,SAAA,UAAA,EAAA,UAAA,QAAA,oCAAA;AACA,SACA,SADA,EAEA,MAFA,EAGA,KAHA,EAIA,MAJA,EAKA,MALA,EAMA,OANA,EAOA,IAPA,EAQA,YARA,QASA,WATA;AAUA,eAAA;AACA,EAAA,IAAA,EAAA,sBADA;AAEA,EAAA,GAAA,EAAA;AACA,IAAA,GAAA,EAAA,6BADA;AAEA,IAAA,KAAA,EAAA,6BAFA;AAGA,IAAA,CAAA,EAAA;AAHA,GAFA;AAOA,EAAA,gBAPA,8BAOA;AACA,WAAA,CAAA,YAAA,CAAA;AACA,GATA;AAUA,EAAA,aAVA,2BAUA;AACA,WAAA;AACA,MAAA,YAAA,EAAA;AADA,KAAA;AAGA,GAdA;AAeA,EAAA,OAfA,qBAeA;AACA,WAAA;AACA,MAAA,QAAA,EAAA,KAAA,YAAA,CAAA,SADA;AAEA,MAAA,OAAA,EAAA,KAAA,YAAA,CAAA,QAFA;AAGA,MAAA,SAAA,EAAA,KAAA,YAAA,CAAA,UAHA;AAIA,MAAA,cAAA,EAAA,KAAA,YAAA,CAAA,eAJA;AAKA,MAAA,kBAAA,EAAA,KAAA,YAAA,CAAA,mBALA;AAMA,MAAA,kBAAA,EAAA,KAAA,YAAA,CAAA,mBANA;AAOA,MAAA,sBAAA,EAAA,KAAA,YAAA,CAAA;AAPA,KAAA;AASA,GAzBA;AA0BA,EAAA,KAAA,EAAA;AACA,IAAA,GAAA,EAAA;AACA,MAAA,IAAA,EAAA,KADA;AAEA,MAAA,QAAA,EAAA;AAFA,KADA;AAKA,IAAA,WAAA,EAAA;AACA,MAAA,IAAA,EAAA;AADA;AALA,GA1BA;AAmCA,EAAA,OAnCA,qBAmCA;AACA,SAAA,YAAA,CAAA,IAAA,CAAA,KAAA,WAAA,EAAA,SAAA;AACA,GArCA;AAsCA,EAAA,IAtCA,kBAsCA;AACA,QAAA,IAAA,GAAA,KAAA,OAAA,CAAA,MAAA,EAAA;AACA,QAAA,UAAA,GAAA,IAAA,CAAA,UAAA,CAAA,WAAA,CAAA;AACA,WAAA;AACA,MAAA,oBAAA,EAAA,CADA;AAEA,MAAA,wBAAA,EAAA,CAFA;AAGA,MAAA,YAAA,EAAA,EAHA;AAIA,MAAA,gBAAA,EAAA,IAJA;AAKA,MAAA,aAAA,EAAA,EALA;AAMA,MAAA,kBAAA,EAAA,EANA;AAOA,MAAA,sBAAA,EAAA,IAPA;AAQA,MAAA,cAAA,EAAA,EARA;AASA,MAAA,iBAAA,EAAA,EATA;AAUA,MAAA,eAAA,EAAA,EAVA;AAYA,MAAA,iBAAA,EAAA,EAZA;AAaA,MAAA,oBAAA,EAAA,EAbA;AAcA,MAAA,wBAAA,EAAA,IAdA;AAeA,MAAA,mBAAA,EAAA,EAfA;AAgBA,MAAA,mBAAA,EAAA,EAhBA;AAkBA,MAAA,UAAA,EAAA,UAlBA;AAmBA,MAAA,UAAA,EAAA,UAnBA;AAoBA,MAAA,IAAA,EAAA,IApBA;AAqBA,MAAA,UAAA,EAAA,UArBA;AAsBA,MAAA,IAAA,EAAA,KAtBA;AAuBA,MAAA,UAAA,EAAA,UAAA,CAAA,QAvBA;AAwBA,MAAA,YAAA,EAAA,KAxBA;AAyBA,MAAA,gBAAA,EAAA,KAzBA;AA0BA,MAAA,+BAAA,EAAA,KA1BA;AA2BA,MAAA,6BAAA,EAAA,EA3BA;AA4BA,MAAA,8BAAA,EAAA;AA5BA,KAAA;AA8BA,GAvEA;AAwEA,EAAA,QAAA,EAAA;AACA,IAAA,kBADA,gCACA;AAAA;;AACA,aAAA,KAAA,cAAA,CAAA,MAAA,CAAA,UAAA,IAAA;AAAA,eACA,KAAA,CAAA,eAAA,CAAA,QAAA,CAAA,IAAA,CAAA,EAAA,CADA;AAAA,OAAA,CAAA;AAGA,KALA;AAMA,IAAA,sBANA,oCAMA;AAAA;;AACA,UAAA,OAAA,GAAA,EAAA;AACA,UAAA,KAAA,GAAA,CAAA;AACA,WAAA,SAAA,CAAA,OAAA,CAAA,UAAA,IAAA,EAAA;AACA,QAAA,OAAA,CAAA,IAAA,CAAA,IAAA,CAAA,EAAA;AACA,QAAA,KAAA,IAAA,IAAA,CAAA,YAAA;AACA,OAHA;AAIA,aAAA,KAAA,kBAAA,CAAA,MAAA,CAAA,UAAA,IAAA,EAAA;AACA;AACA,YAAA,MAAA,CAAA,mBAAA,CAAA,QAAA,CAAA,IAAA,CAAA,EAAA,CAAA,EAAA;AACA,UAAA,IAAA,CAAA,cAAA,GAAA,OAAA;AACA,UAAA,IAAA,CAAA,KAAA,GAAA,KAAA;AACA,iBAAA,IAAA;AACA;AACA,OAPA,CAAA;AAQA,KArBA;AAsBA,IAAA,QAtBA,sBAsBA;AACA,aAAA,KAAA,QAAA,GAAA,KAAA,UAAA,CAAA,SAAA,GACA,KAAA,UAAA,CAAA,SADA,GAEA,EAFA;AAGA,KA1BA;AA2BA,IAAA,QA3BA,sBA2BA;AACA,aAAA,KAAA,QAAA,GAAA,KAAA,UAAA,CAAA,SAAA;AACA,KA7BA;AA8BA,IAAA,cA9BA,4BA8BA;AACA,aAAA,KAAA,UAAA,KAAA,KAAA,UAAA,CAAA,QAAA,GACA,KAAA,GAAA,CAAA,MADA,GAEA,KAAA,QAFA;AAGA;AAlCA,GAxEA;AA4GA,EAAA,OAAA,EAAA;AACA,IAAA,yBADA,uCACA;AACA,WAAA,wBAAA,GAAA,EAAA;AACA,KAHA;AAIA,IAAA,2BAJA,uCAIA,KAJA,EAIA;AACA,UAAA,CAAA,KAAA,gBAAA,EAAA;AACA,WAAA,kBAAA,GAAA,KAAA,kBAAA,CAAA,GAAA,CAAA,UAAA,IAAA,EAAA;AACA,QAAA,IAAA,CAAA,aAAA,GAAA,KAAA;AACA,eAAA,IAAA;AACA,OAHA,CAAA;AAIA,KAVA;AAWA,IAAA,qBAXA,mCAWA;AACA,WAAA,oBAAA,GAAA,EAAA;AACA,KAbA;AAcA,IAAA,uBAdA,mCAcA,KAdA,EAcA;AACA,UAAA,CAAA,KAAA,YAAA,EAAA;AACA,WAAA,cAAA,GAAA,KAAA,cAAA,CAAA,GAAA,CAAA,UAAA,IAAA,EAAA;AACA,QAAA,IAAA,CAAA,aAAA,GAAA,KAAA;AACA,eAAA,IAAA;AACA,OAHA,CAAA;AAIA,KApBA;AAqBA,IAAA,iBArBA,+BAqBA;AACA,aAAA,QAAA,CAAA,sBAAA,CAAA,yBAAA,EAAA,CAAA,CAAA;AACA,KAvBA;AAwBA,IAAA,UAxBA,wBAwBA;AAAA;;AACA,WAAA,eAAA,GAAA,KAAA,aAAA,CAAA,MAAA,CACA,UAAA,CAAA;AAAA,eAAA,CAAA,IAAA,CAAA,MAAA,CAAA,kBAAA,EAAA;AAAA,UAAA,EAAA,EAAA;AAAA,SAAA,CAAA;AAAA,OADA,CAAA;AAGA,WAAA,aAAA,CAAA,OAAA,CAAA,UAAA,CAAA,EAAA,KAAA,EAAA;AACA,YAAA,IAAA,GAAA,IAAA,CAAA,MAAA,CAAA,kBAAA,EAAA;AAAA,UAAA,EAAA,EAAA;AAAA,SAAA,CAAA;;AACA,YAAA,IAAA,EAAA;AACA,cAAA,OAAA,GAAA,IAAA,CAAA,QAAA,CAAA,MAAA,CAAA,UAAA,YAAA;AAAA,mBACA,MAAA,CAAA,aAAA,CAAA,QAAA,CAAA,YAAA,CAAA,EAAA,CADA;AAAA,WAAA,CAAA;;AAGA,cAAA,OAAA,CAAA,MAAA,IAAA,CAAA,EAAA;AACA,YAAA,MAAA,CAAA,aAAA,CAAA,MAAA,CAAA,KAAA,EAAA,CAAA;AACA,WAFA,MAEA,IAAA,OAAA,CAAA,MAAA,KAAA,IAAA,CAAA,QAAA,CAAA,MAAA,EAAA;AACA,gBAAA,MAAA,GAAA,MAAA,CAAA,aAAA,CAAA,OAAA,CAAA,IAAA,CAAA,EAAA,CAAA;;AACA,YAAA,MAAA,CAAA,aAAA,CAAA,MAAA,CAAA,MAAA,EAAA,CAAA;AACA;AACA;AACA,OAbA;AAcA,KA1CA;AA2CA,IAAA,cA3CA,4BA2CA;AAAA;;AACA,WAAA,mBAAA,GAAA,KAAA,iBAAA,CAAA,MAAA,CACA,UAAA,CAAA;AAAA,eAAA,CAAA,IAAA,CAAA,MAAA,CAAA,sBAAA,EAAA;AAAA,UAAA,EAAA,EAAA;AAAA,SAAA,CAAA;AAAA,OADA,CAAA;AAGA,WAAA,iBAAA,CAAA,OAAA,CAAA,UAAA,CAAA,EAAA,KAAA,EAAA;AACA,YAAA,IAAA,GAAA,IAAA,CAAA,MAAA,CAAA,sBAAA,EAAA;AAAA,UAAA,EAAA,EAAA;AAAA,SAAA,CAAA;;AACA,YAAA,IAAA,EAAA;AACA,cAAA,OAAA,GAAA,EAAA;AACA,cAAA,IAAA,CAAA,QAAA,EACA,OAAA,GAAA,IAAA,CAAA,QAAA,CAAA,MAAA,CAAA,UAAA,YAAA;AAAA,mBACA,MAAA,CAAA,iBAAA,CAAA,QAAA,CAAA,YAAA,CAAA,EAAA,CADA;AAAA,WAAA,CAAA;;AAGA,cAAA,OAAA,CAAA,MAAA,IAAA,CAAA,EAAA;AACA,YAAA,MAAA,CAAA,iBAAA,CAAA,MAAA,CAAA,KAAA,EAAA,CAAA;AACA,WAFA,MAEA,IAAA,OAAA,CAAA,MAAA,KAAA,IAAA,CAAA,QAAA,CAAA,MAAA,EAAA;AACA,gBAAA,OAAA,GAAA,MAAA,CAAA,iBAAA,CAAA,OAAA,CAAA,IAAA,CAAA,EAAA,CAAA;;AACA,YAAA,MAAA,CAAA,iBAAA,CAAA,MAAA,CAAA,OAAA,EAAA,CAAA;AACA;AACA;AACA,OAfA;AAgBA,KA/DA;AAgEA,IAAA,eAhEA,2BAgEA,IAhEA,EAgEA,KAhEA,EAgEA;AACA,UAAA,GAAA,GAAA,KAAA,SAAA,CAAA,MAAA,CAAA,UAAA,CAAA;AAAA,eAAA,IAAA,CAAA,cAAA,CAAA,QAAA,CAAA,CAAA,CAAA,EAAA,CAAA;AAAA,OAAA,CAAA;AACA,UAAA,KAAA,GAAA,CAAA;AACA,MAAA,GAAA,CAAA,OAAA,CAAA,UAAA,CAAA,EAAA;AACA,QAAA,KAAA,IAAA,CAAA,CAAA,YAAA;AACA,OAFA;AAGA,MAAA,IAAA,CAAA,KAAA,GAAA,KAAA;AACA,KAvEA;AAwEA,IAAA,iBAxEA,6BAwEA,CAxEA,EAwEA,KAxEA,EAwEA;AACA,WAAA,aAAA,GAAA,KAAA,aAAA,CAAA,MAAA,CAAA,UAAA,IAAA;AAAA,eAAA,IAAA,KAAA,CAAA,CAAA,EAAA;AAAA,OAAA,CAAA;AACA,WAAA,UAAA;AACA,KA3EA;AA4EA,IAAA,qBA5EA,iCA4EA,CA5EA,EA4EA,KA5EA,EA4EA;AACA,WAAA,iBAAA,GAAA,KAAA,iBAAA,CAAA,MAAA,CACA,UAAA,IAAA;AAAA,eAAA,IAAA,KAAA,CAAA,CAAA,EAAA;AAAA,OADA,CAAA;AAGA,WAAA,cAAA;AACA,KAjFA;AAkFA,IAAA,cAlFA,0BAkFA,IAlFA,EAkFA;AAAA;;AACA,UAAA,IAAA,KAAA,MAAA,EAAA;AACA,aAAA,YAAA,GAAA,CAAA,KAAA,YAAA;AACA,aAAA,kBAAA,CAAA,OAAA,CAAA,UAAA,IAAA,EAAA;AACA,UAAA,IAAA,CAAA,OAAA,GAAA,MAAA,CAAA,YAAA;AACA,SAFA;AAGA;;AACA,UAAA,IAAA,KAAA,UAAA,EAAA;AACA,aAAA,gBAAA,GAAA,CAAA,KAAA,gBAAA;AACA,aAAA,sBAAA,CAAA,OAAA,CAAA,UAAA,IAAA,EAAA;AACA,UAAA,IAAA,CAAA,OAAA,GAAA,MAAA,CAAA,gBAAA;AACA,SAFA;AAGA;AACA,KA/FA;AAgGA,IAAA,iBAhGA,6BAgGA,IAhGA,EAgGA;AACA,UAAA,IAAA,KAAA,MAAA,EAAA;AACA,YAAA,KAAA,YAAA,EAAA;AACA,eAAA,aAAA,GAAA,EAAA;AACA,eAAA,YAAA,GAAA,KAAA;AACA,eAAA,UAAA;AACA;AACA;;AACA,UAAA,IAAA,KAAA,UAAA,EAAA;AACA,YAAA,KAAA,gBAAA,EAAA;AACA,eAAA,iBAAA,GAAA,EAAA;AACA,eAAA,gBAAA,GAAA,KAAA;AACA,eAAA,cAAA;AACA;AACA;AACA,KA/GA;AAgHA,IAAA,gBAhHA,4BAgHA,CAhHA,EAgHA;AAAA;;AACA,UAAA,KAAA,GAAA,CAAA,CAAA,MAAA,CAAA,KAAA;AACA,UAAA,kBAAA,GAAA,KAAA,cAAA,CACA,GADA,CACA,UAAA,IAAA,EAAA;AACA,YAAA,IAAA,CAAA,IAAA,CAAA,OAAA,CAAA,KAAA,IAAA,CAAA,CAAA,EAAA;AACA,iBAAA,MAAA,CAAA,YAAA,CACA,IAAA,CAAA,IADA,EAEA,SAAA,CAAA,MAAA,CAAA,kBAAA,CAFA,CAAA;AAIA;;AACA,eAAA,IAAA;AACA,OATA,EAUA,MAVA,CAUA,UAAA,IAAA,EAAA,CAAA,EAAA,IAAA;AAAA,eAAA,IAAA,IAAA,IAAA,CAAA,OAAA,CAAA,IAAA,MAAA,CAAA;AAAA,OAVA,CAAA;AAWA,MAAA,MAAA,CAAA,MAAA,CAAA,IAAA,EAAA;AACA,QAAA,kBAAA,EAAA,kBADA;AAEA,QAAA,iBAAA,EAAA,KAFA;AAGA,QAAA,sBAAA,EAAA;AAHA,OAAA;AAKA,KAlIA;AAmIA,IAAA,kBAnIA,8BAmIA,CAnIA,EAmIA;AAAA;;AACA,UAAA,KAAA,GAAA,CAAA,CAAA,MAAA,CAAA,KAAA;AACA,UAAA,oBAAA,GAAA,KAAA,kBAAA,CACA,GADA,CACA,UAAA,IAAA,EAAA;AACA,YAAA,IAAA,CAAA,IAAA,CAAA,OAAA,CAAA,KAAA,IAAA,CAAA,CAAA,EAAA;AACA,iBAAA,MAAA,CAAA,YAAA,CACA,IAAA,CAAA,IADA,EAEA,SAAA,CAAA,MAAA,CAAA,sBAAA,CAFA,CAAA;AAIA;;AACA,eAAA,IAAA;AACA,OATA,EAUA,MAVA,CAUA,UAAA,IAAA,EAAA,CAAA,EAAA,IAAA;AAAA,eAAA,IAAA,IAAA,IAAA,CAAA,OAAA,CAAA,IAAA,MAAA,CAAA;AAAA,OAVA,CAAA;AAWA,MAAA,MAAA,CAAA,MAAA,CAAA,IAAA,EAAA;AACA,QAAA,oBAAA,EAAA,oBADA;AAEA,QAAA,mBAAA,EAAA,KAFA;AAGA,QAAA,wBAAA,EAAA;AAHA,OAAA;AAKA,KArJA;AAsJA,IAAA,YAtJA,wBAsJA,GAtJA,EAsJA,IAtJA,EAsJA;AACA,UAAA,SAAA;;AACA,WAAA,IAAA,CAAA,GAAA,CAAA,EAAA,CAAA,GAAA,IAAA,CAAA,MAAA,EAAA,CAAA,EAAA,EAAA;AACA,YAAA,IAAA,GAAA,IAAA,CAAA,CAAA,CAAA;;AACA,YAAA,IAAA,CAAA,QAAA,EAAA;AACA,cAAA,IAAA,CAAA,QAAA,CAAA,IAAA,CAAA,UAAA,IAAA;AAAA,mBAAA,IAAA,CAAA,IAAA,KAAA,GAAA;AAAA,WAAA,CAAA,EAAA;AACA,YAAA,SAAA,GAAA,IAAA,CAAA,GAAA;AACA,WAFA,MAEA,IAAA,KAAA,YAAA,CAAA,GAAA,EAAA,IAAA,CAAA,QAAA,CAAA,EAAA;AACA,YAAA,SAAA,GAAA,KAAA,YAAA,CAAA,GAAA,EAAA,IAAA,CAAA,QAAA,CAAA;AACA;AACA;AACA;;AACA,aAAA,SAAA;AACA,KAnKA;AAoKA,IAAA,cApKA,0BAoKA,YApKA,EAoKA;AACA,WAAA,kBAAA,GAAA,YAAA;AACA,WAAA,sBAAA,GAAA,KAAA;AACA,KAvKA;AAwKA,IAAA,gBAxKA,4BAwKA,YAxKA,EAwKA;AACA,WAAA,oBAAA,GAAA,YAAA;AACA,WAAA,wBAAA,GAAA,KAAA;AACA,KA3KA;AA4KA,IAAA,cA5KA,4BA4KA;AAAA;;AACA,UAAA,GAAA,GAAA,KAAA,SAAA,CAAA,MAAA,CAAA,UAAA,CAAA;AAAA,eACA,MAAA,CAAA,6BAAA,CAAA,QAAA,CAAA,CAAA,CAAA,EAAA,CADA;AAAA,OAAA,CAAA;AAGA,UAAA,KAAA,GAAA,CAAA;AACA,MAAA,GAAA,CAAA,OAAA,CAAA,UAAA,CAAA,EAAA;AACA,QAAA,KAAA,IAAA,CAAA,CAAA,YAAA;AACA,OAFA;AAGA,WAAA,8BAAA,GAAA,KAAA;AACA,KArLA;AAsLA,IAAA,mBAtLA,iCAsLA;AAAA;;AACA,UAAA,GAAA,GAAA,KAAA,SAAA,CAAA,MAAA,CAAA,UAAA,CAAA;AAAA,eACA,MAAA,CAAA,6BAAA,CAAA,QAAA,CAAA,CAAA,CAAA,EAAA,CADA;AAAA,OAAA,CAAA;AAGA,UAAA,KAAA,GAAA,CAAA;AACA,MAAA,GAAA,CAAA,OAAA,CAAA,UAAA,CAAA,EAAA;AACA,QAAA,KAAA,IAAA,CAAA,CAAA,YAAA;AACA,OAFA;AAGA,WAAA,sBAAA,CAAA,OAAA,CAAA,UAAA,IAAA,EAAA;AACA,QAAA,IAAA,CAAA,cAAA,GAAA,SAAA,CAAA,MAAA,CAAA,6BAAA,CAAA;AACA,QAAA,IAAA,CAAA,KAAA,GAAA,KAAA;AACA,OAHA,EARA,CAYA;;AACA,WAAA,6BAAA,GAAA,EAAA;AACA,WAAA,8BAAA,GAAA,CAAA,CAdA,CAeA;;AACA,WAAA,+BAAA,GAAA,KAAA;AACA,KAvMA;AAwMA,IAAA,QAxMA,sBAwMA;AAAA;;AACA,WAAA,IAAA,CAAA,QAAA,GAAA,IAAA,CAAA,UAAA,MAAA,EAAA;AACA,YAAA,WAAA,GAAA,EAAA;AACA,YAAA,OAAA,GAAA,EAAA;;AACA,QAAA,OAAA,CAAA,sBAAA,CAAA,OAAA,CAAA,UAAA,IAAA,EAAA;AACA,UAAA,WAAA,CAAA,IAAA,CAAA;AACA,YAAA,EAAA,EAAA,IAAA,CAAA,EADA;AAEA,YAAA,SAAA,EAAA,IAAA,CAAA,cAFA;AAGA,YAAA,aAAA,EAAA,CAAA,IAAA,CAAA;AAHA,WAAA;AAKA,SANA;;AAOA,QAAA,OAAA,CAAA,kBAAA,CAAA,OAAA,CAAA,UAAA,IAAA,EAAA;AACA,UAAA,OAAA,CAAA,IAAA,CAAA;AACA,YAAA,EAAA,EAAA,IAAA,CAAA,EADA;AAEA,YAAA,aAAA,EAAA,CAAA,IAAA,CAAA;AAFA,WAAA;AAIA,SALA;;AAMA,QAAA,OAAA,CAAA,YAAA,CACA,kBADA,CACA;AACA,UAAA,UAAA,EAAA,OAAA,CAAA,UADA;AAEA,UAAA,QAAA,EAAA,OAAA,CAAA,GAFA;AAGA,UAAA,UAAA,EAAA,OAAA,CAAA,WAHA;AAIA,UAAA,WAAA,EAAA,OAJA;AAKA,UAAA,eAAA,EAAA;AALA,SADA,EAQA,SARA,CAQA,UAAA,GAAA,EAAA;AACA,UAAA,OAAA,CAAA,KAAA,CAAA,SAAA;;AACA,UAAA,OAAA,CAAA,IAAA,GAAA,KAAA;AACA,SAXA;AAYA,OA5BA;AA6BA;AAtOA;AA5GA,CAAA","sourcesContent":["<template>\n  <st-modal\n    title=\"更换上课范围\"\n    size=\"default\"\n    v-model=\"show\"\n    :wrapClassName=\"b()\"\n  >\n    <st-form :form=\"form\" labelWidth=\"75px\">\n      <st-form-item\n        label=\"选择\"\n        required\n        :help=\"helpText\"\n        :validateStatus=\"helpShow ? 'error' : ''\"\n      >\n        <st-batch-select-radio\n          :ids=\"this.ids\"\n          v-model=\"batch_type\"\n          :total=\"list_num\"\n        ></st-batch-select-radio>\n      </st-form-item>\n      <st-form-item label=\"团体课程\" required>\n        <div :class=\"(add('team-course-table'), add('course'))\">\n          <table :class=\"add('scope-table')\">\n            <colgroup>\n              <col style=\"width:5%;\" />\n              <col style=\"width:41%;\" />\n              <col style=\"width:40%;\" />\n              <col style=\"width:14%;\" />\n            </colgroup>\n            <tr class=\"bg-thead th\">\n              <th></th>\n              <th>课程名称</th>\n              <th>预约课程扣次</th>\n              <th>操作</th>\n            </tr>\n            <tbody>\n              <tr class=\"checkbox border-bottom\">\n                <td colspan=\"4\" class=\"team-course-add-buton\">\n                  <a-popover\n                    trigger=\"click\"\n                    :getPopupContainer=\"getPopupContainer\"\n                  >\n                    <template slot=\"content\">\n                      <div :class=\"b('popup-scroll')\">\n                        <st-input-search\n                          @change=\"filterCourseList\"\n                          placeholder=\"请输入查询内容\"\n                          round=\"round\"\n                        ></st-input-search>\n                        <a-tree\n                          checkable\n                          @check=\"onTeamTree\"\n                          @expand=\"onExpandCourse\"\n                          v-model=\"teamCourseIds\"\n                          :expandedKeys.sync=\"expandedKeysCourse\"\n                          :autoExpandParent=\"autoExpandParentCourse\"\n                          :treeData=\"teamCourseTreeList\"\n                        >\n                          <template slot=\"title\" slot-scope=\"{ title }\">\n                            <span v-if=\"title.indexOf(searchCourseValue) > -1\">\n                              {{\n                                title.substr(\n                                  0,\n                                  title.indexOf(searchCourseValue)\n                                )\n                              }}\n                              <span style=\"color: #f50\">\n                                {{ searchCourseValue }}\n                              </span>\n                              {{\n                                title.substr(\n                                  title.indexOf(searchCourseValue) +\n                                    searchCourseValue.length\n                                )\n                              }}\n                            </span>\n                            <span v-else>{{ title }}</span>\n                          </template>\n                        </a-tree>\n                      </div>\n                    </template>\n                    <st-button block type=\"dashed\" icon=\"add\">\n                      新增团体课程\n                    </st-button>\n                  </a-popover>\n                </td>\n              </tr>\n              <tr>\n                <td colspan=\"4\">\n                  <p\n                    v-if=\"!teamCourseShowList.length\"\n                    class=\"bg-row-even\"\n                    style=\"margin: 0;text-align:center;padding: 8px 0;\"\n                  >\n                    无数据\n                  </p>\n                  <ul\n                    :class=\"b('team-table')\"\n                    v-else\n                    v-scrollBar=\"{ stopPropagation: true }\"\n                    v-decorator=\"['teamCourseList2']\"\n                  >\n                    <li\n                      class=\"checkbox border-bottom\"\n                      :class=\"[\n                        index % 2 !== 0 ? 'bg-row-odd' : 'bg-row-even',\n                        b('course-item')\n                      ]\"\n                      v-for=\"(i, index) in teamCourseShowList\"\n                      :key=\"i.id\"\n                    >\n                      <div class=\"tg-c\" :class=\"b('checked')\">\n                        <a-checkbox :checked=\"i.checked\" />\n                      </div>\n                      <div :class=\"b('name')\">{{ i.name }}</div>\n                      <div :class=\"b('count')\">\n                        <st-input-number\n                          v-model=\"i.course_weight\"\n                          :min=\"0\"\n                          :max=\"99999\"\n                          style=\"width:104px\"\n                        >\n                          <template slot=\"addonAfter\">次</template>\n                        </st-input-number>\n                      </div>\n                      <div :class=\"b('delete')\">\n                        <a @click=\"onClickDeleteTeam(i, index)\">\n                          删除\n                        </a>\n                      </div>\n                    </li>\n                  </ul>\n                </td>\n              </tr>\n              <tr class=\"bg-thead checkbox topline\">\n                <td class=\"tg-c\">\n                  <a-checkbox\n                    @change=\"checkAllChange('team')\"\n                    :checked=\"teamCheckAll\"\n                  />\n                </td>\n                <td>批量操作</td>\n                <td>\n                  <st-input-number\n                    @change=\"onChangeTeamReduceTimes\"\n                    @blur=\"onBlurTeamReduceTimes\"\n                    v-model=\"bacthTeamReduceTimes\"\n                    :min=\"0\"\n                    :max=\"99999\"\n                    style=\"width:104px\"\n                  >\n                    <template slot=\"addonAfter\">次</template>\n                  </st-input-number>\n                </td>\n                <td>\n                  <a @click=\"removeCourseItems('team')\">\n                    删除\n                  </a>\n                </td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n      </st-form-item>\n      <st-form-item label=\"私教课程\" class=\"mg-b0\" required>\n        <div :class=\"(add('personal-course-table'), add('course'))\">\n          <table :class=\"add('course-table')\">\n            <colgroup>\n              <col style=\"width:5%;\" />\n              <col style=\"width:25%;\" />\n              <col style=\"width:25%;\" />\n              <col style=\"width:25%;\" />\n              <col style=\"width:10%;\" />\n              <col style=\"width:10%;\" />\n            </colgroup>\n            <tr class=\"bg-thead th\">\n              <th></th>\n              <th>课程名称</th>\n              <th>扣除次数</th>\n              <th>支持{{ $c('coach') }}等级</th>\n              <th>授课{{ $c('coach') }}数</th>\n              <th>操作</th>\n            </tr>\n            <tbody>\n              <tr class=\"checkbox border-bottom\">\n                <td colspan=\"6\" class=\"personal-course-add-buton\">\n                  <a-popover trigger=\"click\">\n                    <template slot=\"content\">\n                      <div :class=\"b('popup-scroll')\">\n                        <st-input-search\n                          @change=\"filterPersonalList\"\n                          placeholder=\"请输入查询内容\"\n                          round=\"round\"\n                        ></st-input-search>\n                        <a-tree\n                          checkable\n                          @expand=\"onExpandPersonal\"\n                          @check=\"onPersonalTree\"\n                          v-model=\"personalCourseIds\"\n                          :expandedKeys.sync=\"expandedKeysPersonal\"\n                          :autoExpandParent=\"autoExpandParentPersonal\"\n                          :treeData=\"personalCourseTreeList\"\n                        >\n                          <template slot=\"title\" slot-scope=\"{ title }\">\n                            <span\n                              v-if=\"title.indexOf(searchPersonalValue) > -1\"\n                            >\n                              {{\n                                title.substr(\n                                  0,\n                                  title.indexOf(searchPersonalValue)\n                                )\n                              }}\n                              <span style=\"color: #f50\">\n                                {{ searchPersonalValue }}\n                              </span>\n                              {{\n                                title.substr(\n                                  title.indexOf(searchPersonalValue) +\n                                    searchPersonalValue.length\n                                )\n                              }}\n                            </span>\n                            <span v-else>{{ title }}</span>\n                          </template>\n                        </a-tree>\n                      </div>\n                    </template>\n                    <st-button block type=\"dashed\" icon=\"add\">\n                      新增私教课程\n                    </st-button>\n                  </a-popover>\n                </td>\n              </tr>\n              <tr>\n                <td colspan=\"6\">\n                  <p\n                    v-if=\"!personalCourseShowList.length\"\n                    class=\"bg-row-even\"\n                    style=\"margin: 0;text-align:center;padding: 8px 0;\"\n                  >\n                    无数据\n                  </p>\n                  <ul\n                    :class=\"b('team-table')\"\n                    v-else\n                    v-scrollBar=\"{ stopPropagation: true }\"\n                    v-decorator=\"['personalCourseList1']\"\n                  >\n                    <li\n                      class=\"checkbox border-bottom\"\n                      :class=\"[\n                        index % 2 !== 0 ? 'bg-row-odd' : 'bg-row-even',\n                        b('personal-item')\n                      ]\"\n                      v-for=\"(item, index) in personalCourseShowList\"\n                      :key=\"item.id\"\n                    >\n                      <div class=\"tg-c\">\n                        <a-checkbox :checked=\"item.checked\" />\n                      </div>\n                      <div>{{ item.name }}</div>\n                      <div>\n                        <st-input-number\n                          v-model=\"item.course_weight\"\n                          :min=\"0\"\n                          :max=\"99999\"\n                          style=\"width:104px\"\n                        >\n                          <template slot=\"addonAfter\">次</template>\n                        </st-input-number>\n                      </div>\n                      <div>\n                        <a-dropdown\n                          placement=\"bottomRight\"\n                          :trigger=\"['click']\"\n                        >\n                          <a>\n                            {{\n                              item.coachGradeList.length === coachList.length\n                                ? '全部'\n                                : `${item.coachGradeList.length}个`\n                            }}等级&nbsp;&nbsp;\n                            <st-icon class=\"icon-12\" type=\"down-small\" />\n                          </a>\n                          <a-checkbox-group\n                            :class=\"basic(`personal-dropdown`)\"\n                            v-model=\"item.coachGradeList\"\n                            @change=\"coachItemChange(item, index)\"\n                            slot=\"overlay\"\n                          >\n                            <!-- 在AForm组件里用自定义指令时，需要加上v-decorator,值不能重复 -->\n                            <ul\n                              class=\"personal-course-coach-grade-dropdown\"\n                              v-scrollBar=\"{\n                                stopPropagation: true\n                              }\"\n                              v-decorator=\"[\n                                `personalCourseListCoachGrade${index}`\n                              ]\"\n                            >\n                              <li\n                                v-for=\"(coachItem, coachIndex) in coachList\"\n                                :key=\"coachIndex\"\n                              >\n                                <a-checkbox :value=\"coachItem.id\">\n                                  {{ coachItem.setting_name }}\n                                </a-checkbox>\n                              </li>\n                            </ul>\n                          </a-checkbox-group>\n                        </a-dropdown>\n                      </div>\n                      <div>{{ item.coach }}</div>\n                      <div>\n                        <a @click=\"onClickDeletePersonal(item, index)\">\n                          删除\n                        </a>\n                      </div>\n                    </li>\n                  </ul>\n                </td>\n              </tr>\n              <tr class=\"bg-thead checkbox topline\">\n                <td class=\"tg-c\">\n                  <a-checkbox\n                    @change=\"checkAllChange('personal')\"\n                    :checked=\"personalCheckAll\"\n                  />\n                </td>\n                <td>批量操作</td>\n                <td>\n                  <st-input-number\n                    @change=\"onChangePersonalReduceTimes\"\n                    @blur=\"onBlurPersonalReduceTimes\"\n                    v-model=\"bacthPersonalReduceTimes\"\n                    :min=\"0\"\n                    :max=\"99999\"\n                    style=\"width:104px\"\n                  >\n                    <template slot=\"addonAfter\">次</template>\n                  </st-input-number>\n                </td>\n                <td>\n                  <a-dropdown\n                    placement=\"bottomRight\"\n                    :trigger=\"['click']\"\n                    v-model=\"coachAllOperationDropdownIsShow\"\n                  >\n                    <a href=\"javascript:void(0)\">\n                      批量设置等级&nbsp;&nbsp;\n                      <st-icon class=\"icon-12\" type=\"down-small\" />\n                    </a>\n                    <a-checkbox-group\n                      :class=\"basic(`personal-dropdown`)\"\n                      v-model=\"personalAllOperationCoachList\"\n                      @change=\"coachAllChange\"\n                      class=\"all\"\n                      slot=\"overlay\"\n                    >\n                      <ul\n                        class=\"personal-course-coach-grade-dropdown\"\n                        v-scrollBar=\"{ stopPropagation: true }\"\n                        v-decorator=\"['personalCourseListCoachGradeAll']\"\n                      >\n                        <li\n                          v-for=\"(coachItem, coachIndex) in coachList\"\n                          :key=\"coachIndex\"\n                        >\n                          <a-checkbox :value=\"coachItem.id\">\n                            {{ coachItem.setting_name }}\n                          </a-checkbox>\n                        </li>\n                      </ul>\n                      <div class=\"personal-course-coach-grade-dropdown-button\">\n                        <a\n                          :disabled=\"!personalAllOperationCoachList.length\"\n                          @click=\"coachAllOperationOk\"\n                        >\n                          确定\n                        </a>\n                      </div>\n                    </a-checkbox-group>\n                  </a-dropdown>\n                </td>\n                <td>{{ personalAllOperationCoachTotal }}</td>\n                <td>\n                  <a @click=\"removeCourseItems('personal')\">\n                    删除\n                  </a>\n                </td>\n              </tr>\n            </tbody>\n          </table>\n        </div>\n      </st-form-item>\n    </st-form>\n    <template slot=\"footer\">\n      <st-button @click=\"show = false\">\n        取消\n      </st-button>\n      <st-popconfirm class=\"mg-l8\" @confirm=\"onSubmit\">\n        <div slot=\"title\" class=\"sold-popup-tip\">\n          <div class=\"sold-popup-tip__title\">\n            本次共选择{{ operateDataNum }}条记录，请再次确认是否提交！\n          </div>\n          <div class=\"sold-popup-tip__content\">\n            此操作将\n            <span class=\"color-danger\">覆盖</span>\n            当前选择项已有数据，将会有2-5s无法正常使用。\n          </div>\n        </div>\n        <st-button type=\"primary\" :loading=\"loading.changePackageRange\">\n          确认提交\n        </st-button>\n      </st-popconfirm>\n    </template>\n  </st-modal>\n</template>\n\n<script>\nimport { ScopeService } from './scope.service'\nimport { ruleOptions } from './scope.config'\nimport { BATCH_TYPE, BATCH_INFO } from '@/constants/common/batch-operation'\nimport {\n  cloneDeep,\n  remove,\n  every,\n  filter,\n  reduce,\n  forEach,\n  find,\n  intersection\n} from 'lodash-es'\nexport default {\n  name: 'ModalSoldCourseScope',\n  bem: {\n    add: 'page-shop-add-range-package',\n    basic: 'page-shop-add-basic-package',\n    b: 'modal-sold-course-scope'\n  },\n  serviceProviders() {\n    return [ScopeService]\n  },\n  serviceInject() {\n    return {\n      scopeService: ScopeService\n    }\n  },\n  rxState() {\n    return {\n      list_num: this.scopeService.list_num$,\n      loading: this.scopeService.loading$,\n      coachList: this.scopeService.coachList$,\n      teamCourseList: this.scopeService.teamCourseList$,\n      teamCourseTreeList: this.scopeService.teamCourseTreeList$,\n      personalCourseList: this.scopeService.personalCourseList$,\n      personalCourseTreeList: this.scopeService.personalCourseTreeList$\n    }\n  },\n  props: {\n    ids: {\n      type: Array,\n      required: true\n    },\n    searchQuery: {\n      type: Object\n    }\n  },\n  mounted() {\n    this.scopeService.init(this.searchQuery).subscribe()\n  },\n  data() {\n    const form = this.$stForm.create()\n    const decorators = form.decorators(ruleOptions)\n    return {\n      bacthTeamReduceTimes: 0,\n      bacthPersonalReduceTimes: 0,\n      expandedKeys: [],\n      autoExpandParent: true,\n      teamCourseIds: [],\n      expandedKeysCourse: [],\n      autoExpandParentCourse: true,\n      teamCourseList: [],\n      searchCourseValue: '',\n      teamChildrenIds: [],\n\n      personalCourseIds: [],\n      expandedKeysPersonal: [],\n      autoExpandParentPersonal: true,\n      searchPersonalValue: '',\n      personalChildrenIds: [],\n\n      BATCH_TYPE,\n      BATCH_INFO,\n      form,\n      decorators,\n      show: false,\n      batch_type: BATCH_TYPE.SELECTED,\n      teamCheckAll: false,\n      personalCheckAll: false,\n      coachAllOperationDropdownIsShow: false,\n      personalAllOperationCoachList: [],\n      personalAllOperationCoachTotal: 0\n    }\n  },\n  computed: {\n    teamCourseShowList() {\n      return this.teamCourseList.filter(item =>\n        this.teamChildrenIds.includes(item.id)\n      )\n    },\n    personalCourseShowList() {\n      const cocahes = []\n      let total = 0\n      this.coachList.forEach(item => {\n        cocahes.push(item.id)\n        total += item.coach_number\n      })\n      return this.personalCourseList.filter(item => {\n        // if (this.personalCourseIds.includes(item.id)) {\n        if (this.personalChildrenIds.includes(item.id)) {\n          item.coachGradeList = cocahes\n          item.coach = total\n          return item\n        }\n      })\n    },\n    helpText() {\n      return this.list_num > this.BATCH_INFO.LIMIT_NUM\n        ? this.BATCH_INFO.ERROR_TIP\n        : ''\n    },\n    helpShow() {\n      return this.list_num > this.BATCH_INFO.LIMIT_NUM\n    },\n    operateDataNum() {\n      return this.batch_type === this.BATCH_TYPE.SELECTED\n        ? this.ids.length\n        : this.list_num\n    }\n  },\n  methods: {\n    onBlurPersonalReduceTimes() {\n      this.bacthPersonalReduceTimes = ''\n    },\n    onChangePersonalReduceTimes(value) {\n      if (!this.personalCheckAll) return\n      this.personalCourseList = this.personalCourseList.map(item => {\n        item.course_weight = value\n        return item\n      })\n    },\n    onBlurTeamReduceTimes() {\n      this.bacthTeamReduceTimes = ''\n    },\n    onChangeTeamReduceTimes(value) {\n      if (!this.teamCheckAll) return\n      this.teamCourseList = this.teamCourseList.map(item => {\n        item.course_weight = value\n        return item\n      })\n    },\n    getPopupContainer() {\n      return document.getElementsByClassName('modal-sold-course-scope')[0]\n    },\n    onTeamTree() {\n      this.teamChildrenIds = this.teamCourseIds.filter(\n        i => !find(this.teamCourseTreeList, { id: i })\n      )\n      this.teamCourseIds.forEach((i, index) => {\n        const item = find(this.teamCourseTreeList, { id: i })\n        if (item) {\n          const isExist = item.children.filter(childrenItem =>\n            this.teamCourseIds.includes(childrenItem.id)\n          )\n          if (isExist.length <= 0) {\n            this.teamCourseIds.splice(index, 1)\n          } else if (isExist.length !== item.children.length) {\n            const index = this.teamCourseIds.indexOf(item.id)\n            this.teamCourseIds.splice(index, 1)\n          }\n        }\n      })\n    },\n    onPersonalTree() {\n      this.personalChildrenIds = this.personalCourseIds.filter(\n        i => !find(this.personalCourseTreeList, { id: i })\n      )\n      this.personalCourseIds.forEach((i, index) => {\n        const item = find(this.personalCourseTreeList, { id: i })\n        if (item) {\n          let isExist = []\n          if (item.children)\n            isExist = item.children.filter(childrenItem =>\n              this.personalCourseIds.includes(childrenItem.id)\n            )\n          if (isExist.length <= 0) {\n            this.personalCourseIds.splice(index, 1)\n          } else if (isExist.length !== item.children.length) {\n            const index = this.personalCourseIds.indexOf(item.id)\n            this.personalCourseIds.splice(index, 1)\n          }\n        }\n      })\n    },\n    coachItemChange(item, index) {\n      const arr = this.coachList.filter(i => item.coachGradeList.includes(i.id))\n      let total = 0\n      arr.forEach(i => {\n        total += i.coach_number\n      })\n      item.coach = total\n    },\n    onClickDeleteTeam(i, index) {\n      this.teamCourseIds = this.teamCourseIds.filter(item => item !== i.id)\n      this.onTeamTree()\n    },\n    onClickDeletePersonal(i, index) {\n      this.personalCourseIds = this.personalCourseIds.filter(\n        item => item !== i.id\n      )\n      this.onPersonalTree()\n    },\n    checkAllChange(type) {\n      if (type === 'team') {\n        this.teamCheckAll = !this.teamCheckAll\n        this.teamCourseShowList.forEach(item => {\n          item.checked = this.teamCheckAll\n        })\n      }\n      if (type === 'personal') {\n        this.personalCheckAll = !this.personalCheckAll\n        this.personalCourseShowList.forEach(item => {\n          item.checked = this.personalCheckAll\n        })\n      }\n    },\n    removeCourseItems(type) {\n      if (type === 'team') {\n        if (this.teamCheckAll) {\n          this.teamCourseIds = []\n          this.teamCheckAll = false\n          this.onTeamTree()\n        }\n      }\n      if (type === 'personal') {\n        if (this.personalCheckAll) {\n          this.personalCourseIds = []\n          this.personalCheckAll = false\n          this.onPersonalTree()\n        }\n      }\n    },\n    filterCourseList(e) {\n      const value = e.target.value\n      const expandedKeysCourse = this.teamCourseList\n        .map(item => {\n          if (item.name.indexOf(value) > -1) {\n            return this.getParentKey(\n              item.name,\n              cloneDeep(this.teamCourseTreeList)\n            )\n          }\n          return null\n        })\n        .filter((item, i, self) => item && self.indexOf(item) === i)\n      Object.assign(this, {\n        expandedKeysCourse,\n        searchCourseValue: value,\n        autoExpandParentCourse: true\n      })\n    },\n    filterPersonalList(e) {\n      const value = e.target.value\n      const expandedKeysPersonal = this.personalCourseList\n        .map(item => {\n          if (item.name.indexOf(value) > -1) {\n            return this.getParentKey(\n              item.name,\n              cloneDeep(this.personalCourseTreeList)\n            )\n          }\n          return null\n        })\n        .filter((item, i, self) => item && self.indexOf(item) === i)\n      Object.assign(this, {\n        expandedKeysPersonal,\n        searchPersonalValue: value,\n        autoExpandParentPersonal: true\n      })\n    },\n    getParentKey(key, tree) {\n      let parentKey\n      for (let i = 0; i < tree.length; i++) {\n        const node = tree[i]\n        if (node.children) {\n          if (node.children.some(item => item.name === key)) {\n            parentKey = node.key\n          } else if (this.getParentKey(key, node.children)) {\n            parentKey = this.getParentKey(key, node.children)\n          }\n        }\n      }\n      return parentKey\n    },\n    onExpandCourse(expandedKeys) {\n      this.expandedKeysCourse = expandedKeys\n      this.autoExpandParentCourse = false\n    },\n    onExpandPersonal(expandedKeys) {\n      this.expandedKeysPersonal = expandedKeys\n      this.autoExpandParentPersonal = false\n    },\n    coachAllChange() {\n      const arr = this.coachList.filter(i =>\n        this.personalAllOperationCoachList.includes(i.id)\n      )\n      let total = 0\n      arr.forEach(i => {\n        total += i.coach_number\n      })\n      this.personalAllOperationCoachTotal = total\n    },\n    coachAllOperationOk() {\n      const arr = this.coachList.filter(i =>\n        this.personalAllOperationCoachList.includes(i.id)\n      )\n      let total = 0\n      arr.forEach(i => {\n        total += i.coach_number\n      })\n      this.personalCourseShowList.forEach(item => {\n        item.coachGradeList = cloneDeep(this.personalAllOperationCoachList)\n        item.coach = total\n      })\n      // 清空\n      this.personalAllOperationCoachList = []\n      this.personalAllOperationCoachTotal = 0\n      // 收起\n      this.coachAllOperationDropdownIsShow = false\n    },\n    onSubmit() {\n      this.form.validate().then(values => {\n        const arrPersonal = []\n        const arrTeam = []\n        this.personalCourseShowList.forEach(item => {\n          arrPersonal.push({\n            id: item.id,\n            level_ids: item.coachGradeList,\n            course_weight: +item.course_weight\n          })\n        })\n        this.teamCourseShowList.forEach(item => {\n          arrTeam.push({\n            id: item.id,\n            course_weight: +item.course_weight\n          })\n        })\n        this.scopeService\n          .changePackageRange({\n            batch_type: this.batch_type,\n            sold_ids: this.ids,\n            conditions: this.searchQuery,\n            range_teams: arrTeam,\n            range_personals: arrPersonal\n          })\n          .subscribe(res => {\n            this.$emit('success')\n            this.show = false\n          })\n      })\n    }\n  }\n}\n</script>\n"],"sourceRoot":"src/views/biz-modals/sold/course"}]}