{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js!/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhigang/Desktop/styd/web/src/views/pages/shop/member/info/reserve.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/pages/shop/member/info/reserve.vue","mtime":1600926556363},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js","mtime":1591062572376}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { ReserveService } from \"./reserve.service\";\nimport tableMixin from '@/mixins/table.mixin';\nimport UserRange from \"./sold#/user-range\";\nimport EntryData from \"./sold#/entry-data\";\nimport { memberCard, depositCard, personalCourse, packageColumns, smallCourse } from \"./reserve.config\";\nimport { UserService } from '@/services/user.service';\nexport default {\n  mixins: [tableMixin],\n  bem: {\n    b: 'member-reserve'\n  },\n  name: 'InfoReserve',\n  serviceInject: function serviceInject() {\n    return {\n      reserveService: ReserveService,\n      userService: UserService\n    };\n  },\n  rxState: function rxState() {\n    var _this$reserveService = this.reserveService,\n        memberCardList$ = _this$reserveService.memberCardList$,\n        depositCardList$ = _this$reserveService.depositCardList$,\n        personalCourseList$ = _this$reserveService.personalCourseList$,\n        packageList$ = _this$reserveService.packageList$,\n        smallCourseList$ = _this$reserveService.smallCourseList$,\n        memberCardPage$ = _this$reserveService.memberCardPage$,\n        depositCardPage$ = _this$reserveService.depositCardPage$,\n        personalCoursePage$ = _this$reserveService.personalCoursePage$,\n        packagePage$ = _this$reserveService.packagePage$,\n        smallCoursePage$ = _this$reserveService.smallCoursePage$;\n    return {\n      memberCardList$: memberCardList$,\n      depositCardList$: depositCardList$,\n      personalCourseList$: personalCourseList$,\n      packageList$: packageList$,\n      smallCourseList$: smallCourseList$,\n      memberCardPage$: memberCardPage$,\n      depositCardPage$: depositCardPage$,\n      personalCoursePage$: personalCoursePage$,\n      packagePage$: packagePage$,\n      smallCoursePage$: smallCoursePage$,\n      cardConsumeList: this.userService.getOptions$('member.card_consume_type'),\n      courseConsumeList: this.userService.getOptions$('member.course_consume_type')\n    };\n  },\n  data: function data() {\n    return {\n      cardquery: {\n        start_time: '',\n        card_type: 1,\n        keyword: ''\n      },\n      coursequery: {\n        buy_time: '',\n        course_type: 1,\n        keyword: ''\n      },\n      id: ''\n    };\n  },\n  components: {\n    UserRange: UserRange,\n    EntryData: EntryData\n  },\n  computed: {\n    memberCard: memberCard,\n    depositCard: depositCard,\n    personalCourse: personalCourse,\n    packageColumns: packageColumns,\n    smallCourse: smallCourse\n  },\n  methods: {\n    getSoldDetail: function getSoldDetail(type, subType, id) {\n      window.open(\"\".concat(window.location.origin, \"/shop/sold/\").concat(type, \"/info/\").concat(subType, \"/info/operation-record?id=\").concat(id));\n    },\n    onTableMemberChange: function onTableMemberChange(type, e) {\n      this.$searchQuery.type = type;\n      this.reserveService.changePage({\n        id: this.id,\n        type: type,\n        page: e.current,\n        size: e.pageSize\n      }).subscribe();\n    },\n    memberInfo: function memberInfo(record) {\n      var arr = record.members || [];\n      var familyInfo = '';\n\n      if (record.card_number_type === 2) {\n        familyInfo = \"\\u5361\\u6210\\u5458\\uFF1A\".concat(arr.filter(function (item) {\n          return item.is_purchaser !== 1;\n        }).map(function (item) {\n          return item.member_info;\n        }).join(','));\n      }\n\n      return \"\\u8D2D\\u5361\\u4EBA\\uFF1A\".concat(arr.filter(function (item) {\n        return item.is_purchaser === 1;\n      }).map(function (item) {\n        return item.member_info;\n      }).join('')).concat(familyInfo);\n    },\n\n    /**\n     * 设置页码\n     * cardOrCourse 卡或课\n     * current 当前页\n     * pageSize 每页条数\n     */\n    initPage: function initPage(cardOrCourse, current_page, size) {\n      if (cardOrCourse === 1) {\n        this.cardPage.size = size;\n        this.cardPage.current_page = current_page;\n      } else if (cardOrCourse === 2) {\n        this.coursePage.current_page = current_page;\n        this.coursePage.size = size;\n      }\n    },\n    // 拼接入参\n    assignObj: function assignObj(cardOrCourse) {\n      if (cardOrCourse === 1) {\n        return Object.assign(this.cardPage, this.cardquery);\n      } else if (cardOrCourse === 2) {\n        return Object.assign(this.coursePage, this.coursequery);\n      }\n    },\n    // 选择日期\n    onChooseDate: function onChooseDate(date, str) {\n      console.log('======', date, str);\n      this.initPage(1, 1, 10);\n      this.cardquery.start_time = str;\n      this.reserveService.getCardInfo(this.id, this.assignObj(1)).subscribe(function (res) {});\n    },\n    // 选择卡类型\n    onChooseCardType: function onChooseCardType(e) {\n      console.log('选择卡', e);\n      this.initPage(1, 1, 10);\n      this.reserveService.getCardInfo(this.id, this.assignObj(1)).subscribe(function (res) {});\n    },\n    // 卡分页\n    cardPageChange: function cardPageChange(e) {\n      this.initPage(1, e.current, e.pageSize);\n      this.reserveService.getCardInfo(this.id, this.assignObj(1)).subscribe(function (res) {});\n    },\n    // 卡查询\n    searchMemberCard: function searchMemberCard(e) {\n      this.initPage(1, 1, 10);\n      this.cardquery.keyword = e;\n      this.reserveService.getCardInfo(this.id, this.assignObj(1)).subscribe(function (res) {});\n    },\n    // 课项选择时间\n    onChooseDateCourse: function onChooseDateCourse(date, str) {\n      this.initPage(2, 1, 10);\n      this.coursequery.buy_time = str;\n      this.reserveService.getCourseInfo(this.id, this.assignObj(2)).subscribe(function (res) {});\n    },\n    // 课项选择类型\n    onChooseCourseType: function onChooseCourseType(e) {\n      this.initPage(2, 1, 10);\n      this.reserveService.getCourseInfo(this.id, this.assignObj(2)).subscribe(function (res) {});\n    },\n    // 课查询\n    searchCourseName: function searchCourseName(e) {\n      this.initPage(2, 1, 10);\n      this.coursequery.keyword = e;\n      this.reserveService.getCourseInfo(this.id, this.assignObj(2)).subscribe(function (res) {});\n    },\n    // 课分页\n    coursePageChange: function coursePageChange(e) {\n      this.initPage(2, e.current, e.pageSize);\n      this.reserveService.getCourseInfo(this.id, this.assignObj(2)).subscribe(function (res) {});\n    }\n  },\n  mounted: function mounted() {\n    this.id = this.$searchQuery.id;\n  }\n};",{"version":3,"sources":["reserve.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkLA,SAAA,cAAA;AACA,OAAA,UAAA,MAAA,sBAAA;AACA,OAAA,SAAA;AACA,OAAA,SAAA;AACA,SACA,UADA,EAEA,WAFA,EAGA,cAHA,EAIA,cAJA,EAKA,WALA;AAOA,SAAA,WAAA,QAAA,yBAAA;AAEA,eAAA;AACA,EAAA,MAAA,EAAA,CAAA,UAAA,CADA;AAEA,EAAA,GAAA,EAAA;AACA,IAAA,CAAA,EAAA;AADA,GAFA;AAKA,EAAA,IAAA,EAAA,aALA;AAMA,EAAA,aANA,2BAMA;AACA,WAAA;AACA,MAAA,cAAA,EAAA,cADA;AAEA,MAAA,WAAA,EAAA;AAFA,KAAA;AAIA,GAXA;AAYA,EAAA,OAZA,qBAYA;AAAA,+BAYA,KAAA,cAZA;AAAA,QAEA,eAFA,wBAEA,eAFA;AAAA,QAGA,gBAHA,wBAGA,gBAHA;AAAA,QAIA,mBAJA,wBAIA,mBAJA;AAAA,QAKA,YALA,wBAKA,YALA;AAAA,QAMA,gBANA,wBAMA,gBANA;AAAA,QAOA,eAPA,wBAOA,eAPA;AAAA,QAQA,gBARA,wBAQA,gBARA;AAAA,QASA,mBATA,wBASA,mBATA;AAAA,QAUA,YAVA,wBAUA,YAVA;AAAA,QAWA,gBAXA,wBAWA,gBAXA;AAaA,WAAA;AACA,MAAA,eAAA,EAAA,eADA;AAEA,MAAA,gBAAA,EAAA,gBAFA;AAGA,MAAA,mBAAA,EAAA,mBAHA;AAIA,MAAA,YAAA,EAAA,YAJA;AAKA,MAAA,gBAAA,EAAA,gBALA;AAMA,MAAA,eAAA,EAAA,eANA;AAOA,MAAA,gBAAA,EAAA,gBAPA;AAQA,MAAA,mBAAA,EAAA,mBARA;AASA,MAAA,YAAA,EAAA,YATA;AAUA,MAAA,gBAAA,EAAA,gBAVA;AAWA,MAAA,eAAA,EAAA,KAAA,WAAA,CAAA,WAAA,CAAA,0BAAA,CAXA;AAYA,MAAA,iBAAA,EAAA,KAAA,WAAA,CAAA,WAAA,CACA,4BADA;AAZA,KAAA;AAgBA,GAzCA;AA0CA,EAAA,IA1CA,kBA0CA;AACA,WAAA;AACA,MAAA,SAAA,EAAA;AACA,QAAA,UAAA,EAAA,EADA;AAEA,QAAA,SAAA,EAAA,CAFA;AAGA,QAAA,OAAA,EAAA;AAHA,OADA;AAMA,MAAA,WAAA,EAAA;AACA,QAAA,QAAA,EAAA,EADA;AAEA,QAAA,WAAA,EAAA,CAFA;AAGA,QAAA,OAAA,EAAA;AAHA,OANA;AAWA,MAAA,EAAA,EAAA;AAXA,KAAA;AAaA,GAxDA;AAyDA,EAAA,UAAA,EAAA;AACA,IAAA,SAAA,EAAA,SADA;AAEA,IAAA,SAAA,EAAA;AAFA,GAzDA;AA6DA,EAAA,QAAA,EAAA;AACA,IAAA,UAAA,EAAA,UADA;AAEA,IAAA,WAAA,EAAA,WAFA;AAGA,IAAA,cAAA,EAAA,cAHA;AAIA,IAAA,cAAA,EAAA,cAJA;AAKA,IAAA,WAAA,EAAA;AALA,GA7DA;AAoEA,EAAA,OAAA,EAAA;AACA,IAAA,aADA,yBACA,IADA,EACA,OADA,EACA,EADA,EACA;AACA,MAAA,MAAA,CAAA,IAAA,WACA,MAAA,CAAA,QAAA,CAAA,MADA,wBACA,IADA,mBACA,OADA,uCACA,EADA;AAGA,KALA;AAMA,IAAA,mBANA,+BAMA,IANA,EAMA,CANA,EAMA;AACA,WAAA,YAAA,CAAA,IAAA,GAAA,IAAA;AACA,WAAA,cAAA,CACA,UADA,CACA;AACA,QAAA,EAAA,EAAA,KAAA,EADA;AAEA,QAAA,IAAA,EAAA,IAFA;AAGA,QAAA,IAAA,EAAA,CAAA,CAAA,OAHA;AAIA,QAAA,IAAA,EAAA,CAAA,CAAA;AAJA,OADA,EAOA,SAPA;AAQA,KAhBA;AAiBA,IAAA,UAjBA,sBAiBA,MAjBA,EAiBA;AACA,UAAA,GAAA,GAAA,MAAA,CAAA,OAAA,IAAA,EAAA;AACA,UAAA,UAAA,GAAA,EAAA;;AACA,UAAA,MAAA,CAAA,gBAAA,KAAA,CAAA,EAAA;AACA,QAAA,UAAA,qCAAA,GAAA,CACA,MADA,CACA,UAAA,IAAA;AAAA,iBAAA,IAAA,CAAA,YAAA,KAAA,CAAA;AAAA,SADA,EAEA,GAFA,CAEA,UAAA,IAAA;AAAA,iBAAA,IAAA,CAAA,WAAA;AAAA,SAFA,EAGA,IAHA,CAGA,GAHA,CAAA,CAAA;AAIA;;AACA,+CAAA,GAAA,CACA,MADA,CACA,UAAA,IAAA;AAAA,eAAA,IAAA,CAAA,YAAA,KAAA,CAAA;AAAA,OADA,EAEA,GAFA,CAEA,UAAA,IAAA;AAAA,eAAA,IAAA,CAAA,WAAA;AAAA,OAFA,EAGA,IAHA,CAGA,EAHA,CAAA,SAGA,UAHA;AAIA,KA9BA;;AA+BA;;;;;;AAMA,IAAA,QArCA,oBAqCA,YArCA,EAqCA,YArCA,EAqCA,IArCA,EAqCA;AACA,UAAA,YAAA,KAAA,CAAA,EAAA;AACA,aAAA,QAAA,CAAA,IAAA,GAAA,IAAA;AACA,aAAA,QAAA,CAAA,YAAA,GAAA,YAAA;AACA,OAHA,MAGA,IAAA,YAAA,KAAA,CAAA,EAAA;AACA,aAAA,UAAA,CAAA,YAAA,GAAA,YAAA;AACA,aAAA,UAAA,CAAA,IAAA,GAAA,IAAA;AACA;AACA,KA7CA;AA8CA;AACA,IAAA,SA/CA,qBA+CA,YA/CA,EA+CA;AACA,UAAA,YAAA,KAAA,CAAA,EAAA;AACA,eAAA,MAAA,CAAA,MAAA,CAAA,KAAA,QAAA,EAAA,KAAA,SAAA,CAAA;AACA,OAFA,MAEA,IAAA,YAAA,KAAA,CAAA,EAAA;AACA,eAAA,MAAA,CAAA,MAAA,CAAA,KAAA,UAAA,EAAA,KAAA,WAAA,CAAA;AACA;AACA,KArDA;AAsDA;AACA,IAAA,YAvDA,wBAuDA,IAvDA,EAuDA,GAvDA,EAuDA;AACA,MAAA,OAAA,CAAA,GAAA,CAAA,QAAA,EAAA,IAAA,EAAA,GAAA;AACA,WAAA,QAAA,CAAA,CAAA,EAAA,CAAA,EAAA,EAAA;AACA,WAAA,SAAA,CAAA,UAAA,GAAA,GAAA;AACA,WAAA,cAAA,CACA,WADA,CACA,KAAA,EADA,EACA,KAAA,SAAA,CAAA,CAAA,CADA,EAEA,SAFA,CAEA,UAAA,GAAA,EAAA,CAAA,CAFA;AAGA,KA9DA;AA+DA;AACA,IAAA,gBAhEA,4BAgEA,CAhEA,EAgEA;AACA,MAAA,OAAA,CAAA,GAAA,CAAA,KAAA,EAAA,CAAA;AACA,WAAA,QAAA,CAAA,CAAA,EAAA,CAAA,EAAA,EAAA;AACA,WAAA,cAAA,CACA,WADA,CACA,KAAA,EADA,EACA,KAAA,SAAA,CAAA,CAAA,CADA,EAEA,SAFA,CAEA,UAAA,GAAA,EAAA,CAAA,CAFA;AAGA,KAtEA;AAuEA;AACA,IAAA,cAxEA,0BAwEA,CAxEA,EAwEA;AACA,WAAA,QAAA,CAAA,CAAA,EAAA,CAAA,CAAA,OAAA,EAAA,CAAA,CAAA,QAAA;AACA,WAAA,cAAA,CACA,WADA,CACA,KAAA,EADA,EACA,KAAA,SAAA,CAAA,CAAA,CADA,EAEA,SAFA,CAEA,UAAA,GAAA,EAAA,CAAA,CAFA;AAGA,KA7EA;AA8EA;AACA,IAAA,gBA/EA,4BA+EA,CA/EA,EA+EA;AACA,WAAA,QAAA,CAAA,CAAA,EAAA,CAAA,EAAA,EAAA;AACA,WAAA,SAAA,CAAA,OAAA,GAAA,CAAA;AACA,WAAA,cAAA,CACA,WADA,CACA,KAAA,EADA,EACA,KAAA,SAAA,CAAA,CAAA,CADA,EAEA,SAFA,CAEA,UAAA,GAAA,EAAA,CAAA,CAFA;AAGA,KArFA;AAsFA;AACA,IAAA,kBAvFA,8BAuFA,IAvFA,EAuFA,GAvFA,EAuFA;AACA,WAAA,QAAA,CAAA,CAAA,EAAA,CAAA,EAAA,EAAA;AACA,WAAA,WAAA,CAAA,QAAA,GAAA,GAAA;AACA,WAAA,cAAA,CACA,aADA,CACA,KAAA,EADA,EACA,KAAA,SAAA,CAAA,CAAA,CADA,EAEA,SAFA,CAEA,UAAA,GAAA,EAAA,CAAA,CAFA;AAGA,KA7FA;AA8FA;AACA,IAAA,kBA/FA,8BA+FA,CA/FA,EA+FA;AACA,WAAA,QAAA,CAAA,CAAA,EAAA,CAAA,EAAA,EAAA;AACA,WAAA,cAAA,CACA,aADA,CACA,KAAA,EADA,EACA,KAAA,SAAA,CAAA,CAAA,CADA,EAEA,SAFA,CAEA,UAAA,GAAA,EAAA,CAAA,CAFA;AAGA,KApGA;AAqGA;AACA,IAAA,gBAtGA,4BAsGA,CAtGA,EAsGA;AACA,WAAA,QAAA,CAAA,CAAA,EAAA,CAAA,EAAA,EAAA;AACA,WAAA,WAAA,CAAA,OAAA,GAAA,CAAA;AACA,WAAA,cAAA,CACA,aADA,CACA,KAAA,EADA,EACA,KAAA,SAAA,CAAA,CAAA,CADA,EAEA,SAFA,CAEA,UAAA,GAAA,EAAA,CAAA,CAFA;AAGA,KA5GA;AA6GA;AACA,IAAA,gBA9GA,4BA8GA,CA9GA,EA8GA;AACA,WAAA,QAAA,CAAA,CAAA,EAAA,CAAA,CAAA,OAAA,EAAA,CAAA,CAAA,QAAA;AACA,WAAA,cAAA,CACA,aADA,CACA,KAAA,EADA,EACA,KAAA,SAAA,CAAA,CAAA,CADA,EAEA,SAFA,CAEA,UAAA,GAAA,EAAA,CAAA,CAFA;AAGA;AAnHA,GApEA;AAyLA,EAAA,OAzLA,qBAyLA;AACA,SAAA,EAAA,GAAA,KAAA,YAAA,CAAA,EAAA;AACA;AA3LA,CAAA","sourcesContent":["<template>\n  <div :class=\"b()\">\n    <div :class=\"b('member-card')\">\n      <st-t3>已购会员卡</st-t3>\n      <st-table\n        v-if=\"memberCardList$.length\"\n        class=\"mg-t16\"\n        rowKey=\"id\"\n        :columns=\"memberCard\"\n        :dataSource=\"memberCardList$\"\n        :scroll=\"{ x: 1150 }\"\n        @change=\"onTableMemberChange('member', $event)\"\n        :page=\"memberCardPage$\"\n      >\n        <template slot=\"memberList\" slot-scope=\"text\">\n          <st-overflow-text :value=\"text\" max-width=\"120px\"></st-overflow-text>\n        </template>\n        <template slot=\"contract_number\" slot-scope=\"text, record\">\n          <a @click=\"getSoldDetail('card', 'member', record.id)\">{{ text }}</a>\n        </template>\n        <template slot=\"use_range\" slot-scope=\"text, record\">\n          <user-range :userRange=\"text\" :record=\"record\"></user-range>\n        </template>\n        <template slot=\"card_status\" slot-scope=\"text\">\n          <st-text\n            :status=\"{\n              success: text.id === 1,\n              error: text.id === 3,\n              default: text.id === 2\n            }\"\n          >\n            {{ text.name }}\n          </st-text>\n        </template>\n      </st-table>\n      <entry-data v-else tip=\"您还未购买会员卡^o^\"></entry-data>\n    </div>\n    <div :class=\"b('deposit-card')\" class=\"mg-t32\">\n      <st-t3>已购储值卡</st-t3>\n      <st-table\n        v-if=\"depositCardList$.length\"\n        class=\"mg-t16\"\n        rowKey=\"id\"\n        :columns=\"depositCard\"\n        :dataSource=\"depositCardList$\"\n        :scroll=\"{ x: 1150 }\"\n        @change=\"onTableMemberChange('deposit', $event)\"\n        :page=\"depositCardPage$\"\n      >\n        <template slot=\"contract_number\" slot-scope=\"text, record\">\n          <a @click=\"getSoldDetail('card', 'deposit', record.id)\">{{ text }}</a>\n        </template>\n        <template slot=\"use_range\" slot-scope=\"text, record\">\n          <user-range :userRange=\"text\" :record=\"record\"></user-range>\n        </template>\n        <template slot=\"card_status\" slot-scope=\"text\">\n          <st-text\n            :status=\"{\n              success: text.id === 1,\n              error: text.id === 3,\n              default: text.id === 2\n            }\"\n          >\n            {{ text.name }}\n          </st-text>\n        </template>\n      </st-table>\n      <entry-data v-else tip=\"您还未购买储值卡^o^\"></entry-data>\n    </div>\n    <div :class=\"b('personal-course')\" class=\"mg-t32\">\n      <st-t3>已购私教课</st-t3>\n      <st-table\n        class=\"mg-t16\"\n        v-if=\"personalCourseList$.length\"\n        rowKey=\"id\"\n        :columns=\"personalCourse\"\n        :dataSource=\"personalCourseList$\"\n        :scroll=\"{ x: 1150 }\"\n        @change=\"onTableMemberChange('personal', $event)\"\n        :page=\"personalCoursePage$\"\n      >\n        <template slot=\"contract_number\" slot-scope=\"text, record\">\n          <a @click=\"getSoldDetail('course', 'personal', record.id)\">\n            {{ text }}\n          </a>\n        </template>\n        <template slot=\"coach_name\" slot-scope=\"text\">\n          <st-overflow-text max-width=\"180px\" :value=\"text\"></st-overflow-text>\n        </template>\n        <template slot=\"use_range\" slot-scope=\"text, record\">\n          <user-range :userRange=\"text\" :record=\"record\"></user-range>\n        </template>\n        <template slot=\"course_status\" slot-scope=\"text\">\n          <st-text\n            :status=\"{\n              success: text.id === 1,\n              error: text.id === 3,\n              default: text.id === 2\n            }\"\n          >\n            {{ text.name }}\n          </st-text>\n        </template>\n      </st-table>\n      <entry-data v-else tip=\"您还未购买私教课^o^\"></entry-data>\n    </div>\n    <div :class=\"b('package')\" class=\"mg-t32\">\n      <st-t3>已购课程包</st-t3>\n      <st-table\n        class=\"mg-t16\"\n        rowKey=\"id\"\n        v-if=\"packageList$.length\"\n        :columns=\"packageColumns\"\n        :dataSource=\"packageList$\"\n        :scroll=\"{ x: 1150 }\"\n        @change=\"onTableMemberChange('package', $event)\"\n        :page=\"packagePage$\"\n      >\n        <template slot=\"memberList\" slot-scope=\"text\">\n          <st-overflow-text :value=\"text\" max-width=\"120px\"></st-overflow-text>\n        </template>\n        <template slot=\"contract_number\" slot-scope=\"text, record\">\n          <a @click=\"getSoldDetail('course', 'package', record.id)\">\n            {{ text }}\n          </a>\n        </template>\n        <template slot=\"use_range\" slot-scope=\"text, record\">\n          <user-range :userRange=\"text\" :record=\"record\"></user-range>\n        </template>\n        <template slot=\"course_status\" slot-scope=\"text\">\n          <st-text\n            :status=\"{\n              success: text.id === 1,\n              error: text.id === 3,\n              default: text.id === 2\n            }\"\n          >\n            {{ text.name }}\n          </st-text>\n        </template>\n      </st-table>\n      <entry-data v-else tip=\"您还未购买课程包^o^\"></entry-data>\n    </div>\n    <div :class=\"b('small-course')\" class=\"mg-t32\">\n      <st-t3>已购小班课</st-t3>\n      <st-table\n        class=\"mg-t16\"\n        rowKey=\"id\"\n        :columns=\"smallCourse\"\n        v-if=\"smallCourseList$.length\"\n        :dataSource=\"smallCourseList$\"\n        :scroll=\"{ x: 1150 }\"\n        @change=\"onTableMemberChange('small', $event)\"\n        :page=\"smallCoursePage$\"\n      >\n        <template slot=\"contract_number\" slot-scope=\"text, record\">\n          <a @click=\"getSoldDetail('course', 'small-course', record.id)\">\n            {{ text }}\n          </a>\n        </template>\n        <template slot=\"course_status\" slot-scope=\"text\">\n          <st-text\n            :status=\"{\n              success: text.id === 1,\n              error: text.id === 3,\n              default: text.id === 2\n            }\"\n          >\n            {{ text.name }}\n          </st-text>\n        </template>\n      </st-table>\n      <entry-data v-else tip=\"您还未购买小班课^o^\"></entry-data>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { ReserveService } from './reserve.service'\nimport tableMixin from '@/mixins/table.mixin'\nimport UserRange from './sold#/user-range'\nimport EntryData from './sold#/entry-data'\nimport {\n  memberCard,\n  depositCard,\n  personalCourse,\n  packageColumns,\n  smallCourse\n} from './reserve.config'\nimport { UserService } from '@/services/user.service'\n\nexport default {\n  mixins: [tableMixin],\n  bem: {\n    b: 'member-reserve'\n  },\n  name: 'InfoReserve',\n  serviceInject() {\n    return {\n      reserveService: ReserveService,\n      userService: UserService\n    }\n  },\n  rxState() {\n    const {\n      memberCardList$,\n      depositCardList$,\n      personalCourseList$,\n      packageList$,\n      smallCourseList$,\n      memberCardPage$,\n      depositCardPage$,\n      personalCoursePage$,\n      packagePage$,\n      smallCoursePage$\n    } = this.reserveService\n    return {\n      memberCardList$,\n      depositCardList$,\n      personalCourseList$,\n      packageList$,\n      smallCourseList$,\n      memberCardPage$,\n      depositCardPage$,\n      personalCoursePage$,\n      packagePage$,\n      smallCoursePage$,\n      cardConsumeList: this.userService.getOptions$('member.card_consume_type'),\n      courseConsumeList: this.userService.getOptions$(\n        'member.course_consume_type'\n      )\n    }\n  },\n  data() {\n    return {\n      cardquery: {\n        start_time: '',\n        card_type: 1,\n        keyword: ''\n      },\n      coursequery: {\n        buy_time: '',\n        course_type: 1,\n        keyword: ''\n      },\n      id: ''\n    }\n  },\n  components: {\n    UserRange,\n    EntryData\n  },\n  computed: {\n    memberCard,\n    depositCard,\n    personalCourse,\n    packageColumns,\n    smallCourse\n  },\n  methods: {\n    getSoldDetail(type, subType, id) {\n      window.open(\n        `${window.location.origin}/shop/sold/${type}/info/${subType}/info/operation-record?id=${id}`\n      )\n    },\n    onTableMemberChange(type, e) {\n      this.$searchQuery.type = type\n      this.reserveService\n        .changePage({\n          id: this.id,\n          type,\n          page: e.current,\n          size: e.pageSize\n        })\n        .subscribe()\n    },\n    memberInfo(record) {\n      const arr = record.members || []\n      let familyInfo = ''\n      if (record.card_number_type === 2) {\n        familyInfo = `卡成员：${arr\n          .filter(item => item.is_purchaser !== 1)\n          .map(item => item.member_info)\n          .join(',')}`\n      }\n      return `购卡人：${arr\n        .filter(item => item.is_purchaser === 1)\n        .map(item => item.member_info)\n        .join('')}${familyInfo}`\n    },\n    /**\n     * 设置页码\n     * cardOrCourse 卡或课\n     * current 当前页\n     * pageSize 每页条数\n     */\n    initPage(cardOrCourse, current_page, size) {\n      if (cardOrCourse === 1) {\n        this.cardPage.size = size\n        this.cardPage.current_page = current_page\n      } else if (cardOrCourse === 2) {\n        this.coursePage.current_page = current_page\n        this.coursePage.size = size\n      }\n    },\n    // 拼接入参\n    assignObj(cardOrCourse) {\n      if (cardOrCourse === 1) {\n        return Object.assign(this.cardPage, this.cardquery)\n      } else if (cardOrCourse === 2) {\n        return Object.assign(this.coursePage, this.coursequery)\n      }\n    },\n    // 选择日期\n    onChooseDate(date, str) {\n      console.log('======', date, str)\n      this.initPage(1, 1, 10)\n      this.cardquery.start_time = str\n      this.reserveService\n        .getCardInfo(this.id, this.assignObj(1))\n        .subscribe(res => {})\n    },\n    // 选择卡类型\n    onChooseCardType(e) {\n      console.log('选择卡', e)\n      this.initPage(1, 1, 10)\n      this.reserveService\n        .getCardInfo(this.id, this.assignObj(1))\n        .subscribe(res => {})\n    },\n    // 卡分页\n    cardPageChange(e) {\n      this.initPage(1, e.current, e.pageSize)\n      this.reserveService\n        .getCardInfo(this.id, this.assignObj(1))\n        .subscribe(res => {})\n    },\n    // 卡查询\n    searchMemberCard(e) {\n      this.initPage(1, 1, 10)\n      this.cardquery.keyword = e\n      this.reserveService\n        .getCardInfo(this.id, this.assignObj(1))\n        .subscribe(res => {})\n    },\n    // 课项选择时间\n    onChooseDateCourse(date, str) {\n      this.initPage(2, 1, 10)\n      this.coursequery.buy_time = str\n      this.reserveService\n        .getCourseInfo(this.id, this.assignObj(2))\n        .subscribe(res => {})\n    },\n    // 课项选择类型\n    onChooseCourseType(e) {\n      this.initPage(2, 1, 10)\n      this.reserveService\n        .getCourseInfo(this.id, this.assignObj(2))\n        .subscribe(res => {})\n    },\n    // 课查询\n    searchCourseName(e) {\n      this.initPage(2, 1, 10)\n      this.coursequery.keyword = e\n      this.reserveService\n        .getCourseInfo(this.id, this.assignObj(2))\n        .subscribe(res => {})\n    },\n    // 课分页\n    coursePageChange(e) {\n      this.initPage(2, e.current, e.pageSize)\n      this.reserveService\n        .getCourseInfo(this.id, this.assignObj(2))\n        .subscribe(res => {})\n    }\n  },\n  mounted() {\n    this.id = this.$searchQuery.id\n  }\n}\n</script>\n"],"sourceRoot":"src/views/pages/shop/member/info"}]}