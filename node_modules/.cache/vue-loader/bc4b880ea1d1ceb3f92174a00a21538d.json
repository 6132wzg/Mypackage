{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhigang/Desktop/styd/web/src/views/pages/shop/member/info/sold.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/pages/shop/member/info/sold.vue","mtime":1596188219710},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js","mtime":1591062572376}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport formDate from './sold#/form-date.vue'\nimport { SoldService } from './sold.service'\nimport { classrecord } from './sold.config.ts'\nimport tableMixin from '@/mixins/table.mixin'\nimport ScheduleSmallCourseReservedCourse from '@/views/biz-modals/schedule/small-course/reserved-course'\nimport ScheduleSmallCourseRemedialCourse from '@/views/biz-modals/schedule/small-course/remedial-course'\nimport ScheduleSmallCourseRemedialInfo from '@/views/biz-modals/schedule/small-course/remedial-info'\nexport default {\n  mixins: [tableMixin],\n  serviceInject() {\n    return {\n      soldService: SoldService\n    }\n  },\n  rxState() {\n    return {\n      soldListInfo: this.soldService.soldListInfo$,\n      soldPage: this.soldService.soldPage$,\n      auth: this.soldService.auth$\n    }\n  },\n  modals: {\n    ScheduleSmallCourseReservedCourse,\n    ScheduleSmallCourseRemedialCourse,\n    ScheduleSmallCourseRemedialInfo\n  },\n  computed: {\n    classrecord\n  },\n  components: {\n    formDate\n  },\n  data() {\n    return {\n      form: {\n        start_date: '', // 上课日期\n        reserve_type: 1,\n        reserve_status: -1,\n        checkin_status: -1,\n        course_name: undefined,\n        size: 20,\n        page: 1\n      }\n    }\n  },\n  created() {\n    // let self = this\n    // this.soldService.init(self.$searchQuery.id, self.form).subscribe()\n  },\n  methods: {\n    /* 取消预约 */\n    reserveStatus(record) {\n      let self = this\n      this.$confirm({\n        title: '提示',\n        content: '确认取消预约并退还相应费用？',\n        okText: '确认取消',\n        cancelText: '再看看',\n        onOk() {\n          let getdata = {\n            id: self.$searchQuery.id,\n            reserve_type: record.reserve_type.id,\n            reserve_id: record.id\n          }\n          self.soldService.getMemberCancel(getdata).subscribe(res => {\n            self.soldService.init(self.$searchQuery.id, self.form).subscribe()\n          })\n        },\n        onCancel() {}\n      })\n    },\n    /* 课程签到 */\n    isCheckin(record) {\n      let self = this\n      this.$confirm({\n        title: '提示',\n        content: '确认签到?',\n        onOk() {\n          let getdata = {\n            id: self.$searchQuery.id,\n            reserve_type: record.reserve_type.id,\n            reserve_id: record.id\n          }\n          console.log(record, getdata)\n          self.soldService.getMemberSign(getdata).subscribe(res => {\n            self.soldService.init(self.$searchQuery.id, self.form).subscribe()\n          })\n        },\n        onCancel() {}\n      })\n    },\n    handleChange(value) {\n      console.log(`selected ${value}`)\n    },\n    // 上课记录分页\n    reservePageChange(e) {\n      this.form.size = e.pageSize\n      this.form.page = e.current\n    },\n    // 入场记录分页\n    entrancePageChange(e) {\n      this.soldService\n        .getMemberEntrance(this.$searchQuery.id, {\n          size: e.pageSize,\n          page: e.current\n        })\n        .subscribe()\n    },\n    // 查看补课\n    getMessage(id) {\n      this.$modalRouter.push({\n        name: 'schedule-small-course-remedial-info',\n        props: {\n          id: id\n        }\n      })\n      this.show = false\n    },\n    // 补签到\n    checkSign(id) {\n      this.soldService.checkSign(id).subscribe(this.getReserveInfo)\n    },\n    // 取消预约\n    del(id) {\n      this.soldService.del(id).subscribe(this.getReserveInfo)\n    },\n    // 请假\n    leave(id) {\n      this.soldService.leave(id).subscribe(this.getReserveInfo)\n    },\n    // 补课回显\n    remedialCourse(reserve_id) {\n      this.$modalRouter.push({\n        name: 'schedule-small-course-remedial-course',\n        props: {\n          reserve_id: reserve_id\n        },\n        on: {\n          ok: () => {\n            this.$router.reload()\n          }\n        }\n      })\n      this.show = false\n    },\n    getReserveInfo() {\n      this.$router.reload()\n    }\n  },\n  watch: {\n    form: {\n      handler() {\n        this.soldService\n          .getMemberReserve(this.$searchQuery.id, this.form)\n          .subscribe()\n      },\n      deep: true\n    }\n  }\n}\n",null]}