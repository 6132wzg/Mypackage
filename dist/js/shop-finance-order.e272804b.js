(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["shop-finance-order"],{"0b3b":function(t,e,n){"use strict";n.r(e),n.d(e,"InfoService",(function(){return p}));var i,a,s=n("d225"),r=n("b0b4"),o=n("9ab4"),c=n("0cd5"),l=n("df29"),d=n("537a"),u=n("c4cc"),f=n("2cbb"),p=function(){function t(e,n){Object(s["a"])(this,t),this.orderApi=e,this.authService=n,this.info$=new l["d"]({}),this.tabs$=new l["d"]([]),this.auth$=new l["d"]({})}return Object(r["a"])(t,[{key:"getInfo",value:function(t){var e=this;return this.orderApi.getOrderInfo(t).pipe(Object(u["a"])((function(n){e.auth$.commit((function(){return n.auth})),e.info$.commit((function(){return n.info})),e.tabs$.commit((function(){var e=[{label:"收款明细",route:{name:"shop-finance-order-info-collection-details",query:{id:t}}},{label:"商品信息",route:{name:"shop-finance-order-info-commodity-info",query:{id:t}}}];return 4!==n.info.order_status&&5!==n.info.order_status||e.push({label:"退款信息",route:{name:"shop-finance-order-info-refund-info",query:{id:t}}}),12===n.info.product_type&&e.push({label:"配送方式",route:{name:"shop-finance-order-info-delivery-mode",query:{id:t}}}),e}))})))}},{key:"beforeRouteEnter",value:function(t){return this.getInfo(t.meta.query.id)}}]),t}();Object(o["b"])([Object(l["c"])(),Object(o["d"])("design:type",Function),Object(o["d"])("design:paramtypes",[String]),Object(o["d"])("design:returntype",void 0)],p.prototype,"getInfo",null),p=Object(o["b"])([Object(c["b"])(),Object(o["d"])("design:paramtypes",["function"===typeof(i="undefined"!==typeof d["c"]&&d["c"])?i:Object,"function"===typeof(a="undefined"!==typeof f["a"]&&f["a"])?a:Object])],p)},"1c98":function(t,e,n){"use strict";n.r(e),n.d(e,"ListService",(function(){return h}));var i,a,s,r,o=n("d225"),c=n("b0b4"),l=n("9ab4"),d=n("2138"),u=n("0cd5"),f=n("df29"),p=n("537a"),_=n("c4cc"),m=n("2cbb"),h=function(){function t(e,n,i){Object(o["a"])(this,t),this.orderApi=e,this.authService=n,this.userService=i,this.list$=new f["d"]([]),this.page$=new f["d"]({}),this.auth$=this.authService.authMap$({export:"brand_shop:order:order|export"}),this.loading$=new f["d"]({}),this.orderStatus$=this.userService.getOptions$("finance.order_status",{addAll:!0}),this.payStatus$=this.userService.getOptions$("finance.pay_status",{addAll:!0}),this.productType$=this.userService.getOptions$("finance.product_type",{addAll:"全部商品类型"})}return Object(c["a"])(t,[{key:"init",value:function(t){return this.getList(t)}},{key:"beforeEach",value:function(t,e){return this.init(t.meta.query)}},{key:"getList",value:function(t){var e=this;return this.orderApi.getOrderList(t).pipe(Object(_["a"])((function(t){e.list$.commit((function(){return t.list})),e.page$.commit((function(){return t.page}))})))}},{key:"orderCancel",value:function(t){return this.orderApi.orderCancel(t)}}]),t}();Object(l["b"])([Object(f["c"])(),Object(l["d"])("design:type",Function),Object(l["d"])("design:paramtypes",["function"===typeof(i="undefined"!==typeof p["OrderParams"]&&p["OrderParams"])?i:Object]),Object(l["d"])("design:returntype",void 0)],h.prototype,"getList",null),Object(l["b"])([Object(f["c"])(),Object(l["d"])("design:type",Function),Object(l["d"])("design:paramtypes",[String]),Object(l["d"])("design:returntype",void 0)],h.prototype,"orderCancel",null),h=Object(l["b"])([Object(u["b"])(),Object(l["d"])("design:paramtypes",["function"===typeof(a="undefined"!==typeof p["c"]&&p["c"])?a:Object,"function"===typeof(s="undefined"!==typeof m["a"]&&m["a"])?s:Object,"function"===typeof(r="undefined"!==typeof d["a"]&&d["a"])?r:Object])],h)},"5ed6":function(t,e,n){"use strict";var i,a,s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("st-modal",{attrs:{title:"业绩拆分",width:"800px",loading:t.loading.serviceInit,wrapClassName:"modal-shop-finance-split"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[n("div",{class:t.basic("content")},[n("a-row",{class:t.basic("info")},[n("a-col",{staticClass:"mg-b36",attrs:{span:12}},[n("st-info",[n("st-info-item",{attrs:{label:"订单号"}},[t._v(t._s(t.info.order_id))]),n("st-info-item",{attrs:{label:"下单人"}},[t._v(t._s(t.info.operator_name))]),n("st-info-item",{attrs:{label:"销售"}},[t._v(t._s(t.info.staff_name))])],1)],1),n("a-col",{staticClass:"mg-b36",attrs:{span:12}},[n("st-info",[n("st-info-item",{attrs:{label:"下单时间"}},[t._v("\n            "+t._s(t.info.created_time)+"\n          ")]),n("st-info-item",{attrs:{label:"订单总额"}},[t._v("\n            "+t._s(t.info.total_price)+"元\n          ")]),n("st-info-item",{attrs:{label:"实收金额"}},[t._v("\n            "+t._s(t.info.actual_price)+"元\n          ")])],1)],1)],1),n("st-table",{attrs:{rowKey:"staff_id",pagination:!1,columns:t.columns,dataSource:t.info.split_items},scopedSlots:t._u([{key:"staff_name",fn:function(e,i,a){return[i.edit&&i.staff_type!==t.SPLIT.STAFF_TYPE_1?n("a-select",{staticStyle:{width:"150px"},attrs:{placeholder:"选择销售人员"},model:{value:i.staff_id,callback:function(e){t.$set(i,"staff_id",e)},expression:"record.staff_id"}},t._l(t.saleList,(function(e,i){return n("a-select-option",{key:i,attrs:{value:+e.id},on:{click:function(n){return t.changeSaleMan(e,a)}}},[t._v("\n            "+t._s(e.staff_name)+"\n          ")])})),1):[t._v("\n          "+t._s(e)+"\n        ")]]}},{key:"split_ratio",fn:function(e,i){return[i.edit?n("st-input-number",{staticStyle:{width:"150px"},attrs:{min:0,max:100,float:!1,placeholder:"请输入占比"},model:{value:i.split_ratio,callback:function(e){t.$set(i,"split_ratio",e)},expression:"record.split_ratio"}},[n("span",{attrs:{slot:"addonAfter"},slot:"addonAfter"},[t._v("%")])]):[t._v("\n          "+t._s(e)+"\n        ")]]}},{key:"action",fn:function(e,i,a){return n("div",{},[n("st-table-actions",[i.edit===t.SPLIT.EDIT_TYPE_3?n("a",{on:{click:function(e){return t.addSaleMan(i)}}},[t._v("\n            协助售卖人\n          ")]):t._e(),i.edit&&i.edit!==t.SPLIT.EDIT_TYPE_3?n("a",{on:{click:function(e){return t.onSave(i,a)}}},[t._v("\n            确定\n          ")]):t._e(),i.edit?t._e():n("a",{on:{click:function(e){return t.onEidt(i,a)}}},[t._v("编辑")]),i.edit===t.SPLIT.EDIT_TYPE_1||i.edit===t.SPLIT.EDIT_TYPE_2?n("a",{on:{click:function(e){return t.onCanel(i,a)}}},[t._v("\n            取消\n          ")]):t._e(),i.edit||i.staff_type===t.SPLIT.STAFF_TYPE_1?t._e():n("a",{on:{click:function(e){return t.onDelete(a)}}},[t._v("\n            删除\n          ")])])],1)}}])}),n("div",{class:t.basic("descrip")},[n("label",[t._v("备注")]),n("a-textarea",{attrs:{autosize:{minRows:4,maxRows:6}},model:{value:t.description,callback:function(e){t.description=e},expression:"description"}})],1)],1),n("template",{slot:"footer"},[n("st-button",{attrs:{loading:t.loading.split,type:"primary"},on:{click:t.onSubmit}},[t._v("\n      确认拆分\n    ")])],1)],2)},r=[],o=(n("28a5"),n("c32d")),c=n.n(o),l=n("d225"),d=n("b0b4"),u=n("9ab4"),f=n("0cd5"),p=n("df29"),_=n("537a"),m=n("c4cc"),h=n("54da"),b=function(){function t(e){Object(l["a"])(this,t),this.orderApi=e,this.info$=new p["d"]({}),this.loading$=new p["d"]({}),this.saleList$=new p["d"]([])}return Object(d["a"])(t,[{key:"getDetail",value:function(t){var e=this;return this.orderApi.getSplitDetail(t).pipe(Object(m["a"])((function(t){e.info$.commit((function(){return t.info}))})))}},{key:"getSaleList",value:function(){var t=this;return this.orderApi.getSaleList().pipe(Object(m["a"])((function(e){t.saleList$.commit((function(){return e.list}))})))}},{key:"split",value:function(t){return this.orderApi.split(t)}},{key:"serviceInit",value:function(t){return Object(h["a"])(this.getDetail(t),this.getSaleList())}}]),t}();Object(u["b"])([Object(p["c"])(),Object(u["d"])("design:type",Function),Object(u["d"])("design:paramtypes",["function"===typeof(i="undefined"!==typeof _["SplitParams"]&&_["SplitParams"])?i:Object]),Object(u["d"])("design:returntype",void 0)],b.prototype,"split",null),Object(u["b"])([Object(p["c"])(),Object(u["d"])("design:type",Function),Object(u["d"])("design:paramtypes",[String]),Object(u["d"])("design:returntype",void 0)],b.prototype,"serviceInit",null),b=Object(u["b"])([Object(f["b"])(),Object(u["d"])("design:paramtypes",["function"===typeof(a="undefined"!==typeof _["c"]&&_["c"])?a:Object])],b);var v,y=n("5c8a"),S=function(t){return[{title:"销售姓名",dataIndex:"staff_name",scopedSlots:{customRender:"staff_name"}},{title:"销售身份",dataIndex:"staff_type_name",scopedSlots:{customRender:"staff_type_name"}},{title:"拆分比例",dataIndex:"split_ratio",scopedSlots:{customRender:"split_ratio"}},{title:"业务金额(元)",dataIndex:"split_money",scopedSlots:{customRender:"split_money"}},{title:"操作",dataIndex:"action",width:140,scopedSlots:{customRender:"action"}}]};(function(t){t[t["STAFF_TYPE_1"]=1]="STAFF_TYPE_1",t[t["STAFF_TYPE_2"]=2]="STAFF_TYPE_2",t[t["EDIT_TYPE_1"]=1]="EDIT_TYPE_1",t[t["EDIT_TYPE_2"]=2]="EDIT_TYPE_2",t[t["EDIT_TYPE_3"]=3]="EDIT_TYPE_3"})(v||(v={}));var g=n("e69b"),O={name:"ModalShopFinanceOrderSplit",bem:{basic:"modal-shop-finance-split"},serviceInject:function(){return{splitService:b,messageService:g["a"]}},rxState:function(){return{info:this.splitService.info$,loading:this.splitService.loading$,saleList:this.splitService.saleList$}},props:["id"],data:function(){return{SPLIT:v,form:this.$form.createForm(this),show:!1,description:"",rate:0,saleMan:""}},computed:{columns:S},created:function(){var t=this;this.splitService.serviceInit(this.id).subscribe((function(e){t.description=t.info.description||"";var n={edit:t.SPLIT.EDIT_TYPE_3,staff_id:void 0,staff_name:"",staff_type:t.SPLIT.STAFF_TYPE_2,staff_type_name:"协助销售",split_ratio:"",split_money:""};return t.info.split_items.unshift(n)}))},methods:{changeSaleMan:function(t,e){this.info.split_items[e].staff_id=t.staff_id,this.info.split_items[e].staff_name=t.staff_name},validSaleMan:function(t){if(!this.info.split_items||this.info.split_items.length>=7)return!1;for(var e=0,n=1;n<this.info.split_items.length;n++)if(e+=parseInt(this.info.split_items[n].split_ratio||0,10),this.info.split_items[n].staff_id===t.staff_id)return this.messageService.error({content:"销售人员不能重复"}),!1;return e+=parseInt(t.split_ratio,10),!(e>100)||(this.messageService.error({content:"拆分比例总和不能超过100%"}),!1)},addSaleMan:function(t){if(t.staff_id&&t.split_ratio&&this.validSaleMan(t)){delete t.edit;var e=+t.split_ratio/100*+this.info.actual_price;e=Math.floor(10*e)/10,t.split_money=e,this.info.split_items.splice(0,1,t);var n={edit:this.SPLIT.EDIT_TYPE_3,staff_id:void 0,staff_name:"",staff_type:this.SPLIT.STAFF_TYPE_2,staff_type_name:"协助销售",split_ratio:"",split_money:""};this.info.split_items.unshift(n)}},onSave:function(t,e){var n=0,i=Object(y["a"])(this.info.split_items);if(i.shift(),i.map((function(t){n+=parseInt(t.split_ratio||0,10)})),n>100)this.messageService.error({content:"拆分比例总和不能超过100%"});else{delete t.edit;var a=+t.split_ratio/100*+this.info.actual_price;a=Math.floor(10*a)/10,t.split_money=a,this.info.split_items.splice(e,1,t),this.info.split_items[0].staff_id=void 0,this.info.split_items[0].split_ratio=""}},onEidt:function(t,e){t.meta=Object(y["a"])(t),t.edit=t.staff_type,this.info.split_items.splice(e,1,t)},onCanel:function(t,e){t=t.meta,this.info.split_items.splice(e,1,t)},onDelete:function(t){this.info.split_items.splice(t,1)},moment:c.a,onSubmit:function(){var t=this,e=this.info.split_items.map((function(t){var e={};return-1!==t.staff_id&&(e.staff_id=t.staff_id,e.staff_rate=t.split_ratio),e}));e.shift();var n={order_id:this.id,description:this.description,split_data:e};this.splitService.split(n).subscribe((function(e){t.show=!1,t.$emit("success")}))}}},$=O,k=n("2877"),j=Object(k["a"])($,s,r,!1,null,null,null);e["a"]=j.exports},a860:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("st-panel",{attrs:{app:""}},[n("div",{attrs:{slot:"title"},slot:"title"},[n("st-input-search",{attrs:{placeholder:"请输入订单编号、会员姓名或手机号查找"},on:{search:function(e){return t.onSingleSearch("keyword",e,!0)}},model:{value:t.$searchQuery.keyword,callback:function(e){t.$set(t.$searchQuery,"keyword",e)},expression:"$searchQuery.keyword"}})],1),n("st-search-panel",{attrs:{slot:"prepend"},slot:"prepend"},[n("st-search-panel-item",{attrs:{label:"订单状态："}},[n("st-search-radio",{attrs:{options:t.orderStatus},model:{value:t.$searchQuery.status,callback:function(e){t.$set(t.$searchQuery,"status",e)},expression:"$searchQuery.status"}})],1),n("st-search-panel-item",{attrs:{label:"支付状态："}},[n("st-search-radio",{attrs:{options:t.payStatus},model:{value:t.$searchQuery.type,callback:function(e){t.$set(t.$searchQuery,"type",e)},expression:"$searchQuery.type"}})],1),n("st-search-panel-item",{attrs:{label:"创建时间："}},[n("st-range-picker",{attrs:{disabledDays:180},model:{value:t.createDate,callback:function(e){t.createDate=e},expression:"createDate"}})],1),n("st-search-panel-item",{attrs:{label:"支付时间："}},[n("st-range-picker",{attrs:{disabledDays:180},model:{value:t.payDate,callback:function(e){t.payDate=e},expression:"payDate"}})],1),n("st-search-panel-item",{attrs:{label:"商品类型："}},[n("a-select",{staticStyle:{width:"170px"},attrs:{defaultValue:-1,placeholder:"请选商品类型",options:t.productTypeList},on:{change:t.onProductTypeChange},model:{value:t.$searchQuery.product_type,callback:function(e){t.$set(t.$searchQuery,"product_type",e)},expression:"$searchQuery.product_type"}})],1),n("div",{attrs:{slot:"button"},slot:"button"},[n("st-button",{attrs:{type:"primary"},on:{click:t.onSearchNative}},[t._v("查询")]),n("st-button",{staticClass:"mg-l8",on:{click:t.onSearchReset}},[t._v("重置")])],1)],1),n("div",[n("div"),n("st-table",{attrs:{scroll:{x:1650},columns:t.columns,page:t.page,dataSource:t.list,rowKey:"id",loading:t.loading.getList},on:{change:t.onTableChange},scopedSlots:t._u([{key:"pay_status",fn:function(e){return[t._v("\n        "+t._s(t._f("enumFilter")(e,"finance.pay_status"))+"\n      ")]}},{key:"member_mobile",fn:function(e,i){return[i.is_minors?n("span",[t._v("\n          "+t._s(i.parent_mobile)+"("+t._s(i.parent_user_role)+")\n        ")]):n("span",[t._v(t._s(i.member_mobile))])]}},{key:"action",fn:function(e,i){return n("div",{},[n("st-table-actions",[i.auth["brand_shop:order:order|pay"]?n("a",{on:{click:function(e){return t.onGathering(i)}}},[t._v("\n            收款\n          ")]):t._e(),i.auth["brand_shop:order:order|cancel"]?n("a",{on:{click:function(e){return t.onCancel(i)}}},[t._v("\n            取消\n          ")]):t._e(),i.auth["brand_shop:order:order|get"]?n("a",{on:{click:function(e){return t.onOrderInfo(i)}}},[t._v("\n            详情\n          ")]):t._e(),i.auth["brand_shop:order:order|refund"]?n("a",{on:{click:function(e){return t.onRefund(i)}}},[t._v("\n            退款\n          ")]):t._e(),i.auth["brand_shop:order:order|split"]?n("a",{on:{click:function(e){return t.onSplit(i)}}},[t._v("\n            业绩拆分\n          ")]):t._e(),i.auth["shop:order:order|print"]&&13!==i.product_type?n("a",{on:{click:function(e){return t.printOrder(i.id)}}},[t._v("\n            打印小票\n          ")]):t._e(),i.is_children&&i.auth["brand_shop:order:order|children_refund"]?n("a",{on:{click:function(e){return t.onChildredRefund(i)}}},[t._v("\n            退款\n          ")]):t._e()])],1)}}])})],1)],1)},a=[],s=n("1c98"),r=function(){return[{title:"订单编号",dataIndex:"id",fixed:"left",width:200,scopedSlots:{customRender:"id"}},{title:"商品类型",dataIndex:"product_type_name",scopedSlots:{customRender:"product_type_name"}},{title:"商品名称",dataIndex:"product_name",width:175,scopedSlots:{customRender:"product_name"}},{title:"订单状态",dataIndex:"order_status_name",scopedSlots:{customRender:"order_status_name"}},{title:"支付状态",dataIndex:"pay_status",scopedSlots:{customRender:"pay_status"}},{title:"会员姓名",dataIndex:"member_name",width:90,scopedSlots:{customRender:"member_name"}},{title:"手机号",dataIndex:"member_mobile",scopedSlots:{customRender:"member_mobile"}},{title:"订单总价(元)",dataIndex:"total_price",scopedSlots:{customRender:"total_price"}},{title:"优惠(元)",dataIndex:"order_discount",scopedSlots:{customRender:"order_discount"}},{title:"减免(元)",dataIndex:"reduce_price",scopedSlots:{customRender:"reduce_price"}},{title:"实收(元)",dataIndex:"pay_price",scopedSlots:{customRender:"pay_price"}},{title:"剩余待收(元)",dataIndex:"remainder_price",scopedSlots:{customRender:"remainder_price"}},{title:"创建时间",dataIndex:"created_time",scopedSlots:{customRender:"created_time"}},{title:"支付时间",dataIndex:"pay_last_time",scopedSlots:{customRender:"pay_last_time"}},{title:"销售",dataIndex:"staff_name",scopedSlots:{customRender:"staff_name"}},{title:"操作",dataIndex:"action",fixed:"right",width:140,scopedSlots:{customRender:"action"}}]},o=n("ea3e"),c=n("d89a"),l=n("3077"),d=n("5ed6"),u=n("f555"),f=n("c201"),p=n("047e"),_={name:"PageShopFinanceOrder",mixins:[o["a"]],modals:{ShopFinanceCancel:c["a"],ShopFinanceRefund:l["a"],ShopFinanceSplit:d["a"],SoldDealGathering:u["a"],SoldLeaseTransfer:f["a"]},serviceInject:function(){return{listService:s["ListService"]}},rxState:function(){return{loading:this.listService.loading$,page:this.listService.page$,list:this.listService.list$,orderStatus:this.listService.orderStatus$,payStatus:this.listService.payStatus$,productTypeList:this.listService.productType$,auth:this.listService.auth$}},computed:{columns:r},mounted:function(){this.setSearchData()},watch:{$searchQuery:function(){this.setSearchData()}},data:function(){return{ORDER_PRODUCT_TYPE:p["a"],keyword:"",status:-1,type:-1,createDate:[null,null],payDate:[null,null]}},methods:{onChildredRefund:function(t){var e=this,n={id:t.id,isParent:!1,product_type:t.product_type};this.$modalRouter.push({name:"shop-finance-refund",props:n,on:{success:function(t){e.$router.reload()}}})},printOrder:function(t){window.open("/ticket/gathering-print?id="+t,"_blank","width=800,height=600")},formatDate:function(t){return t?"".concat(moment(t).format("YYYY-MM-DD")):""},setSearchData:function(){var t=this.$searchQuery;this.createDate=[t.start_date||null,t.end_date||null],this.payDate=[t.pay_start_date||null,t.pay_end_date||null]},onSearchNative:function(){var t=this.createDate,e=this.payDate;this.$searchQuery.start_date=this.formatDate(t[0]),this.$searchQuery.end_date=this.formatDate(t[1]),this.$searchQuery.pay_start_date=this.formatDate(e[0]),this.$searchQuery.pay_end_date=this.formatDate(e[1]),this.onSearch()},onGathering:function(t){var e=this;this.$modalRouter.push({name:"sold-deal-gathering",props:{order_id:t.id,type:this.productType(t.product_type)},on:{success:function(){e.onSearch()}}})},onCancel:function(t){var e=this;this.$modalRouter.push({name:"shop-finance-cancel",props:{id:t.id},on:{success:function(t){e.$router.reload()}}})},onTransfer:function(t){var e=this;this.$modalRouter.push({name:"sold-lease-transfer",props:{id:t.id},on:{success:function(t){e.$router.reload()}}})},onRefund:function(t){var e=this,n={id:t.id,isParent:!0,product_type:t.product_type};this.$modalRouter.push({name:"shop-finance-refund",props:n,on:{success:function(t){e.$router.reload()}}})},onSplit:function(t){var e=this;this.$modalRouter.push({name:"shop-finance-split",props:{id:t.id},on:{success:function(t){e.$router.reload()}}})},onOrderInfo:function(t){this.$router.push({path:"/shop/finance/order/info/collection-details",query:{id:t.id}})},productType:function(t){var e="";switch(t){case 1:e="member";break;case 2:e="personal";break;case 3:e="team";break;case 4:e="package";break;case 5:e="deposit";break;case 6:e="small_course_order/detail";break;case 7:e="advance";break;case 8:e="advance";break;case 9:e="member";break;case 10:e="cabinet_order";break;case 12:e="cloud_store";break;case 13:e="venues"}return e},onProductTypeChange:function(){}}},m=_,h=n("2877"),b=Object(h["a"])(m,i,a,!1,null,null,null);e["default"]=b.exports},b51b:function(t,e,n){"use strict";var i;n.d(e,"a",(function(){return i})),function(t){t[t["TRANSFORM"]=1]="TRANSFORM",t[t["FREEZE"]=2]="FREEZE"}(i||(i={}))},d89a:function(t,e,n){"use strict";var i,a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("st-modal",{attrs:{title:"取消",size:"small",wrapClassName:"modal-shop-finance-cancel"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[n("div",{class:t.basic("content")},[n("a-row",{class:t.basic("info")},[n("a-col",{staticClass:"mg-b36",attrs:{span:13}},[n("st-info",[n("st-info-item",{attrs:{label:"订单号"}},[t._v(t._s(t.info.order_id))]),n("st-info-item",{staticClass:"mg-b0",attrs:{label:"下单时间"}},[t._v("\n            "+t._s(t.info.created_time)+"\n          ")])],1)],1),n("a-col",{staticClass:"mg-b36",attrs:{span:11}},[n("st-info",[n("st-info-item",{attrs:{label:"下单人"}},[t._v(t._s(t.info.operator_name))]),n("st-info-item",{staticClass:"mg-b0",attrs:{label:"销售"}},[t._v("\n            "+t._s(t.info.staff_name)+"\n          ")])],1)],1),n("a-col",{staticClass:"mg-b36",attrs:{span:13}},[n("st-info",[t.info.order_type?n("st-info-item",{attrs:{label:"订单类型"}},[t._v("\n            "+t._s(t._f("enumFilter")(t.info.order_type,"finance.order_type"))+"\n          ")]):t._e(),n("st-info-item",{staticClass:"mg-b0",attrs:{label:"订单来源"}},[t._v("\n            "+t._s(t._f("enumFilter")(t.info.order_source,"finance.order_source"))+"\n            "+t._s(t.info.mobile)+"\n          ")])],1)],1),n("a-col",{staticClass:"mg-b36",attrs:{span:11}},[n("st-info",[n("st-info-item",{attrs:{label:"场馆"}},[t._v(t._s(t.info.shop_name))]),n("st-info-item",{staticClass:"mg-b0",attrs:{label:"用户"}},[t._v("\n            "+t._s(t.info.member_name)+"\n          ")])],1)],1),n("a-col",{staticClass:"mg-b36",attrs:{span:13}},[n("st-info",[6!==t.info.order_type?n("st-info-item",{attrs:{label:"购买"}},[t._v("\n            "+t._s(t.info.product_name)+"\n          ")]):t._e(),6===t.info.order_type?n("st-info-item",{staticClass:"mg-b0 white-nowrap",attrs:{label:"购买"}},[n("st-overflow-text",{attrs:{title:"购买","max-width":"180px",value:t.info.product_list&&t.info.product_list.map((function(t){return t.product_name+"&nbsp;"+(t.rule_name?"规格：":"")+t.rule_name+"*"+t.product_count+" 金额：&yen;"+t.price}))}})],1):t._e(),n("st-info-item",{attrs:{label:"订单总额"}},[t._v("\n            "+t._s(t.info.total_price)+"元\n          ")]),n("st-info-item",{attrs:{label:"实收金额"}},[t._v("\n            "+t._s(t.info.actual_price)+"元\n          ")])],1)],1),n("a-col",{staticClass:"mg-b36",attrs:{span:11}},[n("st-info",[n("st-info-item",{attrs:{label:"赠送"}},[t._v(t._s(t.info.gift_amount))]),n("st-info-item",{attrs:{label:"应收金额"}},[t._v(t._s(t.info.pay_price)+"元")])],1)],1),n("a-col",{staticClass:"mg-b36",attrs:{span:24}},[n("st-info",[n("st-info-item",{attrs:{label:"备注"}},[t._v("\n            "+t._s(t.info.description||"")+"\n          ")])],1)],1)],1)],1),n("template",{slot:"footer"},[n("st-button",{attrs:{loading:t.loading.orderCancel,type:"primary"},on:{click:t.onSubmit}},[t._v("\n      确认取消\n    ")])],1)],2)},s=[],r=n("c32d"),o=n.n(r),c=n("d225"),l=n("b0b4"),d=n("9ab4"),u=n("0cd5"),f=n("df29"),p=n("537a"),_=n("c4cc"),m=function(){function t(e){Object(c["a"])(this,t),this.orderApi=e,this.info$=new f["d"]({}),this.loading$=new f["d"]({})}return Object(l["a"])(t,[{key:"getDetail",value:function(t){var e=this;return this.orderApi.getDetail(t).pipe(Object(_["a"])((function(t){e.info$.commit((function(){return t.info}))})))}},{key:"orderCancel",value:function(t){return this.orderApi.orderCancel(t)}}]),t}();Object(d["b"])([Object(f["c"])(),Object(d["d"])("design:type",Function),Object(d["d"])("design:paramtypes",[String]),Object(d["d"])("design:returntype",void 0)],m.prototype,"orderCancel",null),m=Object(d["b"])([Object(u["b"])(),Object(d["d"])("design:paramtypes",["function"===typeof(i="undefined"!==typeof p["c"]&&p["c"])?i:Object])],m);var h=n("2138"),b={name:"ModalShopFinanceOrderCancel",bem:{basic:"modal-shop-finance-order-cancel"},serviceInject:function(){return{userService:h["a"],cancelService:m}},rxState:function(){return{info:this.cancelService.info$,loading:this.cancelService.loading$}},props:["id"],data:function(){return{show:!1}},computed:{},created:function(){this.cancelService.getDetail(this.id).subscribe()},methods:{moment:o.a,onSubmit:function(){var t=this;this.cancelService.orderCancel(this.info.order_id).subscribe((function(e){t.$emit("success"),t.show=!1}))}}},v=b,y=n("2877"),S=Object(y["a"])(v,a,s,!1,null,null,null);e["a"]=S.exports},e748:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{class:t.basic()},[n("st-panel",{attrs:{title:"订单详情"}},[n("div",{attrs:{slot:"actions"},slot:"actions"},[n("st-btn-actions",{attrs:{options:[{if:t.auth["brand_shop:order:order|refund"],text:"退款",click:t.onRefund},{if:t.auth["brand_shop:order:order|pay"],text:"收款",click:t.createdOrderPay},{if:t.auth["brand_shop:order:order|cancel"],text:"取消",click:t.onCancel},{if:t.auth["brand_shop:order:order|split"],text:"业绩拆分",click:t.onSplit}]}})],1),n("a-row",{attrs:{gutter:24}},[n("a-col",{attrs:{span:9}},[n("st-info",[n("st-info-item",{attrs:{label:"订单号"}},[t._v(t._s(t.info.id))]),n("st-info-item",{attrs:{label:"商品名称"}},[t._v("\n            "+t._s(t.info.product_name)+"\n          ")]),n("st-info-item",{attrs:{label:"购买会员"}},[t._v("\n            "+t._s(t.info.member_name)+"\n          ")]),t.info.is_minors===t.PERSON_TYPE.CHILD?[n("st-info-item",{attrs:{label:"家长手机号"}},[t._v("\n              "+t._s(t.info.parent_mobile)+"\n            ")]),n("st-info-item",{attrs:{label:"家长姓名"}},[t._v("\n              "+t._s(t.info.parent_name)+"("+t._s(t.info.parent_user_role)+")\n            ")])]:[n("st-info-item",{attrs:{label:"手机号"}},[t._v("\n              "+t._s(t.info.member_mobile)+"\n            ")])],n("st-info-item",{attrs:{label:"下单人"}},[t._v(t._s(t.info.operator_name))]),n("st-info-item",{attrs:{label:"下单时间"}},[t._v("\n            "+t._s(t.info.created_time)+"\n          ")]),n("st-info-item",{attrs:{label:"销售"}},[t._v(t._s(t.info.staff_name))]),n("st-info-item",{attrs:{label:"订单状态"}},[t._v("\n            "+t._s(t._f("enumFilter")(t.info.order_status,"finance.order_status"))+"\n          ")])],2)],1),n("a-col",{attrs:{span:9}},[n("st-info",[n("st-info-item",{attrs:{label:"赠送"}},[t._v(t._s(t.info.gift_amount))]),n("st-info-item",{attrs:{label:"订单总额"}},[t._v(t._s(t.info.total_price))]),n("st-info-item",{attrs:{label:"优惠金额"}},[t._v("\n            "+t._s(t.info.order_discount)+"\n          ")]),n("st-info-item",{attrs:{label:"减免金额"}},[t._v("\n            "+t._s(t.info.reduce_price)+"\n          ")]),n("st-info-item",{attrs:{label:"应收金额"}},[t._v(t._s(t.info.pay_price))]),12===t.info.product_type?n("st-info-item",{attrs:{label:"待收金额"}},[t._v("\n            "+t._s(t.info.remainder_price)+"\n          ")]):t._e(),n("st-info-item",{attrs:{label:"支付状态"}},[t._v("\n            "+t._s(t._f("enumFilter")(t.info.pay_status,"finance.pay_status"))+"\n          ")])],1)],1),n("a-col",{attrs:{span:6}},[n("st-info",[n("st-info-item",{attrs:{label:"备注"}},[t._v(t._s(t.info.description))])],1)],1)],1)],1),n("st-panel",{staticClass:"mg-t12",class:t.basic("panel-bottom"),attrs:{initial:"",tabs:t.tabs}},[n("router-view")],1)],1)},a=[],s=(n("7f7f"),n("7618")),r=n("0b3b"),o=n("d89a"),c=n("3077"),l=n("5ed6"),d=n("f555"),u=n("047e"),f=n("b283"),p={name:"PageShopFinanceOrderInfo",bem:{basic:"page-shop-finance-info"},modals:{ShopFinanceCancel:o["a"],ShopFinanceRefund:c["a"],ShopFinanceSplit:l["a"],SoldDealGathering:d["a"]},serviceInject:function(){return{infoService:r["InfoService"]}},rxState:function(){return{info:this.infoService.info$,tabs:this.infoService.tabs$,auth:this.infoService.auth$}},data:function(){return{ORDER_PRODUCT_TYPE:u["a"],PERSON_TYPE:f["e"]}},computed:{infoParents:function(){var t="";return t="object"===Object(s["a"])(this.info.parents)?"".concat(this.info.parents.name," (").concat(this.info.parents.mobile,")"):this.info.parents,t}},methods:{createdOrderPay:function(){var t=this;this.$modalRouter.push({name:"sold-deal-gathering",props:{order_id:this.$searchQuery.id,type:this.productType(this.info.product_type)},on:{success:function(){t.$router.reload()}}})},onRefund:function(){var t=this,e={id:this.$searchQuery.id,product_type:this.info.product_type};this.$modalRouter.push({name:"shop-finance-refund",props:e,on:{success:function(){t.$router.reload()}}})},onSplit:function(){var t=this;this.$modalRouter.push({name:"shop-finance-split",props:{id:this.$searchQuery.id},on:{success:function(e){t.$router.reload()}}})},onCancel:function(){var t=this;this.$modalRouter.push({name:"shop-finance-cancel",props:{id:this.$searchQuery.id},on:{success:function(e){t.$router.reload()}}})},productType:function(t){var e="";switch(t){case 1:e="member";break;case 2:e="personal";break;case 3:e="member";break;case 4:e="package";break;case 5:e="deposit";break;case 6:e="small_course_order/detail";break;case 7:e="advance";break;case 8:e="advance";break;case 9:e="member";break;case 10:e="cabinet_order";break;case 12:e="cloud_store";break;case 13:e="venues"}return e}}},_=p,m=n("2877"),h=Object(m["a"])(_,i,a,!1,null,null,null);e["default"]=h.exports}}]);