{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhigang/Desktop/styd/web/src/views/biz-modals/brand/marketing/share-poster.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/biz-modals/brand/marketing/share-poster.vue","mtime":1600926555831},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js","mtime":1591062572376}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { ShsService } from '@/services/shs.service'\nimport { cloneDeep } from 'lodash-es'\nexport default {\n  name: 'BrandMarketingPoster',\n  bem: {\n    basic: 'brand-marketing-share'\n  },\n  serviceInject() {\n    return {\n      shsService: ShsService\n    }\n  },\n  serviceProviders() {\n    return [ShsService]\n  },\n  props: {\n    // shsInfo 的qrcode_url必传\n    shsInfo: {\n      type: Object,\n      default: () => {}\n    },\n    // 是否新增下载二维码按钮\n    hasQrCodeBtn: {\n      type: Boolean,\n      default: false\n    },\n    shsPath: String\n  },\n  data() {\n    return {\n      show: false,\n      url: '',\n      title: '分享海报',\n      message:\n        '复制和下载二维码，推广至微信朋友圈、微博等，或打印活动海报，张贴至门店，吸引顾客参与活动。',\n      button: '下载海报'\n    }\n  },\n  created() {\n    const shsInfo = cloneDeep(this.shsInfo)\n    this.shsService.getShsImage(shsInfo, this.shsPath).subscribe(res => {\n      this.url = res\n    })\n  },\n  methods: {\n    downloadFile(url, filename = '') {\n      fetch(url, {\n        headers: new Headers({\n          Origin: location.origin\n        }),\n        mode: 'cors'\n      })\n        .then(res => res.blob())\n        .then(blob => {\n          const blobUrl = window.URL.createObjectURL(blob)\n          this.download(blobUrl, filename)\n          window.URL.revokeObjectURL(blobUrl)\n        })\n    },\n    download(blobUrl, filename) {\n      const a = document.createElement('a')\n      a.href = blobUrl\n      a.target = '_blank'\n      a.download = filename\n      document.body.appendChild(a)\n      a.click()\n      a.remove()\n    }\n  }\n}\n",{"version":3,"sources":["share-poster.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"share-poster.vue","sourceRoot":"src/views/biz-modals/brand/marketing","sourcesContent":["<template>\n  <st-modal :title=\"title\" v-model=\"show\" width=\"400px\" :footer=\"null\">\n    <div :class=\"basic()\">\n      <p :class=\"basic('tip')\">{{ message }}</p>\n      <st-image :src=\"url\" :class=\"basic('poster')\"></st-image>\n      <div :class=\"basic('btn-group')\">\n        <st-button\n          pill\n          type=\"primary\"\n          icon=\"download\"\n          size=\"large\"\n          class=\"mg-r8\"\n          :class=\"basic('button')\"\n          @click=\"downloadFile(url, 'poster.png')\"\n        >\n          {{ button }}\n        </st-button>\n        <st-button\n          pill\n          v-if=\"hasQrCodeBtn\"\n          type=\"primary\"\n          icon=\"download\"\n          size=\"large\"\n          :class=\"basic('button')\"\n          @click=\"downloadFile(shsInfo.qrcode_url, 'qrcode.png')\"\n        >\n          下载小程序码\n        </st-button>\n      </div>\n    </div>\n  </st-modal>\n</template>\n<script>\nimport { ShsService } from '@/services/shs.service'\nimport { cloneDeep } from 'lodash-es'\nexport default {\n  name: 'BrandMarketingPoster',\n  bem: {\n    basic: 'brand-marketing-share'\n  },\n  serviceInject() {\n    return {\n      shsService: ShsService\n    }\n  },\n  serviceProviders() {\n    return [ShsService]\n  },\n  props: {\n    // shsInfo 的qrcode_url必传\n    shsInfo: {\n      type: Object,\n      default: () => {}\n    },\n    // 是否新增下载二维码按钮\n    hasQrCodeBtn: {\n      type: Boolean,\n      default: false\n    },\n    shsPath: String\n  },\n  data() {\n    return {\n      show: false,\n      url: '',\n      title: '分享海报',\n      message:\n        '复制和下载二维码，推广至微信朋友圈、微博等，或打印活动海报，张贴至门店，吸引顾客参与活动。',\n      button: '下载海报'\n    }\n  },\n  created() {\n    const shsInfo = cloneDeep(this.shsInfo)\n    this.shsService.getShsImage(shsInfo, this.shsPath).subscribe(res => {\n      this.url = res\n    })\n  },\n  methods: {\n    downloadFile(url, filename = '') {\n      fetch(url, {\n        headers: new Headers({\n          Origin: location.origin\n        }),\n        mode: 'cors'\n      })\n        .then(res => res.blob())\n        .then(blob => {\n          const blobUrl = window.URL.createObjectURL(blob)\n          this.download(blobUrl, filename)\n          window.URL.revokeObjectURL(blobUrl)\n        })\n    },\n    download(blobUrl, filename) {\n      const a = document.createElement('a')\n      a.href = blobUrl\n      a.target = '_blank'\n      a.download = filename\n      document.body.appendChild(a)\n      a.click()\n      a.remove()\n    }\n  }\n}\n</script>\n"]}]}