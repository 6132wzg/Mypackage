{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js!/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhigang/Desktop/styd/web/src/views/biz-components/schedule/date#/schedule-card.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/biz-components/schedule/date#/schedule-card.vue","mtime":1600926555714},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js","mtime":1591062572376}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.array.sort\";\nimport \"core-js/modules/es6.number.constructor\";\nimport \"core-js/modules/es6.regexp.split\";\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nvar toTen = function toTen(time) {\n  return time.split(':').map(function (n, i) {\n    return {\n      0: +n,\n      1: +n / 60\n    }[i];\n  }).reduce(function (res, n) {\n    return res + n;\n  }, 0);\n};\n\nexport default {\n  name: 'Card',\n  bem: {\n    bCard: 'schedule-card'\n  },\n  props: {\n    cardList: {\n      type: Array,\n      default: function _default() {}\n    },\n    week: {\n      type: Number,\n      default: 99\n    }\n  },\n  computed: {\n    start: function start() {\n      return this.$searchQuery.start_date;\n    }\n  },\n  filters: {\n    barClass: function barClass(item) {\n      var date = moment(\"\".concat(item.start_date, \" \").concat(item.start_time));\n      var current = moment();\n\n      if (date > current) {\n        return 'after';\n      } else if (date === current) {\n        return 'current';\n      } else if (date < current) {\n        return 'before';\n      }\n    }\n  },\n  methods: {\n    dealCourtName: function dealCourtName(courseName, currentCourseName) {\n      return currentCourseName ? courseName + '.' + currentCourseName : courseName;\n    },\n    mbarClass: function mbarClass(item) {\n      var date = moment(\"\".concat(item.start_date, \" \").concat(item.start_time));\n      var current = moment();\n\n      if (date > current) {\n        return 'after';\n      } else if (date === current) {\n        return 'current';\n      } else if (date < current) {\n        return 'before';\n      }\n    },\n    onClick: function onClick(val) {\n      this.$emit('detail', val);\n    },\n    getMatrix: function getMatrix(n) {\n      var weekOfday = moment(this.start).format('E');\n      var date = moment(this.start).subtract(weekOfday - n, 'days').format('YYYY-MM-DD');\n      n === 0 && (date = this.start);\n      var sortedList = this.cardList.filter(function (item) {\n        return item.start_date === date;\n      }).map(function (item) {\n        if (moment(item.end_date) > moment(item.start_date)) {\n          item.overload = 1;\n        }\n\n        item.start = toTen(item.start_time);\n        item.end = toTen(item.end_time);\n        return item;\n      }).sort(function (a, b) {\n        return a.start - b.start;\n      });\n      var timeMatrix = [];\n      var prevStart;\n      var prevEnd;\n      var group = [];\n      var groupIndex = 0;\n      sortedList.forEach(function (item) {\n        if (prevStart === undefined) {\n          prevStart = item.start;\n          prevEnd = item.end;\n        } else {\n          if (item.start < prevEnd) {\n            if (item.end > prevEnd) {\n              prevEnd = item.end;\n            }\n          } else {\n            // 以当前item标记开始位和结束位\n            prevStart = item.start;\n            prevEnd = item.end; // 新增分组\n\n            group = [];\n            groupIndex++;\n          }\n        }\n\n        group.push(item);\n        timeMatrix[groupIndex] = group;\n      });\n      return timeMatrix;\n    },\n    itemStyle: function itemStyle(item) {\n      return {\n        top: \"calc((100% - 40px) * \".concat(item.start / 24, \" + 40px)\"),\n        height: \"\".concat((item.end - item.start) / 24 * 100, \"%\")\n      };\n    }\n  }\n};",{"version":3,"sources":["schedule-card.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div :class=\"bCard()\">\n    <section\n      v-for=\"group in getMatrix(week)\"\n      :key=\"group.id\"\n      :class=\"[bCard('item-group'), bCard(`item-group--has-${group.length}`)]\"\n    >\n      <div\n        class=\"con-item\"\n        :class=\"[`item-${i}`, `${mbarClass(item)}`]\"\n        v-for=\"(item, i) in group\"\n        :key=\"i\"\n        @click=\"onClick(item)\"\n        :style=\"itemStyle(item)\"\n      >\n        <div class=\"schedule-card__bar\" :class=\"item | barClass\"></div>\n\n        <div :class=\"bCard('content')\">\n          <span class=\"time\">\n            <st-icon type=\"timer\"></st-icon>\n            {{ item.start_time }}-{{ item.end_time }}\n          </span>\n          <st-t3 class=\"course__name\">\n            {{ dealCourtName(item.course_name, item.current_course_name) }}\n          </st-t3>\n          <p class=\"course__coach\">{{ $c('coach') }}：{{ item.coach_name }}</p>\n        </div>\n\n        <div class=\"item__extra\" :class=\"item | barClass\">\n          <div :class=\"bCard('content')\">\n            <div class=\"mg-b8 time\">\n              <st-icon type=\"timer\"></st-icon>\n              {{ item.start_time }}-{{ item.end_time }}\n            </div>\n            <st-t3 class=\"mg-b8 course__name\">\n              {{ dealCourtName(item.course_name, item.current_course_name) }}\n            </st-t3>\n            <p class=\"mg-b8 course__item\">\n              <span class=\"label\">{{ $c('coach') }}：</span>\n              <span class=\"value\">{{ item.coach_name }}</span>\n            </p>\n            <p v-if=\"item.court_name\" class=\"mg-b8 course__item\">\n              <span class=\"label\">场地：</span>\n              <span class=\"value\">{{ item.court_name }}</span>\n            </p>\n            <p v-if=\"item.member_name\" class=\"course__item\">\n              <span class=\"label\">会员：</span>\n              <span class=\"value\">{{ item.member_name }}</span>\n            </p>\n          </div>\n        </div>\n      </div>\n    </section>\n  </div>\n</template>\n\n<script>\nconst toTen = time => {\n  return time\n    .split(':')\n    .map((n, i) => {\n      return {\n        0: +n,\n        1: +n / 60\n      }[i]\n    })\n    .reduce((res, n) => res + n, 0)\n}\nexport default {\n  name: 'Card',\n  bem: {\n    bCard: 'schedule-card'\n  },\n  props: {\n    cardList: {\n      type: Array,\n      default: () => {}\n    },\n    week: {\n      type: Number,\n      default: 99\n    }\n  },\n  computed: {\n    start() {\n      return this.$searchQuery.start_date\n    }\n  },\n  filters: {\n    barClass(item) {\n      const date = moment(`${item.start_date} ${item.start_time}`)\n      const current = moment()\n      if (date > current) {\n        return 'after'\n      } else if (date === current) {\n        return 'current'\n      } else if (date < current) {\n        return 'before'\n      }\n    }\n  },\n  methods: {\n    dealCourtName(courseName, currentCourseName) {\n      return currentCourseName\n        ? courseName + '.' + currentCourseName\n        : courseName\n    },\n    mbarClass(item) {\n      const date = moment(`${item.start_date} ${item.start_time}`)\n      const current = moment()\n      if (date > current) {\n        return 'after'\n      } else if (date === current) {\n        return 'current'\n      } else if (date < current) {\n        return 'before'\n      }\n    },\n    onClick(val) {\n      this.$emit('detail', val)\n    },\n    getMatrix(n) {\n      let weekOfday = moment(this.start).format('E')\n      let date = moment(this.start)\n        .subtract(weekOfday - n, 'days')\n        .format('YYYY-MM-DD')\n      n === 0 && (date = this.start)\n      const sortedList = this.cardList\n        .filter(item => item.start_date === date)\n        .map(item => {\n          if (moment(item.end_date) > moment(item.start_date)) {\n            item.overload = 1\n          }\n          item.start = toTen(item.start_time)\n          item.end = toTen(item.end_time)\n          return item\n        })\n        .sort((a, b) => {\n          return a.start - b.start\n        })\n\n      const timeMatrix = []\n      let prevStart\n      let prevEnd\n      let group = []\n      let groupIndex = 0\n\n      sortedList.forEach(item => {\n        if (prevStart === undefined) {\n          prevStart = item.start\n          prevEnd = item.end\n        } else {\n          if (item.start < prevEnd) {\n            if (item.end > prevEnd) {\n              prevEnd = item.end\n            }\n          } else {\n            // 以当前item标记开始位和结束位\n            prevStart = item.start\n            prevEnd = item.end\n            // 新增分组\n            group = []\n            groupIndex++\n          }\n        }\n        group.push(item)\n\n        timeMatrix[groupIndex] = group\n      })\n      return timeMatrix\n    },\n    itemStyle(item) {\n      return {\n        top: `calc((100% - 40px) * ${item.start / 24} + 40px)`,\n        height: `${((item.end - item.start) / 24) * 100}%`\n      }\n    }\n  }\n}\n</script>\n"],"sourceRoot":"src/views/biz-components/schedule/date#"}]}