{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/thread-loader/dist/cjs.js!/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js!/Users/wangzhigang/Desktop/styd/web/src/views/pages/brand/setting/mina/components#/h5/form-components#/mixin.js","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/pages/brand/setting/mina/components#/h5/form-components#/mixin.js","mtime":1598250255839},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/thread-loader/dist/cjs.js","mtime":1591062572352},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.number.constructor\";\nimport CustomDecorateProductTableSelect from '@/views/biz-modals/custom-decorate/product-table-select';\nexport default {\n  modals: {\n    CustomDecorateProductTableSelect: CustomDecorateProductTableSelect\n  },\n  props: {\n    value: {\n      type: Object,\n      default: function _default() {\n        return {};\n      }\n    },\n\n    /**\n     * 模块名称\n     */\n    moduleName: {\n      type: String,\n      default: ''\n    },\n\n    /**\n     * 模块类型\n     */\n    moduleType: {\n      type: [Number, String],\n      default: 1\n    },\n\n    /**\n     * 门店 id\n     */\n    shopId: {\n      type: [Number, String],\n      default: 0\n    },\n\n    /**\n     * 限制数量\n     */\n    maxNum: {\n      type: Number,\n      default: 5\n    }\n  },\n  data: function data() {\n    return {\n      draggableOptions: {\n        filter: '.ignore-elements'\n      },\n      DATA_SOURCE_CUSTOM: 99,\n      flexibleKeys: ['show_direction', 'data_source', 'show_content'],\n      idKeyName: 'id',\n      customList: []\n    };\n  },\n  computed: {\n    isShowCustom: function isShowCustom() {\n      return this.data_source === this.DATA_SOURCE_CUSTOM;\n    },\n    selectedRowKeys: function selectedRowKeys() {\n      var _this = this;\n\n      var selectedRowKeys = [];\n      this.value.list.forEach(function (item) {\n        selectedRowKeys.push(item[_this.idKeyName]);\n      });\n      return selectedRowKeys;\n    }\n  },\n  watch: {\n    value: function value(val) {\n      this.init();\n    },\n    data_source: function data_source(newVal, oldVal) {\n      /**\n       * 缓存自定义数据\n       */\n      var DATA_SOURCE_CUSTOM = this.DATA_SOURCE_CUSTOM;\n\n      if (oldVal === DATA_SOURCE_CUSTOM) {\n        this.customList = this.value.list;\n      }\n\n      if (newVal === DATA_SOURCE_CUSTOM && oldVal !== null) {\n        this.value.list = this.customList;\n      }\n    }\n  },\n  created: function created() {\n    this.init();\n  },\n  methods: {\n    init: function init() {\n      var _this2 = this;\n\n      this.flexibleKeys.forEach(function (key) {\n        if (_this2.hasOwnProperty(key)) {\n          _this2[key] = _this2.value[key];\n        }\n      });\n    },\n    onDel: function onDel(index) {\n      this.value.list.splice(index, 1);\n      this.onChange();\n    },\n    onImageChange: function onImageChange(images, index) {\n      this.value.list[index].image = images.length ? images.pop() : [];\n      this.onChange();\n    },\n    onChange: function onChange() {\n      var _this3 = this;\n\n      var list = this.value.list;\n      var data = {\n        list: list\n      };\n      this.flexibleKeys.forEach(function (key) {\n        if (_this3.hasOwnProperty(key)) {\n          data[key] = _this3[key];\n        }\n      });\n      this.$emit('input', data);\n      this.$emit('change');\n      console.log('change', data);\n    },\n\n    /**\n     * 触发定义选择\n     */\n    onCustomAction: function onCustomAction() {\n      var _this4 = this;\n\n      var _this$modalConfig = this.modalConfig,\n          title = _this$modalConfig.title,\n          max = _this$modalConfig.max;\n      this.$modalRouter.push({\n        name: 'custom-decorate-product-table-select',\n        props: {\n          module_type: this.moduleType,\n          defaultSelectedRowKeys: this.selectedRowKeys,\n          defaultSelectedRows: this.value.list,\n          idKeyName: this.idKeyName,\n          shopId: this.shopId,\n          title: title,\n          max: max\n        },\n        on: {\n          complete: function complete(res) {\n            if (typeof _this4.adaptor === 'function') {\n              _this4.value.list = _this4.adaptor(res.selectedRows);\n\n              _this4.onChange();\n            }\n          }\n        }\n      });\n    },\n    selectedRowKeysFilter: function selectedRowKeysFilter() {\n      var _this5 = this;\n\n      var selectedRowKeys = [];\n      this.value.list.forEach(function (item) {\n        selectedRowKeys.push(item[_this5.idKeyName]);\n      });\n      return selectedRowKeys;\n    }\n  }\n};",null]}