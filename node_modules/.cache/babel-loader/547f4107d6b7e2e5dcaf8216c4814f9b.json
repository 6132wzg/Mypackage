{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js!/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhigang/Desktop/styd/web/src/views/biz-components/staff-select/select-search.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/biz-components/staff-select/select-search.vue","mtime":1600926555723},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js","mtime":1591062572376}],"contextDependencies":[],"result":["import _readOnlyError from \"/Users/wangzhigang/Desktop/styd/web/node_modules/@babel/runtime-corejs2/helpers/esm/readOnlyError\";\nimport \"core-js/modules/es6.regexp.constructor\";\nimport \"core-js/modules/es6.regexp.replace\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { debounce, isEqual } from 'lodash-es';\nexport default {\n  name: 'SelectSearch',\n  bem: {\n    b: 'staff-select'\n  },\n  data: function data() {\n    return {\n      // 搜索关键字\n      keyword: '',\n      // 选择的会员\n      selected: undefined\n    };\n  },\n  props: {\n    list: {\n      type: Array,\n      default: function _default() {\n        return [];\n      }\n    },\n    labelHtml: {\n      type: Function,\n      default: function _default(label, keyword) {\n        return label.replace(new RegExp(keyword, 'g'), \"<span class='global-highlight-color'>\".concat(keyword, \"</span>\"));\n      }\n    },\n    loading: {\n      type: Boolean,\n      default: false\n    },\n    isSrcoll: {\n      type: Boolean,\n      default: false\n    },\n    placeholder: String\n  },\n  model: {\n    props: 'value',\n    event: 'change'\n  },\n  computed: {\n    isSearchNone: function isSearchNone() {\n      return this.keyword !== '' && !this.list.length;\n    }\n  },\n  watch: {\n    list: function list(newValue, oldValue) {\n      if (isEqual(newValue, oldValue) || !newValue.length) return; // 默认选中第一项 blur时起作用，不使用默认，补卡弹窗会影响到页面的搜索\n      // this.selected = newValue[0].value\n    },\n    selected: function selected(val) {\n      // 防止不选择清空\n      if (this.list.length === 0) {\n        this.selected = '';\n        this.$emit('change', '');\n      }\n    }\n  },\n  components: {},\n  methods: {\n    // 搜索会员\n    onSearch: debounce(function (val) {\n      var str = val.trim();\n      if (this.keyword === str) return;\n      this.keyword = str;\n\n      if (str !== '') {\n        this.$emit('search', str);\n      }\n    }, 200),\n    // 检测清空选中\n    onChange: function onChange(val) {\n      console.log('onChange', val);\n      !val && this.$emit('change', this.selected);\n    },\n    // 选择发生变化\n    onSelect: function onSelect(val) {\n      console.log('onSelect', val, this.list);\n      var data = val;\n\n      if (this.list.length === 0) {\n        this.selected = '';\n        data = (_readOnlyError(\"data\"), '');\n      }\n\n      this.$emit('change', data);\n    },\n    // 会员搜索框失去焦点\n    onBlur: function onBlur() {\n      console.log('onBlur', this.selected);\n      this.$emit('blur', this.selected);\n    },\n    // 聚焦时先清空历史搜索\n    onFocus: function onFocus() {\n      this.keyword = '';\n    },\n    scroll: debounce(function (e) {\n      var target = e.target;\n\n      if (Math.floor(target.scrollTop) + target.clientHeight > target.scrollHeight - 20 && this.isSrcoll) {\n        if (!this.loading) {\n          this.$emit('onScroll', data);\n        }\n      }\n    }, 200)\n  }\n};",{"version":3,"sources":["select-search.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div :class=\"b()\">\n    <a-select\n      v-model=\"selected\"\n      class=\"-search-select\"\n      showSearch\n      allowClear\n      :placeholder=\"placeholder\"\n      :defaultActiveFirstOption=\"true\"\n      :filterOption=\"false\"\n      @popupScroll=\"scroll\"\n      @change=\"onChange\"\n      @search=\"onSearch\"\n      @select=\"onSelect\"\n      @blur=\"onBlur\"\n      @focus=\"onFocus\"\n      ref=\"searchSelect\"\n    >\n      <a-icon slot=\"suffixIcon\" type=\"search\" />\n      <!-- 无数据 -->\n      <slot name=\"notFoundContent\" v-bind=\"isSearchNone\">\n        <span slot=\"notFoundContent\" v-if=\"isSearchNone\">\n          查无此用户\n        </span>\n        <span slot=\"notFoundContent\" v-else>无数据</span>\n      </slot>\n      <a-select-option v-for=\"item in list\" :key=\"item.value\">\n        <span v-html=\"labelHtml(item.label, keyword)\">\n          {{ item.label }}\n        </span>\n      </a-select-option>\n      <!-- loading -->\n      <a-select-option\n        disabled\n        :key=\"new Date() + Math.random()\"\n        :class=\"reception('-search-tip')\"\n        v-if=\"loading\"\n      >\n        <a-spin size=\"small\"></a-spin>\n      </a-select-option>\n    </a-select>\n  </div>\n</template>\n<script>\nimport { debounce, isEqual } from 'lodash-es'\n\nexport default {\n  name: 'SelectSearch',\n  bem: {\n    b: 'staff-select'\n  },\n\n  data() {\n    return {\n      // 搜索关键字\n      keyword: '',\n      // 选择的会员\n      selected: undefined\n    }\n  },\n  props: {\n    list: {\n      type: Array,\n      default: () => []\n    },\n    labelHtml: {\n      type: Function,\n      default: (label, keyword) => {\n        return label.replace(\n          new RegExp(keyword, 'g'),\n          `\\<span class='global-highlight-color'\\>${keyword}\\<\\/span\\>`\n        )\n      }\n    },\n    loading: {\n      type: Boolean,\n      default: false\n    },\n    isSrcoll: {\n      type: Boolean,\n      default: false\n    },\n    placeholder: String\n  },\n  model: {\n    props: 'value',\n    event: 'change'\n  },\n  computed: {\n    isSearchNone() {\n      return this.keyword !== '' && !this.list.length\n    }\n  },\n  watch: {\n    list(newValue, oldValue) {\n      if (isEqual(newValue, oldValue) || !newValue.length) return\n      // 默认选中第一项 blur时起作用，不使用默认，补卡弹窗会影响到页面的搜索\n      // this.selected = newValue[0].value\n    },\n    selected(val) {\n      // 防止不选择清空\n      if (this.list.length === 0) {\n        this.selected = ''\n        this.$emit('change', '')\n      }\n    }\n  },\n  components: {},\n  methods: {\n    // 搜索会员\n    onSearch: debounce(function(val) {\n      let str = val.trim()\n      if (this.keyword === str) return\n      this.keyword = str\n      if (str !== '') {\n        this.$emit('search', str)\n      }\n    }, 200),\n    // 检测清空选中\n    onChange(val) {\n      console.log('onChange', val)\n      !val && this.$emit('change', this.selected)\n    },\n    // 选择发生变化\n    onSelect(val) {\n      console.log('onSelect', val, this.list)\n      const data = val\n      if (this.list.length === 0) {\n        this.selected = ''\n        data = ''\n      }\n      this.$emit('change', data)\n    },\n    // 会员搜索框失去焦点\n    onBlur() {\n      console.log('onBlur', this.selected)\n      this.$emit('blur', this.selected)\n    },\n    // 聚焦时先清空历史搜索\n    onFocus() {\n      this.keyword = ''\n    },\n    scroll: debounce(function(e) {\n      const { target } = e\n      if (\n        Math.floor(target.scrollTop) + target.clientHeight >\n          target.scrollHeight - 20 &&\n        this.isSrcoll\n      ) {\n        if (!this.loading) {\n          this.$emit('onScroll', data)\n        }\n      }\n    }, 200)\n  }\n}\n</script>\n"],"sourceRoot":"src/views/biz-components/staff-select"}]}