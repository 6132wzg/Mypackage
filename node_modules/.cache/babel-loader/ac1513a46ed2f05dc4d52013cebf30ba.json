{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js!/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhigang/Desktop/styd/web/src/views/fragments/shop/switch.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/fragments/shop/switch.vue","mtime":1601345845254},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js","mtime":1591062572376}],"contextDependencies":[],"result":["import \"core-js/modules/es7.array.includes\";\nimport \"core-js/modules/es6.string.includes\";\nimport \"core-js/modules/web.dom.iterable\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { fromEvent } from 'rxjs';\nimport { tap, debounceTime } from 'rxjs/operators';\nimport { MessageService } from '@/services/message.service';\nimport { SwitchService } from \"./switch.service\";\nimport { UserService } from '@/services/user.service';\nimport { WsNotifyService } from '@/views/layouts/default#/ws-notify.service';\nexport default {\n  name: 'SwtichShopDrawer',\n  serviceProvider: function serviceProvider() {\n    return [SwitchService];\n  },\n  serviceInject: function serviceInject() {\n    return {\n      wsNotifyService: WsNotifyService,\n      messageService: MessageService,\n      switchService: SwitchService,\n      userService: UserService\n    };\n  },\n  rxState: function rxState() {\n    var _this$switchService = this.switchService,\n        shopList$ = _this$switchService.shopList$,\n        loading$ = _this$switchService.loading$;\n    return {\n      shopList: shopList$,\n      loading: loading$,\n      shop: this.userService.shop$,\n      isShop: this.userService.isShop$\n    };\n  },\n  data: function data() {\n    return {\n      /**\n       * Drawer 是否可见\n       */\n      visible: false,\n\n      /**\n       * 是否显示右上角的关闭按钮\n       */\n      closable: false,\n      keyword: '',\n      list: [],\n      isShowShadow: false\n    };\n  },\n  props: {\n    value: {\n      type: Boolean,\n      default: false\n    }\n  },\n  watch: {\n    value: function value(val) {\n      this.visible = val;\n      this.onSearch();\n    }\n  },\n  computed: {\n    currentShopId: function currentShopId() {\n      return this.shop.id;\n    }\n  },\n  methods: {\n    onClose: function onClose() {\n      this.wsNotifyService.complete();\n      this.visible = false;\n      this.$emit('input', false);\n    },\n    onSwitchShop: function onSwitchShop(shop) {\n      var params = {\n        shop_id: shop.shop_id\n      };\n      this.switchService.switchShop(params).subscribe(this.onClose);\n    },\n    switchBackToBrand: function switchBackToBrand() {\n      this.switchService.switchBackToBrand().subscribe(this.onClose);\n    },\n    onSearch: function onSearch() {\n      var _this = this;\n\n      var shopList = this.shopList;\n      var list = [];\n      shopList.forEach(function (item) {\n        if (item.shop_name.toLowerCase().includes(_this.keyword.toLowerCase())) {\n          list.push(item);\n        }\n      });\n      this.list = list;\n    },\n    onChange: function onChange() {\n      this.onSearch(this.keyword);\n    }\n  }\n};",{"version":3,"sources":["switch.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6DA,SAAA,SAAA,QAAA,MAAA;AACA,SAAA,GAAA,EAAA,YAAA,QAAA,gBAAA;AACA,SAAA,cAAA,QAAA,4BAAA;AACA,SAAA,aAAA;AACA,SAAA,WAAA,QAAA,yBAAA;AACA,SAAA,eAAA,QAAA,4CAAA;AACA,eAAA;AACA,EAAA,IAAA,EAAA,kBADA;AAEA,EAAA,eAFA,6BAEA;AACA,WAAA,CAAA,aAAA,CAAA;AACA,GAJA;AAKA,EAAA,aALA,2BAKA;AACA,WAAA;AACA,MAAA,eAAA,EAAA,eADA;AAEA,MAAA,cAAA,EAAA,cAFA;AAGA,MAAA,aAAA,EAAA,aAHA;AAIA,MAAA,WAAA,EAAA;AAJA,KAAA;AAMA,GAZA;AAaA,EAAA,OAbA,qBAaA;AAAA,8BACA,KAAA,aADA;AAAA,QACA,SADA,uBACA,SADA;AAAA,QACA,QADA,uBACA,QADA;AAEA,WAAA;AACA,MAAA,QAAA,EAAA,SADA;AAEA,MAAA,OAAA,EAAA,QAFA;AAGA,MAAA,IAAA,EAAA,KAAA,WAAA,CAAA,KAHA;AAIA,MAAA,MAAA,EAAA,KAAA,WAAA,CAAA;AAJA,KAAA;AAMA,GArBA;AAsBA,EAAA,IAtBA,kBAsBA;AACA,WAAA;AACA;;;AAGA,MAAA,OAAA,EAAA,KAJA;;AAKA;;;AAGA,MAAA,QAAA,EAAA,KARA;AASA,MAAA,OAAA,EAAA,EATA;AAUA,MAAA,IAAA,EAAA,EAVA;AAWA,MAAA,YAAA,EAAA;AAXA,KAAA;AAaA,GApCA;AAqCA,EAAA,KAAA,EAAA;AACA,IAAA,KAAA,EAAA;AACA,MAAA,IAAA,EAAA,OADA;AAEA,MAAA,OAAA,EAAA;AAFA;AADA,GArCA;AA2CA,EAAA,KAAA,EAAA;AACA,IAAA,KADA,iBACA,GADA,EACA;AACA,WAAA,OAAA,GAAA,GAAA;AACA,WAAA,QAAA;AACA;AAJA,GA3CA;AAiDA,EAAA,QAAA,EAAA;AACA,IAAA,aADA,2BACA;AACA,aAAA,KAAA,IAAA,CAAA,EAAA;AACA;AAHA,GAjDA;AAsDA,EAAA,OAAA,EAAA;AACA,IAAA,OADA,qBACA;AACA,WAAA,eAAA,CAAA,QAAA;AACA,WAAA,OAAA,GAAA,KAAA;AACA,WAAA,KAAA,CAAA,OAAA,EAAA,KAAA;AACA,KALA;AAMA,IAAA,YANA,wBAMA,IANA,EAMA;AACA,UAAA,MAAA,GAAA;AACA,QAAA,OAAA,EAAA,IAAA,CAAA;AADA,OAAA;AAGA,WAAA,aAAA,CAAA,UAAA,CAAA,MAAA,EAAA,SAAA,CAAA,KAAA,OAAA;AACA,KAXA;AAYA,IAAA,iBAZA,+BAYA;AACA,WAAA,aAAA,CAAA,iBAAA,GAAA,SAAA,CAAA,KAAA,OAAA;AACA,KAdA;AAeA,IAAA,QAfA,sBAeA;AAAA;;AAAA,UACA,QADA,GACA,IADA,CACA,QADA;AAEA,UAAA,IAAA,GAAA,EAAA;AACA,MAAA,QAAA,CAAA,OAAA,CAAA,UAAA,IAAA,EAAA;AACA,YAAA,IAAA,CAAA,SAAA,CAAA,WAAA,GAAA,QAAA,CAAA,KAAA,CAAA,OAAA,CAAA,WAAA,EAAA,CAAA,EAAA;AACA,UAAA,IAAA,CAAA,IAAA,CAAA,IAAA;AACA;AACA,OAJA;AAKA,WAAA,IAAA,GAAA,IAAA;AACA,KAxBA;AAyBA,IAAA,QAzBA,sBAyBA;AACA,WAAA,QAAA,CAAA,KAAA,OAAA;AACA;AA3BA;AAtDA,CAAA","sourcesContent":["<template>\n  <a-drawer\n    placement=\"left\"\n    width=\"340\"\n    wrapClassName=\"drawer-switch-shop-wrap\"\n    :visible=\"visible\"\n    :closable=\"closable\"\n    @close=\"onClose\"\n  >\n    <div class=\"drawer-switch-shop\">\n      <section class=\"header\" :class=\"{ 'header--show': isShowShadow }\">\n        <div class=\"header__title\">\n          <st-t3>切换门店</st-t3>\n          <st-button\n            v-if=\"isShop\"\n            pill\n            type=\"primary\"\n            icon=\"entry\"\n            @click=\"switchBackToBrand\"\n          >\n            进入品牌\n          </st-button>\n        </div>\n        <st-input-search\n          placeholder=\"搜索门店\"\n          width=\"100%\"\n          v-model=\"keyword\"\n          @search=\"onSearch\"\n          @change=\"onChange\"\n        />\n      </section>\n      <section class=\"body\">\n        <a-spin :spinning=\"!!loading.switchShop\">\n          <ul class=\"drawer-shops\" v-if=\"list.length\">\n            <li\n              class=\"drawer-shops__item\"\n              :class=\"{ current: currentShopId === shop.shop_id }\"\n              v-for=\"(shop, index) in list\"\n              :key=\"index\"\n              @click=\"onSwitchShop(shop)\"\n            >\n              <img\n                class=\"drawer-shops__img\"\n                :src=\"shop.image_url | imgFilter({ w: 128, h: 128 })\"\n                alt=\"店招\"\n              />\n              <div>\n                <div class=\"drawer-shops__name\">{{ shop.shop_name }}</div>\n                <div class=\"drawer-shops__address\">{{ shop.address }}</div>\n                <div class=\"drawer-shops__tel\">{{ shop.link_phone }}</div>\n              </div>\n            </li>\n          </ul>\n          <st-no-data text=\"空空如也~\" v-else />\n        </a-spin>\n      </section>\n    </div>\n  </a-drawer>\n</template>\n\n<script>\nimport { fromEvent } from 'rxjs'\nimport { tap, debounceTime } from 'rxjs/operators'\nimport { MessageService } from '@/services/message.service'\nimport { SwitchService } from './switch.service'\nimport { UserService } from '@/services/user.service'\nimport { WsNotifyService } from '@/views/layouts/default#/ws-notify.service'\nexport default {\n  name: 'SwtichShopDrawer',\n  serviceProvider() {\n    return [SwitchService]\n  },\n  serviceInject() {\n    return {\n      wsNotifyService: WsNotifyService,\n      messageService: MessageService,\n      switchService: SwitchService,\n      userService: UserService\n    }\n  },\n  rxState() {\n    const { shopList$, loading$ } = this.switchService\n    return {\n      shopList: shopList$,\n      loading: loading$,\n      shop: this.userService.shop$,\n      isShop: this.userService.isShop$\n    }\n  },\n  data() {\n    return {\n      /**\n       * Drawer 是否可见\n       */\n      visible: false,\n      /**\n       * 是否显示右上角的关闭按钮\n       */\n      closable: false,\n      keyword: '',\n      list: [],\n      isShowShadow: false\n    }\n  },\n  props: {\n    value: {\n      type: Boolean,\n      default: false\n    }\n  },\n  watch: {\n    value(val) {\n      this.visible = val\n      this.onSearch()\n    }\n  },\n  computed: {\n    currentShopId() {\n      return this.shop.id\n    }\n  },\n  methods: {\n    onClose() {\n      this.wsNotifyService.complete()\n      this.visible = false\n      this.$emit('input', false)\n    },\n    onSwitchShop(shop) {\n      const params = {\n        shop_id: shop.shop_id\n      }\n      this.switchService.switchShop(params).subscribe(this.onClose)\n    },\n    switchBackToBrand() {\n      this.switchService.switchBackToBrand().subscribe(this.onClose)\n    },\n    onSearch() {\n      let { shopList } = this\n      const list = []\n      shopList.forEach(item => {\n        if (item.shop_name.toLowerCase().includes(this.keyword.toLowerCase())) {\n          list.push(item)\n        }\n      })\n      this.list = list\n    },\n    onChange() {\n      this.onSearch(this.keyword)\n    }\n  }\n}\n</script>\n"],"sourceRoot":"src/views/fragments/shop"}]}