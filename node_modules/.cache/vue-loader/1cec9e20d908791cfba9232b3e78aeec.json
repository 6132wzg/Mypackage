{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhigang/Desktop/styd/web/src/views/biz-modals/marketing/add-signup.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/biz-modals/marketing/add-signup.vue","mtime":1597396799936},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js","mtime":1591062572376}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { ruleOptions } from './add-signup.config'\nimport { PatternService } from '@/services/pattern.service'\nimport { MessageService } from '@/services/message.service'\nconst uuidv1 = require('uuid/v1')\nexport default {\n  name: 'ModalAddTicket',\n  bem: {\n    bModal: 'modal-marketing-add-signup'\n  },\n  serviceInject() {\n    return {\n      pattern: PatternService,\n      msg: MessageService\n    }\n  },\n  data() {\n    const form = this.$stForm.create()\n    const decorators = form.decorators(ruleOptions)\n    return {\n      extraTypeList: ['text', 'textarea', 'radio', 'checkbox'],\n      form,\n      decorators,\n      show: false,\n      ticketType: 1,\n      option: '',\n      extraType: 1,\n      extra_info: []\n    }\n  },\n  props: {\n    modalTitle: {\n      type: String,\n      default: '报名信息设置'\n    },\n    extra_sort: Number,\n    signUpList: {\n      type: Array,\n      default: () => []\n    }\n  },\n  computed: {\n    isShowSignUp() {\n      return this.extraType === 2 || this.extraType === 3\n    }\n  },\n  methods: {\n    onCLickDelOption(value) {\n      this.extra_info = this.extra_info.filter(item => item !== value)\n    },\n    onCLickGetOption() {\n      if (this.extra_info.length >= 10) {\n        this.msg.error({ content: '报名的选项最多新增10个选项值' })\n        return\n      }\n      if (!this.option) {\n        this.msg.error({ content: '报名选项不能为空' })\n        return\n      }\n      if (!this.pattern.CN_EN_NUM('1-15').test(this.option)) {\n        this.msg.error({ content: '请输入1~15个字符' })\n        return\n      }\n      if (!this.extra_info.includes(this.option)) {\n        this.extra_info.push(this.option)\n        this.option = ''\n      } else {\n        this.msg.error({ content: '选项重复,请重新填写' })\n      }\n    },\n    onChangeExtraType(e) {\n      this.extraType = e.target.value\n    },\n    isUniq(name) {\n      let bool = false\n      this.signUpList.forEach(item => {\n        bool = item.extra_name === name\n      })\n      return bool\n    },\n    onSubmit() {\n      this.form.validate().then(values => {\n        if (this.isUniq(values.extra_name)) {\n          this.msg.error({ content: '标题名重复请重新填写' })\n          return\n        }\n        this.show = false\n        const obj = {\n          extra_name: values.extra_name,\n          extra_require: values.extra_require,\n          extra_default_value: '',\n          extra_sort: this.extra_sort,\n          extra_info: this.extra_info,\n          extra_type: this.extraTypeList[values.extra_type],\n          extra_key: uuidv1(values)\n        }\n        this.$emit('show', obj)\n        this.$emit('submit', obj)\n      })\n    }\n  }\n}\n",null]}