{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhigang/Desktop/styd/web/src/views/pages/brand/product/package/info.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/pages/brand/product/package/info.vue","mtime":1596188219694},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js","mtime":1591062572376}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { InfoService } from './info.service'\nimport tableMixin from '@/mixins/table.mixin'\nimport {\n  personalFixColumns,\n  personalRangeColumns,\n  teamFixColumns,\n  teamRangeColumns,\n  courseUnLimitColumns,\n  shopColumns\n} from './info.config'\nimport { columns } from '../../../common/export.config'\nimport OnSales from '@/views/biz-modals/package/onSales'\nimport OffSales from '@/views/biz-modals/package/offSales'\nimport ShopList from '@/views/biz-modals/package/shop-list'\nimport Synchronize from '@/views/biz-modals/package/synchronize'\nimport SuccessTip from '@/views/biz-modals/package/success-tip'\nimport { SHOP_RANGE, PRODUCT_CHANNEL } from '@/constants/course/package.ts'\nexport default {\n  name: 'BrandPackageInfo',\n  bem: {\n    b: 'page-brand-package-info'\n  },\n  modals: {\n    OnSales,\n    OffSales,\n    ShopList,\n    Synchronize,\n    SuccessTip\n  },\n  mixins: [tableMixin],\n  data() {\n    return {\n      FIXATION: 3,\n      UNLIMIT: 1,\n      RANGE: 2,\n      SHOP_RANGE,\n      PRODUCT_CHANNEL\n    }\n  },\n  serviceInject() {\n    return {\n      service: InfoService\n    }\n  },\n  rxState() {\n    const { info$, auth$ } = this.service\n    return {\n      info$,\n      auth$\n    }\n  },\n  computed: {\n    btnOptions() {\n      return [\n        {\n          text: '编辑',\n          click: this.onEdit,\n          if: this.auth$['brand:product:package_course|edit']\n        },\n        {\n          text: '删除',\n          click: this.deletePackage,\n          if: this.auth$['brand:product:package_course|del']\n        },\n        {\n          text: '下架',\n          click: this.onDownShelf,\n          if: this.auth$['brand:product:package_course|down']\n        },\n        {\n          text: '上架',\n          click: this.onUpShelf,\n          if: this.auth$['brand:product:package_course|up']\n        },\n        {\n          text: '应用至售出',\n          click: this.batchOperate,\n          if: this.auth$['brand:product:package_course|batch_operate']\n        }\n      ]\n    },\n    packageTypeConst() {\n      return {\n        RANGE: 2,\n        FIXATION: 3,\n        UNLIMITED: 1\n      }\n    },\n    unlimitRange() {\n      return [\n        {\n          course_type: '团课课程',\n          price: this.info$.team_unit_price,\n          count: this.info$.team_times,\n          total: this.info$.team_unit_price * this.info$.team_times\n        },\n        {\n          course_type: '私教课程',\n          price: this.info$.personal_unit_price,\n          count: this.info$.personal_times,\n          total: this.info$.personal_unit_price * this.info$.personal_times\n        }\n      ]\n    },\n    personalFixColumns,\n    personalRangeColumns,\n    teamFixColumns,\n    teamRangeColumns,\n    shopColumns,\n    courseUnLimitColumns,\n    packageType() {\n      return +this.$route.query.packageType\n    },\n    teamColumns() {\n      if (this.packageType === this.packageTypeConst.RANGE) {\n        return this.teamRangeColumns\n      }\n      if (this.packageType === this.packageTypeConst.FIXATION) {\n        return this.teamFixColumns\n      }\n      return this.teamFixColumns\n    },\n    personalColumns() {\n      if (this.packageType === this.packageTypeConst.RANGE) {\n        return this.personalRangeColumns\n      }\n      if (this.packageType === this.packageTypeConst.FIXATION) {\n        return this.personalFixColumns\n      }\n      return this.personalFixColumns\n    },\n    isUnLimit() {\n      // TODO\n      return +this.packageType === this.packageTypeConst.UNLIMITED\n    },\n    salesDate() {\n      return `${this.info$.start_time} ~ ${this.info$.end_time}`\n    },\n    title() {\n      return this.info$.course_name\n    }\n  },\n  methods: {\n    onUpShelf() {\n      let id = this.info$.package_course_id\n      let channel = this.info$.publish_channel\n      this.$modalRouter.push({\n        name: 'on-sales',\n        props: {\n          id,\n          channel: channel === PRODUCT_CHANNEL.SHOP ? 'shop' : 'brand'\n        },\n        on: {\n          success: () => {\n            this.$router.reload()\n          }\n        }\n      })\n    },\n    onDownShelf() {\n      let id = this.info$.package_course_id\n      this.$modalRouter.push({\n        name: 'off-sales',\n        props: {\n          id\n        },\n        on: {\n          success: () => {\n            this.$router.reload()\n          }\n        }\n      })\n    },\n    batchOperate() {\n      let id = this.info$.package_course_id\n      this.$modalRouter.push({\n        name: 'Synchronize',\n        on: {\n          success: () => {\n            this.$confirm({\n              title: '提示',\n              content: `请再次确认是否同步，同步后会覆盖售出课程包，将会有2～5s无法正常使用`,\n              onOk: () => {\n                this.listService.setSyncSold(id).subscribe(res => {\n                  this.$modalRouter.push({\n                    name: 'success-tip'\n                  })\n                  this.$router.reload()\n                })\n              },\n              onCancel() {}\n            })\n          }\n        }\n      })\n    },\n    deletePackage() {\n      let id = this.info$.package_course_id\n      let name = this.info$.course_name\n      this.$confirm({\n        title: '提示',\n        content: ` 删除后不影响已购买的用户，一旦删除则无法恢复，确认删除${name}？`,\n        onOk: () => {\n          this.listService.deletePackage(id).subscribe(res => {\n            this.$router.reload()\n          })\n        },\n        onCancel() {}\n      })\n    },\n    onEdit() {\n      let id = this.info$.package_course_id\n      let type = this.packageType\n      let editList = {\n        [this.FIXATION]: 'brand-product-package-edit-fix-package',\n        [this.UNLIMIT]: 'brand-product-package-edit-unlimit-package',\n        [this.RANGE]: 'brand-product-package-edit-range-package'\n      }\n      this.$router.push({\n        name: editList[type],\n        query: {\n          id\n        }\n      })\n    }\n  }\n}\n",{"version":3,"sources":["info.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8JA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"info.vue","sourceRoot":"src/views/pages/brand/product/package","sourcesContent":["<template>\n  <st-panel :calss=\"b()\" class=\"mg-t16\" app :title=\"title\">\n    <div slot=\"actions\">\n      <st-btn-actions :options=\"btnOptions\"></st-btn-actions>\n    </div>\n    <div :class=\"b('base-info')\">\n      <div class=\"text\">\n        <st-info class=\"text-item\">\n          <st-info-item label=\"售价\">{{ info$.priceText }}</st-info-item>\n          <st-info-item label=\"有效时间\">\n            {{ info$.validTimeUnit }}\n          </st-info-item>\n          <st-info-item label=\"售卖方式\">{{ info$.saleMode }}</st-info-item>\n          <st-info-item label=\"约课限制\">\n            {{ info$.reserveIsLimit }}\n          </st-info-item>\n        </st-info>\n        <st-info class=\"text-item\">\n          <st-info-item label=\"售卖时间\">{{ salesDate }}</st-info-item>\n          <st-info-item label=\"允许冻结天数\">\n            {{ info$.frozenDays }}\n          </st-info-item>\n          <st-info-item label=\"转让设置\">\n            {{ info$.isAllowTransfer }}\n          </st-info-item>\n          <st-info-item label=\"支持使用人数\">\n            {{ info$.support_num }}\n          </st-info-item>\n        </st-info>\n      </div>\n\n      <div class=\"img\">\n        <st-image\n          :src=\"info$.image_url | imgFilter({ w: 280, h: 158 })\"\n          alt=\"课程包封面\"\n        />\n      </div>\n    </div>\n    <div :class=\"b('course-range')\" class=\"mg-t24\">\n      <st-info class=\"text-item\">\n        <st-info-item label=\"上课范围\"></st-info-item>\n      </st-info>\n      <template v-if=\"isUnLimit\">\n        <st-container>\n          <st-table\n            :columns=\"courseUnLimitColumns\"\n            pageMode=\"client\"\n            :dataSource=\"unlimitRange\"\n          />\n        </st-container>\n      </template>\n      <st-container v-if=\"!isUnLimit\">\n        <div :class=\"b('course-title')\" class=\"mg-b8\">\n          <st-t3 class=\"mg-r24\">团课</st-t3>\n          <span v-if=\"info$.is_limit === 0\" class=\"mg-r12\" label=\"\">\n            不限次\n          </span>\n          <st-info class=\"text-item\">\n            <st-info-item v-if=\"info$.is_limit\" class=\"mg-r12\" label=\"节数\">\n              {{ info$.team_times }}\n            </st-info-item>\n            <st-info-item v-if=\"packageType !== FIXATION\" label=\"课单价\">\n              {{ info$.team_unit_price }}\n            </st-info-item>\n          </st-info>\n        </div>\n\n        <st-table\n          :columns=\"teamColumns\"\n          pageMode=\"client\"\n          :dataSource=\"info$.team_range\"\n        >\n          <template slot=\"shop_name\" slot-scope=\"text\">\n            <st-overflow-text\n              max-width=\"120px\"\n              :value=\"text\"\n            ></st-overflow-text>\n          </template>\n        </st-table>\n      </st-container>\n      <st-container class=\"mg-t24\" v-if=\"!isUnLimit\">\n        <div :class=\"b('course-title')\" class=\"mg-b8\">\n          <st-t3 class=\"mg-r24\">私教课</st-t3>\n          <span v-if=\"info$.is_limit === 0\" class=\"mg-r12\" label=\"\">\n            不限次\n          </span>\n          <st-info class=\"text-item\">\n            <st-info-item v-if=\"info$.is_limit\" class=\"mg-r12\" label=\"节数\">\n              {{ info$.personal_times }}\n            </st-info-item>\n            <st-info-item v-if=\"packageType !== FIXATION\" label=\"课单价\">\n              {{ info$.personal_unit_price }}\n            </st-info-item>\n          </st-info>\n        </div>\n\n        <st-table\n          :columns=\"personalColumns\"\n          pageMode=\"client\"\n          :dataSource=\"info$.personal_range\"\n        >\n          <template slot=\"coach_level\" slot-scope=\"text\">\n            <st-overflow-text\n              max-width=\"120px\"\n              :value=\"text.map(item => item.setting_name)\"\n            ></st-overflow-text>\n          </template>\n\n          <template slot=\"shop_name\" slot-scope=\"text\">\n            <st-overflow-text\n              max-width=\"120px\"\n              :value=\"text\"\n            ></st-overflow-text>\n          </template>\n        </st-table>\n      </st-container>\n      <st-info class=\"text-item mg-t24\">\n        <st-info-item label=\"支持使用门店\">\n          {{ info$.useRangeName }}\n        </st-info-item>\n      </st-info>\n      <st-container v-if=\"info$.use_range === SHOP_RANGE.SPECIFIED_STORE\">\n        <st-table\n          :columns=\"shopColumns\"\n          :dataSource=\"info$.use_shop_list\"\n          pageMode=\"client\"\n        ></st-table>\n      </st-container>\n      <st-info class=\"text-item mg-t24\">\n        <st-info-item label=\"支持售卖门店\">\n          {{ info$.saleRangeName }}\n        </st-info-item>\n      </st-info>\n      <st-container v-if=\"info$.sale_range === SHOP_RANGE.SPECIFIED_STORE\">\n        <st-table\n          :columns=\"shopColumns\"\n          :dataSource=\"info$.sale_shop_list\"\n          pageMode=\"client\"\n        ></st-table>\n      </st-container>\n    </div>\n    <div :class=\"b('detail')\" class=\"mg-t24\">\n      <st-info class=\"text-item\">\n        <st-info-item label=\"课程介绍\">\n          <div v-html=\"info$.intro\"></div>\n        </st-info-item>\n      </st-info>\n      <div></div>\n      <st-info class=\"text-item\">\n        <st-info-item label=\"备注\">\n          {{ info$.remarks }}\n        </st-info-item>\n      </st-info>\n    </div>\n  </st-panel>\n</template>\n\n<script>\nimport { InfoService } from './info.service'\nimport tableMixin from '@/mixins/table.mixin'\nimport {\n  personalFixColumns,\n  personalRangeColumns,\n  teamFixColumns,\n  teamRangeColumns,\n  courseUnLimitColumns,\n  shopColumns\n} from './info.config'\nimport { columns } from '../../../common/export.config'\nimport OnSales from '@/views/biz-modals/package/onSales'\nimport OffSales from '@/views/biz-modals/package/offSales'\nimport ShopList from '@/views/biz-modals/package/shop-list'\nimport Synchronize from '@/views/biz-modals/package/synchronize'\nimport SuccessTip from '@/views/biz-modals/package/success-tip'\nimport { SHOP_RANGE, PRODUCT_CHANNEL } from '@/constants/course/package.ts'\nexport default {\n  name: 'BrandPackageInfo',\n  bem: {\n    b: 'page-brand-package-info'\n  },\n  modals: {\n    OnSales,\n    OffSales,\n    ShopList,\n    Synchronize,\n    SuccessTip\n  },\n  mixins: [tableMixin],\n  data() {\n    return {\n      FIXATION: 3,\n      UNLIMIT: 1,\n      RANGE: 2,\n      SHOP_RANGE,\n      PRODUCT_CHANNEL\n    }\n  },\n  serviceInject() {\n    return {\n      service: InfoService\n    }\n  },\n  rxState() {\n    const { info$, auth$ } = this.service\n    return {\n      info$,\n      auth$\n    }\n  },\n  computed: {\n    btnOptions() {\n      return [\n        {\n          text: '编辑',\n          click: this.onEdit,\n          if: this.auth$['brand:product:package_course|edit']\n        },\n        {\n          text: '删除',\n          click: this.deletePackage,\n          if: this.auth$['brand:product:package_course|del']\n        },\n        {\n          text: '下架',\n          click: this.onDownShelf,\n          if: this.auth$['brand:product:package_course|down']\n        },\n        {\n          text: '上架',\n          click: this.onUpShelf,\n          if: this.auth$['brand:product:package_course|up']\n        },\n        {\n          text: '应用至售出',\n          click: this.batchOperate,\n          if: this.auth$['brand:product:package_course|batch_operate']\n        }\n      ]\n    },\n    packageTypeConst() {\n      return {\n        RANGE: 2,\n        FIXATION: 3,\n        UNLIMITED: 1\n      }\n    },\n    unlimitRange() {\n      return [\n        {\n          course_type: '团课课程',\n          price: this.info$.team_unit_price,\n          count: this.info$.team_times,\n          total: this.info$.team_unit_price * this.info$.team_times\n        },\n        {\n          course_type: '私教课程',\n          price: this.info$.personal_unit_price,\n          count: this.info$.personal_times,\n          total: this.info$.personal_unit_price * this.info$.personal_times\n        }\n      ]\n    },\n    personalFixColumns,\n    personalRangeColumns,\n    teamFixColumns,\n    teamRangeColumns,\n    shopColumns,\n    courseUnLimitColumns,\n    packageType() {\n      return +this.$route.query.packageType\n    },\n    teamColumns() {\n      if (this.packageType === this.packageTypeConst.RANGE) {\n        return this.teamRangeColumns\n      }\n      if (this.packageType === this.packageTypeConst.FIXATION) {\n        return this.teamFixColumns\n      }\n      return this.teamFixColumns\n    },\n    personalColumns() {\n      if (this.packageType === this.packageTypeConst.RANGE) {\n        return this.personalRangeColumns\n      }\n      if (this.packageType === this.packageTypeConst.FIXATION) {\n        return this.personalFixColumns\n      }\n      return this.personalFixColumns\n    },\n    isUnLimit() {\n      // TODO\n      return +this.packageType === this.packageTypeConst.UNLIMITED\n    },\n    salesDate() {\n      return `${this.info$.start_time} ~ ${this.info$.end_time}`\n    },\n    title() {\n      return this.info$.course_name\n    }\n  },\n  methods: {\n    onUpShelf() {\n      let id = this.info$.package_course_id\n      let channel = this.info$.publish_channel\n      this.$modalRouter.push({\n        name: 'on-sales',\n        props: {\n          id,\n          channel: channel === PRODUCT_CHANNEL.SHOP ? 'shop' : 'brand'\n        },\n        on: {\n          success: () => {\n            this.$router.reload()\n          }\n        }\n      })\n    },\n    onDownShelf() {\n      let id = this.info$.package_course_id\n      this.$modalRouter.push({\n        name: 'off-sales',\n        props: {\n          id\n        },\n        on: {\n          success: () => {\n            this.$router.reload()\n          }\n        }\n      })\n    },\n    batchOperate() {\n      let id = this.info$.package_course_id\n      this.$modalRouter.push({\n        name: 'Synchronize',\n        on: {\n          success: () => {\n            this.$confirm({\n              title: '提示',\n              content: `请再次确认是否同步，同步后会覆盖售出课程包，将会有2～5s无法正常使用`,\n              onOk: () => {\n                this.listService.setSyncSold(id).subscribe(res => {\n                  this.$modalRouter.push({\n                    name: 'success-tip'\n                  })\n                  this.$router.reload()\n                })\n              },\n              onCancel() {}\n            })\n          }\n        }\n      })\n    },\n    deletePackage() {\n      let id = this.info$.package_course_id\n      let name = this.info$.course_name\n      this.$confirm({\n        title: '提示',\n        content: ` 删除后不影响已购买的用户，一旦删除则无法恢复，确认删除${name}？`,\n        onOk: () => {\n          this.listService.deletePackage(id).subscribe(res => {\n            this.$router.reload()\n          })\n        },\n        onCancel() {}\n      })\n    },\n    onEdit() {\n      let id = this.info$.package_course_id\n      let type = this.packageType\n      let editList = {\n        [this.FIXATION]: 'brand-product-package-edit-fix-package',\n        [this.UNLIMIT]: 'brand-product-package-edit-unlimit-package',\n        [this.RANGE]: 'brand-product-package-edit-range-package'\n      }\n      this.$router.push({\n        name: editList[type],\n        query: {\n          id\n        }\n      })\n    }\n  }\n}\n</script>\n"]}]}