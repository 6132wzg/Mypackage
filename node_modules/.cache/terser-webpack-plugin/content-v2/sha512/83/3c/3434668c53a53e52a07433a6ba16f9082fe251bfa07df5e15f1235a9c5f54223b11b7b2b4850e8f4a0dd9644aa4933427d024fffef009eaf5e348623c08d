{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"tier-34~brand-marketing~brand-marketing-plugin-activity-registration~brand-marketing-plugin-coupon~b~e6730682\"],{da41:function(t,e,n){\"use strict\";n.d(e,\"a\",(function(){return w}));n(\"2397\"),n(\"6b54\"),n(\"a481\"),n(\"28a5\"),n(\"7f7f\"),n(\"ac6a\"),n(\"6762\"),n(\"2fdb\");var i=n(\"d225\"),r=n(\"b0b4\"),c=n(\"308d\"),o=n(\"6bb5\"),a=n(\"4e2b\"),s=n(\"9ab4\"),u=n(\"0cd5\"),p=n(\"2bd2\"),f=n(\"5929\"),l=n(\"ce8b\"),d=n(\"3060\"),h=n(\"acf8\"),b=n(\"ebb6\"),v=n(\"d3fb\");function y(t,e,n){return void 0===n&&(n=Number.POSITIVE_INFINITY),\"function\"===typeof e?function(i){return i.pipe(y((function(n,i){return Object(v[\"a\"])(t(n,i)).pipe(Object(b[\"a\"])((function(t,r){return e(n,t,i,r)})))}),n))}:(\"number\"===typeof e&&(n=e),function(e){return e.lift(new m(t,n))})}var m=function(){function t(t,e){void 0===e&&(e=Number.POSITIVE_INFINITY),this.project=t,this.concurrent=e}return t.prototype.call=function(t,e){return e.subscribe(new _(t,this.project,this.concurrent))},t}(),_=function(t){function e(e,n,i){void 0===i&&(i=Number.POSITIVE_INFINITY);var r=t.call(this,e)||this;return r.project=n,r.concurrent=i,r.hasCompleted=!1,r.buffer=[],r.active=0,r.index=0,r}return s[\"c\"](e,t),e.prototype._next=function(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)},e.prototype._tryNext=function(t){var e,n=this.index++;try{e=this.project(t,n)}catch(i){return void this.destination.error(i)}this.active++,this._innerSub(e,t,n)},e.prototype._innerSub=function(t,e,n){var i=new h[\"a\"](this,e,n),r=this.destination;r.add(i);var c=Object(l[\"a\"])(this,t,void 0,void 0,i);c!==i&&r.add(c)},e.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()},e.prototype.notifyNext=function(t,e,n,i,r){this.destination.next(e)},e.prototype.notifyComplete=function(t){var e=this.buffer;this.remove(t),this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},e}(d[\"a\"]),g=n(\"de46\");function S(t){return function(){var e,n=Object(o[\"a\"])(t);if(O()){var i=Object(o[\"a\"])(this).constructor;e=Reflect.construct(n,arguments,i)}else e=n.apply(this,arguments);return Object(c[\"a\"])(this,e)}}function O(){if(\"undefined\"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if(\"function\"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var w=function(t){Object(a[\"a\"])(n,t);var e=S(n);function n(){var t;return Object(i[\"a\"])(this,n),t=e.apply(this,arguments),t.BUSINESS_TYPES=[\"image\",\"face\",\"file\",\"excel\"],t.typeSuffix=[{type:\"image/png\",suffix:\".png\"}],t}return Object(r[\"a\"])(n,[{key:\"put\",value:function(t){var e=this,n=t.file,i=t.business,r=void 0===i?\"\":i,c=t.uploadProgress,o=void 0===c?function(){}:c,a=t.isPrivate,s=void 0!==a&&a;if(!this.BUSINESS_TYPES.includes(r))throw new Error(\"[oss.service] 上传文件必须使用业务类型 \".concat(this.BUSINESS_TYPES,\" 之一\"));return this.getOssPolicy(r,s).pipe(y((function(t){var i=t.policy_info,r=e.getKey(n),c=new FormData,a=\"\".concat(i.dir).concat(r);c.append(\"key\",a),c.append(\"policy\",i.policy),c.append(\"OSSAccessKeyId\",i.accessid),c.append(\"success_action_status\",\"200\"),c.append(\"signature\",i.signature),c.append(\"file\",n);c.entries();var u=new p[\"b\"],l=Object(f[\"a\"])({url:i.host,body:c,method:\"post\",crossDomain:!0,progressSubscriber:u});u.subscribe((function(t){o(t)}));var d={fileName:n.name,fileKey:a,host:i.host,url:s?URL.createObjectURL(n):i.host+\"/\"+a};return l.pipe(Object(b[\"a\"])((function(t){return d})))})))}},{key:\"getOssPolicy\",value:function(t,e){return this.http.get(\"/upload/policy\",{query:{business:t,acl:e?\"private\":\"public-read-write\"}})}},{key:\"getFileSuffix\",value:function(t){if(t.name){var e=t.name.lastIndexOf(\".\");return t.name.slice(e)}return\".\"+t.type.split(\"/\")[1]}},{key:\"getKey\",value:function(t){var e=this.getFileSuffix(t),n=\"\";return t.name&&(n=t.name.replace(/[?\\s%<>&#\\\\:]/g,\"\").replace(e,\"\")),\".xlsx\"===e||\".xls\"===e||\".csv\"===e?\"import__\".concat(n,\"___\").concat(Math.random().toString(16).slice(3),\"___\").concat(e):\"\".concat(n,\"___\").concat(Math.random().toString(16).slice(3),\"___\").concat(e)}},{key:\"downloadFile\",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:\"download.xlsx\",n=document.createElement(\"a\");n.href=t,n.target=\"_blank\",n.download=e,n.click()}},{key:\"openNewTab\",value:function(t){window.open(t)}}]),n}(g[\"a\"]);w=Object(s[\"b\"])([Object(u[\"b\"])()],w)}}]);","extractedComments":[]}