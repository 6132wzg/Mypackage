{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhigang/Desktop/styd/web/src/views/pages/shop/store/list.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/pages/shop/store/list.vue","mtime":1596792848091},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js","mtime":1591062572376}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport tableMixin from '@/mixins/table.mixin'\nimport { columns } from './list.config'\nimport { ListService } from './list.service'\nimport { UserService } from '@/services/user.service'\n\nexport default {\n  mixins: [tableMixin],\n  name: 'PageShopStoreList',\n  bem: {\n    basic: 'page-shop-store-list'\n  },\n  serviceInject() {\n    return {\n      listService: ListService\n    }\n  },\n  rxState() {\n    return {\n      list: this.listService.list$,\n      page: this.listService.page$,\n      loading: this.listService.loading$,\n      goodsList: this.listService.goodsList$,\n      cloudStore: this.listService.shelvesStatus$,\n      auth: this.listService.auth$\n    }\n  },\n  data(vm) {\n    return {\n      goodsName: '', // 商品名称\n      shelvesStatus: -1, // 上架状态\n      categoryId: -1, // 商品分类\n      columns: columns(vm)\n    }\n  },\n  computed: {\n    goods_sort() {\n      let list = []\n      this.goodsList.forEach(item => {\n        list.push({ value: +item.category_id, label: item.category_name })\n      })\n      return [{ value: -1, label: '所有商品分类' }, ...list]\n    }\n  },\n  mounted() {\n    this.setSearchData()\n    console.log(this.auth)\n  },\n  watch: {\n    query(newVal) {\n      this.setSearchData()\n    }\n  },\n  methods: {\n    // 设置状态&名称\n    setSearchData() {\n      let { product_name, shelves_status, category_id } = this.$searchQuery\n      this.goodsName = product_name\n      this.categoryId = category_id || -1\n      this.shelvesStatus = shelves_status || -1\n    },\n    // 新建商品\n    onAddGoods() {\n      this.$router.push({\n        path: './add'\n      })\n    },\n    // 上下架\n    onShelf(record) {\n      let status = record.product_shelves === 1 ? 2 : 1\n      this.$confirm({\n        title: '提示',\n        content: `确定${status === 1 ? '上架' : '下架'}该商品吗？`,\n        onOk: () => {\n          this.listService\n            .onShelf(record.product_id, { shelves_status: status })\n            .subscribe(res => {\n              this.$router.reload()\n            })\n        },\n        onCancel() {}\n      })\n    },\n    onDel(record) {\n      console.log(record)\n      this.$confirm({\n        title: '提示',\n        content: `一旦删除则无法恢复，确定删除${record.product_name}？`,\n        onOk: () => {\n          this.listService.delproduct(record.product_id).subscribe(res => {\n            this.$router.reload()\n          })\n        },\n        onCancel() {}\n      })\n    },\n    onEdit(record) {\n      this.$router.push({\n        path: './edit',\n        query: { id: record.product_id }\n      })\n    }\n  }\n}\n",null]}