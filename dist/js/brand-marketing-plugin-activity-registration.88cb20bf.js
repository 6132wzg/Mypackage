(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["brand-marketing-plugin-activity-registration"],{"0309":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("st-panel",{class:t.bPage(),attrs:{app:""}},[a("div",{class:t.bPage("content")},[a("img",{class:t.bPage("content-img"),attrs:{src:i("0974")}}),a("st-t2",{class:t.bPage("content-title")},[t._v("发布成功")]),a("p",{class:t.bPage("content-subtitle")},[t._v("更多曝光推广，获得更多客户与订单")]),a("ul",{class:t.bPage("content-list")},[a("li",{staticClass:"mg-r48",on:{click:function(e){return t.pushSharePosterModal()}}},[a("img",{attrs:{src:i("1370"),alt:""}}),a("a",[t._v("分享海报")])]),a("li",{staticClass:"mg-r48",on:{click:t.onClickGoactivityAd}},[a("img",{attrs:{src:i("30b1"),alt:""}}),a("a",[t._v("设置活动广告")])]),a("li",{on:{click:function(e){return t.pushQrCodeModal()}}},[a("img",{attrs:{src:i("d277"),alt:""}}),a("a",[t._v("小程序码")])])]),a("div",{class:t.bPage("content-button-group")},[a("st-button",{staticClass:"mg-r16",on:{click:t.onClickGoAddActivity}},[t._v("\n        新增活动\n      ")]),a("st-button",{attrs:{type:"primary"},on:{click:t.onClickGoActivityList}},[t._v("\n        返回活动\n      ")])],1)],1)])},n=[],s=(i("7f7f"),i("a481"),i("6c6c")),r=i("5ffc"),o={name:"ReleaseActivity",bem:{bPage:"page-marketing-release-activity"},serviceInject:function(){return{service:s["SuccessService"]}},rxState:function(){var t=this.service,e=t.info$,i=t.qrcode$,a=t.brand$;return{info$:e,qrcode$:i,brand$:a}},hooks:function(){return{share:Object(r["a"])()}},data:function(){return{show:!1}},computed:{activityId:function(){return+this.$searchQuery.activity_id}},methods:{onClickGoAddActivity:function(){this.$router.replace({name:"brand-marketing-plugin-activity-registration-add"})},onClickGoActivityList:function(){this.$router.replace({name:"brand-marketing-plugin-activity-registration-list"})},onClickGoactivityAd:function(){this.$router.replace({name:"brand-marketing-activity"})},pushSharePosterModal:function(){var t=this;this.service.getSharePosterInfo(this.activityId).subscribe((function(e){var i=t.info$,a="".concat(i.start_time," - ").concat(i.end_time),n={qrcode_url:i.qrcode,brand_name:t.brand$.name,brand_logo:t.brand$.logo,activity_img:i.image.image_url,activity_title:i.activity_name,activity_date:a,activity_address:i.address};t.share.poster({isAuth:e.is_auth,shsInfo:n,shsPath:"/saas/activity"})}))},pushQrCodeModal:function(){var t=this;this.service.getQrCode(this.activityId).subscribe((function(e){t.share.qrCode({isAuth:e.is_auth,qrCodeUrl:t.qrcode$})}))}}},c=o,u=i("2877"),l=Object(u["a"])(c,a,n,!1,null,null,null);e["default"]=l.exports},"0974":function(t,e,i){t.exports=i.p+"img/icon_setting_success.c9b867d6.png"},"0fc9e":function(t,e,i){"use strict";i.r(e);var a,n,s,r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("st-mina-panel",[i("div",{attrs:{slot:"preview"},slot:"preview"},[0===t.currentStep?i("activity-h5-view",{attrs:{stepInfo:t.step1Info}}):t._e(),1===t.currentStep?i("ticket-h5-view",{attrs:{stepInfo:t.step2Info}}):t._e(),2===t.currentStep?i("signup-h5-view",{attrs:{stepInfo:t.step3Info}}):t._e()],1),i("div",{class:t.bPage()},[i("a-steps",{class:t.bPage("step"),attrs:{current:t.currentStep}},t._l(t.steps,(function(t,e){return i("a-step",{key:e,attrs:{title:t.title}})})),1),i("div",{class:t.bPage("form")},[i("step1-form",{directives:[{name:"show",rawName:"v-show",value:0===t.currentStep,expression:"currentStep === 0"}],attrs:{show:0===t.currentStep,isCopy:t.isCopy,isEdit:t.isEdit},on:{"step-submit":t.onSubmitGetStep1Form,change:t.onChangeStep1Form}}),i("step2-form",{directives:[{name:"show",rawName:"v-show",value:1===t.currentStep,expression:"currentStep === 1"}],attrs:{show:1===t.currentStep,isCopy:t.isCopy,stepForm:t.stepForm,isEdit:t.isEdit},on:{back:t.onBack,"step-submit":t.onSubmitGetStep2Form,change:t.onChangeStep2Form}}),i("step3-form",{directives:[{name:"show",rawName:"v-show",value:2===t.currentStep,expression:"currentStep === 2"}],attrs:{show:2===t.currentStep,isCopy:t.isCopy,isEdit:t.isEdit},on:{back:t.onBack,release:t.onReleaseActivity,"save-draft":t.onSaveDraftActivity,change:t.onChangeStep3Form}})],1)],1),i("portal-target",{attrs:{slot:"actions",name:"BRAND_MARKETING_ACTIVITY_FORM_ACTIONS"},slot:"actions"})],1)},o=[],c=i("75fc"),u=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("a-row",[i("a-col",{attrs:{xl:14}},[i("st-form",{class:t.b(),attrs:{form:t.form}},[i("st-form-item",{attrs:{label:"活动标题",required:""}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.activity_name,expression:"decorators.activity_name"}],attrs:{placeholder:"请输入活动标题",maxlength:"15"}})],1),i("st-form-item",{attrs:{label:"活动时间",required:""}},[i("a-range-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.date,expression:"decorators.date"}],class:t.b("picker"),attrs:{disabledDate:t.disabledDate,showTime:{format:"HH:mm"},format:"YYYY-MM-DD HH:mm"}})],1),i("st-form-item",{attrs:{label:"活动地点",required:""}},[i("map-button",{attrs:{addText:"设置活动地点",lat:t.address.lat,lng:t.address.lng,province:t.address.province,city:t.address.city,district:t.address.district,address:t.address.address},on:{select:t.onSelectGetAddress}}),t.isAddress?i("div",{staticClass:"color-danger"},[t._v("请选择地址")]):t._e()],1),i("st-form-item",{attrs:{label:"活动海报",required:""}},[i("st-image-upload",{attrs:{width:"220px",height:"140px",list:t.fileShareList,placeholder:"上传图片"},on:{change:t.onShareChangeGetImage},scopedSlots:t._u([{key:"description",fn:function(){return[i("p",[t._v("请上传jpg、png格式的图片")]),i("p",[t._v("大小不超过2M，建议尺寸16:9")])]},proxy:!0}])}),t.isPoster?i("div",{staticClass:"color-danger"},[t._v("请上传活动海报")]):t._e()],1),i("st-form-item",{attrs:{label:"活动人数",required:""}},[i("st-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.member_limit_num,expression:"decorators.member_limit_num"}],attrs:{placeholder:"若不限制活动人数，请填写0",min:0,disabled:t.isMemberNumDisabled,max:9999}})],1),i("st-form-item",{attrs:{label:"活动详情",required:""}},[i("st-editor",{on:{input:t.onChangeEditor},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}}),t.isEditor?i("div",{staticClass:"color-danger"},[t._v("请输入活动详情")]):t._e()],1),t.show?i("portal",{attrs:{to:"BRAND_MARKETING_ACTIVITY_FORM_ACTIONS"}},[i("st-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("\n          下一步\n        ")])],1):t._e()],1)],1),i("a-col",{attrs:{xl:10}})],1)},l=[],d=(i("8e6e"),i("ac6a"),i("456d"),i("bd86")),m=(i("6762"),i("2fdb"),i("c32d")),p=i.n(m);(function(t){t[t["COUPON_TYPE"]=1]="COUPON_TYPE",t[t["QRCODE_TYPE"]=2]="QRCODE_TYPE"})(a||(a={})),function(t){t[t["POSTER_TYPE"]=1]="POSTER_TYPE",t[t["QRCODE_TYPE"]=2]="QRCODE_TYPE"}(n||(n={})),function(t){t[t["PUBLISHED"]=1]="PUBLISHED",t[t["END"]=3]="END",t[t["DRAFT"]=4]="DRAFT",t[t["CANCELED"]=5]="CANCELED"}(s||(s={}));var f=function(t){var e=t.pattern;return{activity_name:{rules:[{required:!0,message:"请输入活动标题"},{pattern:e.CN_EN_NUM("1-15"),message:"请输入1~15个字符"}]},date:{rules:[{required:!0,message:"请输入活动时间"},{validator:function(e,i,a){if(i){var n=i[0].valueOf(),s=p()().subtract(30,"m").valueOf();return!t.isEdit&&n<s?"选择活动开始时间要大于当前时间":void 0}}}]},member_limit_num:{rules:[{required:!0,message:"请输入活动限制人数"},{validator:function(e,i,a){if((0!==i||!t.defaultForm$.member_limit_num)&&(!t.defaultForm$||t.defaultForm$.activity_status===s.PUBLISHED)){var n=t.defaultForm$.member_limit_num;return t.$route.path.includes("/activity-registration/edit")&&i>0&&i<n?"编辑活动时，活动人数不能小于".concat(n):void 0}}}]}}},h=i("2527"),v=i("7ce1"),_=i("99c0"),b=i("972a"),g=i("5c8a"),y=i("34b9"),k=i("2171");function S(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,a)}return i}function C(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?S(Object(i),!0).forEach((function(e){Object(d["a"])(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):S(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var x={name:"Step1Form",bem:{b:"step-form-activity"},serviceInject:function(){return{copyService:y["CopyService"],editService:k["EditService"],pattern:h["a"]}},rxState:function(){var t=this.copyService.defaultForm$;return{defaultForm$:t}},data:function(){var t=this,e=this.$stForm.create({onValuesChange:function(e,i){t.$nextTick().then((function(){t.formInfo=C({},t.formInfo,{},t.form.getFieldsValue()),t.$emit("change",t.formInfo)}))}}),i=e.decorators(f);return{ACTIVITY_STATUS:s,isEditor:!1,isPoster:!1,isAddress:!1,form:e,formInfo:{},decorators:i,fileShareList:[],address:{},content:""}},props:{isCopy:{type:Boolean,default:!1},isEdit:{type:Boolean,default:!1},show:{type:Boolean,default:!1}},computed:{isMemberNumDisabled:function(){return this.isEdit&&this.defaultForm$.activity_status===s.PUBLISHED&&0===this.defaultForm$.member_limit_num}},created:function(){(this.isCopy||this.isEdit)&&this.initForm()},components:{MapButton:_["a"],StEditor:b["a"],StImageUpload:v["a"]},watch:{content:function(t,e){this.$set(this.formInfo,"content",t),this.$emit("change",this.formInfo)}},methods:{moment:p.a,onChangeEditor:function(){return this.isEditor=0===this.content.length,0===this.content.length},onChangePoster:function(){return this.isPoster=0===this.fileShareList.length,0===this.fileShareList.length},onChangeAddress:function(){return this.isAddress=!this.address.address,!this.address.address},initForm:function(){var t=this;this.$nextTick().then((function(){var e=[p()(t.defaultForm$.start_time),p()(t.defaultForm$.end_time)];t.content=t.defaultForm$.description,t.fileShareList.push(t.defaultForm$.image),t.$set(t.formInfo,"imageUrl",t.defaultForm$.image.image_url);var i=t.defaultForm$,a=i.address,n=i.lat,s=i.lng,r=i.district,o=i.province,c=i.city;t.address={address:a,lat:n,lng:s,district:r,province:o,city:c},t.$set(t.formInfo,"address",a),t.$emit("change",t.formInfo),t.form.setFieldsValue({activity_name:t.defaultForm$.activity_name,date:e,member_limit_num:t.defaultForm$.member_limit_num})}))},onShareChangeGetImage:function(t){this.defaultForm$.image&&this.isEdit&&(t[0].image_id=this.defaultForm$.image.image_id),this.$set(this.formInfo,"imageUrl",t[0].image_url),this.$emit("change",this.formInfo),this.fileShareList=Object(g["a"])(t),this.onChangePoster()},onSelectGetAddress:function(t){this.$set(this.formInfo,"address",t.address),this.$emit("change",this.formInfo),this.address=t,this.onChangeAddress()},disabledDate:function(t){return t&&t.format("YYYY-MM-DD")<p()().format("YYYY-MM-DD")},onSubmit:function(){var t=this;this.form.validate().then((function(e){if(!(t.onChangeEditor()||t.onChangePoster()||t.onChangeAddress())){var i=e.activity_name,a=e.member_limit_num,n=e.date[0].format("YYYY-MM-DD HH:mm"),s=e.date[1].format("YYYY-MM-DD HH:mm"),r=(t.file,t.address),o=r.address,c=r.province,u=r.city,l=r.district,d=r.lat,m=r.lng,p=t.isEdit?t.defaultForm$.activity_id:void 0,f={activity_id:p,address:o,province:c,city:u,district:l,lat:d,lng:m,end_time:s,start_time:n,activity_name:i,member_limit_num:+a,description:t.content,image:t.fileShareList[0]};t.$emit("step-submit",f)}})).catch((function(){t.onChangeEditor()&&t.onChangePoster()&&t.onChangeAddress()}))}}},O=x,w=i("2877"),j=Object(w["a"])(O,u,l,!1,null,null,null),I=j.exports,D=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("st-form-table",[i("thead",[i("tr",[i("th",[t._v("票种名称")]),i("th",[t._v("价格(元)")]),i("th",[t._v("票数（张）")]),i("th",[t._v("购买用户")]),i("th",[t._v("操作")])])]),i("tbody",[i("tr",[i("td",{staticClass:"st-form-table__add",attrs:{colspan:t.colspanNum}},[i("st-button",{directives:[{name:"modal-link",rawName:"v-modal-link",value:{name:"marketing-add-ticket",props:{formData:t.defaultForm$,dataSource:t.dataSource,stepForm:t.stepForm},on:{show:t.getTableItem,submit:t.getFormItem}},expression:"{\n              name: 'marketing-add-ticket',\n              props: {\n                formData: defaultForm$,\n                dataSource: dataSource,\n                stepForm: stepForm\n              },\n              on: {\n                show: getTableItem,\n                submit: getFormItem\n              }\n            }"}],attrs:{disabled:10===t.dataSource.length,type:"dashed",icon:"add",block:""}},[t._v("\n            新增票种\n          ")])],1)]),t.dataSource.length?t._l(t.dataSource,(function(e,a){return i("tr",{key:a},[i("td",[t._v(t._s(e.ticket_name))]),i("td",[t._v(t._s(e.ticket_price))]),i("td",[t._v(t._s(e.ticket_total_num))]),i("td",[t._v(t._s(t.getCrowdName(e.crowd_id)))]),i("td",[i("st-table-actions",[i("a",{on:{click:function(i){return t.editTicketItemRecord({ticket:e,index:a})}}},[t._v("\n                设置\n              ")]),t.isTicketName(e)?t._e():i("a",{on:{click:function(i){return t.delTicketItemRecord(e.ticket_name)}}},[t._v("\n                删除\n              ")])])],1)])})):[i("tr",[i("td",{attrs:{colspan:t.colspanNum}},[i("st-no-data")],1)])]],2)]),t.show?i("portal",{attrs:{to:"BRAND_MARKETING_ACTIVITY_FORM_ACTIONS"}},[i("st-button",{on:{click:t.onClickBack}},[t._v("\n      上一步\n    ")]),i("st-button",{staticClass:"mg-l16",attrs:{type:"primary"},on:{click:t.onClickAddTicketComplete}},[t._v("\n      下一步\n    ")])],1):t._e()],1)},$=[],T=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("st-modal",{attrs:{title:t.modalTitle,width:"568px"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[i("div",{staticClass:"modal-marketing-add-ticket"},[i("st-form",{attrs:{form:t.form}},[i("st-form-item",{attrs:{label:"票种类型",required:""}},[i("a-radio-group",{attrs:{disabled:t.isDisabled},on:{change:t.onChangeGetTicketType},model:{value:t.ticketType,callback:function(e){t.ticketType=e},expression:"ticketType"}},t._l(t.ticketTypeList,(function(e){return i("a-radio",{key:e.value,attrs:{value:e.value}},[t._v("\n            "+t._s(e.label)+"\n          ")])})),1)],1),i("st-form-item",{attrs:{label:"票种名称",required:""}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.ticket_name,expression:"decorators.ticket_name"}],attrs:{disabled:t.isDisabled,placeholder:"请输入票种名称"}})],1),i("st-form-item",{directives:[{name:"show",rawName:"v-show",value:2===t.ticketType,expression:"ticketType === 2"}],attrs:{label:"价格",required:""}},[i("st-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.ticket_price,expression:"decorators.ticket_price"}],staticClass:"input",attrs:{disabled:t.isDisabled,float:!0,min:.1,max:1e4},on:{change:t.onChangeGetTicketPrice}}),i("span",{staticClass:"mg-l4"},[t._v("元")])],1),i("st-form-item",{directives:[{name:"show",rawName:"v-show",value:1===t.ticketType,expression:"ticketType === 1"}],attrs:{label:"价格",required:""}},[i("span",[t._v("免费")])]),i("st-form-item",{attrs:{label:"票数",required:""}},[i("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.ticket_total_num,expression:"decorators.ticket_total_num"}],staticClass:"input",attrs:{min:1,max:9999,step:1,precision:0},on:{change:t.onChangeGetTicketTotalNum}}),i("span",{staticClass:"mg-l4"},[t._v("张")])],1),i("a-row",[i("a-col",{attrs:{span:16}},[i("st-form-item",{attrs:{label:"购买限制",required:""}},[i("span",[t._v("单次购买，最少")]),i("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.buy_limit_min,expression:"decorators.buy_limit_min"}],staticClass:"input mg-l4 mg-r4",attrs:{min:0,max:9999,disabled:t.isDisabled,step:1,precision:0}}),i("span",[t._v("份，")])],1)],1),i("a-col",{attrs:{span:8}},[i("st-form-item",{staticClass:"st-form-item__row",attrs:{labelWidth:"0"}},[i("span",[t._v("最多")]),i("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.buy_limit_max,expression:"decorators.buy_limit_max"}],staticClass:"input mg-l4 mg-r4",attrs:{min:0,max:9999,disabled:t.isDisabled,step:1,precision:0}}),i("span",[t._v("份")])],1)],1)],1),i("st-form-item",{attrs:{label:"购买用户",required:""}},[i("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.crowd_id,expression:"decorators.crowd_id"}],staticStyle:{width:"140px"},attrs:{disabled:t.isDisabled,options:t.crowdIdOptions}})],1),i("st-form-item",{directives:[{name:"show",rawName:"v-show",value:2===t.ticketType,expression:"ticketType === 2"}],class:{"mg-b0":1===t.isBulk},attrs:{label:"团购优惠",required:""}},[i("a-radio-group",{attrs:{disabled:t.isDisabled,defaultValue:0},model:{value:t.isBulk,callback:function(e){t.isBulk=e},expression:"isBulk"}},[i("a-radio",{attrs:{value:1}},[t._v("开启")]),i("a-radio",{attrs:{value:0}},[t._v("关闭")])],1)],1),1===t.isBulk?i("div",{staticClass:"form-bulk"},[i("st-pop-container",{staticClass:"mg-t8",attrs:{offset:"22px"}},[i("a-row",[i("a-col",{attrs:{span:11}},[i("st-form-item",{staticClass:"st-form-item__row mg-b0",attrs:{labelWidth:"0"}},[i("span",[t._v("单次购买超过")]),i("a-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.group_buy_min,expression:"decorators.group_buy_min"}],staticClass:"input mg-l4 mg-r4",attrs:{max:9999,disabled:t.isDisabled,step:1,precision:0,min:0}}),i("span",[t._v("张,")])],1)],1),i("a-col",{attrs:{span:13}},[i("st-form-item",{staticClass:"st-form-item__row mg-b0",attrs:{labelWidth:"0"}},[i("span",{staticClass:"mg-l4"},[t._v("每张原价减")]),i("st-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.reduce_price,expression:"decorators.reduce_price"}],staticClass:"input mg-l4 mg-r4",attrs:{disabled:t.isDisabled,float:!0,min:0,max:1e4}}),i("span",[t._v("元")])],1)],1)],1)],1)],1):t._e(),i("st-form-item",{class:{"mg-b0":t.isShowSaleDatePicker},attrs:{label:"售卖时间",required:""}},[i("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.buy_time_limit,expression:"decorators.buy_time_limit"}],style:t.radioStyle,attrs:{disabled:t.isDisabled},on:{change:t.getCurSaleTimeType}},[i("a-radio",{attrs:{value:1}},[t._v("指定时间")]),i("a-radio",{attrs:{value:0}},[t._v("活动结束前均可售卖")])],1)],1),i("st-form-item",{directives:[{name:"show",rawName:"v-show",value:t.form.getFieldValue("buy_time_limit"),expression:"form.getFieldValue('buy_time_limit')"}],attrs:{labelFix:""}},[i("a-range-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.buy_time,expression:"decorators.buy_time"}],staticClass:"mg-t8",attrs:{disabledDate:t.disabledDate,disabled:t.isDisabled,showTime:{format:"HH:mm"},format:"YYYY-MM-DD HH:mm"}})],1),i("st-form-item",{staticClass:"mg-b0",attrs:{label:"备注说明"}},[i("st-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.ticket_remark,expression:"decorators.ticket_remark"}],attrs:{maxlength:100,autosize:{minRows:2,maxRows:6},disabled:t.isDisabled,placeholder:"请输入备注说明"}})],1)],1)],1),i("template",{slot:"footer"},[i("st-button",{on:{click:function(e){t.show=!1}}},[t._v("取消")]),i("st-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("\n      确定\n    ")])],1)],2)},E=[],A=(i("c5f6"),i("ee1d"),function(t){var e=t.pattern;return{ticket_name:{rules:[{required:!0,message:"请输入票种名称"},{pattern:e.CN_EN_NUM("1-10"),message:"请输入1~10个英文，中文字符"},{validator:function(e,i,a){var n=t.dataSource.map((function(t){return t.ticket_name}));if(!t.ticket||t.ticket.ticket_name!==i)return n.includes(i)?"票种名称重复请重新输入":void 0}}]},ticket_price:{initialValue:1,rules:[{required:!0,message:"请输入价格"}]},ticket_total_num:{initialValue:1,rules:[{required:!0,message:"请输入票数"},{validator:function(e,i,a){var n=0;if(t.formData&&Array.isArray(t.formData.ticket_list)&&t.formData.ticket_list.forEach((function(e){t.ticket&&e.ticket_id===t.ticket.ticket_id&&(n=e.ticket_total_num)})),t.ticket&&t.ticket.ticket_id&&1===t.formData.activity_status&&i<n)return"编辑票种时，票数只能增加不能减少"}}]},crowd_id:{rules:[{required:!0,message:"请选择购买用户"}]},buy_limit_min:{initialValue:1,rules:[{required:!0,message:"请输入最少份数"},{validator:function(t,e,i){if(+i.ticket_price>0&&+e>+i.ticket_total_num)return"单次购买最低张数应小于票的总数"}}]},buy_limit_max:{initialValue:1,rules:[{validator:function(t,e,i){return+e>+i.ticket_total_num?"单次购买最高张数应小于票的总数":+i.buy_limit_min>0&&+e<+i.buy_limit_min?"最大购买张数应大于最低购买张数".concat(i.buy_limit_min):void 0}}]},is_group_buy:{initialValue:1},group_buy_min:{initialValue:1,rules:[{validator:function(t,e,i){if(!Number.isNaN(e)&&!Number.isNaN(i.ticket_total_num))return e>i.ticket_total_num?"单次购买超过张数应小于票的总数":+e<+i.buy_limit_min||+e>+i.buy_limit_max?"单次购买区间在".concat(i.buy_limit_min," - ").concat(i.buy_limit_max):void 0}}]},reduce_price:{initialValue:1,rules:[{validator:function(t,e,i){if(!Number.isNaN(e)&&!Number.isNaN(i.ticket_price))return+e>+i.ticket_price?"每张减的价格应小于票的原价":void 0}}]},buy_time_limit:{initialValue:0,rules:[{required:!0,message:"请选择时间"}]},buy_time:{rules:[{validator:function(e,i,a){if(t.formData.activity_status!==s.PUBLISHED){var n=p()(t.stepForm.end_time);return i&&i.length&&i[0].valueOf()>n.valueOf()?"售卖开始时间要早于活动结束时间".concat(n.format("YYYY-MM-DD  HH:mm")):i&&i.length&&i[1].valueOf()>n.valueOf()?"售卖结束时间要早于活动结束时间".concat(n.format("YYYY-MM-DD  HH:mm")):void 0}}}]},ticket_remark:{}}}),F=i("e69b"),P=i("2138");function N(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,a)}return i}function Y(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?N(Object(i),!0).forEach((function(e){Object(d["a"])(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):N(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var L,U={name:"ModalAddTicket",bem:{bModal:"modal-marketing-add-ticket"},serviceInject:function(){return{pattern:h["a"],userService:P["a"],messageService:F["a"]}},rxState:function(){return{ticketTypeList:this.userService.getOptions$("plugin.ticket_type")}},data:function(){var t=this.$stForm.create(),e=t.decorators(A);return{form:t,decorators:e,show:!1,ticketType:this.ticketTypeList[1].value,isBulk:1,crowdIdOptions:[{label:"全部用户",value:0}],radioStyle:{display:"block"},isShowSaleDatePicker:!1}},props:{modalTitle:{type:String,default:"票种信息设置"},dataSource:{type:Array,default:function(){return[]}},stepForm:{type:Object,default:function(){}},formData:{type:Object,default:function(){}},index:Number,isSetting:{type:Boolean,default:!1},ticket:{type:Object,default:function(){}}},computed:{freeTicket:function(){return 1===this.ticketType},isDisabled:function(){return!(!this.ticket||!this.ticket.ticket_id||this.formData.activity_status!==s.PUBLISHED)}},mounted:function(){var t=this;this.form.setFieldsValue({crowd_id:0}),this.ticket&&this.$nextTick().then((function(){var e=t.ticket,i=e.ticket_name,a=e.ticket_price,n=e.ticket_total_num,s=e.buy_limit_min,r=e.buy_limit_max,o=e.group_buy_min,c=e.buy_time_limit,u=e.is_group_buy,l=e.buy_start_time,d=e.buy_end_time,m=e.reduce_price,p=e.ticket_remark;t.ticketType=a>0?2:1;var f=[t.moment(l),t.moment(d)];t.form.setFieldsValue({ticket_name:i,ticket_price:a,ticket_total_num:n,buy_limit_min:s,buy_limit_max:r,buy_time_limit:c,ticket_remark:p}),0!==a&&t.form.setFieldsValue({group_buy_min:o,reduce_price:m}),t.isShowSaleDatePicker=c,1===t.isShowSaleDatePicker&&t.form.setFieldsValue({buy_time:f}),t.isBulk=u}))},methods:{moment:p.a,formatData:function(t){var e=t.ticket_name,i=t.ticket_price,a=t.crowd_id,n=t.ticket_total_num,s=t.buy_limit_min,r=t.buy_limit_max,o=t.group_buy_min,c=t.reduce_price,u=t.buy_time_limit,l=t.buy_time,d=t.ticket_remark,m="",p="";1===u&&l&&(m=l[0].format("YYYY-MM-DD HH:mm"),p=l[1].format("YYYY-MM-DD HH:mm"));var f={ticket_name:e,ticket_price:i,crowd_id:a,ticket_total_num:n,buy_limit_min:s,buy_limit_max:r,is_group_buy:this.isBulk,group_buy_min:o,reduce_price:c,buy_time_limit:u,buy_start_time:m,buy_end_time:p,ticket_remark:d};return f},getShowData:function(t){var e=t.ticket_name,i=t.ticket_price,a=t.crowd_id,n=t.ticket_total_num,s=t.group_buy_min,r=t.buy_limit_min,o=t.buy_limit_max,c=t.reduce_price,u=t.buy_time_limit,l=t.ticket_remark,d=t.buy_time,m="",p="";return 1===u?(m=d[0].format("YYYY-MM-DD HH:mm"),p=d[1].format("YYYY-MM-DD HH:mm")):(m=this.stepForm.start_time,p=this.stepForm.end_time),{ticket_name:e,ticket_price:i,ticket_total_num:n,crowd_id:a,group_buy_min:s,buy_limit_min:r,buy_limit_max:o,ticket_remark:l,buy_time_limit:u,is_group_buy:this.isBulk,buy_start_time:m,buy_end_time:p,reduce_price:c}},onChangeGetTicketTotalNum:function(){this.isDisabled||(this.form.setFieldsValue({buy_limit_min:1,buy_limit_max:1}),this.isBulk&&this.form.setFieldsValue({group_buy_min:1,reduce_price:1}))},onChangeGetTicketPrice:function(){this.isBulk&&this.form.setFieldsValue({group_buy_min:1,reduce_price:1})},onSubmit:function(){var t=this;this.form.validate().then((function(e){if(1!==e.buy_time_limit||e.buy_time){var i=t.getShowData(e),a=t.formatData(e);if(t.ticket&&t.ticket.ticket_id){var n=t.ticket.ticket_id;i=Y({ticket_id:n},i),a=Y({ticket_id:n},a)}t.show=!1,t.$emit("show",{ticket:i,index:t.index}),t.$emit("submit",{ticket:a,index:t.index})}else t.messageService.success({content:"请选择时间"})}))},onChangeGetTicketType:function(t){this.freeTicket&&(this.form.setFieldsValue({ticket_price:0,is_group_buy:0}),this.isBulk=0)},getCurSaleTimeType:function(t){this.isShowSaleDatePicker=t.target.value},disabledDate:function(t){return t&&t.format("YYYY-MM-DD")<p()().format("YYYY-MM-DD")}}},M=U,R=Object(w["a"])(M,T,E,!1,null,null,null),G=R.exports,H={name:"Step2Form",modals:{MarketingAddTicket:G},bem:{b:"step-form-signup"},serviceInject:function(){return{copyService:y["CopyService"],msg:F["a"]}},rxState:function(){var t=this.copyService.defaultForm$;return{defaultForm$:t}},props:{isCopy:{type:Boolean,default:!1},stepForm:{type:Object,default:function(){}},isEdit:{type:Boolean,default:!1},show:{type:Boolean}},created:function(){(this.isCopy||this.isEdit)&&this.initForm()},data:function(){return{ACTIVITY_STATUS:s,checkedShopIds:[],dataSource:[],formDataList:[],list:[],crowdIdOptions:[{label:"全部用户",value:0}]}},computed:{colspanNum:function(){return 5},ticketList:function(){return Object(g["a"])(this.defaultForm$.ticket_list)||[]}},methods:{getCrowdName:function(t){var e="";return this.crowdIdOptions.forEach((function(i){e=i.value===t?i.label:""})),e},initForm:function(){var t=this;this.$nextTick().then((function(){t.dataSource=Object(g["a"])(t.defaultForm$.ticket_list),t.formDataList=Object(g["a"])(t.defaultForm$.ticket_list),t.$emit("change",t.dataSource)}))},isTicketName:function(t){return this.defaultForm$.activity_status!==s.DRAFT&&this.ticketList.map((function(t){return t.ticket_name})).includes(t.ticket_name)},editTicketItemRecord:function(t){var e=t.ticket,i=t.index;this.$modalRouter.push({name:"marketing-add-ticket",props:{formData:this.defaultForm$,dataSource:this.dataSource,ticket:e,index:i,isSetting:!0,stepForm:this.stepForm},on:{show:this.getTableItem,submit:this.getFormItem}})},onClickBack:function(){this.$emit("back",0)},getTableItem:function(t){var e=t.ticket,i=t.index;i>-1?this.dataSource=this.dataSource.map((function(t,a){return a===i&&(t=e),t})):this.dataSource.push(e),this.$emit("change",this.dataSource)},delTicketItemRecord:function(t){var e=this;this.$confirm({title:"提示",content:"是否删除该票种?",okText:"是的",cancelText:"再想想",onOk:function(){e.dataSource=e.dataSource.filter((function(e){return e.ticket_name!==t})),e.formDataList=e.formDataList.filter((function(e){return e.ticket_name!==t})),e.$emit("change",e.dataSource)},onCancel:function(){}})},getFormItem:function(t){var e=t.ticket,i=t.index;i>-1?this.formDataList=this.formDataList.map((function(t,a){return a===i&&(t=e),t})):this.formDataList.push(e)},onClickAddTicketComplete:function(){0!==this.formDataList.length?this.$emit("step-submit",this.formDataList):this.msg.error({content:"最少新增一个票种"})}}},q=H,B=Object(w["a"])(q,D,$,!1,null,null,null),V=B.exports,Q=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:t.pComponents()},[i("div",{class:t.pComponents("switch")},[i("span",{staticClass:"mg-r24"},[t._v("您是否需要收集参与者的必要信息")]),i("st-switch",{on:{change:t.onChangeIsShow},model:{value:t.isStep3,callback:function(e){t.isStep3=e},expression:"isStep3"}})],1),t.isStep3?i("div",{staticClass:"mg-t24"},[i("ul",{class:t.pComponents("table-header")},[i("li",{class:t.pComponents("table-header-item")},[t._v("报名项标题")]),i("li",{class:t.pComponents("table-header-item")},[t._v("操作")])]),i("st-button",{staticClass:"mg-t8",attrs:{disabled:10===t.dataSource.length,type:"dashed",icon:"add",block:""},on:{click:t.onCLickOpenmodal}},[t._v("\n      新增\n    ")]),i("ul",{staticClass:"mg-t8",class:t.pComponents("draggable"),attrs:{tag:"ul"}},[t._l(t.dataSource,(function(e,a){return[a<=1||!t.isDel(e)?i("li",{key:a,class:t.pComponents("draggable-li")},[i("div",{class:t.pComponents("draggable-name")},[a<=1?i("span",{staticStyle:{color:"red"}},[t._v("*")]):t._e(),t._v("\n            "+t._s(e.extra_name)+"\n          ")]),i("div",{class:t.pComponents("draggable-action")},[i("a",{on:{click:function(i){return t.delExtraItemRecord(e.extra_key)}}},[t._v("\n              --\n            ")])])]):t._e()]}))],2),i("draggable",{staticClass:"mg-t8",class:t.pComponents("draggable"),attrs:{tag:"ul"},on:{end:t.onEnd},model:{value:t.addDataSource,callback:function(e){t.addDataSource=e},expression:"addDataSource"}},[t._l(t.dataSource,(function(e,a){return[a>1&&t.isDel(e)?i("li",{key:a,class:t.pComponents("draggable-li")},[i("div",{class:t.pComponents("draggable-name")},[i("st-icon",{staticClass:"mg-r8",attrs:{color:"#9BACB9",type:"draggable"}}),"radio"===e.extra_type||"checkbox"===e.extra_type?i("a-popover",{attrs:{placement:"bottomLeft"}},[i("template",{slot:"content"},t._l(e.extra_info,(function(e,a){return i("st-button",{key:a,staticClass:"mg-r8 option-tip",attrs:{size:"small"}},[t._v("\n                  "+t._s(e)+"\n                ")])})),1),i("template",{slot:"title"},[i("span",[t._v(t._s(e.extra_name)+"选项")])]),i("span",[t._v(t._s(e.extra_name))])],2):i("span",[t._v(t._s(e.extra_name))])],1),i("div",{class:t.pComponents("draggable-action")},[t.isDel(e)?i("a",{on:{click:function(i){return t.delExtraItemRecord(e.extra_key)}}},[t._v("\n              删除\n            ")]):i("a",[t._v("--")])])]):t._e()]}))],2)],1):t._e(),t.show?i("portal",{attrs:{to:"BRAND_MARKETING_ACTIVITY_FORM_ACTIONS"}},[i("st-button",{staticClass:"mg-r8",on:{click:t.onClickBack}},[t._v("\n      上一步\n    ")]),t.isSaveDraft?t._e():i("st-button",{staticClass:"mg-r8",on:{click:t.onClickSaveDraft}},[t._v("\n      存草稿\n    ")]),i("st-button",{attrs:{type:"primary"},on:{click:t.onClickRelease}},[t._v("\n      发布\n    ")])],1):t._e()],1)},J=[],K=i("310e"),z=i.n(K),Z=i("d225"),W=i("b0b4"),X=i("9ab4"),tt=i("c4cc"),et=i("df29"),it=i("0cd5"),at=i("ba07"),nt=function(){function t(e){Object(Z["a"])(this,t),this.api=e,this.defaultExtInfo$=new et["d"]([])}return Object(W["a"])(t,[{key:"getDefaultExtInfo",value:function(){var t=this;return this.api.getSignUpDefaultExtInfo().pipe(Object(tt["a"])((function(e){t.defaultExtInfo$.commit((function(){return e.list}))})))}}]),t}();nt=Object(X["b"])([Object(it["b"])(),Object(X["d"])("design:paramtypes",["function"===typeof(L="undefined"!==typeof at["c"]&&at["c"])?L:Object])],nt);var st=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("st-modal",{attrs:{title:t.modalTitle,width:"568px"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[i("div",{class:t.bModal()},[i("st-form",{attrs:{form:t.form}},[i("st-form-item",{attrs:{label:"报名标题"}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.extra_name,expression:"decorators.extra_name"}],attrs:{placeholder:"请输入报名项"}})],1),i("st-form-item",{attrs:{label:"报名类型"}},[i("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.extra_type,expression:"decorators.extra_type"}],on:{change:t.onChangeExtraType}},[i("a-radio",{attrs:{value:0}},[t._v("单行文本")]),i("a-radio",{attrs:{value:1}},[t._v("多行文本")]),i("a-radio",{attrs:{value:2}},[t._v("单选")]),i("a-radio",{attrs:{value:3}},[t._v("多选")])],1)],1),t.isShowSignUp?i("st-form-item",{attrs:{label:"报名选项"}},[i("a-input-group",{attrs:{compact:""}},[i("a-input",{staticStyle:{width:"80%"},attrs:{placeholder:"请填写报名选项"},model:{value:t.option,callback:function(e){t.option=e},expression:"option"}}),i("st-button",{on:{click:t.onCLickGetOption}},[t._v("新增")])],1),i("div",{staticClass:"option-group-wrap"},t._l(t.extra_info,(function(e,a){return i("div",{key:a,staticClass:"mg-r8 option-tip",attrs:{size:"small"}},[i("span",{staticClass:"tip"},[t._v(t._s(e))]),i("span",{staticClass:"mg-l8",on:{click:function(i){return t.onCLickDelOption(e)}}},[t._v("x")])])})),0)],1):t._e(),i("st-form-item",{staticClass:"mg-b0",attrs:{label:"是否必填"}},[i("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.extra_require,expression:"decorators.extra_require"}]},[i("a-radio",{attrs:{value:1}},[t._v("是")]),i("a-radio",{attrs:{value:2}},[t._v("否")])],1)],1)],1)],1),i("template",{slot:"footer"},[i("st-button",{on:{click:function(e){t.show=!1}}},[t._v("取消")]),i("st-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("\n      确定\n    ")])],1)],2)},rt=[],ot=function(t){var e=t.pattern;return{extra_name:{rules:[{required:!0,message:"请输入报名选项"},{pattern:e.CN_EN_NUM("1-15"),message:"请输入1~15个字符"},{validator:function(e,i,a){var n=t.signUpList.map((function(t){return t.extra_name}));if(n.includes(i))return"票种名称重复请重新输入"}}]},extra_type:{rules:[{required:!0,message:"请选择报名类型"}]},extra_info:{rules:[{required:!0,message:"请输入活动时间"}]},extra_require:{rules:[{required:!0,message:"请选择是否必填"}]}}},ct=i("c437"),ut={name:"ModalAddTicket",bem:{bModal:"modal-marketing-add-signup"},serviceInject:function(){return{pattern:h["a"],msg:F["a"]}},data:function(){var t=this.$stForm.create(),e=t.decorators(ot);return{extraTypeList:["text","textarea","radio","checkbox"],form:t,decorators:e,show:!1,ticketType:1,option:"",extraType:1,extra_info:[]}},props:{modalTitle:{type:String,default:"报名信息设置"},extra_sort:Number,signUpList:{type:Array,default:function(){return[]}}},computed:{isShowSignUp:function(){return 2===this.extraType||3===this.extraType}},methods:{onCLickDelOption:function(t){this.extra_info=this.extra_info.filter((function(e){return e!==t}))},onCLickGetOption:function(){this.extra_info.length>=10?this.msg.error({content:"报名的选项最多新增10个选项值"}):this.option?this.pattern.CN_EN_NUM("1-15").test(this.option)?this.extra_info.includes(this.option)?this.msg.error({content:"选项重复,请重新填写"}):(this.extra_info.push(this.option),this.option=""):this.msg.error({content:"请输入1~15个字符"}):this.msg.error({content:"报名选项不能为空"})},onChangeExtraType:function(t){this.extraType=t.target.value},isUniq:function(t){var e=!1;return this.signUpList.forEach((function(i){e=i.extra_name===t})),e},onSubmit:function(){var t=this;this.form.validate().then((function(e){if(t.isUniq(e.extra_name))t.msg.error({content:"标题名重复请重新填写"});else{t.show=!1;var i={extra_name:e.extra_name,extra_require:e.extra_require,extra_default_value:"",extra_sort:t.extra_sort,extra_info:t.extra_info,extra_type:t.extraTypeList[e.extra_type],extra_key:ct(e)};t.$emit("show",i),t.$emit("submit",i)}}))}}},lt=ut,dt=Object(w["a"])(lt,st,rt,!1,null,null,null),mt=dt.exports,pt={name:"Step3Form",bem:{pComponents:"step-form-signup"},modals:{MarketingAddSignup:mt},serviceInject:function(){return{service:nt,msg:F["a"],copyService:y["CopyService"]}},rxState:function(){var t=this.service.defaultExtInfo$,e=this.copyService.defaultForm$;return{defaultExtInfo$:t,defaultForm$:e}},data:function(){return{ACTIVITY_STATUS:s,checkedShopIds:[],addDataSource:[],formData:[],isStep3:0,extraSort:3,list:[]}},components:{draggable:z.a},props:{isCopy:{type:Boolean,default:!1},isEdit:{type:Boolean,default:!1},show:{type:Boolean}},created:function(){this.service.getDefaultExtInfo().subscribe(),(this.isCopy||this.isEdit)&&this.initForm()},computed:{colspanNum:function(){return 5},activityStatus:function(){return this.defaultForm$.activity_status},activity_id:function(){return this.defaultForm$.activity_id},isSaveDraft:function(){return this.$route.path.includes("/activity-registration/edit")&&this.activityStatus===s.PUBLISHED},dataSource:function(){var t=!1;return this.addDataSource.forEach((function(e){"username"===e.extra_key&&(t=!0)})),t?Object(c["a"])(this.addDataSource):[].concat(Object(c["a"])(this.defaultExtInfo$),Object(c["a"])(this.addDataSource))}},methods:{onEnd:function(){var t=this.addDataSource.map((function(t,e){return t.extra_sort=e,t}));this.$set(this,"addDataSource",t),this.$emit("change",this.dataSource)},isDel:function(t){if(0===t.extra_sort||1===t.extra_sort)return!1;if(this.activityStatus===s.DRAFT)return!0;if(this.isEdit){var e=Object(g["a"])(this.defaultForm$.rule_settings.join_ext_info).extra_data.map((function(t){return t.extra_sort}));return!e.includes(t.extra_sort)}return!0},initForm:function(){var t=this;this.$nextTick().then((function(){var e=Object(g["a"])(t.defaultForm$.rule_settings.join_ext_info),i=e.extra_data;t.isStep3=t.isEdit?e.extra_type:0,t.$set(t,"addDataSource",i),t.formData=Object(c["a"])(i),t.$emit("change",t.dataSource)}))},onClickBack:function(){this.$emit("back",1)},onCLickOpenmodal:function(){this.extraSort=Math.max.apply(Math,Object(c["a"])(this.dataSource.map((function(t){return t.extra_sort}))))+1,this.$modalRouter.push({name:"marketing-add-signup",props:{signUpList:this.dataSource,extra_sort:this.extraSort},on:{show:this.getTableItem,submit:this.getFormItem}})},getTableItem:function(t){this.addDataSource.push(t),this.$emit("change",this.dataSource)},getFormItem:function(t){this.formData.push(t)},getStepForm:function(){var t=!1,e=[];return this.formData.forEach((function(e){"username"===e.extra_key&&(t=!0)})),e=t?Object(c["a"])(this.isStep3?this.formData:[]):[].concat(Object(c["a"])(this.defaultExtInfo$),Object(c["a"])(this.isStep3?this.formData:[])),{join_ext_info:{extra_type:this.isStep3,extra_data:e}}},delExtraItemRecord:function(t){this.addDataSource=this.addDataSource.filter((function(e){return e.extra_key!==t})),this.formData=this.formData.filter((function(e){return e.extra_key!==t})),this.$emit("change",this.addDataSource)},onClickRelease:function(){this.$emit("release",this.getStepForm())},onClickSaveDraft:function(){this.$emit("save-draft",this.getStepForm())},onChangeIsShow:function(){this.isEdit&&this.defaultForm$.activity_status===s.PUBLISHED&&1===this.defaultForm$.rule_settings.join_ext_info.extra_type&&(this.isStep3=this.defaultForm$.rule_settings.join_ext_info.extra_type,this.msg.error({content:"已发布的活动，不能关闭活动信息"}));var t=this.isStep3?this.dataSource:[];this.$emit("change",t)}}},ft=pt,ht=Object(w["a"])(ft,Q,J,!1,null,null,null),vt=ht.exports,_t=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:t.bComponent()},[a("h5-container",{attrs:{fixed:""},scopedSlots:t._u([{key:"title",fn:function(){return[t._v("\n      活动报名\n    ")]},proxy:!0}])},[a("div",{class:t.bComponent("content")},[a("div",{class:t.bComponent("content-img")},[a("img",{staticClass:"image",attrs:{src:t.stepInfo.imageUrl,alt:"活动海报"}})]),a("div",{class:t.bComponent("content-info")},[a("st-t2",{staticClass:"title"},[t._v(t._s(t.stepInfo.activity_name))]),a("div",{staticClass:"content"},[a("div",{staticClass:"price-info"},[a("span",{staticClass:"price"},[t._v("¥--")]),a("span",{staticClass:"subfix"},[t._v("起")])]),a("div",{staticClass:"hot-info"},[a("div",{staticClass:"view mg-r48"},[a("st-icon",{attrs:{size:"32px",type:"scan"}}),a("span",{staticClass:"mg-l16"},[t._v("190")])],1),a("div",{staticClass:"share"},[a("st-icon",{attrs:{size:"32px",type:"share-link"}}),a("span",{staticClass:"mg-l16"},[t._v("108")])],1)])])],1),a("div",{class:t.bComponent("content-sub-info")},[a("div",{staticClass:"time"},[a("st-icon",{staticClass:"mg-r16",attrs:{size:"32px",type:"clock"}}),a("span",[t._v(t._s(t._f("formatActivityDate")(t.stepInfo.date)))])],1),a("div",{staticClass:"address"},[a("div",[a("st-icon",{staticClass:"mg-r16",attrs:{size:"32px",type:"location-mina"}}),a("span",[t._v(t._s(t.stepInfo.address))])],1),a("div",{staticClass:"address__map"},[a("img",{attrs:{src:i("93c6"),alt:""}})])])]),a("div",{class:t.bComponent("content-activity-detail")},[a("st-t2",{staticClass:"title"},[t._v("活动详情")]),a("div",{staticClass:"content-box",domProps:{innerHTML:t._s(t.stepInfo.content)}})],1),a("div",{class:t.bComponent("footer")},[a("st-icon",{attrs:{size:"44px",type:"share"}}),a("st-button",{staticClass:"footer__button",attrs:{pill:"",type:"primary"}},[t._v("\n          立即报名\n        ")])],1)])])],1)},bt=[],gt=i("5bfd"),yt={name:"h5-view",bem:{bComponent:"component-activity-h5-view"},components:{H5Container:gt["a"]},filters:{formatActivityDate:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!t.length)return"";var e=t[0].format("YYYY-MM-DD"),i=t[1].format("YYYY-MM-DD"),a=t[0].format("HH:mm"),n=t[1].format("HH:mm");return e===i?"".concat(e," ").concat(a," - ").concat(n):"".concat(e," ").concat(a," - ").concat(i," ").concat(n)}},props:{stepInfo:{type:Object,default:function(){return{content:""}}}}},kt=yt,St=Object(w["a"])(kt,_t,bt,!1,null,null,null),Ct=St.exports,xt=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:t.bComponent()},[i("h5-container",{scopedSlots:t._u([{key:"title",fn:function(){return[t._v("\n      选择票种\n    ")]},proxy:!0}])},[i("div",{class:t.bComponent("content")},[t._l(t.stepInfo,(function(e,a){return i("div",{key:a,class:t.bItem()},[i("st-t3",{class:t.bItem("title")},[t._v("\n          "+t._s(e.ticket_name)+"\n        ")]),i("div",{class:t.bItem("price-info")},[e.reduce_price?i("span",{staticClass:"discount-price"},[t._v("\n            ¥ xxx\n          ")]):i("span",{staticClass:"discount-price"},[t._v("\n            ¥"+t._s(e.ticket_price)+"\n          ")]),e.reduce_price?i("span",{staticClass:"original-price"},[t._v("\n            /¥"+t._s(e.ticket_price)+"\n          ")]):t._e(),e.group_buy_min?i("span",{staticClass:"discount-terms"},[t._v("\n            超过"+t._s(e.group_buy_min)+"张，每张减¥"+t._s(e.reduce_price)+"\n          ")]):t._e()]),i("div",{class:t.bItem("date")},[t._v("\n          售票时间："+t._s(e.buy_start_time)+" - "+t._s(e.buy_end_time)+"\n        ")]),i("div",{class:t.bItem("remark")},[t._v("\n          备注说明："+t._s(e.ticket_remark)+"\n        ")])],1)})),i("div",{staticClass:"contnet-mgt120"}),i("div",{class:t.bComponent("footer")},[i("div",{staticClass:"footer__count"},[i("span",{staticClass:"price"},[t._v("¥2000")]),i("i",{staticClass:"reduce"},[t._v("优惠减¥500")])]),i("st-button",{staticClass:"footer__button",attrs:{pill:"",type:"primary"}},[t._v("\n          下一步\n        ")])],1)],2)])],1)},Ot=[],wt={name:"TicketH5View",bem:{bComponent:"component-ticket-h5-view",bItem:"ticket-item"},components:{H5Container:gt["a"]},filters:{filterPrice:function(t){return+t.ticket_price-t.reduce_price<=.1?.1:+t.ticket_price-+t.reduce_price}},props:{stepInfo:{type:Array,default:function(){return[{ticket_name:"票种名"}]}}}},jt=wt,It=Object(w["a"])(jt,xt,Ot,!1,null,null,null),Dt=It.exports,$t=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:t.bComponent()},[i("h5-container",{scopedSlots:t._u([{key:"title",fn:function(){return[t._v("\n      报名表\n    ")]},proxy:!0}])},[i("div",{class:t.bComponent("content")},[i("div",{class:t.bComponent("header")},[i("div",{class:t.bComponent("activity-info")},[i("div",{staticClass:"activity-title"},[i("st-t2",[t._v("2019 CHINA FIT 体育与健身大会")])],1),i("div",{staticClass:"activity-box"},[i("div",{staticClass:"time"},[i("st-icon",{attrs:{type:"time"}}),i("span",[t._v("2019.06.22 19:30-21:30")])],1),i("div",{staticClass:"address"},[i("st-icon",{attrs:{type:"address"}}),i("span",[t._v("上海市闵行区漕河泾门店")])],1),i("div",{staticClass:"count"},[i("span",[t._v("早鸟票早鸟票200元")]),i("span",[t._v("x10 张")])])])])]),i("div",{class:t.bComponent("tip")},[i("div",{class:t.bComponent("tip-title")},[i("st-t3",{staticClass:"title"},[t._v("报名表")]),i("span",{staticClass:"sub-title"},[t._v("\n            为了更好的服务，我们需要收集您以下信息\n          ")])],1),i("div",{class:t.bComponent("tip-phone")},[t._v("\n          您已绑定手机号码 ***********\n        ")])]),i("ul",{class:t.bComponent("info")},t._l(t.stepInfo,(function(e,a){return i("li",{key:a,staticClass:"item"},[i("span",{staticClass:"label"},[t._v("\n            "+t._s(e.extra_name)+"\n            "),1===e.extra_require?i("span",{staticClass:"tip"},[t._v("\n              (必填)\n            ")]):t._e()]),"text"===e.extra_type||"texteara"===e.extra_type?i("a",{staticClass:"action"},[t._v("\n            请编辑\n          ")]):i("a",{staticClass:"action"},[t._v("\n            请选择\n          ")])])})),0),i("div",{class:t.bComponent("footer")},[i("st-button",{attrs:{disabled:"",block:"",pill:"",type:"primary",size:"large"}},[t._v("\n          下一步\n        ")])],1)])])],1)},Tt=[],Et={name:"SignUpH5View",bem:{bComponent:"component-signup-h5-view"},components:{H5Container:gt["a"]},props:{stepInfo:{type:Array,default:function(){return[]}}}},At=Et,Ft=Object(w["a"])(At,$t,Tt,!1,null,null,null),Pt=Ft.exports,Nt=i("1bf7"),Yt={name:"AddActivity",bem:{bPage:"page-plugin-form-activity"},serviceInject:function(){return{service:Nt["AddService"]}},components:{ActivityH5View:Ct,TicketH5View:Dt,SignupH5View:Pt,Step1Form:I,Step3Form:vt,Step2Form:V},data:function(){return{step1Info:{},step2Info:[],step3Info:[],stepForm:{},steps:[{title:"活动信息"},{title:"票种信息"},{title:"报名信息"}],currentStep:0}},props:{isCopy:{type:Boolean,default:!1},isEdit:{type:Boolean,default:!1}},methods:{onBack:function(t){this.currentStep=t},onChangeStep1Form:function(t){this.step1Info=t},onChangeStep2Form:function(t){this.step2Info=Object(c["a"])(t)},onChangeStep3Form:function(t){this.step3Info=Object(c["a"])(t)},onSubmitGetStep1Form:function(t){this.currentStep=1,this.stepForm=t},onSubmitGetStep2Form:function(t){this.currentStep=2,this.$set(this.stepForm,"tickets",t)},onReleaseActivity:function(t){var e=this;this.stepForm.is_draft=0,this.$set(this.stepForm,"rule_settings",JSON.stringify(t)),this.isEdit?this.service.updateActivity(this.stepForm).subscribe((function(t){e.$router.push({path:"/brand/marketing/plugin/activity-registration/success",query:{activity_id:e.stepForm.activity_id}})})):this.isCopy?this.service.copyActivity(this.stepForm).subscribe((function(t){e.$router.push({path:"/brand/marketing/plugin/activity-registration/success",query:{activity_id:t.activity_id}})})):this.service.addActivity(this.stepForm).subscribe((function(t){e.$router.push({path:"/brand/marketing/plugin/activity-registration/success",query:{activity_id:t.activity_id}})}))},onSaveDraftActivity:function(t){var e=this;this.stepForm.is_draft=1,this.$set(this.stepForm,"rule_settings",JSON.stringify(t)),this.service.saveDraftActivity(this.stepForm).subscribe((function(t){e.$router.push({path:"/brand/marketing/plugin/activity-registration/list"})}))},onClickStep:function(t){this.currentStep=t}}},Lt=Yt,Ut=Object(w["a"])(Lt,r,o,!1,null,null,null);e["default"]=Ut.exports},"1bf7":function(t,e,i){"use strict";i.r(e),i.d(e,"AddService",(function(){return p}));var a,n,s=i("d225"),r=i("b0b4"),o=i("9ab4"),c=i("0cd5"),u=i("df29"),l=i("c4cc"),d=i("ba07"),m=i("e69b"),p=function(){function t(e,i){Object(s["a"])(this,t),this.api=e,this.msg=i,this.loading$=new u["d"]({}),this.defaultForm$=new u["d"]({}),this.info$=new u["d"]({})}return Object(r["a"])(t,[{key:"addActivity",value:function(t){return this.api.addSignUp(t).pipe(Object(l["a"])((function(t){})))}},{key:"updateActivity",value:function(t){var e=this;return this.api.updateSignUpInfo(t).pipe(Object(l["a"])((function(t){e.msg.success({content:"编辑活动成功！"})})))}},{key:"copyActivity",value:function(t){var e=this;return this.api.addSignUp(t).pipe(Object(l["a"])((function(t){e.msg.success({content:"复制活动成功！"})})))}},{key:"saveDraftActivity",value:function(t){var e=this;return t.activity_id?this.api.updateSignUpInfo(t).pipe(Object(l["a"])((function(t){e.msg.success({content:"存草稿成功！"})}))):this.api.addSignUp(t).pipe(Object(l["a"])((function(t){e.msg.success({content:"存草稿成功！"})})))}}]),t}();p=Object(o["b"])([Object(c["b"])(),Object(o["d"])("design:paramtypes",["function"===typeof(a="undefined"!==typeof d["c"]&&d["c"])?a:Object,"function"===typeof(n="undefined"!==typeof m["a"]&&m["a"])?n:Object])],p)},2171:function(t,e,i){"use strict";i.r(e),i.d(e,"EditService",(function(){return u}));var a,n=i("d225"),s=i("b0b4"),r=i("9ab4"),o=i("34b9"),c=i("0cd5"),u=function(){function t(e){Object(n["a"])(this,t),this.copyService=e}return Object(s["a"])(t,[{key:"beforeRouteEnter",value:function(t){return this.copyService.getDefaultForm(t.meta.query.id)}}]),t}();u=Object(r["b"])([Object(c["b"])(),Object(r["d"])("design:paramtypes",["function"===typeof(a="undefined"!==typeof o["CopyService"]&&o["CopyService"])?a:Object])],u)},"2f09":function(t,e,i){t.exports=i.p+"img/mina-activity-view.497734cf.png"},3176:function(t,e,i){"use strict";i.r(e),i.d(e,"CheckinService",(function(){return f}));var a,n,s,r=i("d225"),o=i("b0b4"),c=i("9ab4"),u=i("ba07"),l=i("0cd5"),d=i("df29"),m=i("c4cc"),p=i("e69b"),f=function(){function t(e,i){Object(r["a"])(this,t),this.signUpApi=e,this.msg=i,this.list$=new d["d"]([]),this.page$=new d["d"]({}),this.loading$=new d["d"]({})}return Object(o["a"])(t,[{key:"getList",value:function(t){var e=this;return this.signUpApi.getSignUpSignList(t).pipe(Object(m["a"])((function(t){e.list$.commit((function(){return t.list})),e.page$.commit((function(){return t.page}))})))}},{key:"updateSignUpChecked",value:function(t){var e=this;return this.signUpApi.updateSignUpChecked(t).pipe(Object(m["a"])((function(t){e.msg.success({content:"票种签到成功"})})))}},{key:"beforeEach",value:function(t){}}]),t}();Object(c["b"])([Object(d["c"])(),Object(c["d"])("design:type",Function),Object(c["d"])("design:paramtypes",["function"===typeof(a="undefined"!==typeof u["GetSignUpSignList"]&&u["GetSignUpSignList"])?a:Object]),Object(c["d"])("design:returntype",void 0)],f.prototype,"getList",null),f=Object(c["b"])([Object(l["b"])(),Object(c["d"])("design:paramtypes",["function"===typeof(n="undefined"!==typeof u["c"]&&u["c"])?n:Object,"function"===typeof(s="undefined"!==typeof p["a"]&&p["a"])?s:Object])],f)},"34b9":function(t,e,i){"use strict";i.r(e),i.d(e,"CopyService",(function(){return d}));var a,n=i("d225"),s=i("b0b4"),r=i("9ab4"),o=i("0cd5"),c=i("df29"),u=i("c4cc"),l=i("ba07"),d=function(){function t(e){Object(n["a"])(this,t),this.api=e,this.loading$=new c["d"]({}),this.defaultForm$=new c["d"]({})}return Object(s["a"])(t,[{key:"getDefaultForm",value:function(t){var e=this;return this.api.getSignUpEditInfo(t).pipe(Object(u["a"])((function(t){e.defaultForm$.commit((function(){return t.info}))})))}},{key:"beforeRouteEnter",value:function(t){return this.getDefaultForm(t.meta.query.id)}}]),t}();d=Object(r["b"])([Object(o["b"])(),Object(r["d"])("design:paramtypes",["function"===typeof(a="undefined"!==typeof l["c"]&&l["c"])?a:Object])],d)},"35d0":function(t,e,i){"use strict";i.r(e),i.d(e,"RosterService",(function(){return v}));var a,n,s,r=i("75fc"),o=(i("7f7f"),i("d225")),c=i("b0b4"),u=i("9ab4"),l=i("0cd5"),d=i("df29"),m=i("c4cc"),p=i("ba07"),f=i("2138"),h=i("e69b"),v=function(){function t(e,i,a){Object(o["a"])(this,t),this.signUpApi=e,this.userService=i,this.msg=a,this.list$=new d["d"]([]),this.page$=new d["d"]({}),this.loading$=new d["d"]({}),this.activityInfo$=new d["d"]({}),this.ticketTypeOptions$=new d["d"]({}),this.ticketStatus$=this.userService.getOptions$("plugin.ticket_status",{addAll:!0}),this.PLUGIN_TYPE_ACTIVITY=4}return Object(c["a"])(t,[{key:"getList",value:function(t){var e=this;return this.signUpApi.getSignUpRoster(t).pipe(Object(m["a"])((function(t){e.list$.commit((function(){return t.list})),e.page$.commit((function(){return t.page}))})))}},{key:"getActivityInfo",value:function(t){var e=this;return this.signUpApi.getActivityInfo(t).pipe(Object(m["a"])((function(t){e.activityInfo$.commit((function(){return t.info})),e.ticketTypeOptions$.commit((function(){var e=[{label:"全部",value:-1}],i=t.info.ticket_list.map((function(t){return{label:t.name,value:t.id}}));return[].concat(e,Object(r["a"])(i))}))})))}},{key:"updateSignUpChecked",value:function(t){var e=this;return this.signUpApi.updateSignUpChecked(t).pipe(Object(m["a"])((function(t){e.msg.success({content:"票种签到成功"})})))}},{key:"beforeRouteEnter",value:function(t,e){return this.getActivityInfo(t.meta.query.id)}},{key:"beforeEach",value:function(t,e){return this.getList(t.meta.query)}}]),t}();Object(u["b"])([Object(d["c"])(),Object(u["d"])("design:type",Function),Object(u["d"])("design:paramtypes",[Object]),Object(u["d"])("design:returntype",void 0)],v.prototype,"getList",null),v=Object(u["b"])([Object(l["b"])(),Object(u["d"])("design:paramtypes",["function"===typeof(a="undefined"!==typeof p["c"]&&p["c"])?a:Object,"function"===typeof(n="undefined"!==typeof f["a"]&&f["a"])?n:Object,"function"===typeof(s="undefined"!==typeof h["a"]&&h["a"])?s:Object])],v)},4583:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:t.bPage()},[i("div",{class:t.bPage("info")},[i("st-t3",{staticClass:"title"},[t._v(t._s(t.activityInfo$.activity_name))]),i("div",{staticClass:"time mg-t24"},[i("span",{staticClass:"label"},[t._v("活动时间：")]),i("span",{staticClass:"value"},[t._v("\n        "+t._s(t.activityInfo$.start_time)+"-"+t._s(t.activityInfo$.end_time)+"\n      ")])]),i("div",{staticClass:"address mg-t8"},[i("span",{staticClass:"label"},[t._v("活动地点：")]),i("span",{staticClass:"value"},[t._v(t._s(t.activityInfo$.address))])])],1),i("st-panel",{staticClass:"mg-t24",attrs:{app:""}},[i("div",{class:t.bPage("search")},[i("div",{class:t.bSearch("select-group")},[i("a-select",{staticClass:"mg-r16",staticStyle:{width:"160px"},attrs:{placeholder:"请选择状态",options:t.ticketStatus$},on:{change:function(e){return t.onSingleSearch("ticket_status",e)}},model:{value:t.$searchQuery.ticket_status,callback:function(e){t.$set(t.$searchQuery,"ticket_status",e)},expression:"$searchQuery.ticket_status"}}),i("a-select",{staticClass:"mg-r16",staticStyle:{width:"160px"},attrs:{placeholder:"请选择票种",options:t.ticketTypeOptions$},on:{change:function(e){return t.onSingleSearch("ticket_id",e)}},model:{value:t.$searchQuery.ticket_id,callback:function(e){t.$set(t.$searchQuery,"ticket_id",e)},expression:"$searchQuery.ticket_id"}})],1),i("div",{class:t.bSearch("input-group")},[i("st-input-search",{staticStyle:{width:"290px"},attrs:{placeholder:"请输入姓名、手机号"},on:{search:function(e){return t.onSingleSearch("keyword",e)}}})],1)]),i("div",{staticClass:"mg-t16",class:t.bPage("list")},[i("st-table",{attrs:{page:t.page$,rowKey:"id",columns:t.columns,scroll:{x:1500},dataSource:t.list$},on:{change:t.onTableChange},scopedSlots:t._u([{key:"ticket_status",fn:function(e){return[i("st-text",{attrs:{status:{error:1===e.id,success:2===e.id,default:3===e.id}}},[t._v("\n            "+t._s(e.name)+"\n          ")])]}},{key:"registration_info",fn:function(e){return i("div",{},[Array.isArray(e)?i("a",{on:{click:function(i){return t.onClickShowInfo(e)}}},[t._v("查看详情")]):i("span",[t._v("--")])])}},{key:"action",fn:function(e,a){return[i("st-table-actions",[1===a.ticket_status.id?i("a",[i("st-popconfirm",{attrs:{title:"签到后将视为已使用，您确定要将其核销签到吗？",okText:"确认",cancelText:"取消"},on:{confirm:function(e){return t.onConfirmSignIn(a)}}},[t._v("\n                签到\n              ")])],1):i("span",[t._v(t._s(a.ticket_status.name))])])]}}])})],1)])],1)},n=[],s=i("ea3e"),r=function(t){return[{title:"用户姓名",width:140,fixed:"left",dataIndex:"member_name",scopedSlots:{customRender:"member_name"}},{title:"用户手机号",dataIndex:"member_mobile",scopedSlots:{customRender:"member_mobile"}},{title:"报名时间",dataIndex:"registration_time",scopedSlots:{customRender:"registration_time"}},{title:"票种",dataIndex:"ticket_name",scopedSlots:{customRender:"ticket_name"}},{title:"价格(元)",dataIndex:"ticket_price",scopedSlots:{customRender:"ticket_price"}},{title:"票号",dataIndex:"id",scopedSlots:{customRender:"id"}},{title:"状态",dataIndex:"ticket_status",scopedSlots:{customRender:"ticket_status"}},{title:"报名信息",dataIndex:"registration_info",scopedSlots:{customRender:"registration_info"}},{title:"操作",dataIndex:"action",width:140,fixed:"right",scopedSlots:{customRender:"action"}}]},o=i("35d0"),c=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("st-modal",{attrs:{title:"报名信息",footer:null,width:"500px"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[i("div",{class:t.bModal()},[i("st-info",t._l(t.signUpInfo,(function(e,a){return i("st-info-item",{key:a,attrs:{label:e.label}},[t._v("\n        "+t._s(e.value)+"\n      ")])})),1)],1)])},u=[],l={name:"ModalActivitySignUpInfo",bem:{bModal:"modal-marketing-activity-sign-up-info"},props:{signUpInfo:Array},data:function(){return{show:!1}}},d=l,m=i("2877"),p=Object(m["a"])(d,c,u,!1,null,null,null),f=p.exports,h={name:"RosterList",mixins:[s["a"]],bem:{bPage:"marketing-plugin-activity-roster",bSearch:"roster-search"},modals:{MarketingActivitySignUpInfo:f},serviceInject:function(){return{service:o["RosterService"]}},rxState:function(){var t=this.service,e=t.list$,i=t.page$,a=t.loading$,n=t.ticketStatus$,s=t.activityInfo$,r=t.ticketTypeOptions$;return{list$:e,page$:i,loading$:a,ticketStatus$:n,activityInfo$:s,ticketTypeOptions$:r}},computed:{columns:r},methods:{onClickShowInfo:function(t){this.$modalRouter.push({name:"marketing-activity-sign-up-info",props:{signUpInfo:t}})},onConfirmSignIn:function(t){var e=this;this.service.updateSignUpChecked(t.id).subscribe((function(t){e.$router.reload()}))}}},v=h,_=Object(m["a"])(v,a,n,!1,null,null,null);e["default"]=_.exports},"6c6c":function(t,e,i){"use strict";i.r(e),i.d(e,"SuccessService",(function(){return p}));i("c5f6");var a,n,s=i("d225"),r=i("b0b4"),o=i("9ab4"),c=i("0cd5"),u=i("df29"),l=i("c4cc"),d=i("ba07"),m=i("2138"),p=function(){function t(e,i){Object(s["a"])(this,t),this.api=e,this.userService=i,this.loading$=new u["d"]({}),this.info$=new u["d"]({}),this.qrcode$=new u["d"]({}),this.brand$=this.userService.brand$}return Object(r["a"])(t,[{key:"getSharePosterInfo",value:function(t){var e=this;return this.api.getSharePosterInfo(t).pipe(Object(l["a"])((function(t){e.info$.commit((function(){return t.info}))})))}},{key:"getQrCode",value:function(t){var e=this;return this.api.getQrCode(t).pipe(Object(l["a"])((function(t){e.qrcode$.commit((function(){return t.qrcode}))})))}}]),t}();Object(o["b"])([Object(u["c"])(),Object(o["d"])("design:type",Function),Object(o["d"])("design:paramtypes",[Number]),Object(o["d"])("design:returntype",void 0)],p.prototype,"getSharePosterInfo",null),Object(o["b"])([Object(u["c"])(),Object(o["d"])("design:type",Function),Object(o["d"])("design:paramtypes",[Number]),Object(o["d"])("design:returntype",void 0)],p.prototype,"getQrCode",null),p=Object(o["b"])([Object(c["b"])(),Object(o["d"])("design:paramtypes",["function"===typeof(a="undefined"!==typeof d["c"]&&d["c"])?a:Object,"function"===typeof(n="undefined"!==typeof m["a"]&&m["a"])?n:Object])],p)},"89a8":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("st-panel-layout",{class:t.bPage()},[i("markteing-plugin-title",{attrs:{type:t.TYPE.ACTIVITY}}),i("st-panel",{class:t.bPage("content"),attrs:{app:""}},[i("div",{class:t.bSearch(),attrs:{slot:"title"},slot:"title"},[i("div",{class:t.bSearch("button-group")},[t.auth$.add?i("st-button",{attrs:{icon:"add",type:"primary"},on:{click:function(e){return t.onClickRouterPush({pathName:"addActivity"})}}},[t._v("\n          新增活动\n        ")]):t._e(),t.auth$.checkIn?i("st-button",{staticClass:"mg-l8",on:{click:function(e){return t.onClickRouterPush({pathName:"checkinActivity"})}}},[t._v("\n          签到验票\n        ")]):t._e(),i("st-button",{staticClass:"mg-l8",on:{click:t.onConfigHandle}},[t._v("\n          配置到小程序\n        ")])],1),i("div",{class:t.bSearch("input-group")},[i("a-select",{staticClass:"mg-r8",staticStyle:{width:"160px"},attrs:{placeholder:"请选择活动报名状态",options:t.activityStatus$},on:{change:function(e){return t.onSingleSearch("activity_status",e)}},model:{value:t.$searchQuery.activity_status,callback:function(e){t.$set(t.$searchQuery,"activity_status",e)},expression:"$searchQuery.activity_status"}}),i("st-input-search",{staticStyle:{width:"290px"},attrs:{placeholder:"请输入活动报名标题"},on:{search:function(e){return t.onSingleSearch("activity_name",e)}}})],1)]),i("div",{class:t.bPage("table")},[i("st-table",{attrs:{page:t.page$,rowKey:"id",loading:t.loading$.getList,columns:t.columns,dataSource:t.list$},on:{change:t.onTableChange},scopedSlots:t._u([{key:"time",fn:function(e){return i("span",{},[t._v("\n          "+t._s(e.start_time)+" ~ "+t._s(e.end_time)+"\n        ")])}},{key:"activity_status",fn:function(e,a){return[i("st-text",{attrs:{status:{error:3===a.activity_status.id,success:2===a.activity_status.id||1===a.activity_status.id,default:4===a.activity_status.id||5===a.activity_status.id}}},[t._v("\n            "+t._s(e.name)+"\n          ")])]}},{key:"join_people",fn:function(e,a){return[e>0?i("a",{on:{click:function(e){return t.onClickNameList({record:a,pathName:"rosterActivity"})}}},[t._v("\n            "+t._s(e)+"\n          ")]):i("span",[t._v(t._s(e))])]}},{key:"action",fn:function(e,a){return[i("st-table-actions",[a.auth.isEdit?i("a",{on:{click:function(e){return t.onClickEdit({record:a,pathName:"editActivity"})}}},[t._v("\n              编辑\n            ")]):t._e(),a.auth.isAdv?i("a",{on:{click:function(e){return t.onCLickGeneralize(a)}}},[t._v("\n              推广\n            ")]):t._e(),a.auth.isName?i("a",{on:{click:function(e){return t.onClickNameList({record:a,pathName:"rosterActivity"})}}},[t._v("\n              名单\n            ")]):t._e(),a.auth.isCopy?i("a",{on:{click:function(e){return t.onClickCopy({record:a,pathName:"copyActivity"})}}},[t._v("\n              复制\n            ")]):t._e(),a.auth.isCancel?i("a",{on:{click:function(e){return t.onClickStop(a)}}},[t._v("\n              取消\n            ")]):t._e()])]}}])})],1)])],1)},n=[],s=(i("7f7f"),i("ea3e")),r=i("a029"),o=i("aa7d"),c=function(t){return[{title:"活动标题",width:240,dataIndex:"activity_name",scopedSlots:{customRender:"activity_name"}},{title:"活动时间",scopedSlots:{customRender:"time"}},{title:"包含票种",dataIndex:"ticket_type_num",scopedSlots:{customRender:"ticket_type_num"}},{title:"已报名人数",dataIndex:"join_people",scopedSlots:{customRender:"join_people"}},{title:"活动状态",dataIndex:"activity_status",width:80,scopedSlots:{customRender:"activity_status"}},{title:"发布时间",width:150,dataIndex:"publish_time",scopedSlots:{customRender:"publish_time"}},{title:"操作",dataIndex:"action",width:140,scopedSlots:{customRender:"action"}}]},u=i("6c94"),l=i("5ffc"),d={name:"ActivityList",mixins:[s["a"]],bem:{bPage:"page-plugin-activity-registration",bSearch:"search"},data:function(){return{TYPE:u["a"],plugin_image:[],redirectPath:{addActivity:"brand-marketing-plugin-activity-registration-add",editActivity:"brand-marketing-plugin-activity-registration-edit",checkinActivity:"brand-marketing-plugin-activity-registration-checkin",copyActivity:"brand-marketing-plugin-activity-registration-copy",rosterActivity:"brand-marketing-plugin-activity-registration-roster"}}},hooks:function(){return{share:Object(l["a"])()}},serviceInject:function(){return{service:r["ListService"]}},rxState:function(){var t=this.service,e=t.info$,i=t.brand$,a=t.page$,n=t.list$,s=t.activityStatus$,r=t.loading$,o=t.auth$;return{activityStatus$:s,page$:a,list$:n,auth$:o,loading$:r,brand$:i,info$:e}},components:{MarkteingPluginTitle:o["a"]},computed:{columns:c},methods:{onConfigHandle:function(){this.$router.push({path:"/brand/setting/mina/index"})},onClickRouterPush:function(t){t.record;var e=t.pathName;this.$router.push({name:this.redirectPath[e]})},onClickEdit:function(t){var e=t.record,i=t.pathName;this.$router.push({name:this.redirectPath[i],query:{id:e.id}})},onCLickGeneralize:function(t){var e=this;this.service.getSharePosterInfo(t.id).subscribe((function(t){var i=e.info$,a="".concat(i.start_time," - ").concat(i.end_time),n={qrcode_url:i.qrcode,brand_name:e.brand$.name,brand_logo:e.brand$.logo,activity_img:i.image.image_url,activity_title:i.activity_name,activity_date:a,activity_address:i.address};e.share.poster({isAuth:t.is_auth,shsInfo:n,shsPath:"/saas/activity"})}))},onClickNameList:function(t){var e=t.record,i=t.pathName;this.$router.push({name:this.redirectPath[i],query:{id:e.id}})},onClickStop:function(t){var e=this;this.$confirm({title:"提示",content:"确认取消该活动吗?",okText:"是的",cancelText:"再想想",onOk:function(){e.service.cancelSignUp(t.id).subscribe((function(t){e.$router.reload()}))},onCancel:function(){}})},onClickCopy:function(t){var e=t.record,i=t.pathName;this.$router.push({name:this.redirectPath[i],query:{id:e.id}})}}},m=d,p=i("2877"),f=Object(p["a"])(m,a,n,!1,null,null,null);e["default"]=f.exports},"93c6":function(t,e){t.exports="data:image/png;base64,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"},9577:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("page-add",{attrs:{isCopy:!0}})],1)},n=[],s=i("0fc9e"),r={name:"CopyActivity",components:{PageAdd:s["default"]}},o=r,c=i("2877"),u=Object(c["a"])(o,a,n,!1,null,null,null);e["default"]=u.exports},"9f45":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("st-panel",{class:t.bPage(),attrs:{app:"",initial:""}},[i("header",{class:t.bPage("header")},[i("a-input-search",{attrs:{placeholder:"输入票号，用户姓名，手机号进行搜索"},on:{search:t.getList},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}},[i("a-button",{attrs:{slot:"enterButton",type:"primary"},slot:"enterButton"},[t._v("\n        搜索\n      ")])],1)],1),i("main",{class:t.bPage("main")},[t.isSearch?i("st-container",[i("st-table",{attrs:{columns:t.columns,rowKey:"id",loading:t.loading$.getList,dataSource:t.list$,page:!1},on:{change:t.onTableChange},scopedSlots:t._u([{key:"ticket_status",fn:function(e){return[i("st-text",{attrs:{status:{error:1===e.id,success:2===e.id,default:3===e.id}}},[t._v("\n            "+t._s(e.name)+"\n          ")])]}},{key:"action",fn:function(e,a){return[i("st-table-actions",[1===a.ticket_status.id?i("a",[i("st-popconfirm",{attrs:{title:"签到后将视为已使用，您确定要将其核销签到吗？",okText:"确认",cancelText:"取消"},on:{confirm:function(e){return t.onConfirmSignIn(a)}}},[t._v("\n                签到\n              ")])],1):i("span",[t._v(t._s(a.ticket_status.name))])])]}}],null,!1,2395588306)})],1):i("checkin-guide")],1)])},n=[],s=(i("8e6e"),i("ac6a"),i("456d"),i("bd86")),r=i("ea3e"),o=function(t){return[{title:"票号",dataIndex:"id",scopedSlots:{customRender:"id"}},{title:"用户姓名",dataIndex:"member_name",scopedSlots:{customRender:"member_name"}},{title:"用户手机号",dataIndex:"member_mobile",scopedSlots:{customRender:"member_mobile"}},{title:"活动标题",dataIndex:"activity_name",scopedSlots:{customRender:"activity_name"}},{title:"票种",dataIndex:"ticket_name",scopedSlots:{customRender:"ticket_name"}},{title:"价格(元)",dataIndex:"ticket_price",scopedSlots:{customRender:"ticket_price"}},{title:"状态",dataIndex:"ticket_status",scopedSlots:{customRender:"ticket_status"}},{title:"操作",dataIndex:"action",width:140,fixed:"right",scopedSlots:{customRender:"action"}}]},c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:t.bComponent()},[a("img",{class:t.bComponent("left"),attrs:{src:i("2f09"),alt:""}}),a("div",{class:t.bComponent("right")},[a("st-steps-line",t._l(t.steps,(function(t){return a("st-steps-line-item",{key:t.index,attrs:{step:t.index,title:t.title,description:t.description}})})),1)],1)])},u=[],l={bem:{bComponent:"component-checkin-guide"},data:function(){return{steps:[{index:1,title:"搜索票号",description:"输入参与用户提供的票号"},{index:2,title:"校验",description:"检查票号信息是否对应及有效"},{index:3,title:"签到验票",description:"点击签到，签到后状态更新为已签到"}]}}},d=l,m=i("2877"),p=Object(m["a"])(d,c,u,!1,null,null,null),f=p.exports,h=i("3176");function v(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,a)}return i}function _(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?v(Object(i),!0).forEach((function(e){Object(s["a"])(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):v(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}var b={name:"CheckInList",mixins:[r["a"]],bem:{bPage:"page-activity-checkin"},components:{CheckinGuide:f},serviceInject:function(){return{service:h["CheckinService"]}},rxState:function(){var t=this.service,e=t.page$,i=t.list$,a=t.loading$;return{loading$:a,page$:e,list$:i}},computed:{columns:o},data:function(){return{keyword:"",isSearch:!1}},methods:{getList:function(){var t=this;if(this.keyword)return this.service.getList({keyword:this.keyword}).subscribe((function(e){t.isSearch=!0}));this.message.warn({content:"请输入内容"})},onConfirmSignIn:function(t){var e=this;this.service.updateSignUpChecked(t.id).subscribe((function(t){e.keyword="",e.$router.reload()}))},onTableChange:function(t,e,i){var a=_({},this.pagination);a.current=t.current,a.pageSize=t.pageSize,this.page$=a}}},g=b,y=Object(m["a"])(g,a,n,!1,null,null,null);e["default"]=y.exports},a029:function(t,e,i){"use strict";i.r(e),i.d(e,"ListService",(function(){return b}));var a,n,s,r,o,c=i("d225"),u=i("b0b4"),l=i("9ab4"),d=i("0cd5"),m=i("df29"),p=i("c4cc"),f=i("ba07"),h=i("2138"),v=i("e69b"),_=i("2cbb"),b=function(){function t(e,i,a,n){Object(c["a"])(this,t),this.signUpApi=e,this.msg=i,this.userService=a,this.authService=n,this.list$=new m["d"]([]),this.page$=new m["d"]({}),this.loading$=new m["d"]({}),this.info$=new m["d"]({}),this.pluginInfo$=new m["d"]({}),this.brand$=this.userService.brand$,this.auth$=this.authService.authMap$({add:"brand:activity:sign_up|add",checkIn:"brand:activity:sign_up|check_in"}),this.activityStatus$=this.userService.getOptions$("plugin.activity_status_sign_up_join",{addAll:!0})}return Object(u["a"])(t,[{key:"SET_LIST",value:function(t){this.list$.commit((function(){return t}))}},{key:"getList",value:function(t){var e=this;return this.signUpApi.getSignUpList(t).pipe(Object(p["a"])((function(t){var i=t.list.map((function(t){return t.auth.isEdit=t.auth["brand:activity:sign_up|edit"],t.auth.isAdv=t.auth["brand:activity:sign_up|promotion"],t.auth.isName=t.auth["brand:activity:sign_up|list"],t.auth.isCopy=t.auth["brand:activity:sign_up|add"],t.auth.isCancel=t.auth["brand:activity:sign_up|end"],t}));e.SET_LIST(i),e.page$.commit((function(){return t.page}))})))}},{key:"getSharePosterInfo",value:function(t){var e=this;return this.signUpApi.getSharePosterInfo(t).pipe(Object(p["a"])((function(t){e.info$.commit((function(){return t.info}))})))}},{key:"cancelSignUp",value:function(t){var e=this;return this.signUpApi.cancelSignUp(t).pipe(Object(p["a"])((function(t){e.msg.success({content:"结束活动成功"})})))}},{key:"beforeEach",value:function(t,e){return this.getList(t.meta.query)}}]),t}();Object(l["b"])([Object(m["c"])(),Object(l["d"])("design:type",Function),Object(l["d"])("design:paramtypes",["function"===typeof(a="undefined"!==typeof f["GetSignUpList"]&&f["GetSignUpList"])?a:Object]),Object(l["d"])("design:returntype",void 0)],b.prototype,"getList",null),b=Object(l["b"])([Object(d["b"])(),Object(l["d"])("design:paramtypes",["function"===typeof(n="undefined"!==typeof f["c"]&&f["c"])?n:Object,"function"===typeof(s="undefined"!==typeof v["a"]&&v["a"])?s:Object,"function"===typeof(r="undefined"!==typeof h["a"]&&h["a"])?r:Object,"function"===typeof(o="undefined"!==typeof _["a"]&&_["a"])?o:Object])],b)},b7d6:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("page-add",{attrs:{isEdit:!0}})},n=[],s=i("0fc9e"),r={name:"EditActivity",components:{PageAdd:s["default"]}},o=r,c=i("2877"),u=Object(c["a"])(o,a,n,!1,null,null,null);e["default"]=u.exports},ee1d:function(t,e,i){var a=i("5ca1");a(a.S,"Number",{isNaN:function(t){return t!=t}})}}]);