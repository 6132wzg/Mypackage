{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/thread-loader/dist/cjs.js!/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js!/Users/wangzhigang/Desktop/styd/web/node_modules/ts-loader/index.js??ref--13-3!/Users/wangzhigang/Desktop/styd/web/src/views/pages/shop/reception/cabinet.service.ts","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/pages/shop/reception/cabinet.service.ts","mtime":1591147717436},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/thread-loader/dist/cjs.js","mtime":1591062572352},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/ts-loader/index.js","mtime":1591062571609}],"contextDependencies":[],"result":["import \"core-js/modules/es6.array.sort\";\nimport _classCallCheck from \"/Users/wangzhigang/Desktop/styd/web/node_modules/@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/wangzhigang/Desktop/styd/web/node_modules/@babel/runtime-corejs2/helpers/esm/createClass\";\n\nvar _a, _b, _c, _d, _e;\n\nimport { __decorate, __metadata } from \"tslib\";\nimport { Injectable } from 'vue-service-app';\nimport { Effect, State } from 'rx-state/src';\nimport { CabinetAreaService as AreaService } from \"../setting/components#/area.service\";\nimport { CabinetApi, DelInput } from '@/api/v1/setting/cabinet';\nimport { AuthService } from '@/services/auth.service';\nimport { CabinetListService } from \"./components#/cabinet-list.service\";\nimport { forkJoin } from 'rxjs';\n\nvar CabinetService = /*#__PURE__*/function () {\n  function CabinetService(areaService, cabinetApi, authService, cabinetListService) {\n    _classCallCheck(this, CabinetService);\n\n    this.areaService = areaService;\n    this.cabinetApi = cabinetApi;\n    this.authService = authService;\n    this.cabinetListService = cabinetListService;\n    this.loading$ = new State({});\n    this.auth$ = this.authService.authMap$({\n      areaAdd: 'shop:cabinet:cabinet_area|add',\n      areaEdit: 'shop:cabinet:cabinet_area|edit',\n      areaDel: 'shop:cabinet:cabinet_area|del',\n      batchAdd: 'shop:cabinet:cabinet|batch_add',\n      batchPrice: 'shop:cabinet:cabinet|price',\n      batchDel: 'shop:cabinet:cabinet|batch_del'\n    });\n  }\n\n  _createClass(CabinetService, [{\n    key: \"del\",\n    value: function del(params) {\n      return this.cabinetApi.deleteCabinet(params);\n    }\n  }, {\n    key: \"sort\",\n    value: function sort(list) {\n      list = list.map(function (item, index) {\n        return {\n          id: item.id,\n          sorted: index\n        };\n      });\n      return this.areaService.sort({\n        list: list\n      });\n    }\n  }, {\n    key: \"clearCabinet\",\n    value: function clearCabinet(params) {\n      return this.cabinetApi.clearCabinet(params);\n    }\n  }, {\n    key: \"init\",\n    value: function init(query) {\n      return forkJoin(this.cabinetListService.getList(query.type, query.id), this.areaService.getList());\n    }\n  }, {\n    key: \"beforeRouteEnter\",\n    value: function beforeRouteEnter(to, form) {\n      return this.init(to.meta.query);\n    }\n  }, {\n    key: \"beforeRouteUpdate\",\n    value: function beforeRouteUpdate(to, form) {\n      return this.cabinetListService.getList(to.meta.query.type, to.meta.query.id);\n    }\n  }]);\n\n  return CabinetService;\n}();\n\n__decorate([Effect(), __metadata(\"design:type\", Function), __metadata(\"design:paramtypes\", [typeof (_a = typeof DelInput !== \"undefined\" && DelInput) === \"function\" ? _a : Object]), __metadata(\"design:returntype\", void 0)], CabinetService.prototype, \"del\", null);\n\n__decorate([Effect(), __metadata(\"design:type\", Function), __metadata(\"design:paramtypes\", [Object]), __metadata(\"design:returntype\", void 0)], CabinetService.prototype, \"clearCabinet\", null);\n\nCabinetService = __decorate([Injectable(), __metadata(\"design:paramtypes\", [typeof (_b = typeof AreaService !== \"undefined\" && AreaService) === \"function\" ? _b : Object, typeof (_c = typeof CabinetApi !== \"undefined\" && CabinetApi) === \"function\" ? _c : Object, typeof (_d = typeof AuthService !== \"undefined\" && AuthService) === \"function\" ? _d : Object, typeof (_e = typeof CabinetListService !== \"undefined\" && CabinetListService) === \"function\" ? _e : Object])], CabinetService);\nexport { CabinetService };",null]}