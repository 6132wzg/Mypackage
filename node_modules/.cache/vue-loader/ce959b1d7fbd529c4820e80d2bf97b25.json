{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhigang/Desktop/styd/web/src/views/biz-modals/hardware/black-list.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/biz-modals/hardware/black-list.vue","mtime":1591147717180},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js","mtime":1591062572376}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { columns } from './black-list.config'\nimport { BlackService } from './black-list.service'\n\nexport default {\n  serviceInject() {\n    return {\n      blackService: BlackService\n    }\n  },\n  rxState() {\n    return {\n      loading: this.blackService.loading$,\n      blackList: this.blackService.blackList$,\n      blackKeys: this.blackService.blackKeys$,\n      searchList: this.blackService.searchList$\n    }\n  },\n  bem: {\n    bPage: 'modal-shop-blacklist'\n  },\n  props: {\n    id: Number\n  },\n  data() {\n    return {\n      show: false,\n      list: [],\n      page: {} // 前端分页\n    }\n  },\n  created() {\n    this.getBlackList()\n  },\n  computed: {\n    columns\n  },\n  methods: {\n    getBlackList() {\n      return this.blackService.getBlackList().subscribe()\n    },\n    onSearchKeyWords(val) {\n      this.blackService.onSearchKeyWords(val).subscribe()\n    },\n    joinPerson(para) {\n      let arr = this.blackList\n      this.blackList = []\n      this.blackKeys = Array.from(new Set(this.blackKeys))\n      let searchRes = this.searchList.concat(arr)\n      this.blackKeys.map(id => {\n        searchRes.map(searchItem => {\n          if (searchItem.user_id === id) {\n            this.blackList.push(searchItem)\n          }\n        })\n      })\n    },\n    deletePerson(para) {\n      this.blackKeys = this.blackKeys.filter(id => {\n        return id !== para.user_id\n      })\n      this.blackList = this.blackList.filter(({ user_id }) => {\n        return user_id !== para.user_id\n      })\n    },\n    onChange(pagination, filters, sorter) {\n      this.page = pagination\n      this.page.current_page = pagination.current\n      this.page.size = pagination.pageSize\n    },\n    postBlackListSetting() {\n      this.blackService\n        .postBlackListSetting({ black_list: this.blackList })\n        .subscribe(res => {\n          this.show = false\n          this.$emit('success')\n        })\n    }\n  },\n  watch: {\n    // 去重\n    blackList() {\n      for (var i = 0; i < this.blackList.length; i++) {\n        for (var j = i + 1; j < this.blackList.length; j++) {\n          if (this.blackList[i].user_id === this.blackList[j].user_id) {\n            this.blackList.splice(j, 1)\n            j--\n          }\n        }\n      }\n    }\n  }\n}\n",{"version":3,"sources":["black-list.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyDA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"black-list.vue","sourceRoot":"src/views/biz-modals/hardware","sourcesContent":["<template>\n  <st-modal\n    title=\"黑名单管理\"\n    v-model=\"show\"\n    size=\"small\"\n    @ok=\"postBlackListSetting\"\n  >\n    <a-select\n      v-model=\"blackKeys\"\n      showSearch\n      mode=\"multiple\"\n      placeholder=\"手机号搜索\"\n      style=\"width: 100%\"\n      :defaultActiveFirstOption=\"false\"\n      @search=\"onSearchKeyWords\"\n      :filterOption=\"false\"\n      @change=\"joinPerson\"\n      :maxTagCount=\"0\"\n      class=\"mg-b24\"\n    >\n      <template slot=\"maxTagPlaceholder\">\n        <div>已选择{{ blackKeys.length || 0 }}个</div>\n      </template>\n      <a-select-option\n        v-for=\"item in searchList\"\n        :key=\"item.user_id\"\n        :value=\"+item.user_id\"\n      >\n        ({{ item.user_cate }}) &nbsp;&nbsp;{{ item.user_name }}&nbsp;{{\n          item.mobile\n        }}\n      </a-select-option>\n    </a-select>\n\n    <st-table\n      :columns=\"columns\"\n      :dataSource=\"blackList\"\n      :page=\"page\"\n      rowKey=\"user_id\"\n      @change=\"onChange\"\n    >\n      <div slot=\"action\" slot-scope=\"text, record\">\n        <st-table-actions>\n          <a>\n            <st-popconfirm\n              :title=\"'一旦删除则无法恢复，确认删除'\"\n              @confirm=\"deletePerson(record)\"\n            >\n              删除\n            </st-popconfirm>\n          </a>\n        </st-table-actions>\n      </div>\n    </st-table>\n  </st-modal>\n</template>\n<script>\nimport { columns } from './black-list.config'\nimport { BlackService } from './black-list.service'\n\nexport default {\n  serviceInject() {\n    return {\n      blackService: BlackService\n    }\n  },\n  rxState() {\n    return {\n      loading: this.blackService.loading$,\n      blackList: this.blackService.blackList$,\n      blackKeys: this.blackService.blackKeys$,\n      searchList: this.blackService.searchList$\n    }\n  },\n  bem: {\n    bPage: 'modal-shop-blacklist'\n  },\n  props: {\n    id: Number\n  },\n  data() {\n    return {\n      show: false,\n      list: [],\n      page: {} // 前端分页\n    }\n  },\n  created() {\n    this.getBlackList()\n  },\n  computed: {\n    columns\n  },\n  methods: {\n    getBlackList() {\n      return this.blackService.getBlackList().subscribe()\n    },\n    onSearchKeyWords(val) {\n      this.blackService.onSearchKeyWords(val).subscribe()\n    },\n    joinPerson(para) {\n      let arr = this.blackList\n      this.blackList = []\n      this.blackKeys = Array.from(new Set(this.blackKeys))\n      let searchRes = this.searchList.concat(arr)\n      this.blackKeys.map(id => {\n        searchRes.map(searchItem => {\n          if (searchItem.user_id === id) {\n            this.blackList.push(searchItem)\n          }\n        })\n      })\n    },\n    deletePerson(para) {\n      this.blackKeys = this.blackKeys.filter(id => {\n        return id !== para.user_id\n      })\n      this.blackList = this.blackList.filter(({ user_id }) => {\n        return user_id !== para.user_id\n      })\n    },\n    onChange(pagination, filters, sorter) {\n      this.page = pagination\n      this.page.current_page = pagination.current\n      this.page.size = pagination.pageSize\n    },\n    postBlackListSetting() {\n      this.blackService\n        .postBlackListSetting({ black_list: this.blackList })\n        .subscribe(res => {\n          this.show = false\n          this.$emit('success')\n        })\n    }\n  },\n  watch: {\n    // 去重\n    blackList() {\n      for (var i = 0; i < this.blackList.length; i++) {\n        for (var j = i + 1; j < this.blackList.length; j++) {\n          if (this.blackList[i].user_id === this.blackList[j].user_id) {\n            this.blackList.splice(j, 1)\n            j--\n          }\n        }\n      }\n    }\n  }\n}\n</script>\n"]}]}