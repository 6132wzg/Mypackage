(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["shop-staff"],{"19f1":function(t,e,a){"use strict";var s,r,i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("st-modal",{attrs:{title:"绑定实体卡",size:"small"},on:{ok:t.save},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("div",{staticClass:"modal-bind-entity-card"},[a("staff-info",{attrs:{staff:t.staff}}),t.staff.has_card?a("a-row",{staticClass:"staff-card  mg-b24"},[a("a-col",{staticClass:"pd-x8 pd-y16",attrs:{span:24}},[a("div",{staticClass:"card"},[a("span",{staticClass:"label"},[t._v("当前绑定实体卡号：")]),a("span",{staticClass:"vlaue"},[t._v(t._s(t.staff.card_number))])]),a("div",{staticClass:"card mg-t8"},[a("span",{staticClass:"label"},[t._v("物理ID：")]),a("span",{staticClass:"vlaue"},[t._v(t._s(t.staff.physical_number))])])])],1):t._e(),a("a-row",[a("st-form",{staticClass:"modal-bind-entity-card__form",attrs:{labelWidth:"88px",form:t.form},on:{submit:t.save}},[a("st-form-item",{attrs:{label:"实体卡号"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.card_number,expression:"decorators.card_number"}],attrs:{placeholder:"请输入实体卡号"}})],1),a("st-form-item",{attrs:{label:"物理ID"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.physical_number,expression:"decorators.physical_number"}],attrs:{placeholder:"请将实体卡置于读卡器上"}})],1)],1)],1)],1)])},n=[],o=(a("8e6e"),a("ac6a"),a("456d"),a("bd86")),c=a("6e27"),d=a("d225"),f=a("b0b4"),l=a("9ab4"),u=a("0cd5"),p=a("e69b"),m=a("cc76"),h=a("c4cc"),v=function(){function t(e,a){Object(d["a"])(this,t),this.staffApi=e,this.msg=a}return Object(f["a"])(t,[{key:"putStaffBindPhysical",value:function(t){var e=this;return this.staffApi.putStaffBindPhysical(t).pipe(Object(h["a"])((function(t){e.msg.success({content:"绑定实体卡成功"})})))}}]),t}();v=Object(l["b"])([Object(u["b"])(),Object(l["d"])("design:paramtypes",["function"===typeof(s="undefined"!==typeof m["g"]&&m["g"])?s:Object,"function"===typeof(r="undefined"!==typeof p["a"]&&p["a"])?r:Object])],v);var b=function(t){t.pattern;return{card_number:{rules:[{required:!0,message:"请输入实体卡号"}]},physical_number:[{rules:[{required:!0,message:"请输入物理ID"}]}]}};function _(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,s)}return a}function y(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?_(Object(a),!0).forEach((function(e){Object(o["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):_(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var g={name:"BindCard",serviceInject:function(){return{bindCardService:v}},data:function(){var t=this.$stForm.create(),e=t.decorators(b);return{show:!1,form:t,decorators:e}},props:{staff:{type:Object,default:function(){}}},components:{StaffInfo:c["a"]},methods:{save:function(t){var e=this;t.preventDefault(),this.form.validate().then((function(t){var a=y({id:e.staff.id},t);e.bindCardService.putStaffBindPhysical(a).subscribe((function(){e.show=!1,e.$router.reload()}))}))}}},S=g,w=a("2877"),O=Object(w["a"])(S,i,n,!1,null,null,null);e["a"]=O.exports},"241b":function(t,e,a){"use strict";a.r(e),a.d(e,"EditService",(function(){return y}));var s,r,i,n,o,c,d=a("d225"),f=a("b0b4"),l=a("9ab4"),u=a("0cd5"),p=a("df29"),m=a("54da"),h=a("c4cc"),v=a("3bc6"),b=a("cc76"),_=a("dcb5"),y=function(){function t(e,a,s){Object(d["a"])(this,t),this.shopStaffApi=e,this.staffApi=a,this.roleApi=s,this.staffInfo$=new p["d"]({}),this.department$=new p["d"]([]),this.staffSpecialty$=new p["d"]({}),this.codeList$=new p["d"]([]),this.roleList$=new p["d"]([]),this.loading$=new p["d"]({})}return Object(f["a"])(t,[{key:"getCountryCodes",value:function(){var t=this;return this.staffApi.getCountryCodes().pipe(Object(h["a"])((function(e){t.codeList$.commit((function(){var t=e.code_list;return t.length||t.push({phone_code:e.default_code,code_id:e.default_code_id}),t}))})))}},{key:"getStaffDepartment",value:function(){var t=this;return this.shopStaffApi.getStaffDepartmentList().pipe(Object(h["a"])((function(e){t.department$.commit((function(){return e.department}))})))}},{key:"getNormalList",value:function(){var t=this;return this.roleApi.getNormalList().pipe(Object(h["a"])((function(e){t.roleList$.commit((function(){return e.roles}))})))}},{key:"getStaffSpecialty",value:function(){var t=this;return this.shopStaffApi.getStaffSpecialty().pipe(Object(h["a"])((function(e){t.staffSpecialty$.commit((function(){return e}))})))}},{key:"getStaffInfo",value:function(t){var e=this;return this.shopStaffApi.editStaffInfo(t).pipe(Object(h["a"])((function(t){e.staffInfo$.commit((function(){return t.staff_info}))})))}},{key:"init",value:function(t){return Object(m["a"])(this.getStaffSpecialty(),this.getStaffDepartment(),this.getNormalList(),this.getCountryCodes(),this.getStaffInfo(t))}},{key:"updateBasicInfo",value:function(t,e){return this.shopStaffApi.updateStaffBasicInfo(t,e)}},{key:"updateDetailedInfo",value:function(t,e){return this.shopStaffApi.updateStaffDetailedInfo(t,e)}},{key:"updateCoachInfo",value:function(t,e){return this.shopStaffApi.updateCoachInfo(t,e)}},{key:"beforeRouteEnter",value:function(t,e){var a=t.query.id;return this.init(a)}}]),t}();Object(l["b"])([Object(p["c"])(),Object(l["d"])("design:type",Function),Object(l["d"])("design:paramtypes",[]),Object(l["d"])("design:returntype",void 0)],y.prototype,"getCountryCodes",null),Object(l["b"])([Object(p["c"])(),Object(l["d"])("design:type",Function),Object(l["d"])("design:paramtypes",[String,"function"===typeof(s="undefined"!==typeof _["EditStaffBasicInfoQuery"]&&_["EditStaffBasicInfoQuery"])?s:Object]),Object(l["d"])("design:returntype",void 0)],y.prototype,"updateBasicInfo",null),Object(l["b"])([Object(p["c"])(),Object(l["d"])("design:type",Function),Object(l["d"])("design:paramtypes",[String,"function"===typeof(r="undefined"!==typeof _["EditStaffDetailInfoQuery"]&&_["EditStaffDetailInfoQuery"])?r:Object]),Object(l["d"])("design:returntype",void 0)],y.prototype,"updateDetailedInfo",null),Object(l["b"])([Object(p["c"])(),Object(l["d"])("design:type",Function),Object(l["d"])("design:paramtypes",[String,"function"===typeof(i="undefined"!==typeof _["EditStaffCoachInfoQuery"]&&_["EditStaffCoachInfoQuery"])?i:Object]),Object(l["d"])("design:returntype",void 0)],y.prototype,"updateCoachInfo",null),y=Object(l["b"])([Object(u["b"])(),Object(l["d"])("design:paramtypes",["function"===typeof(n="undefined"!==typeof b["g"]&&b["g"])?n:Object,"function"===typeof(o="undefined"!==typeof _["k"]&&_["k"])?o:Object,"function"===typeof(c="undefined"!==typeof v["b"]&&v["b"])?c:Object])],y)},"2efa":function(t,e,a){"use strict";a.d(e,"a",(function(){return s}));var s=function(t){var e=t.pattern;return{name:{rules:[{required:!0,message:"请输入姓名"},{pattern:e.CN_EN_NUM("0-15"),message:"请输入15个字符以内"}]},account:{rules:[{required:!0,message:"请输入登录账户"},{pattern:e.CN_EN_NUM("6-15"),message:"请输入6~15个字符"}]},password:{rules:[{required:!0,message:"请输入登录密码"},{pattern:e.CN_EN_NUM("6-15"),message:"请输入6~15个字符"}]},repeat_password:{rules:[{validator:function(t,e,a){return e?e.length<6||e.length>15?"请输入正确格式登录密码":e!==a.password?"两次密码输入不一致":void 0:"请输入登录密码"}}]},staff_name:{rules:[{required:!0,message:"请输入用户名"},{pattern:e.CN_EN_NUM("1-15"),message:"请输入1-15个字符"}]},nickname:{rules:[{required:!0,message:"请填写昵称"},{pattern:e.CN_EN_NUM("1-10"),message:"请输入1-10个字，中英文及数字"}]},country_code_id:{initialValue:37},mobile:{rules:[{required:!0,message:"手机号格式错误",pattern:e.MOBILE}]},mail:{rules:[{message:"请填写正确格式邮箱号",pattern:e.EMAIL}]},sex:{rules:[{required:!0,message:"请选择你的性别"}]},id_type:{initialValue:1},id_number:{rules:[{validator:function(a,s,r){return 1===t.id_type&&s&&!e.ID.test(s)?"请填写正确的身份证号":2===t.id_type&&s&&!e.PASSPORT.test(s)?"请填写正确的护照号码":void 0}}]},coach_levelRule:{},image_avatar:{},image_face:{},identity:{rules:[{required:!0,message:"请选择职能"}]},department_id:{rules:[{required:!0,message:"请选择部门"}]},staff_num:{rules:[{pattern:e.CN_EN_NUM("1-20"),message:"请输入1-20个字，中英文及数字"}]},nature_work:{},entry_date:{},shop_id:{rules:[{required:!0,message:"请选择门店"}]},role_id:{rules:[{required:!0,message:"请选择系统角色"}]},album_id:{},is_permission:{initialValue:0},coach_level_id:{rules:[{required:!0,message:"请选择".concat(t.$c("coach"),"等级")}]},graduated_school:{rules:[{pattern:e.CN_EN_NUM("1-100"),message:"请输入1-100个字，中英文及数字"}]},education:{},birthday:{},native_place:{},children_status:{},marry_status:{},graduation_time:{},profession:{rules:[{pattern:e.CN_EN_NUM("1-50"),message:"请输入1-50个字，中英文及数字"}]},address:{rules:[{pattern:e.CN_EN_NUM("0-100"),message:"请输入0-100个字，中英文及数字"}]},description:{},employment_time:{},introduction:{},specialty_id:{},certification_name:{rules:[{pattern:e.CN_EN_NUM("1-100"),message:"请输入1-100个字，中英文及数字"}]},is_show:{}}}},"3b8f":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("st-panel",{attrs:{app:""}},[a("a-row",{staticClass:"mg-b48 mg-t48",class:t.bstep(),attrs:{gutter:8}},[a("a-col",{attrs:{offset:"1",span:t.stepsSpan}},[a("a-steps",{attrs:{current:t.currentIndex}},t._l(t.stepArr,(function(t){return a("a-step",{key:t.key,staticClass:"cursor-pointer",attrs:{title:t.title}})})),1)],1)],1),0==t.currentIndex?a("staff-detail-basics",{attrs:{codeList:t.codeList,roleList:t.roleList},on:{addStep:t.addCoachInfo,deletStep:t.deletStep}}):t._e()],1)},r=[],i=(a("20d6"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("st-form",{class:t.addBasicsInfo(),attrs:{form:t.form}},[a("a-row",{attrs:{gutter:8}},[a("a-col",{attrs:{lg:10,xs:22,offset:1}},[a("st-form-item",{staticClass:"upload-staff-image",attrs:{label:"员工头像"}},[a("st-image-upload",{attrs:{width:"164px",height:"164px",list:t.fileList,sizeLimit:2,placeholder:"上传头像"},on:{change:t.onChangeGetAvatar}}),a("div",{staticClass:"page-course-photo-des mg-l16"},[a("div",{staticClass:"page-course-item"},[a("div",{staticClass:"page-course-item-tip"},[t._v("1.")]),a("div",{staticClass:"page-course-item-cont"},[t._v("\n              图片格式必须为：png,bmp,\n              jpeg,jpg,gif,建议使用png格式图片，以保存最佳效果\n            ")])]),a("div",{staticClass:"page-course-item"},[a("div",{staticClass:"page-course-item-tip"},[t._v("2.")]),a("div",{staticClass:"page-course-item-cont"},[t._v("\n              建议尺寸为200px * 200px， 不大于200KB\n            ")])])])],1),a("st-form-item",{attrs:{label:"姓名",required:""}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.staff_name,expression:"decorators.staff_name"}],attrs:{placeholder:"支持中英文、数字、不超过15个字",max:"15"}})],1),a("st-form-item",{attrs:{label:"手机号",required:""}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.mobile,expression:"decorators.mobile"}],attrs:{placeholder:"请输入手机号"}},[a("a-select",{staticStyle:{width:"100px"},attrs:{slot:"addonBefore"},slot:"addonBefore",model:{value:t.country_code_id,callback:function(e){t.country_code_id=e},expression:"country_code_id"}},t._l(t.codeList,(function(e){return a("a-select-option",{key:e.code_id,attrs:{value:e.code_id}},[t._v("\n              +"+t._s(e.phone_code)+"\n            ")])})),1)],1)],1),a("st-form-item",{attrs:{label:"性别",required:""}},[a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.sex,expression:"decorators.sex"}],attrs:{name:"radioGroup"}},[a("a-radio",{attrs:{value:t.SEX.MALE}},[t._v("\n            男\n            "),a("st-icon",{staticClass:"sex__male",staticStyle:{color:"#636aec"},attrs:{type:"male"}})],1),a("a-radio",{attrs:{value:t.SEX.FEMALE}},[t._v("\n            女\n            "),a("st-icon",{staticStyle:{color:"#fa756c"},attrs:{calss:"sex__female",type:"female"}})],1)],1)],1)],1),a("a-col",{attrs:{lg:10,xs:22,offset:1}},[a("st-form-item",{attrs:{label:"员工人脸"}},[a("face-upload",{attrs:{width:"164px",height:"164px",list:t.faceList,placeholder:"上传头像"},on:{change:t.onChangeGetFace}})],1),a("st-form-item",{attrs:{required:""}},[a("template",{slot:"label"},[t._v("\n          昵称\n          "),a("st-help-tooltip",{attrs:{id:"TSCE001"}})],1),a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.nickname,expression:"decorators.nickname"}],attrs:{placeholder:"支持中英文、数字,不超过10个字"}})],2),a("st-form-item",{attrs:{label:"邮箱"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.mail,expression:"decorators.mail"}],attrs:{placeholder:"请输入邮箱"}})],1),a("st-form-item",{attrs:{label:"证件"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.id_number,expression:"decorators.id_number"}],attrs:{placeholder:"请输入"}},[a("a-select",{staticStyle:{width:"100px"},attrs:{slot:"addonBefore"},on:{change:t.resetID},slot:"addonBefore",model:{value:t.id_type,callback:function(e){t.id_type=e},expression:"id_type"}},t._l(t.id_types,(function(e,s){return a("a-select-option",{key:s,attrs:{value:+e.value}},[t._v("\n              "+t._s(e.label)+"\n            ")])})),1)],1)],1)],1)],1),a("a-row",{attrs:{gutter:8}},[a("a-col",{attrs:{offset:1,lg:22}},[a("st-hr")],1)],1),a("a-row",{attrs:{gutter:8}},[a("a-col",{attrs:{offset:1,lg:23}},[a("st-form-item",{attrs:{required:""}},[a("template",{slot:"label"},[t._v("\n          员工职能\n          "),a("st-help-tooltip",{attrs:{id:"TSCE002"}})],1),a("a-checkbox-group",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.identity,expression:"decorators.identity"}],on:{change:t.getIsCoach}},t._l(t.identitys,(function(e,s){return a("a-checkbox",{key:s,attrs:{value:+e.value}},[t._v("\n            "+t._s(e.label)+"\n          ")])})),1)],2)],1),a("a-col",{attrs:{offset:1,lg:10,xs:22}},[a("st-form-item",{attrs:{label:"部门",required:""}},[a("department-select",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.department_id,expression:"decorators.department_id"}],staticStyle:{width:"100%"},attrs:{placeholder:"请选择部门",useType:"form"}})],1),a("st-form-item",{attrs:{label:"工作性质"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.nature_work,expression:"decorators.nature_work"}],attrs:{placeholder:"请选择",options:t.nature_works}})],1),a("st-form-item",{attrs:{label:"系统角色",required:""}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.role_id,expression:"decorators.role_id"}],attrs:{mode:"multiple",placeholder:"请选择"}},[t._l(t.roleList,(function(e){return[a("a-select-option",{key:e.id,attrs:{value:e.id}},[t._v("\n              "+t._s(e.name)+"\n            ")])]}))],2)],1),t.isShowLevel?a("st-form-item",{attrs:{required:""}},[a("template",{slot:"label"},[t._v("\n          "+t._s(t.$c("coach"))+"等级\n          "),a("st-help-tooltip",{attrs:{id:"TSCE003"}})],1),a("coach-level-select",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.coach_level_id,expression:"decorators.coach_level_id"}],staticStyle:{width:"100%"},attrs:{placeholder:"请选择"+t.$c("coach")+"等级",useType:"form"},on:{change:t.onChange}})],2):t._e()],1),a("a-col",{attrs:{offset:1,lg:10,xs:22}},[a("st-form-item",{attrs:{label:"工号"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.staff_num,expression:"decorators.staff_num"}],attrs:{placeholder:"请输入员工工号"}})],1),a("st-form-item",{attrs:{label:"入职时间"}},[a("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.entry_date,expression:"decorators.entry_date"}],staticStyle:{width:"100%"}})],1),a("st-form-item",{attrs:{label:"所属门店"}},[a("shop-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["shop_id"],expression:"['shop_id']"}],attrs:{mode:"multiple",useType:"form",placeholder:"所属门店",disabled:!0}})],1)],1)],1),a("a-row",{attrs:{gutter:8}},[a("a-col",{attrs:{offset:1,lg:22}},[a("st-hr")],1)],1),a("a-row",{attrs:{gutter:8}},[a("a-col",{attrs:{offset:1,lg:10}},[a("st-form-item",{attrs:{label:"系统权限"}},[a("a-checkbox",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.is_permission,expression:"decorators.is_permission"}],on:{change:t.permissionChange}},[t._v("\n          开通系统使用权限\n        ")])],1),t.isChoosePermission?a("st-form-item",{attrs:{label:"登录账号"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.account,expression:"decorators.account"}],attrs:{placeholder:"6-18个字符，可使用字母、数字、下划线"}})],1):t._e(),t.isChoosePermission?a("st-form-item",{attrs:{required:"",label:"登录密码"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.password,expression:"decorators.password"}],attrs:{placeholder:"6-15个字符，区分大小写",type:"password"}})],1):t._e(),t.isChoosePermission?a("st-form-item",{attrs:{required:"",label:"确认密码"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.repeat_password,expression:"decorators.repeat_password"}],attrs:{placeholder:"请再次填写密码",type:"password"}})],1):t._e()],1)],1),a("a-row",{attrs:{gutter:8}},[a("a-col",{attrs:{offset:1}},[a("st-form-item",{attrs:{labelFix:""}},[a("st-button",{attrs:{loaidng:t.loading.addStaff,type:"primary"},on:{click:t.goNext}},[t._v("\n          保存，继续填写细信息\n        ")])],1)],1)],1)],1)}),n=[],o=(a("6762"),a("2fdb"),a("2138")),c=a("e69b"),d=a("bf2e"),f=a("462b"),l=a("b346"),u=a("3949"),p=a("2527"),m=a("2efa"),h=a("9e5b"),v=a("188d"),b=a("7ce1"),_=a("5c8a"),y={name:"StaffDetailBasics",bem:{addBasicsInfo:"page-shop-staff-add-detail"},serviceInject:function(){return{pattern:p["a"],userService:o["a"],message:c["a"],addService:d["AddService"]}},rxState:function(){return{loading:this.addService.loading$,shop:this.userService.shop$,id_types:this.userService.getOptions$("staff.id_type"),nature_works:this.userService.getOptions$("staff.nature_work"),identitys:this.userService.getOptions$("staff.identity")}},components:{ShopSelect:l["a"],CoachLevelSelect:f["a"],DepartmentSelect:h["a"],FaceUpload:v["a"],StImageUpload:b["a"]},props:{roleList:{type:Array},codeList:{type:Array},department:{type:Array}},data:function(){var t=this.$stForm.create(),e=t.decorators(m["a"]);return{form:t,decorators:e,SEX:u["a"],fileList:[],faceList:[],isChoosePermission:!1,isAdd:[],addflag:!0,isShowLevel:!1,treeExpandedKeys:[],value:void 0,id_type:1,country_code_id:37}},mounted:function(){this.form.setFieldsValue({shop_id:this.shop.id})},methods:{resetID:function(){this.form.setFieldsValue({id_number:void 0})},onChangeGetAvatar:function(t){this.fileList=Object(_["a"])(t)},onChangeGetFace:function(t){this.faceList=Object(_["a"])(t)},getIsCoach:function(t){if(this.isShowLevel=t.includes(4),this.isShowLevel){if(this.addflag)return;this.$emit("addStep"),this.addflag=!0}else this.$emit("deletStep"),this.addflag=!1},permissionChange:function(t){this.isChoosePermission=t.target.checked},onChange:function(t){this.value=t},onSelectIdtype:function(t){},goNext:function(t){var e=this;t.preventDefault(),this.form.validate().then((function(t){e.submit(t,1)}))},submit:function(t){var e=this;t.is_permission=+this.isChoosePermission,t.entry_date=moment(t.entry_date).format("YYYY-MM-DD"),t.image_avatar=this.fileList[0]||{},t.image_face=this.faceList[0]||{},t.country_code_id=this.country_code_id,t.id_type=this.id_type,this.addService.addStaff(t).subscribe((function(a){e.$router.push({name:"shop-staff-edit",query:{id:a.staff_id,currentIndex:1,isShowCoach:t.identity.includes(3)||t.identity.includes(4)?1:0}})}))}}},g=y,S=a("2877"),w=Object(S["a"])(g,i,n,!1,null,null,null),O=w.exports,j={serviceInject:function(){return{messageService:c["a"],addService:d["AddService"]}},rxState:function(){return{codeList:this.addService.codeList$,roleList:this.addService.roleList$}},name:"addDetail",components:{StaffDetailBasics:O},bem:{b:"page-add-staff",bstep:"page-add-staff-steps",bHeader:"default-brand-header"},data:function(){return{stepsSpan:12,currentIndex:0,stepArr:[{title:"基础信息",key:1},{title:"详细信息",key:2}]}},methods:{deletStep:function(t){var e=this;this.stepsSpan=12;var a=this.stepArr.findIndex((function(t,a,s){return t.title==="".concat(e.$c("coach"),"信息")}));-1!==a&&this.stepArr.pop()},addCoachInfo:function(t){this.stepsSpan=18,this.stepArr.push({title:"".concat(this.$c("coach"),"信息"),key:3})},goNext:function(t){var e=this.currentIndex;this.currentIndex=e+1,3===this.currentIndex&&(this.currentIndex=0)}}},k=j,x=Object(S["a"])(k,s,r,!1,null,null,null);e["default"]=x.exports},"52a0":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("st-panel",{attrs:{app:""}},[a("a-row",{staticClass:"mg-b48 mg-t48",class:t.bstep(),attrs:{gutter:8}},[a("a-col",{attrs:{offset:"1",span:t.stepsSpan}},[a("a-steps",{attrs:{current:t.currentIndex}},t._l(t.stepArr,(function(e){return a("a-step",{key:e.key,staticClass:"cursor-pointer",attrs:{title:e.title},on:{click:function(a){return t.changeStep(e.key)}}})})),1)],1)],1),0==t.currentIndex?a("edit-basic-info",{attrs:{data:t.staffInfo},on:{updateStaffInfo:t.updateStaffInfo,gonext:t.gonext}}):1==t.currentIndex?a("edit-detailed-info",{attrs:{isPrivateCoach:t.isPrivateCoach,isShowCoach:t.isShowCoach,data:t.staffInfo},on:{updateStaffInfo:t.updateStaffInfo,back:t.onBack,gonext:t.gonext}}):2==t.currentIndex&&t.isPrivateCoach?a("edit-coach-info",{attrs:{data:t.staffInfo,staffSpecialty:t.staffSpecialty},on:{back:t.onBack,gonext:t.gonext}}):t._e()],1)},r=[],i=(a("c5f6"),a("6762"),a("2fdb"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("st-form",{staticClass:"page-edit-coachInfo",attrs:{form:t.form}},[a("a-row",{attrs:{gutter:8}},[a("a-col",{attrs:{lg:10,xs:22,offset:1}},[a("st-form-item",{attrs:{label:"从业时间"}},[a("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.employment_time,expression:"decorators.employment_time"}],staticStyle:{width:"100%"}})],1),a("st-form-item",{attrs:{label:"擅长的项目"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.specialty_id,expression:"decorators.specialty_id"}],attrs:{mode:"multiple",placeholder:"请选择擅长的项目"}},t._l(t.staffSpecialty,(function(e){return a("a-select-option",{key:e.id,attrs:{value:e.id}},[t._v("\n            "+t._s(e.specialty_name)+"\n          ")])})),1)],1),a("st-form-item",{attrs:{label:"专业认证"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.certification_name,expression:"decorators.certification_name"}],staticStyle:{top:"0"},attrs:{placeholder:"请输入专业证书名称"},on:{pressEnter:t.onAddProfess}},[t.coachInfoData.certification_name.length<10?a("div",{staticClass:"add-profess-button cursor-pointer",attrs:{slot:"addonAfter"},on:{click:t.onAddProfess},slot:"addonAfter"},[t._v("\n            新增\n          ")]):t._e()]),a("div",{staticClass:"add-profess-card"},t._l(t.coachInfoData.certification_name,(function(e,s){return a("div",{key:s},[a("span",[t._v(t._s(e))]),a("st-icon",{staticStyle:{cursor:"pointer"},attrs:{type:"anticon:close"},on:{click:function(e){return t.onProfessRule(s)}}})],1)})),0)],1),a("st-form-item",{attrs:{label:"个人经历"}},[a("st-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.introduction,expression:"decorators.introduction"}],attrs:{maxlength:500,rows:10,placeholder:"填写点什么吧"}})],1)],1)],1),a("a-row",{attrs:{gutter:8}},[a("a-col",{attrs:{lg:24,xs:22,offset:1}},[a("st-form-item",{staticClass:"page-image-personal",attrs:{label:"员工风采"}},[a("st-image-upload",{attrs:{width:"100px",height:"100px",list:t.fileList,sizeLimit:2,placeholder:"上传头像",numLimit:10},on:{change:t.onChangeGetShowImage}})],1)],1)],1),a("a-row",{attrs:{gutter:8}},[a("a-col",{attrs:{offset:1}},[a("st-form-item",{attrs:{labelFix:""}},[a("st-button",{attrs:{type:"primary",loading:t.loading.updateCoachInfo,ghost:""},on:{click:t.onClickBack}},[t._v("\n          上一步\n        ")]),a("st-button",{staticClass:"mg-l16",attrs:{loading:t.loading.updateCoachInfo,type:"primary"},on:{click:t.goNext}},[t._v("\n          保存\n        ")])],1)],1)],1)],1)}),n=[],o=(a("ac6a"),a("5df3"),a("4f7f"),a("75fc")),c=a("241b"),d=a("e69b"),f=a("2527"),l=a("2efa"),u=a("7ce1"),p={name:"EditCoachInfo",serviceInject:function(){return{pattern:f["a"],service:c["EditService"],message:d["a"]}},components:{StImageUpload:u["a"]},rxState:function(){return{loading:this.service.loading$}},props:{data:{type:Object},staffSpecialty:{type:Array,default:function(){return[]}}},data:function(){var t=this.$stForm.create(),e=t.decorators(l["a"]);return{form:t,decorators:e,coachInfoData:{certification_name:[]},fileList:[],checked:!1}},mounted:function(){this.setData(this.data)},methods:{onChangeGetShowImage:function(t){this.image_personal=cloneDeep(t)},onChangeSpecialtyId:function(t){t.length>10&&t.pop()},onClickBack:function(){this.$emit("back",1)},imageUploadChange:function(t){this.image_personal=t},onChooseSpecialty:function(t){},setData:function(t){this.form.setFieldsValue({employment_time:t.employment_time?moment(t.employment_time):void 0,introduction:t.introduction,specialty_id:t.specialty_id}),this.fileList=t.image_personal,this.coachInfoData.certification_name=t.certification_name?t.certification_name:[]},goNext:function(t){var e=this;this.form.validate().then((function(t){e.submit(e.form.getFieldsValue(),1)}))},submit:function(t,e){var a=this;t.employment_time?t.employment_time=t.employment_time.format("YYYY-MM-DD"):t.employment_time=void 0,t.certification_name=this.coachInfoData.certification_name,t.image_personal=this.fileList,t.album_id=this.data.album_id,this.service.updateCoachInfo(this.data.staff_id,t).subscribe((function(t){a.$router.push({name:"shop-staff-list"})}))},onAddProfess:function(){var t=this;this.form.validate(["certification_name"]).then((function(e){var a=Object(o["a"])(t.coachInfoData.certification_name);e.certification_name&&(a.push(e.certification_name),t.coachInfoData.certification_name=Object(o["a"])(new Set(a)),t.form.setFieldsValue({certification_name:""}))}))},onProfessRule:function(t){this.coachInfoData.certification_name.splice(t,1)}}},m=p,h=a("2877"),v=Object(h["a"])(m,i,n,!1,null,null,null),b=v.exports,_=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("st-form",{staticClass:"page-edit-container",attrs:{form:t.form}},[a("a-row",{attrs:{gutter:8}},[a("a-col",{attrs:{lg:10,xs:22,offset:1}},[a("st-form-item",{attrs:{label:"毕业院校"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.graduated_school,expression:"decorators.graduated_school"}],attrs:{placeholder:"支持中英文、数字,不超过100个字"}})],1),a("st-form-item",{attrs:{label:"学历"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.education,expression:"decorators.education"}],attrs:{placeholder:"请选择"}},t._l(t.educations,(function(e,s){return a("a-select-option",{key:s,attrs:{value:+e.value}},[t._v("\n            "+t._s(e.label)+"\n          ")])})),1)],1),a("st-form-item",{attrs:{label:"生日"}},[a("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.birthday,expression:"decorators.birthday"}],staticStyle:{width:"100%"}})],1),a("st-form-item",{attrs:{label:"婚姻状况"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.marry_status,expression:"decorators.marry_status"}],attrs:{placeholder:"请选择"}},t._l(t.marry_status,(function(e,s){return a("a-select-option",{key:s,attrs:{value:+e.value}},[t._v("\n            "+t._s(e.label)+"\n          ")])})),1)],1)],1),a("a-col",{attrs:{lg:10,xs:22,offset:1}},[a("st-form-item",{attrs:{label:"毕业时间"}},[a("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.graduation_time,expression:"decorators.graduation_time"}],staticStyle:{width:"100%"}})],1),a("st-form-item",{attrs:{label:"专业"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.profession,expression:"decorators.profession"}],attrs:{placeholder:"请输入专业名称"}})],1),a("st-form-item",{attrs:{label:"籍贯"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.native_place,expression:"decorators.native_place"}],attrs:{placeholder:"请输入籍贯"}})],1),a("st-form-item",{attrs:{label:"子女状态"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.children_status,expression:"decorators.children_status"}],attrs:{placeholder:"请选择"}},t._l(t.children_status,(function(e,s){return a("a-select-option",{key:s,attrs:{value:+e.value}},[t._v("\n            "+t._s(e.label)+"\n          ")])})),1)],1)],1)],1),a("a-row",{staticClass:"mg-t48",attrs:{gutter:8}},[a("a-col",{attrs:{lg:10,xs:22,offset:1}},[a("st-form-item",{attrs:{label:"家庭住址"}},[a("a-cascader",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.provinces,expression:"decorators.provinces"}],attrs:{options:t.regions,fieldNames:t.fieldNames,changeOnSelect:"",placeholder:"请选择"}})],1),a("st-form-item",{attrs:{label:"详细住址"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.address,expression:"decorators.address"}],attrs:{placeholder:"填写点什么吧"}})],1),a("st-form-item",{attrs:{label:"备注"}},[a("st-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.description,expression:"decorators.description"}],attrs:{maxlength:500,rows:10,placeholder:"填写点什么吧"}})],1),t.isShowCoach?a("st-form-item",{attrs:{label:"对外展示"}},[a("st-checkbox",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.is_show,expression:"decorators.is_show"}]},[t._v("\n          展示在小程序\n        ")])],1):t._e()],1),a("a-col",{attrs:{lg:10,xs:22,offset:2}})],1),a("a-row",{attrs:{gutter:8}},[a("a-col",{attrs:{offset:1}},[a("st-form-item",{attrs:{labelFix:""}},[a("st-button",{staticClass:"mg-r16",attrs:{type:"primary",ghost:"",loading:t.loading.updateDetailedInfo},on:{click:t.onClickBack}},[t._v("\n          上一步\n        ")]),a("st-button",{staticClass:"mg-l16",attrs:{loading:t.loading.updateDetailedInfo,type:"primary"},on:{click:t.goNext}},[t._v("\n          "+t._s(t.isPrivateCoach?"保存，继续填写":"保存")+"\n        ")])],1)],1)],1)],1)},y=[],g=a("62eb"),S=a("ec41"),w=a("2138"),O={name:"EditDetailedInfo",serviceInject:function(){return{pattern:f["a"],region:g["a"],service:c["EditService"],message:d["a"],userService:w["a"]}},rxState:function(){return{children_status:this.userService.getOptions$("staff.children_status"),marry_status:this.userService.getOptions$("staff.marry_status"),educations:this.userService.getOptions$("staff.education"),loading:this.service.loading$}},props:{isPrivateCoach:{type:Boolean,default:!1},data:{type:Object},isShowCoach:{type:Boolean,default:!1}},data:function(){var t=this.$stForm.create(),e=t.decorators(l["a"]);return{form:t,decorators:e,regions:[],fieldNames:{label:"name",value:"id",children:"children"}}},mounted:function(){var t=this;this.setData(this.data),this.region.regionApi.getRegions().subscribe((function(e){t.regions=e}))},methods:{onClickBack:function(){this.$emit("back",1)},setData:function(t){this.form.setFieldsValue({graduated_school:t.graduated_school,graduation_time:t.graduation_time?moment(t.graduation_time):void 0,education:t.education||void 0,profession:t.profession,birthday:t.birthday?moment(t.birthday):void 0,native_place:t.native_place,marry_status:t.marry_status||void 0,children_status:t.children_status||void 0,address:t.address,description:t.description,provinces:[t.province_id,t.city_id,t.district_id],is_show:t.is_show})},goNext:function(t){var e=this;t.preventDefault(),this.form.validate().then((function(t){e.submit(t,1)}))},submit:function(t,e){var a=this;t.province_id=Object(S["a"])(t,"provinces.0"),t.city_id=Object(S["a"])(t,"provinces.1"),t.district_id=Object(S["a"])(t,"provinces.2"),t.birthday&&(t.birthday=t.birthday.format("YYYY-MM-DD")),t.birthday&&(t.graduation_time=t.graduation_time.format("YYYY-MM-DD")),this.isShowCoach||delete t.is_show,this.service.updateDetailedInfo(this.data.staff_id,t).subscribe((function(){a.isPrivateCoach?(a.$emit("gonext"),a.$emit("updateStaffInfo")):a.$router.push({name:"shop-staff-list"})}))}}},j=O,k=Object(h["a"])(j,_,y,!1,null,null,null),x=k.exports,C=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("st-form",{class:t.editBasicInfo(),attrs:{form:t.form}},[a("a-row",{attrs:{gutter:8}},[a("a-col",{attrs:{lg:10,xs:22,offset:1}},[a("st-form-item",{staticClass:"upload-staff-image",attrs:{label:"员工头像"}},[a("st-image-upload",{attrs:{width:"164px",height:"164px",list:t.fileList,sizeLimit:2,placeholder:"上传头像"},on:{change:t.onChangeGetAvatar}}),a("div",{staticClass:"page-course-photo-des mg-l16"},[a("div",{staticClass:"page-course-item"},[a("div",{staticClass:"page-course-item-tip"},[t._v("1.")]),a("div",{staticClass:"page-course-item-cont"},[t._v("\n              图片格式必须为：png,bmp,\n              jpeg,jpg,gif,建议使用png格式图片，以保存最佳效果\n            ")])]),a("div",{staticClass:"page-course-item"},[a("div",{staticClass:"page-course-item-tip"},[t._v("2.")]),a("div",{staticClass:"page-course-item-cont"},[t._v("\n              建议尺寸为200px * 200px， 不大于200KB\n            ")])])])],1),a("st-form-item",{attrs:{label:"姓名",required:""}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.staff_name,expression:"decorators.staff_name"}],attrs:{placeholder:"支持中英文、数字、不超过15个字",max:"15"}})],1),a("st-form-item",{attrs:{label:"手机号",required:""}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.mobile,expression:"decorators.mobile"}],attrs:{placeholder:"请输入手机号"}},[a("a-select",{staticStyle:{width:"100px"},attrs:{slot:"addonBefore"},slot:"addonBefore",model:{value:t.country_code_id,callback:function(e){t.country_code_id=e},expression:"country_code_id"}},t._l(t.codeList,(function(e){return a("a-select-option",{key:e.code_id,attrs:{value:e.code_id}},[t._v("\n              +"+t._s(e.phone_code)+"\n            ")])})),1)],1)],1),a("st-form-item",{attrs:{label:"性别",required:""}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.sex,expression:"decorators.sex"}],attrs:{placeholder:"请选择"}},[t._l(t.sexs,(function(e,s){return[a("a-select-option",{key:s,attrs:{value:+e.value}},[t._v("\n              "+t._s(e.label)+"\n            ")])]}))],2)],1)],1),a("a-col",{attrs:{lg:10,xs:22,offset:1}},[a("st-form-item",{attrs:{label:"员工人脸"}},[a("face-upload",{attrs:{width:"164px",height:"164px",list:t.faceList,placeholder:"上传头像"}})],1),a("st-form-item",{attrs:{required:""}},[a("template",{slot:"label"},[t._v("\n          昵称\n          "),a("st-help-tooltip",{attrs:{id:"TSCE001"}})],1),a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.nickname,expression:"decorators.nickname"}],attrs:{placeholder:"支持中英文、数字,不超过10个字"}})],2),a("st-form-item",{attrs:{label:"邮箱"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.mail,expression:"decorators.mail"}],attrs:{placeholder:"请输入邮箱"}})],1),a("st-form-item",{attrs:{label:"证件"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.id_number,expression:"decorators.id_number"}],attrs:{placeholder:"请输入"}},[a("a-select",{staticStyle:{width:"100px"},attrs:{slot:"addonBefore"},on:{change:t.resetID},slot:"addonBefore",model:{value:t.id_type,callback:function(e){t.id_type=e},expression:"id_type"}},t._l(t.id_types,(function(e,s){return a("a-select-option",{key:s,attrs:{value:+e.value}},[t._v("\n              "+t._s(e.label)+"\n            ")])})),1)],1)],1)],1)],1),a("a-row",{attrs:{gutter:8}},[a("a-col",{attrs:{offset:1,lg:22}},[a("st-hr")],1)],1),a("a-row",{attrs:{gutter:8}},[a("a-col",{attrs:{offset:1,lg:10,xs:22}},[a("st-form-item",{attrs:{label:"部门"}},[a("department-select",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.department_id,expression:"decorators.department_id"}],attrs:{placeholder:"请选择部门",useType:"form"}})],1),a("st-form-item",{attrs:{label:"工作性质"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.nature_work,expression:"decorators.nature_work"}],attrs:{placeholder:"请选择"}},[t._l(t.nature_works,(function(e,s){return[a("a-select-option",{key:s,attrs:{value:+e.value}},[t._v("\n              "+t._s(e.label)+"\n            ")])]}))],2)],1),a("st-form-item",{attrs:{label:"系统角色",required:""}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.role_id,expression:"decorators.role_id"}],attrs:{mode:"multiple",placeholder:"请选择",disabled:t.isSuperAdmin},on:{change:t.roleChange}},[t._l(t.roleList,(function(e){return[a("a-select-option",{key:e.id,attrs:{value:e.id}},[t._v("\n              "+t._s(e.name)+"\n            ")])]}))],2)],1)],1),a("a-col",{attrs:{offset:1,lg:10,xs:22}},[a("st-form-item",{attrs:{label:"工号"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.staff_num,expression:"decorators.staff_num"}],attrs:{placeholder:"请输入员工工号"}})],1),a("st-form-item",{attrs:{label:"入职时间"}},[a("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.entry_date,expression:"decorators.entry_date"}],staticStyle:{width:"100%"}})],1),a("st-form-item",{attrs:{label:"所属门店"}},[a("shop-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["shop_id"],expression:"['shop_id']"}],attrs:{mode:"multiple",useType:"form",placeholder:"所属门店",disabled:!0}})],1)],1)],1),a("a-row",{attrs:{gutter:8}},[a("a-col",{attrs:{offset:1,lg:22}},[a("st-hr")],1)],1),a("a-row",{attrs:{gutter:8}},[a("a-col",{attrs:{offset:1}},[a("st-form-item",{attrs:{labelFix:""}},[a("st-button",{attrs:{type:"primary",loading:t.loading.updateBasicInfo,ghost:""},on:{click:t.save}},[t._v("\n          提交\n        ")]),a("st-button",{staticClass:"mg-l16",attrs:{loading:t.loading.updateBasicInfo,type:"primary"},on:{click:t.goNext}},[t._v("\n          保存,继续填写\n        ")])],1)],1)],1)],1)},I=[],$=a("b346"),P=a("9e5b"),L=a("b70e"),N=a("74d8"),A=a("188d"),D=a("5c8a"),E={name:"EditBasicInfo",bem:{editBasicInfo:"page-shop-staff-edit-basic"},serviceInject:function(){return{pattern:f["a"],appConfig:N["a"],listservice:L["ListService"],editservice:c["EditService"],message:d["a"],userService:w["a"]}},rxState:function(){return{roleList:this.editservice.roleList$,codeList:this.editservice.codeList$,loading:this.editservice.loading$,id_types:this.userService.getOptions$("staff.id_type"),nature_works:this.userService.getOptions$("staff.nature_work"),sexs:this.userService.getOptions$("staff.sex")}},components:{ShopSelect:$["a"],DepartmentSelect:P["a"],FaceUpload:A["a"],StImageUpload:u["a"]},props:{data:{type:Object}},data:function(){var t=this.$stForm.create(),e=t.decorators(l["a"]);return{form:t,decorators:e,fileList:[],faceList:[],country_code_id:37,id_type:"",value:""}},computed:{isSuperAdmin:function(){return!!this.data.is_super_admin}},mounted:function(){var t=this;this.$nextTick((function(){t.setData(t.data)}))},methods:{resetID:function(){this.form.setFieldsValue({id_number:void 0})},onChangeGetAvatar:function(t){this.fileList=Object(D["a"])(t)},onChangeGetFace:function(t){this.faceList=Object(D["a"])(t)},roleChange:function(t){t&&t.length>10&&t.pop()},onChange:function(t){this.value=t},goNext:function(t){var e=this;this.form.validate().then((function(t){e.submit(t,1)}))},save:function(t){var e=this;this.form.validate().then((function(t){e.submit(t)}))},submit:function(t,e){var a=this;t.entry_date=moment(t.entry_date).format("YYYY-MM-DD"),t.album_id=this.data.album_id,t.image_avatar=this.fileList[0]||{},t.image_face=this.faceList[0]||{},t.country_code_id=this.country_code_id,t.id_type=this.id_type,t.department_id=+t.department_id,this.editservice.updateBasicInfo(this.data.staff_id,t).subscribe((function(t){1===e?(a.$emit("gonext"),a.$emit("updateStaffInfo")):(a.message.success({content:"编辑成功"}),a.$router.push({path:"/shop/staff/info/basic",query:{id:a.data.staff_id}}))}))},setData:function(t){this.form.setFieldsValue({staff_name:t.staff_name,nickname:t.nickname,department_id:String(t.department_id),mobile:t.mobile,staff_num:t.staff_num,sex:t.sex,id_number:t.id_number,nature_work:t.nature_work||void 0,role_id:t.role_id,entry_date:t.entry_date?moment(t.entry_date):void 0,mail:t.mail,shop_id:t.shop_id}),this.country_code_id=t.country_code_id,this.id_type=t.id_type,this.fileList=Array.isArray(t.image_avatar)?t.image_avatar:[t.image_avatar],this.faceList=Array.isArray(t.image_face)?t.image_face:[t.image_face]}}},B=E,q=Object(h["a"])(B,C,I,!1,null,null,null),F=q.exports,R={bem:{b:"page-add-staff",bstep:"page-add-staff-steps",bHeader:"default-brand-header"},serviceInject:function(){return{userService:w["a"],messageService:d["a"],services:c["EditService"]}},rxState:function(){return{staffInfo:this.services.staffInfo$,staffSpecialty:this.services.staffSpecialty$}},components:{EditCoachInfo:b,EditDetailedInfo:x,EditBasicInfo:F},data:function(){return{stepsSpan:18,currentIndex:0,stepArr:[{title:"基础信息",key:0},{title:"详细信息",key:1},{title:"".concat(this.$c("coach"),"信息"),key:2}]}},computed:{isShowCoach:function(){return 0!==this.staffInfo.identity.length&&(this.staffInfo.identity.includes(3)||this.staffInfo.identity.includes(4))},isPrivateCoach:function(){return 0!==this.staffInfo.identity.length&&this.staffInfo.identity.includes(4)},id:function(){return this.staffInfo.staff_id}},watch:{isPrivateCoach:function(t){t&&(this.stepsSpan=12,this.stepArr.pop())}},created:function(){var t=this.$searchQuery.currentIndex;this.isPrivateCoach||(this.stepsSpan=12,this.stepArr.pop()),t&&(this.currentIndex=Number(t))},methods:{updateStaffInfo:function(){this.services.getStaffInfo(this.id).subscribe()},onBack:function(t){this.currentIndex=this.currentIndex-t},gonext:function(){this.currentIndex<2&&(this.currentIndex=this.currentIndex+1)},changeStep:function(t){this.currentIndex=t}}},M=R,Q=Object(h["a"])(M,s,r,!1,null,null,null);e["default"]=Q.exports},"57b4":function(t,e,a){"use strict";var s,r,i,n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("st-modal",{staticClass:"modal-staff-delete",attrs:{title:"管理登录账号",size:"small",confirmLoading:t.openRepassword?t.loading.getRePassword:t.loading.setAccount},on:{ok:t.onSubmit},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("staff-info",{attrs:{staff:t.staff}}),a("div",[a("st-form",{attrs:{form:t.form,autocomplete:"off"}},[a("st-form-item",{attrs:{label:"系统权限"}},[a("a-checkbox",{attrs:{checked:t.openJurisdiction},on:{change:function(e){return e.stopPropagation(),t.changePermission(e)}}},[t._v("\n          开通系统使用权限\n        ")])],1),t.hasAccountName?a("st-form-item",{attrs:{label:"登录账号"}},[a("span",[t._v(t._s(t.rePasswordInfo.account_name))]),a("span",{staticStyle:{color:"#1890FF"},on:{click:t.onClickRePassword}},[t._v("\n          重置密码\n        ")])]):t._e(),!t.hasAccountName&&t.openJurisdiction?a("st-form-item",{attrs:{label:"登录账号",required:""}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.name,expression:"decorators.name"}],attrs:{autocomplete:"off",placeholder:"6～18个字符，可使用字母，数字，下划线"}})],1):t._e(),!t.hasAccountName&&t.openJurisdiction?a("st-form-item",{attrs:{label:"登录密码",required:""}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.password,expression:"decorators.password"}],attrs:{type:"password",autocomplete:"new-password",placeholder:"6~15个字符，区分大小写"}})],1):t._e(),!t.hasAccountName&&t.openJurisdiction?a("st-form-item",{attrs:{label:"确认密码",required:""}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.repeat_password,expression:"decorators.repeat_password"}],attrs:{autocomplete:"off",type:"password",placeholder:"请再次填写密码"}})],1):t._e(),t.openRepassword?a("st-form-item",{attrs:{label:"登录密码",required:""}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.password,expression:"decorators.password"}],attrs:{type:"password",autocomplete:"new-password",placeholder:"6~15个字符，区分大小写"}})],1):t._e(),t.openRepassword?a("st-form-item",{attrs:{label:"确认密码",required:""}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.repeat_password,expression:"decorators.repeat_password"}],attrs:{type:"password",autocomplete:"new-password",placeholder:"请再次填写密码"}})],1):t._e(),t.bindAccount?a("st-form-item",{attrs:{label:"账号绑定"}},[t.rePasswordInfo.wechat?a("div",[a("span",[t._v("绑定微信号")]),a("span",[t._v(t._s(t.rePasswordInfo.wechat))])]):t._e(),t.rePasswordInfo.mail?a("div",[a("span",[t._v("绑定邮箱")]),a("span",[t._v(t._s(t.rePasswordInfo.mail))])]):t._e(),t.rePasswordInfo.phone?a("div",[a("span",[t._v("绑定手机")]),a("span",[t._v(t._s(t.rePasswordInfo.phone))])]):t._e(),t.rePasswordInfo.QQ?a("div",[a("span",[t._v("绑定qq")]),a("span",[t._v(t._s(t.rePasswordInfo.QQ))])]):t._e()]):t._e()],1)],1)],1)},o=[],c=(a("8e6e"),a("ac6a"),a("456d"),a("7f7f"),a("bd86")),d=a("6e27"),f=a("d225"),l=a("b0b4"),u=a("9ab4"),p=a("cc76"),m=a("0cd5"),h=a("df29"),v=a("c4cc"),b=a("e69b"),_=function(){function t(e,a){Object(f["a"])(this,t),this.staffApi=e,this.msg=a,this.rePasswordInfo$=new h["d"]({}),this.loading$=new h["d"]({})}return Object(l["a"])(t,[{key:"getRePassword",value:function(t){var e=this;return this.staffApi.getRePassword(t).pipe(Object(v["a"])((function(t){e.rePasswordInfo$.commit((function(){return t.account}))})))}},{key:"setAccount",value:function(t){var e=this;return this.staffApi.setAccount(t).pipe(Object(v["a"])((function(t){e.msg.success({content:"创建账号成功"})})))}},{key:"rePassword",value:function(t){var e=this;return this.staffApi.rePassword(t).pipe(Object(v["a"])((function(t){e.msg.success({content:"修改密码成功"})})))}},{key:"updatepermission",value:function(t,e){var a=this;return this.staffApi.updatepermission(t,e).pipe(Object(v["a"])((function(t){a.msg.success({content:"修改密码成功"})})))}}]),t}();Object(u["b"])([Object(h["c"])(),Object(u["d"])("design:type",Function),Object(u["d"])("design:paramtypes",[String]),Object(u["d"])("design:returntype",void 0)],_.prototype,"getRePassword",null),Object(u["b"])([Object(h["c"])(),Object(u["d"])("design:type",Function),Object(u["d"])("design:paramtypes",["function"===typeof(s="undefined"!==typeof p["RePasswordInput"]&&p["RePasswordInput"])?s:Object]),Object(u["d"])("design:returntype",void 0)],_.prototype,"setAccount",null),_=Object(u["b"])([Object(m["b"])(),Object(u["d"])("design:paramtypes",["function"===typeof(r="undefined"!==typeof p["g"]&&p["g"])?r:Object,"function"===typeof(i="undefined"!==typeof b["a"]&&b["a"])?i:Object])],_);a("3b2b");var y=function(t){var e=new RegExp(/^[A-Za-z0-9\_]{6,15}$/);return{name:{rules:[{required:!0,message:"请输入登录账户"},{pattern:e,message:"请输入6~15个字符"}]},password:{rules:[{validator:function(t,e,a){return e?e.length<6||e.length>15?"请输入正确格式登录密码":void 0:"请输入登录密码"}}]},repeat_password:{rules:[{validator:function(t,e,a){return e?e.length<6||e.length>15?"请输入正确格式登录密码":e!==a.password?"两次密码输入不一致":void 0:"请输入登录密码"}}]}}};function g(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,s)}return a}function S(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?g(Object(a),!0).forEach((function(e){Object(c["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):g(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var w={name:"RePassword",serviceInject:function(){return{rePasswordService:_}},rxState:function(){return{loading:this.rePasswordService.loading$,rePasswordInfo:this.rePasswordService.rePasswordInfo$}},components:{StaffInfo:d["a"]},props:{staff:{type:Object,default:function(){}}},data:function(){var t=this.$stForm.create(),e=t.decorators(y);return{form:t,decorators:e,openJurisdiction:!1,openRepassword:!1,show:!1}},computed:{is_permission:function(){return this.rePasswordInfo.is_permission},hasAccountName:function(){return this.rePasswordInfo.account_name},bindAccount:function(){return this.rePasswordInfo&&this.rePasswordInfo.wechat&&this.rePasswordInfo.mail&&this.rePasswordInfo.phone&&this.rePasswordInfo.QQ}},mounted:function(){this.init()},methods:{changePermission:function(t){this.openJurisdiction=t.target.checked},init:function(){var t=this;this.rePasswordService.getRePassword(this.staff.id).subscribe((function(e){e=e.account,t.openJurisdiction=!!e.is_permission;var a={password:e.password,repeat_password:e.repeat_password};t.hasAccountName&&(a=Object.assign(a,{name:e.account_name})),t.form.setFieldsValue(a)}))},onClickRePassword:function(){this.openRepassword=!0},onSubmit:function(){var t=this;this.form.validate().then((function(e){var a=S({id:t.staff.id,is_permission:+t.openJurisdiction},e);t.hasAccountName?e.password&&e.repeat_password?t.rePasswordService.rePassword(a).subscribe((function(){t.show=!1})):t.rePasswordService.updatepermission(t.staff.id,{is_permission:+t.openJurisdiction}).subscribe((function(){t.show=!1})):e.name&&e.password&&e.repeat_password?t.rePasswordService.setAccount(a).subscribe((function(){t.show=!1})):t.rePasswordService.updatepermission(t.staff.id,{is_permission:+t.openJurisdiction}).subscribe((function(){t.show=!1}))}))}}},O=w,j=a("2877"),k=Object(j["a"])(O,n,o,!1,null,null,null);e["a"]=k.exports},"6e27":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal-staff"},[a("a-row",{staticClass:"staff-info mg-b16",attrs:{type:"flex"}},[t.staff.avatar?a("a-col",{staticClass:"staff-info__img"},[a("img",{attrs:{src:t.staff.avatar,alt:""}})]):t._e(),a("a-col",{staticClass:"staff-info__content"},[a("st-t3",[t._v(t._s(t.staff.staff_name))]),a("div",{staticClass:"staff-identity"},t._l(t.identity,(function(e){return a("span",{key:e.id,staticClass:"staff-identity__item mg-r8"},[t._v("\n          "+t._s(e.name)+"\n        ")])})),0)],1)],1)],1)},r=[],i={name:"StaffInfo",computed:{identity:function(){return this.staff.identity}},props:{staff:{type:Object,default:function(){}}}},n=i,o=a("2877"),c=Object(o["a"])(n,s,r,!1,null,null,null);e["a"]=c.exports},"82a7":function(t,e,a){"use strict";a.r(e),a.d(e,"InfoService",(function(){return b}));var s,r,i,n,o=a("d225"),c=a("b0b4"),d=a("9ab4"),f=a("0cd5"),l=a("df29"),u=a("c4cc"),p=a("cc76"),m=a("2cbb"),h=a("dcb5"),v=a("e69b"),b=function(){function t(e,a,s,r){Object(o["a"])(this,t),this.shopStaffapi=e,this.authService=a,this.staffApi=s,this.message=r,this.info$=new l["d"]({}),this.auth$=new l["d"]([])}return Object(c["a"])(t,[{key:"getInfo",value:function(t){var e=this;return this.shopStaffapi.getStaffInfoCommonHeader(t).pipe(Object(u["a"])((function(t){e.info$.commit((function(){return t.common_info})),e.auth$.commit((function(){return t.auth}))})))}},{key:"deleteStaffFinger",value:function(t){var e=this;return this.staffApi.deleteStaffFinger(t).pipe(Object(u["a"])((function(t){e.message.success({content:"指纹信息清空成功"})})))}},{key:"deleteStaffCabinetPassword",value:function(t){var e=this;return this.staffApi.deleteStaffCabinetPassword(t).pipe(Object(u["a"])((function(t){e.message.success({content:"硬件密码清空成功"})})))}},{key:"beforeRouteEnter",value:function(t,e){var a=t.query.id;return this.getInfo(a)}}]),t}();b=Object(d["b"])([Object(f["b"])(),Object(d["d"])("design:paramtypes",["function"===typeof(s="undefined"!==typeof p["g"]&&p["g"])?s:Object,"function"===typeof(r="undefined"!==typeof m["a"]&&m["a"])?r:Object,"function"===typeof(i="undefined"!==typeof h["k"]&&h["k"])?i:Object,"function"===typeof(n="undefined"!==typeof v["a"]&&v["a"])?n:Object])],b)},8473:function(t,e,a){"use strict";var s,r,i,n,o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("st-modal",{attrs:{title:"更改员工职位",size:"small"},on:{ok:t.onSubmit},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("staff-info",{attrs:{staff:t.staff}}),a("st-form",{attrs:{labelWidth:"70px",form:t.form}},[a("st-form-item",{attrs:{label:"工作性质"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.nature_work,expression:"decorators.nature_work"}],attrs:{placeholder:"请选择工作性质"}},t._l(t.natureWork,(function(e){return a("a-select-option",{key:e.value,attrs:{value:e.value}},[t._v("\n          "+t._s(e.label)+"\n        ")])})),1)],1),a("st-form-item",{attrs:{label:"员工职能",required:""}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.identity,expression:"decorators.identity"}],attrs:{mode:"multiple",placeholder:"请选择员工职能"},on:{change:t.onChangeIdentity,deselect:t.onDeselectIndentity}},t._l(t.identityList,(function(e){return a("a-select-option",{key:e.value,attrs:{value:e.value}},[t._v("\n          "+t._s(e.label)+"\n        ")])})),1),!t.canDeleteIdentity&&t.tips.length?a("staff-modal-tips",{attrs:{list:t.tips,canNotDelete:!t.operate}}):t._e()],1),a("st-form-item",{directives:[{name:"show",rawName:"v-show",value:!t.canDeleteIdentity||t.coach_level_required,expression:"!canDeleteIdentity || coach_level_required"}],attrs:{label:t.$c("coach")+"等级",required:!t.canDeleteIdentity||t.coach_level_required}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.coach_level_id,expression:"decorators.coach_level_id"}],attrs:{placeholder:"请选择"+t.$c("coach")+"等级"}},t._l(t.coachLevelList,(function(e){return a("a-select-option",{key:e.id,attrs:{value:e.id}},[t._v("\n          "+t._s(e.name)+"\n        ")])})),1)],1),a("st-form-item",{attrs:{label:"薪资模板"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.basic_salary,expression:"decorators.basic_salary"}],attrs:{placeholder:"请选择底薪模版"}},t._l(t.salaryBasic,(function(e){return a("a-select-option",{key:e.id,attrs:{value:e.id,disabled:!e.id}},[t._v("\n          "+t._s(e.name)+"\n        ")])})),1)],1),a("st-form-item",{attrs:{label:" "}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.sale_percentage,expression:"decorators.sale_percentage"}],attrs:{placeholder:"请选择薪资模板"}},t._l(t.salarySale,(function(e){return a("a-select-option",{key:e.id,attrs:{value:e.id,disabled:!e.id}},[t._v("\n          "+t._s(e.name)+"\n        ")])})),1)],1),a("st-form-item",{attrs:{label:" "}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.course_percentage,expression:"decorators.course_percentage"},{name:"show",rawName:"v-show",value:t.isSalaryCourse,expression:"isSalaryCourse"}],attrs:{placeholder:"请选择课程模板"}},t._l(t.salaryCourse,(function(e){return a("a-select-option",{key:e.id,attrs:{value:e.id,disabled:!e.id}},[t._v("\n          "+t._s(e.name)+"\n        ")])})),1)],1)],1)],1)},c=[],d=(a("8e6e"),a("ac6a"),a("456d"),a("bd86")),f=a("75fc"),l=(a("6762"),a("2fdb"),a("c5f6"),a("d225")),u=a("b0b4"),p=a("9ab4"),m=a("2138"),h=a("e69b"),v=a("2f8f"),b=a("0cd5"),_=a("df29"),y=a("c4cc"),g=a("dcb5"),S=a("54da"),w=function(){function t(e,a,s,r){Object(l["a"])(this,t),this.staffApi=e,this.coachLevel=a,this.msg=s,this.userService=r,this.positionInfo$=new _["d"]({}),this.coachLevelList$=new _["d"]([]),this.salaryBasic$=new _["d"]([]),this.salarySale$=new _["d"]([]),this.salaryCourse$=new _["d"]([]),this.identityList$=this.userService.getOptions$("staff.identity"),this.natureWork$=this.userService.getOptions$("staff.nature_work")}return Object(u["a"])(t,[{key:"getCoachLevel",value:function(){var t=this;return this.coachLevel.getCoachLevelListAll().pipe(Object(y["a"])((function(e){t.coachLevelList$.commit((function(){return e.list}))})))}},{key:"getStaffSalaryBasic",value:function(){var t=this;return this.staffApi.getStaffSalaryBasic().pipe(Object(y["a"])((function(e){t.salaryBasic$.commit((function(){return[{id:0,name:"请选择"}].concat(Object(f["a"])(e.basic_templates))}))})))}},{key:"getStaffSalarySale",value:function(){var t=this;return this.staffApi.getStaffSalarySale().pipe(Object(y["a"])((function(e){t.salarySale$.commit((function(){return[{id:0,name:"请选择"}].concat(Object(f["a"])(e.sale_templates))}))})))}},{key:"getStaffSalaryCourse",value:function(){var t=this;return this.staffApi.getStaffSalaryCourse().pipe(Object(y["a"])((function(e){t.salaryCourse$.commit((function(){return[{id:0,name:"请选择"}].concat(Object(f["a"])(e.course_templates))}))})))}},{key:"getStaffBrandPosition",value:function(t){var e=this;return this.staffApi.getStaffBrandPosition({id:t}).pipe(Object(y["a"])((function(t){e.positionInfo$.commit((function(){return t.position}))})))}},{key:"init",value:function(t){return Object(S["a"])(this.getStaffBrandPosition(t),this.getCoachLevel(),this.getStaffSalaryCourse(),this.getStaffSalaryBasic(),this.getStaffSalarySale())}},{key:"putStaffBindPosition",value:function(t){var e=this;return this.staffApi.putStaffBindPosition(t).pipe(Object(y["a"])((function(t){e.msg.success({content:"提交成功"})})))}},{key:"validatStaffPosition",value:function(t,e){return this.staffApi.validatStaffPosition(t,e)}}]),t}();Object(p["b"])([Object(_["c"])(),Object(p["d"])("design:type",Function),Object(p["d"])("design:paramtypes",[Number,Number]),Object(p["d"])("design:returntype",void 0)],w.prototype,"validatStaffPosition",null),w=Object(p["b"])([Object(b["b"])(),Object(p["d"])("design:paramtypes",["function"===typeof(s="undefined"!==typeof g["k"]&&g["k"])?s:Object,"function"===typeof(r="undefined"!==typeof v["b"]&&v["b"])?r:Object,"function"===typeof(i="undefined"!==typeof h["a"]&&h["a"])?i:Object,"function"===typeof(n="undefined"!==typeof m["a"]&&m["a"])?n:Object])],w);var O=a("6e27"),j=a("88b8"),k=function(t){return{nature_work:{},identity:{},coach_level_id:{rules:[{required:t.coach_level_required,message:"请选择".concat(t.$c("coach"),"等级")}]},basic_salary:{},sale_percentage:{},course_percentage:{}}},x=a("5c8a");function C(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,s)}return a}function I(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?C(Object(a),!0).forEach((function(e){Object(d["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):C(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var $={serviceInject:function(){return{updateStaffPositionService:w,msg:h["a"]}},rxState:function(){return{identityList:this.updateStaffPositionService.identityList$,natureWork:this.updateStaffPositionService.natureWork$,positionInfo:this.updateStaffPositionService.positionInfo$,coachLevelList:this.updateStaffPositionService.coachLevelList$,salaryBasic:this.updateStaffPositionService.salaryBasic$,salarySale:this.updateStaffPositionService.salarySale$,salaryCourse:this.updateStaffPositionService.salaryCourse$}},name:"UpdateStaffPosition",data:function(){var t=this.$stForm.create(),e=t.decorators(k);return{form:t,decorators:e,show:!1,isSalaryCourse:!1,tips:[],operate:!1,canDeleteIdentity:!0,coach_level_required:!1}},props:{staff:{type:Object,default:function(){}}},filters:{identityFilter:function(t){var e=["role-staff","role-saler","coach-personal","coach-team","swimming-coach"];return e[t-1]}},watch:{identity:function(t){this.isSalaryCourse=t.includes(3)||t.includes(4)}},components:{StaffInfo:O["a"],StaffModalTips:j["a"]},computed:{identity:function(){return this.staff&&this.staff.identity}},mounted:function(){var t=this;this.updateStaffPositionService.init(this.staff.id).subscribe((function(e){t.initFormData()}))},methods:{initFormData:function(){var t=this.positionInfo,e=t.basic_salary,a=t.coach_level_id,s=t.course_percentage,r=t.identity,i=t.nature_work,n=t.sale_percentage;i||(i=void 0),this.onChangeIdentity(r);var o={coach_level_id:a,sale_percentage:n,course_percentage:s,basic_salary:e,identity:r,nature_work:i};this.form.setFieldsValue(o)},onChangeIdentity:function(t){this.isSalaryCourse=t.includes(3)||t.includes(4),this.coach_level_required=t.includes(4)},onDeselectIndentity:function(t){var e=this;this.updateStaffPositionService.validatStaffPosition(this.staff.id,t).subscribe((function(a){var s=a.operate;if(!s){var r=e.identity.filter((function(e){return e.id===t})),i=[].concat(Object(f["a"])(r.map((function(t){return t.id}))),Object(f["a"])(e.form.getFieldValue("identity")));e.form.setFieldsValue({identity:i}),e.tips=a.list,e.operate=a.operate,e.canDeleteIdentity=!1}}))},onSubmit:function(t){var e=this;t.preventDefault(),this.form.validate().then((function(t){var a=Object(x["a"])(t);!e.coach_level_required&&e.canDeleteIdentity&&(a.coach_level_id=void 0),e.updateStaffPositionService.putStaffBindPosition(I({id:e.staff.id},t)).subscribe((function(){e.show=!1}))}))}}},P=$,L=a("2877"),N=Object(L["a"])(P,o,c,!1,null,null,null);e["a"]=N.exports},"8d44":function(t,e,a){"use strict";var s,r,i,n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("st-modal",{staticClass:"model-leave-store-container",attrs:{title:"解除门店关系",size:"small"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("staff-info",{attrs:{staff:t.staff}}),t.operate===t.LEAVE_CURRENT_SHOP.OPERATE_TYPE?[a("a-row",{staticClass:"mg-t16",attrs:{gutter:8}},[a("a-col",{attrs:{lg:24}},[a("p",{staticClass:"model-leave-store-container_tip"},[t._v("\n          确认此员工不在"+t._s("门店名称")+"进行相关工作\n        ")])])],1),a("template",{slot:"footer"},[a("st-button",{staticClass:"mg-r8",on:{click:t.onCancel}},[t._v("取消")]),a("st-button",{attrs:{type:"primary"},on:{click:t.onSubmit}},[t._v("确认")])],1)]:[0!==t.list.length?a("a-row",{staticClass:"mg-t16",attrs:{gutter:8}},[a("a-col",{attrs:{lg:24}},[a("div",{staticClass:"model-leave-store-container_info"},[a("div",{staticClass:"model-leave-store-container_same mg-b8"},[t._v("\n            该员工在本门店还有未完成的事项，无法解除\n          ")]),t._l(t.list,(function(e){return[a("div",{key:e.type,staticClass:"model-leave-store-container_same mg-b8"},[t._v("\n              "+t._s(e.num)+t._s(e.name)+"\n            ")])]}))],2)])],1):t._e(),a("template",{slot:"footer"},[a("st-button",{attrs:{type:"primary"},on:{click:t.onCancel}},[t._v("知道了")])],1)]],2)},o=[],c=a("6e27"),d=a("d225"),f=a("b0b4"),l=a("9ab4"),u=a("0cd5"),p=a("cc76"),m=a("c4cc"),h=a("e69b"),v=a("df29"),b=function(){function t(e,a){Object(d["a"])(this,t),this.api=e,this.message=a,this.list$=new v["d"]([]),this.operate$=new v["d"](0)}return Object(f["a"])(t,[{key:"getInfo",value:function(t){var e=this;return this.api.getLeaveStoreInfo(t).pipe(Object(m["a"])((function(t){e.list$.commit((function(){return t.list})),e.operate$.commit((function(){return t.operate}))})))}},{key:"leaveStore",value:function(t){var e=this;return this.api.leaveStore(t).pipe(Object(m["a"])((function(t){e.message.success({content:"解除门店关系成功"})})))}}]),t}();b=Object(l["b"])([Object(u["b"])(),Object(l["d"])("design:paramtypes",["function"===typeof(s="undefined"!==typeof p["g"]&&p["g"])?s:Object,"function"===typeof(r="undefined"!==typeof h["a"]&&h["a"])?r:Object])],b),function(t){t[t["OPERATE_TYPE"]=1]="OPERATE_TYPE"}(i||(i={}));var _={name:"LeaveCurrentStore",serviceInject:function(){return{service:b}},rxState:function(){return{list:this.service.list$,operate:this.service.operate$}},props:{staff:{type:Object,default:function(){}}},data:function(){return{LEAVE_CURRENT_SHOP:i,show:!1}},mounted:function(){this.service.getInfo(this.staff.id).subscribe()},components:{StaffInfo:c["a"]},methods:{onCancel:function(){this.show=!1},onSubmit:function(){var t=this;this.service.leaveStore(this.staff.id).subscribe((function(e){t.show=!1}))}}},y=_,g=a("2877"),S=Object(g["a"])(y,n,o,!1,null,null,null);e["a"]=S.exports},9129:function(t,e,a){"use strict";a.r(e);var s,r,i,n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("st-panel",{staticClass:"page-shop-staff-list",attrs:{app:""}},[s("a-row",{attrs:{type:"flex",justify:"space-between"}},[s("a-col",{attrs:{span:10}},[s("div",{staticClass:"page-shop-staff-list__selectRow"},[t.auth.add?s("st-button",{staticClass:"mg-r8",attrs:{type:"primary",icon:"add"},on:{click:t.onAddStaff}},[t._v("\n          新增员工\n        ")]):t._e(),t.auth.export?s("st-button",{directives:[{name:"export-excel",rawName:"v-export-excel",value:{type:"staff",query:{conditions:t.$searchQuery}},expression:"{\n            type: 'staff',\n            query: { conditions: $searchQuery }\n          }"}],staticClass:"mg-r8",attrs:{type:"primary"}},[t._v("\n          全部导出\n        ")]):t._e(),t.auth.join?s("st-button",{attrs:{disabled:!t.selectedRowKeys.length,icon:"add"},on:{click:t.onJoinDepartment}},[t._v("\n          批量加入部门\n        ")]):t._e()],1)]),s("a-col",{attrs:{span:14}},[s("div",{staticClass:"filter-staff "},[s("a-select",{staticClass:"mg-r8",attrs:{placeholder:"全部角色",dropdownMatchSelectWidth:!1},on:{change:function(e){return t.onSingleSearch("role_id",e)}},model:{value:t.$searchQuery.role_id,callback:function(e){t.$set(t.$searchQuery,"role_id",e)},expression:"$searchQuery.role_id"}},t._l(t.roleOptions,(function(e){return s("a-select-option",{key:e.id,attrs:{value:e.id}},[t._v("\n            "+t._s(e.name)+"\n          ")])})),1),s("a-tree-select",{staticClass:"mg-r8",attrs:{showSearch:"",dropdownMatchSelectWidth:!1,dropdownStyle:{maxHeight:"400px",overflow:"auto"},placeholder:"请选择部门",treeDefaultExpandAll:""},on:{change:function(e){return t.onSingleSearch("department_id",e)}},model:{value:t.$searchQuery.department_id,callback:function(e){t.$set(t.$searchQuery,"department_id",e)},expression:"$searchQuery.department_id"}},t._l(t.department,(function(e){return s("a-tree-select-node",{key:e.id,attrs:{value:e.id,title:e.name}},t._l(e.children,(function(e){return s("a-tree-select-node",{key:e.id,attrs:{value:e.id,title:e.name}},t._l(e.children,(function(e){return s("a-tree-select-node",{key:e.id,attrs:{value:e.id,title:e.name}},t._l(e.children,(function(e){return s("a-tree-select-node",{key:e.id,attrs:{value:e.id,title:e.name}},t._l(e.children,(function(t){return s("a-tree-select-node",{key:t.id,attrs:{value:t.id,title:t.name}})})),1)})),1)})),1)})),1)})),1),s("a-select",{staticClass:"mg-r8",attrs:{placeholder:"请选择员工职能",options:t.identityList},on:{change:function(e){return t.onSingleSearch("identity",e)}},model:{value:t.$searchQuery.identity,callback:function(e){t.$set(t.$searchQuery,"identity",e)},expression:"$searchQuery.identity"}}),s("a-select",{staticClass:"mg-r8",attrs:{placeholder:"请选择在职状态",options:t.workStatusList},on:{change:function(e){return t.onSingleSearch("work_status",e)}},model:{value:t.$searchQuery.work_status,callback:function(e){t.$set(t.$searchQuery,"work_status",e)},expression:"$searchQuery.work_status"}}),s("st-input-search",{attrs:{placeholder:"搜索员工"},on:{search:function(e){return t.onKeywordsSearch("keyword",e)}},model:{value:t.$searchQuery.keyword,callback:function(e){t.$set(t.$searchQuery,"keyword",e)},expression:"$searchQuery.keyword"}})],1)])],1),s("a-row",{staticClass:"mg-t16"},[s("st-table",{staticClass:"page-shop-staff-table",attrs:{rowSelection:{selectedRowKeys:t.selectedRowKeys,onChange:t.onSelectionChange},loading:t.loading.getStaffList,columns:t.columns,dataSource:t.staffList,rowKey:"id",page:t.page},on:{change:t.onTableChange},scopedSlots:t._u([{key:"staff_name",fn:function(e,r){return[t._v("\n        "+t._s(e)+"\n        "),1===r.is_super_admin?s("img",{staticClass:"page-shop-staff-list__staff-role",attrs:{src:a("fd89"),alt:"超级管理员"}}):t._e()]}},{key:"shop",fn:function(e,a){return s("st-overflow-text",{attrs:{title:"所在门店","max-width":"150px",value:t.getShopName(a)}})}},{key:"identity",fn:function(e,a){return[t._l(a.identity,(function(e){return[s("span",{key:e.id,staticClass:"mg-r8"},[t._v(t._s(e.name))])]}))]}},{key:"sex",fn:function(e){return[s("span",[t._v(t._s(e.name))])]}},{key:"work_status",fn:function(e){return[s("st-text",{attrs:{status:{success:1===e.id,error:2===e.id}}},[t._v("\n          "+t._s(e.name)+"\n        ")])]}},{key:"action",fn:function(e,a){return[s("st-table-actions",[a.auth["shop:staff:staff|get"]?s("a",{attrs:{href:"javascript: void(0)"},on:{click:function(e){return t.onSearchDetail(a)}}},[t._v("\n            详情\n          ")]):t._e(),"在职"===a.work_status.name?[a.auth["shop:staff:staff|edit"]?s("a",{attrs:{href:"javascript: void(0)"},on:{click:function(e){return t.onEdit(a)}}},[t._v("\n              编辑\n            ")]):t._e(),a.auth["shop:staff:staff|bind_card"]?s("a",{directives:[{name:"modal-link",rawName:"v-modal-link",value:{name:"shop-staff-bind-card",props:{staff:a}},expression:"{\n                name: 'shop-staff-bind-card',\n                props: { staff: record }\n              }"}],attrs:{href:"javascript: void(0)"}},[t._v("\n              绑定实体卡\n            ")]):t._e(),a.auth["shop:staff:staff|rebind_card"]?s("a",{directives:[{name:"modal-link",rawName:"v-modal-link",value:{name:"shop-staff-bind-card",props:{staff:a}},expression:"{\n                name: 'shop-staff-bind-card',\n                props: { staff: record }\n              }"}],attrs:{href:"javascript: void(0)"}},[t._v("\n              重绑实体卡\n            ")]):t._e(),a.auth["shop:staff:account|save"]?s("a",{directives:[{name:"modal-link",rawName:"v-modal-link",value:{name:"shop-staff-re-password",props:{staff:a}},expression:"{\n                name: 'shop-staff-re-password',\n                props: { staff: record }\n              }"}],attrs:{href:"javascript: void(0)"}},[t._v("\n              管理登录账号\n            ")]):t._e(),a.auth["shop:staff:staff|position"]?s("a",{directives:[{name:"modal-link",rawName:"v-modal-link",value:{name:"shop-staff-update-staff-position",props:{staff:a}},expression:"{\n                name: 'shop-staff-update-staff-position',\n                props: { staff: record }\n              }"}],attrs:{href:"javascript: void(0)"}},[t._v("\n              职位和薪资变更\n            ")]):t._e(),a.auth["shop:staff:staff|salary"]?s("a",{directives:[{name:"modal-link",rawName:"v-modal-link",value:{name:"shop-staff-salary-account-setting",props:{staff:a}},expression:"{\n                name: 'shop-staff-salary-account-setting',\n                props: { staff: record }\n              }"}],attrs:{href:"javascript: void(0)"}},[t._v("\n              设置提现账户\n            ")]):t._e(),a.auth["shop:staff:staff|shop_leave"]?s("a",{directives:[{name:"modal-link",rawName:"v-modal-link",value:{name:"shop-staff-leave-current-shop",props:{staff:a}},expression:"{\n                name: 'shop-staff-leave-current-shop',\n                props: { staff: record }\n              }"}],attrs:{href:"javascript: void(0)"}},[t._v("\n              解除门店关系\n            ")]):t._e(),a.auth["shop:staff:staff|finger_del"]?s("a",{attrs:{href:"javascript: void(0)"},on:{click:function(e){return t.onClearFingerprintInfo(a)}}},[t._v("\n              清空指纹信息\n            ")]):t._e(),a.auth["shop:staff:staff|cabinet_pwd_del"]?s("a",{attrs:{href:"javascript: void(0)"},on:{click:function(e){return t.onClearHardwarePassword(a)}}},[t._v("\n              清空硬件密码\n            ")]):t._e()]:t._e()],2)]}}])})],1),s("change-staff-postion",{attrs:{show:t.visible,enums:t.enums,data:t.modaldata}})],1)},o=[],c=(a("7f7f"),a("2138")),d=a("b70e"),f=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-modal",{attrs:{title:"更改员工职位",size:"small"},on:{ok:t.onSubmit},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("section",[a("div",{staticClass:"mg-b24"},[a("st-tag",{staticClass:"mg-r4",attrs:{type:"coach-personal"}}),a("st-tag",{staticClass:"mg-r4",attrs:{type:"coach-team"}}),a("st-tag",{staticClass:"mg-r8",attrs:{type:"role-staff"}})],1)]),a("st-form",{attrs:{labelWidth:"66px",form:t.form}},[a("st-form-item",{attrs:{label:"工作性质"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["nature_work",{initialValue:1}],expression:"['nature_work', { initialValue: 1 }]"}],attrs:{placeholder:"请选择"}},[t.enums.nature_work?[t._l(t.enums.nature_work.value,(function(e,s){return[a("a-select-option",{key:e,attrs:{value:+s}},[t._v("\n              "+t._s(e)+"\n            ")])]}))]:t._e()],2)],1),a("st-form-item",{attrs:{label:"员工职能"}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["identity",{initialValue:[1,2]}],expression:"['identity', { initialValue: [1, 2] }]"}],attrs:{mode:"multiple",placeholder:"请选择"},on:{change:t.onChange}},[t.enums.nature_work?[t._l(t.enums.identity.value,(function(e,s){return[a("a-select-option",{key:e,attrs:{value:+s}},[t._v("\n              "+t._s(e)+"\n            ")])]}))]:t._e()],2)],1),a("st-form-item",{attrs:{label:t.$c("coach")+"等级"}},[a("a-input",{attrs:{placeholder:"支持中英文、数字,不超过10个字"}})],1),a("st-form-item",{attrs:{label:"薪资模板"}},[a("a-input",{staticClass:"mg-b8",attrs:{placeholder:"支持中英文、数字,不超过10个字"}}),a("a-input",{attrs:{placeholder:"支持中英文、数字,不超过10个字"}})],1)],1)],1)},l=[],u={name:"ChangeStaffPostion",props:{show:{type:Boolean,default:!1},data:Object,enums:{type:Object,default:function(){return{nature_work:{value:[]},identity:{value:[]}}}}},serviceInject:function(){return{userservice:c["a"]}},data:function(){return{form:this.$stForm.create()}},methods:{onChange:function(t){},onSubmit:function(t){t.preventDefault(),this.form.validate().then((function(t){}))}}},p=u,m=a("2877"),h=Object(m["a"])(p,f,l,!1,null,null,null),v=h.exports,b=function(){return[{title:"姓名",dataIndex:"staff_name",key:"staff_name",width:130,scopedSlots:{customRender:"staff_name"}},{title:"昵称",dataIndex:"nickname",key:"nickname"},{title:"手机号",dataIndex:"mobile",key:"mobile"},{title:"性别",dataIndex:"sex",key:"sex",scopedSlots:{customRender:"sex"}},{title:"工号",dataIndex:"staff_num",key:"staff_num"},{title:"所属部门",dataIndex:"department",key:"department"},{title:"所在门店",dataIndex:"shop",key:"shop",width:175,scopedSlots:{customRender:"shop"}},{title:"员工职能",dataIndex:"identity",key:"identity",scopedSlots:{customRender:"identity"}},{title:"在职状态",dataIndex:"work_status",key:"work_status",scopedSlots:{customRender:"work_status"}},{title:"操作",key:"action",width:140,scopedSlots:{customRender:"action"}}]},_=a("ea3e"),y=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("st-modal",{attrs:{title:"选择所属部门",confirmLoading:t.loading.transferBrand,size:"small"},on:{ok:t.save},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("a-tree",{attrs:{treeData:t.departmentOptions},on:{select:t.onSelect},scopedSlots:t._u([{key:"title",fn:function(e){var a=e.title;return[t._v("\n      title: "+t._s(a)+"\n    ")]}}])})],1)},g=[],S=a("d225"),w=a("b0b4"),O=a("9ab4"),j=a("0cd5"),k=a("dcb5"),x=a("e69b"),C=a("c4cc"),I=a("df29"),$=function(){function t(e,a){Object(S["a"])(this,t),this.staffApi=e,this.msg=a,this.loading$=new I["d"]({})}return Object(w["a"])(t,[{key:"transferBrand",value:function(t){var e=this;return this.staffApi.transferBrand(t).pipe(Object(C["a"])((function(t){e.msg.success({content:"批量导入成功"})})))}}]),t}();Object(O["b"])([Object(I["c"])(),Object(O["d"])("design:type",Function),Object(O["d"])("design:paramtypes",["function"===typeof(s="undefined"!==typeof k["TransferBrandInput"]&&k["TransferBrandInput"])?s:Object]),Object(O["d"])("design:returntype",void 0)],$.prototype,"transferBrand",null),$=Object(O["b"])([Object(j["b"])(),Object(O["d"])("design:paramtypes",["function"===typeof(r="undefined"!==typeof k["k"]&&k["k"])?r:Object,"function"===typeof(i="undefined"!==typeof x["a"]&&x["a"])?i:Object])],$);var P=a("89fa"),L={name:"BindEntityCard",serviceInject:function(){return{staffApi:k["k"],batchImportService:$}},rxState:function(){return{loading:this.batchImportService.loading$}},props:{ids:{type:Array,default:function(){return[]}}},data:function(){return{show:!1,departmentOptions:[],department_id:0}},mounted:function(){this.getDepartmentList()},methods:{onSelect:function(t){this.department_id=t.map((function(t){return JSON.parse(t)["key"]}))[0]},save:function(t){var e=this;t.preventDefault(),this.batchImportService.transferBrand({ids:this.ids,department_id:this.department_id}).subscribe((function(t){e.show=!1,e.$emit("change")}))},traverseTree:function(t){var e=this;return t.map((function(t){return t.children?{name:t.name,children:e.traverseTree(t.children),id:t.id+"",count:t.count}:t}))},getDepartmentList:function(){var t=this;this.staffApi.getDepartmentList().subscribe((function(e){t.departmentOptions=Object(P["a"])(e.department,{keyName:"id"})}))}}},N=L,A=Object(m["a"])(N,y,g,!1,null,null,null),D=A.exports,E=a("19f1"),B=a("8d44"),q=a("57b4"),F=a("e294"),R=a("8473"),M=a("58c8"),Q={mixins:[_["a"]],modals:{ShopStaffBatchImport:D,ShopStaffBindCard:E["a"],ShopStaffLeaveCurrentShop:B["a"],ShopStaffRePassword:q["a"],ShopStaffSalaryAccountSetting:F["a"],ShopStaffUpdateStaffPosition:R["a"],StaffUpdateStaffPosition:M["a"]},components:{ChangeStaffPostion:v},serviceInject:function(){return{userService:c["a"],service:d["ListService"]}},rxState:function(){return{staffList:this.service.staffList$,page:this.service.page$,roleOptions:this.service.roleOptions$,loading:this.service.loading$,department:this.service.department$,identityList:this.service.identityList$,workStatusList:this.service.workStatusList$,auth:this.service.auth$}},data:function(){return{visible:!1,value:"",enums:{},modaldata:{}}},computed:{columns:b},methods:{getShopName:function(t){return t.is_super_admin?"全部":t.shop.filter(Boolean).map((function(t){return t.name})).join(",")},changeStaffPosition:function(t){var e=this;this.userService.getEnums().subscribe((function(t){e.enums=t.staff,e.visible=!0,e.modaldata={nature_work:1,identity:[1,2]}}))},selectDepartment:function(t){this.value=t+""},joinok:function(){this.onSearchReset()},onJoinDepartment:function(t){this.$modalRouter.push({name:"shop-staff-batch-import",props:{ids:this.selectedRowKeys},on:{change:this.joinok}})},onAddStaff:function(){this.$router.push({name:"shop-staff-add"})},onExportStaff:function(){},onSearchDetail:function(t){t.identity.map((function(t){return t.id}));this.$router.push({name:"shop-staff-info-basic",query:{id:t.id}})},onEdit:function(t){this.$router.push({name:"shop-staff-edit",query:{id:t.id}})},onChooseDepartment:function(t){this.$router.push({query:{shop_id:t}})},onChooseStaffFn:function(t){},onChooseStaffStatus:function(t){this.$router.push({query:{work_status:t}})},onSearch:function(t){},onClearFingerprintInfo:function(t){var e=this;this.$confirm({title:"提示信息",content:"确认清空指纹信息？",onOk:function(){e.service.deleteStaffFinger(t.id).subscribe()}})},onClearHardwarePassword:function(t){var e=this;this.$confirm({title:"提示信息",content:"确认清空硬件密码吗？",onOk:function(){e.service.deleteStaffCabinetPassword(t.id).subscribe()}})}}},T=Q,U=Object(m["a"])(T,n,o,!1,null,null,null);e["default"]=U.exports},"983e":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("st-panel-layout",{staticClass:"pages-staffdata-container"},[a("st-panel",{staticClass:"pages-staffdata-header"},[a("a-row",[a("a-col",{staticClass:"pages-staffdata-header-detail",attrs:{span:15}},[a("div",{staticClass:"staff-avatar-container st-preview-item"},[a("img",{attrs:{src:t.image_avatar_url}}),a("div",{staticClass:"staff-avatar-tip"},[t._v("\n            "+t._s(t.info.work_status.name)+"\n            "),t.info.nature_work.name?a("span",[t._v("\n              /"+t._s(t.info.nature_work.name)+"\n            ")]):t._e()])]),a("div",{staticClass:"staff-info-container"},[a("div",{staticClass:"staff-info-name"},[t._v("\n            "+t._s(t.info.staff_name)+"\n            "),t.info.nickname?a("span",[t._v("（"+t._s(t.info.nickname)+"）")]):t._e(),a("st-icon",{style:1===t.info.sex?"color:#FF5E41":"color:#3F66F6",attrs:{type:1===t.info.sex?"female":"male"}})],1),a("div",{staticClass:"staff-info-cont"},[a("span",{staticClass:"mg-r24"},[t._v("手机号："+t._s(t.info.mobile))]),t.info.staff_num?a("span",{staticClass:"mg-r24"},[t._v("\n              工号："+t._s(t.info.staff_num)+"\n            ")]):t._e(),t.info.coach_level?a("span",[t._v("\n              "+t._s(t.$c("coach"))+"等级："+t._s(t.info.coach_level)+"\n            ")]):t._e()]),a("div",{staticClass:"staff-info-shops"},[a("span",{staticClass:"mg-r24"},[t._v("所在部门："+t._s(t.info.department))]),a("span",[t._v("所在门店："+t._s(t.info.shop_num)+"家门店")])])])]),"在职"===t.info.work_status.name?a("a-col",{staticStyle:{"text-align":"right"},attrs:{span:9}},[a("st-btn-actions",{attrs:{options:t.btnOptions}})],1):t._e()],1)],1),a("st-panel",{attrs:{app:"",tabs:t.tabList}},[a("div",{attrs:{slot:"actions"},slot:"actions"}),a("router-view")],1)],1)},r=[],i=(a("1c4c"),a("ac6a"),a("5df3"),a("4f7f"),a("82a7")),n=a("19f1"),o=a("8d44"),c=a("57b4"),d=a("e294"),f=a("8473"),l=a("58c8"),u={modals:{ShopStaffBindCard:n["a"],ShopStaffLeaveCurrentShop:o["a"],ShopStaffRePassword:c["a"],ShopStaffSalaryAccountSetting:d["a"],ShopStaffUpdateStaffPosition:f["a"],StaffUpdateStaffPosition:l["a"]},serviceInject:function(){return{infoService:i["InfoService"]}},rxState:function(){return{info:this.infoService.info$,auth:this.infoService.auth$}},data:function(){return{basic:{label:"员工资料",route:{name:"shop-staff-info-basic",query:{id:this.$searchQuery.id}}},course:{label:"上课记录",route:{name:"shop-staff-info-course",query:{id:this.$searchQuery.id}}},follow:{label:"跟进记录",route:{name:"shop-staff-info-follow",query:{id:this.$searchQuery.id}}},sold:{label:"售卖订单",route:{name:"shop-staff-info-sold",query:{id:this.$searchQuery.id}}},member:{label:"服务课程",route:{name:"shop-staff-info-member",query:{id:this.$searchQuery.id}}},tabList:[]}},computed:{image_avatar_url:function(){return this.info&&this.info.image_avatar&&this.info.image_avatar.image_url||""},btnOptions:function(){return[{text:"编辑资料",click:this.editStaffInfo,if:this.auth["shop:staff:staff|edit"]},{text:"绑定实体卡",click:this.openModalBindCard,if:this.auth["shop:staff:staff|bind_card"]},{text:"重绑实体卡",click:this.openModalRebindCard,if:this.auth["shop:staff:staff|rebind_card"]},{text:"职位和薪资变更",click:this.openModalPosition,if:this.auth["shop:staff:staff|position"]},{text:"离职",click:this.openModalLeave,if:this.auth["shop:staff:staff|leave"]},{text:"复职",click:this.openModalReinstate,if:this.auth["shop:staff:staff|reinstate"]},{text:"管理登录账户",click:this.openModalSave,if:this.auth["shop:staff:account|save"]},{text:"设置提现账户",click:this.openModalSalary,if:this.auth["shop:staff:staff|salary"]},{text:"解除门店关系",click:this.openModalShopLeave,if:this.auth["shop:staff:staff|shop_leave"]},{text:"清空指纹信息",click:this.onClearFingerprintInfo,if:this.auth["shop:staff:staff|finger_del"]},{text:"清空硬件密码",click:this.onClearHardwarePassword,if:this.auth["shop:staff:staff|cabinet_pwd_del"]}]}},created:function(){var t=this,e=this.info.identity;e=e.map((function(t){return t.id}));var a=new Set;this.setIndentyList(["basic"],a),Array.isArray(e)&&e.length&&e.forEach((function(e){2===e?t.setIndentyList(["member","sold"],a):3===e?t.setIndentyList(["course"],a):4===e&&t.setIndentyList(["course","follow","member","sold"],a)})),this.tabList=Array.from(a).map((function(e){return t[e]}))},methods:{setIndentyList:function(t,e){var a=this;t.forEach((function(t){return e.add(t,a[t])}))},openModal:function(t){var e={bind_card:"shop-staff-bind-card",rebind_card:"shop-staff-bind-card",leave:"shop-staff-turnover",reinstate:"shop-staff-reinstatement",save:"shop-staff-re-password",position:"shop-staff-update-staff-position",salary:"shop-staff-salary-account-setting",shop_leave:"shop-staff-leave-current-shop"},a=e[t];this.$modalRouter.push({name:a,props:{staff:this.info}})},openModalBindCard:function(){this.openModal("bind_card")},openModalRebindCard:function(){this.openModal("rebind_card")},openModalLeave:function(){this.openModal("leave")},openModalReinstate:function(){this.openModal("reinstate")},openModalSave:function(){this.openModal("save")},openModalPosition:function(){this.openModal("position")},openModalSalary:function(){this.openModal("salary")},openModalShopLeave:function(){this.openModal("shop_leave")},editStaffInfo:function(){this.$router.push({name:"shop-staff-edit",query:{id:this.info.id}})},onClearFingerprintInfo:function(){var t=this;this.$confirm({title:"提示信息",content:"确认清空指纹信息？",onOk:function(){t.infoService.deleteStaffFinger(t.info.id).subscribe()}})},onClearHardwarePassword:function(){var t=this;this.$confirm({title:"提示信息",content:"确认清空硬件密码吗？",onOk:function(){t.infoService.deleteStaffCabinetPassword(t.info.id).subscribe()}})}}},p=u,m=a("2877"),h=Object(m["a"])(p,s,r,!1,null,null,null);e["default"]=h.exports},b70e:function(t,e,a){"use strict";a.r(e),a.d(e,"ListService",(function(){return C}));a("8e6e"),a("ac6a"),a("456d");var s,r,i,n,o,c,d,f=a("bd86"),l=a("75fc"),u=a("d225"),p=a("b0b4"),m=a("9ab4"),h=a("0cd5"),v=a("df29"),b=a("c4cc"),_=a("cc76"),y=a("3bc6"),g=a("2138"),S=a("2cbb"),w=a("54da"),O=a("dcb5"),j=a("e69b");function k(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,s)}return a}function x(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?k(Object(a),!0).forEach((function(e){Object(f["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):k(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var C=function(){function t(e,a,s,r,i,n){Object(u["a"])(this,t),this.shopStaffApi=e,this.roleApi=a,this.userService=s,this.authService=r,this.staffApi=i,this.message=n,this.staffList$=new v["d"]([]),this.page$=new v["d"]({}),this.roleOptions$=new v["d"]([]),this.department$=new v["d"]({}),this.identityList$=this.userService.getOptions$("staff.identity",{addAll:"全部员工职能"}),this.workStatusList$=this.userService.getOptions$("staff.work_status",{addAll:"全部在职状态"}),this.loading$=new v["d"]({}),this.auth$=this.authService.authMap$({join:"shop:staff:staff|join",add:"shop:staff:staff|add",import:"shop:staff:staff|import",export:"shop:staff:staff|export"})}return Object(p["a"])(t,[{key:"getStaffList",value:function(t){var e=this;return this.shopStaffApi.getList(t).pipe(Object(b["a"])((function(t){e.staffList$.commit((function(){return t.list})),e.page$.commit((function(){return t.page}))})))}},{key:"getStaffDepartment",value:function(){var t=this;return this.shopStaffApi.getStaffDepartmentList().pipe(Object(b["a"])((function(e){t.department$.commit((function(){return[{id:-1,name:"全部部门"}].concat(Object(l["a"])(e.department))}))})))}},{key:"getRoleList",value:function(){var t=this;return this.roleApi.getRoleOptions("shop").pipe(Object(b["a"])((function(e){t.roleOptions$.commit((function(){return[{id:-1,name:"全部角色"}].concat(Object(l["a"])(e.roles))}))})))}},{key:"deleteStaffFinger",value:function(t){var e=this;return this.staffApi.deleteStaffFinger(t).pipe(Object(b["a"])((function(t){e.message.success({content:"指纹信息清空成功"})})))}},{key:"deleteStaffCabinetPassword",value:function(t){var e=this;return this.staffApi.deleteStaffCabinetPassword(t).pipe(Object(b["a"])((function(t){e.message.success({content:"硬件密码清空成功"})})))}},{key:"beforeRouteEnter",value:function(t,e){return Object(w["a"])(this.getStaffDepartment(),this.getRoleList())}},{key:"beforeEach",value:function(t,e){var a=t.meta.query,s=a.page,r=void 0===s?1:s,i=a.size,n=void 0===i?20:i;return Object(w["a"])(this.getStaffList(x({page:r,size:n},t.query)))}}]),t}();Object(m["b"])([Object(v["c"])(),Object(m["d"])("design:type",Function),Object(m["d"])("design:paramtypes",["function"===typeof(s="undefined"!==typeof _["GetListQuery"]&&_["GetListQuery"])?s:Object]),Object(m["d"])("design:returntype",void 0)],C.prototype,"getStaffList",null),C=Object(m["b"])([Object(h["b"])(),Object(m["d"])("design:paramtypes",["function"===typeof(r="undefined"!==typeof _["g"]&&_["g"])?r:Object,"function"===typeof(i="undefined"!==typeof y["b"]&&y["b"])?i:Object,"function"===typeof(n="undefined"!==typeof g["a"]&&g["a"])?n:Object,"function"===typeof(o="undefined"!==typeof S["a"]&&S["a"])?o:Object,"function"===typeof(c="undefined"!==typeof O["k"]&&O["k"])?c:Object,"function"===typeof(d="undefined"!==typeof j["a"]&&j["a"])?d:Object])],C)},bf2e:function(t,e,a){"use strict";a.r(e),a.d(e,"AddService",(function(){return y}));var s,r,i,n,o,c=a("d225"),d=a("b0b4"),f=a("9ab4"),l=a("3bc6"),u=a("0cd5"),p=a("df29"),m=a("c4cc"),h=a("cc76"),v=a("dcb5"),b=a("54da"),_=a("e69b"),y=function(){function t(e,a,s,r){Object(c["a"])(this,t),this.message=e,this.shopStaffApi=a,this.staffApi=s,this.roleApi=r,this.codeList$=new p["d"]({}),this.roleList$=new p["d"]({}),this.department$=new p["d"]({}),this.loading$=new p["d"]({})}return Object(d["a"])(t,[{key:"getCountryCodes",value:function(){var t=this;return this.staffApi.getCountryCodes().pipe(Object(m["a"])((function(e){t.codeList$.commit((function(){var t=e.code_list;return t.length||t.push({phone_code:e.default_code,code_id:e.default_code_id}),t}))})))}},{key:"getNormalList",value:function(){var t=this;return this.roleApi.getNormalList().pipe(Object(m["a"])((function(e){t.roleList$.commit((function(){return e.roles}))})))}},{key:"getStaffDepartment",value:function(){var t=this;return this.shopStaffApi.getStaffDepartmentList().pipe(Object(m["a"])((function(e){t.department$.commit((function(){return e.department}))})))}},{key:"addStaff",value:function(t){var e=this;return this.shopStaffApi.addStaffBasicInfo(t).pipe(Object(m["a"])((function(t){e.message.success({content:"提交成功"})})))}},{key:"init",value:function(){return Object(b["a"])(this.getNormalList(),this.getCountryCodes(),this.getStaffDepartment())}},{key:"beforeRouteEnter",value:function(t,e){return this.init()}}]),t}();Object(f["b"])([Object(p["c"])(),Object(f["d"])("design:type",Function),Object(f["d"])("design:paramtypes",[]),Object(f["d"])("design:returntype",void 0)],y.prototype,"getCountryCodes",null),Object(f["b"])([Object(p["c"])(),Object(f["d"])("design:type",Function),Object(f["d"])("design:paramtypes",["function"===typeof(s="undefined"!==typeof v["AddStaffBasicInfoParams"]&&v["AddStaffBasicInfoParams"])?s:Object]),Object(f["d"])("design:returntype",void 0)],y.prototype,"addStaff",null),y=Object(f["b"])([Object(u["b"])(),Object(f["d"])("design:paramtypes",["function"===typeof(r="undefined"!==typeof _["a"]&&_["a"])?r:Object,"function"===typeof(i="undefined"!==typeof h["g"]&&h["g"])?i:Object,"function"===typeof(n="undefined"!==typeof v["k"]&&v["k"])?n:Object,"function"===typeof(o="undefined"!==typeof l["b"]&&l["b"])?o:Object])],y)},e294:function(t,e,a){"use strict";var s,r,i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("st-modal",{attrs:{title:"工资账户设置",size:"small"},on:{ok:t.onSubmit},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("staff-info",{attrs:{staff:t.staff}}),a("st-form",{attrs:{form:t.form,labelWidth:"70px"}},[a("st-form-item",{attrs:{label:"姓名",required:""}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.account_name,expression:"decorators.account_name"}],attrs:{placeholder:"请输入姓名"}})],1),a("st-form-item",{attrs:{label:"银行卡号",required:""}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.card_number,expression:"decorators.card_number"}],attrs:{placeholder:"请输入银行卡号"}})],1),a("st-form-item",{staticClass:"mg-b0",attrs:{label:"开户银行",required:""}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.bank_name,expression:"decorators.bank_name"}],staticClass:"mg-b8",attrs:{placeholder:"请输入开户银行"}})],1)],1)],1)},n=[],o=(a("8e6e"),a("ac6a"),a("456d"),a("bd86")),c=a("6e27"),d=a("d225"),f=a("b0b4"),l=a("9ab4"),u=a("0cd5"),p=a("df29"),m=a("c4cc"),h=a("cc76"),v=a("e69b"),b=function(){function t(e,a){Object(d["a"])(this,t),this.staffApi=e,this.msg=a,this.loading$=new p["d"]({}),this.accountInfo$=new p["d"]({})}return Object(f["a"])(t,[{key:"getBankInfo",value:function(t){var e=this;return this.staffApi.getBankInfo(t).pipe(Object(m["a"])((function(t){e.accountInfo$.commit((function(){return t.bank}))})))}},{key:"putStaffBindBank",value:function(t){var e=this;return this.staffApi.putStaffBindBank(t).pipe(Object(m["a"])((function(t){e.msg.success({content:"员工银行账户设置成功"})})))}}]),t}();b=Object(l["b"])([Object(u["b"])(),Object(l["d"])("design:paramtypes",["function"===typeof(s="undefined"!==typeof h["g"]&&h["g"])?s:Object,"function"===typeof(r="undefined"!==typeof v["a"]&&v["a"])?r:Object])],b);var _=function(t){return{account_name:{rules:[{required:!0,message:"请输入姓名"}]},card_number:{rules:[{required:!0,message:"请输入银行卡号"}]},bank_name:{rules:[{required:!0,message:"请输入开户银行"}]}}};function y(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,s)}return a}function g(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?y(Object(a),!0).forEach((function(e){Object(o["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):y(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var S={name:"SalaryAccountSetting",serviceInject:function(){return{salaryAccountSettingService:b}},rxState:function(){return{accountInfo:this.salaryAccountSettingService.accountInfo$}},data:function(){var t=this.$stForm.create(),e=t.decorators(_);return{form:t,decorators:e,show:!1}},props:{staff:{type:Object,default:function(){}}},components:{StaffInfo:c["a"]},methods:{getBankInfo:function(){var t=this;this.salaryAccountSettingService.getBankInfo(this.staff.id).subscribe((function(e){t.form.setFieldsValue({account_name:e.bank.account_name,card_number:e.bank.card_number,bank_name:e.bank.bank_name})}))},onSubmit:function(){var t=this;this.form.validate().then((function(e){t.salaryAccountSettingService.putStaffBindBank(g({id:t.staff.id},e)).subscribe((function(e){t.show=!1,t.$router.reload()}))}))}},mounted:function(){this.getBankInfo()}},w=S,O=a("2877"),j=Object(O["a"])(w,i,n,!1,null,null,null);e["a"]=j.exports}}]);