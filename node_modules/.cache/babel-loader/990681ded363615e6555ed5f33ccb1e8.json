{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js!/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhigang/Desktop/styd/web/src/views/biz-components/shop/cabinet/area.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/biz-components/shop/cabinet/area.vue","mtime":1601345845207},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js","mtime":1591062572376}],"contextDependencies":[],"result":["import \"core-js/modules/es6.array.sort\";\nimport \"core-js/modules/es6.number.constructor\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { MessageService } from '@/services/message.service';\nimport { PatternService } from '@/services/pattern.service';\nimport { AreaService } from \"./area.service\";\nimport CabinetModule from \"./components#/module\";\nimport { isEqual } from 'lodash-es';\nexport default {\n  name: '',\n  bem: {\n    b: 'cabinet-area'\n  },\n  serviceInject: function serviceInject() {\n    return {\n      messageService: MessageService,\n      pattern: PatternService,\n      cabinetService: AreaService\n    };\n  },\n  rxState: function rxState() {\n    return {\n      auth: this.cabinetService.auth$,\n      list: this.cabinetService.list$,\n      loading: this.cabinetService.loading$\n    };\n  },\n  components: {\n    CabinetModule: CabinetModule\n  },\n  props: {\n    value: {\n      type: [Number, String],\n      default: 0\n    }\n  },\n  data: function data() {\n    return {\n      isAdd: false,\n      addItem: {\n        id: 0,\n        area_name: ''\n      }\n    };\n  },\n  computed: {\n    areaId: {\n      set: function set(newValue, oldValue) {\n        if (isEqual(newValue, oldValue)) return;\n        this.$emit('change', newValue);\n        this.$emit('input', newValue);\n      },\n      get: function get() {\n        return this.value;\n      }\n    }\n  },\n  watch: {\n    value: function value(newV) {\n      if (!newV && this.list && this.list.length) {\n        this.init();\n      }\n    }\n  },\n  mounted: function mounted() {\n    this.init();\n  },\n  methods: {\n    init: function init(tag) {\n      var _this = this;\n\n      this.cabinetService.getList().subscribe(function (res) {\n        var list = res.list;\n        var currentArea;\n\n        if (+_this.areaId) {\n          currentArea = list.filter(function (item) {\n            return item.id === +_this.areaId;\n          })[0];\n        } else {\n          currentArea = list.length ? list[0] : {};\n        }\n\n        if (tag) {\n          _this.$emit('onlyChangeCurrentArea', currentArea);\n        } else {\n          _this.$emit('changeCurrentArea', currentArea);\n        }\n      });\n    },\n    onEditStatusChange: function onEditStatusChange(params) {\n      console.log('params', params);\n      var list = this.list.map(function (item) {\n        if (item.id === params.id) {\n          item.isEdit = true;\n        } else {\n          item.isEdit = false;\n        }\n\n        return item;\n      });\n      this.cabinetService.SET_LIST(list);\n    },\n    onAreaSortChange: function onAreaSortChange() {\n      var list = this.list.map(function (item, index) {\n        var area = {\n          id: item.id,\n          sorted: index\n        };\n        return area;\n      });\n      this.cabinetService.sort({\n        list: list\n      }).subscribe();\n    },\n    onAreaChange: function onAreaChange(id) {\n      if (this.areaId === id) return false;\n\n      if (this.isAdd) {\n        this.isAdd = false;\n      }\n\n      this.areaId = id;\n      var currentArea = this.list.filter(function (item) {\n        return item.id === id;\n      })[0];\n      this.$emit('changeCurrentArea', currentArea);\n    },\n    onMouseMove: function onMouseMove(status) {},\n    onRefresh: function onRefresh() {\n      this.init();\n    },\n    onAddStatusChange: function onAddStatusChange(status) {\n      console.log('onAddStatusChange', status);\n      this.isAdd = status;\n    },\n    onAddArea: function onAddArea() {\n      this.isAdd = true;\n    }\n  }\n};",{"version":3,"sources":["area.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div :class=\"b()\">\n    <div :class=\"b('title')\">\n      <div :class=\"b('title-main')\">\n        <div :class=\"b('title-main-desc')\">\n          区域\n        </div>\n        <st-button v-if=\"auth.areaAdd\" type=\"primary\" @click=\"onAddArea\">\n          新增区域\n        </st-button>\n      </div>\n      <div :class=\"b('title-sub')\">支持拖动排序</div>\n    </div>\n    <a-spin :spinning=\"loading.getList\">\n      <div v-if=\"isAdd\">\n        <cabinet-module\n          :info=\"addItem\"\n          :isActive=\"false\"\n          isAdd\n          @refresh=\"onRefresh\"\n          @onAddStatusChange=\"onAddStatusChange\"\n        ></cabinet-module>\n      </div>\n      <st-draggable\n        v-model=\"list\"\n        :animation=\"200\"\n        @change=\"onAreaSortChange\"\n        handle=\".st-cabinet-area--canDrag\"\n      >\n        <div\n          v-for=\"item in list\"\n          :key=\"item.id\"\n          @click=\"onAreaChange(item.id)\"\n          @mouseMove=\"onMouseMove\"\n        >\n          <cabinet-module\n            :info=\"item\"\n            :isActive=\"item.id === areaId\"\n            @refresh=\"onRefresh\"\n            @onEditStatusChange=\"onEditStatusChange\"\n          ></cabinet-module>\n        </div>\n      </st-draggable>\n    </a-spin>\n  </div>\n</template>\n\n<script>\nimport { MessageService } from '@/services/message.service'\nimport { PatternService } from '@/services/pattern.service'\nimport { AreaService } from './area.service'\nimport CabinetModule from './components#/module'\n\nimport { isEqual } from 'lodash-es'\nexport default {\n  name: '',\n\n  bem: {\n    b: 'cabinet-area'\n  },\n\n  serviceInject() {\n    return {\n      messageService: MessageService,\n      pattern: PatternService,\n      cabinetService: AreaService\n    }\n  },\n  rxState() {\n    return {\n      auth: this.cabinetService.auth$,\n      list: this.cabinetService.list$,\n      loading: this.cabinetService.loading$\n    }\n  },\n\n  components: {\n    CabinetModule\n  },\n\n  props: {\n    value: {\n      type: [Number, String],\n      default: 0\n    }\n  },\n\n  data() {\n    return {\n      isAdd: false,\n      addItem: {\n        id: 0,\n        area_name: ''\n      }\n    }\n  },\n\n  computed: {\n    areaId: {\n      set(newValue, oldValue) {\n        if (isEqual(newValue, oldValue)) return\n        this.$emit('change', newValue)\n        this.$emit('input', newValue)\n      },\n      get() {\n        return this.value\n      }\n    }\n  },\n  watch: {\n    value(newV) {\n      if (!newV && this.list && this.list.length) {\n        this.init()\n      }\n    }\n  },\n\n  mounted() {\n    this.init()\n  },\n\n  methods: {\n    init(tag) {\n      this.cabinetService.getList().subscribe(res => {\n        let list = res.list\n        let currentArea\n        if (+this.areaId) {\n          currentArea = list.filter(item => item.id === +this.areaId)[0]\n        } else {\n          currentArea = list.length ? list[0] : {}\n        }\n        if (tag) {\n          this.$emit('onlyChangeCurrentArea', currentArea)\n        } else {\n          this.$emit('changeCurrentArea', currentArea)\n        }\n      })\n    },\n    onEditStatusChange(params) {\n      console.log('params', params)\n      let list = this.list.map(item => {\n        if (item.id === params.id) {\n          item.isEdit = true\n        } else {\n          item.isEdit = false\n        }\n        return item\n      })\n      this.cabinetService.SET_LIST(list)\n    },\n    onAreaSortChange() {\n      let list = this.list.map((item, index) => {\n        let area = {\n          id: item.id,\n          sorted: index\n        }\n        return area\n      })\n      this.cabinetService\n        .sort({\n          list\n        })\n        .subscribe()\n    },\n    onAreaChange(id) {\n      if (this.areaId === id) return false\n      if (this.isAdd) {\n        this.isAdd = false\n      }\n      this.areaId = id\n      let currentArea = this.list.filter(item => item.id === id)[0]\n      this.$emit('changeCurrentArea', currentArea)\n    },\n    onMouseMove(status) {},\n    onRefresh() {\n      this.init()\n    },\n    onAddStatusChange(status) {\n      console.log('onAddStatusChange', status)\n      this.isAdd = status\n    },\n    onAddArea() {\n      this.isAdd = true\n    }\n  }\n}\n</script>\n"],"sourceRoot":"src/views/biz-components/shop/cabinet"}]}