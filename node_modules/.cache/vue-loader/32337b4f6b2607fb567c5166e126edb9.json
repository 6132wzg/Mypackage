{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhigang/Desktop/styd/web/src/views/pages/shop/reception/reserve/course.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/pages/shop/reception/reserve/course.vue","mtime":1595230476682},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js","mtime":1591062572376}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport tableMixin from '@/mixins/table.mixin'\nimport { mainColumns, childColumns } from './course.config'\nimport { CourseService } from './course.service'\nimport CustomRadioGroup from '@/views/biz-components/custom-radio-group/custom-radio-group'\nimport moment from 'moment'\n\nexport default {\n  name: '',\n\n  bem: {\n    b: 'shop-reception-reserve-course'\n  },\n\n  components: { CustomRadioGroup },\n\n  modals: {},\n\n  serviceInject() {\n    return {\n      courseService: CourseService\n    }\n  },\n\n  rxState() {\n    const { courseService } = this\n    return {\n      list: courseService.list$,\n      page: courseService.page$,\n      loading: courseService.loading$,\n      auth: courseService.auth$,\n      courseTypeOptions: courseService.courseTypeOptions$,\n      reserveStatusOptions: courseService.reserveStatusOptions$,\n      checkinOptions: courseService.checkinOptions$\n    }\n  },\n\n  mixins: [tableMixin],\n\n  props: {},\n\n  data() {\n    return {\n      reserveQuery: {\n        end_time: '',\n        search_date: 1,\n        start_time: ''\n      }\n    }\n  },\n\n  computed: {\n    mainColumns,\n    childColumns\n  },\n\n  mounted() {},\n\n  methods: {\n    moment,\n    recentChange(data) {\n      const start_time = data.start_time\n        ? `${data.start_time.format('YYYY-MM-DD')} 00:00`\n        : ''\n      const end_time = data.end_time\n        ? `${data.end_time.format('YYYY-MM-DD')} 23:59`\n        : ''\n      let recent = data.recent\n      this.$searchQuery.search_date = data.recent || undefined\n      this.$searchQuery.start_time = start_time || undefined\n      this.$searchQuery.end_time = end_time || undefined\n      if (this.$searchQuery.start_time || this.$searchQuery.end_time) {\n        this.$searchQuery.search_date = undefined\n        recent = undefined\n      }\n      this.reserveQuery = {\n        start_time: start_time,\n        end_time: end_time,\n        search_date: recent\n      }\n      this.onMultiSearch(this.reserveQuery)\n      // console.log('query', this.query)\n      // console.log('$searchQuery', this.$searchQuery)\n      // this.onSearch()\n    },\n    getCourseForm(record, index) {\n      const { id, member } = record\n      let reserve_type = this.list[index].sub_reserve_type\n      return {\n        id: member.id,\n        reserve_type: reserve_type.id,\n        reserve_id: id\n      }\n    },\n    // 取消签到\n    cancelBooking(record, index) {\n      let params = this.getCourseForm(record, index)\n      this.courseService.cancelVisitReserve(params).subscribe(res => {\n        this.$router.reload()\n      })\n    },\n    // 签到\n    booking(record, index) {\n      let params = this.getCourseForm(record, index)\n      this.courseService.confirmVisitReserve(params).subscribe(res => {\n        this.$router.reload()\n      })\n    },\n    onPrint(id) {\n      window.open('/ticket/print?id=' + id, '_blank', 'width=800,height=600')\n    },\n    onSearch() {\n      this.$router.push({ query: this.$searchQuery })\n    }\n  }\n}\n",null]}