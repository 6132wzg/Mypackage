{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/thread-loader/dist/cjs.js!/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js!/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhigang/Desktop/styd/web/src/views/biz-components/shop-hour-picker/shop-hour-picker.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/biz-components/shop-hour-picker/shop-hour-picker.vue","mtime":1597396799925},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/thread-loader/dist/cjs.js","mtime":1591062572352},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js","mtime":1591062572376}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.regexp.replace\";\nimport \"core-js/modules/es6.number.constructor\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { SLIDER, WEEK_NO_SELF, WEEK, TIMER } from \"./shop-hour-picker.config\";\nimport { constant, cloneDeep, difference } from 'lodash-es';\nimport DateSlider from '@/views/biz-components/date-slider/date-slider';\nexport default {\n  name: 'StShopHourPicker',\n  bem: {\n    ShopHourPicker: 'st-shop-hour-picker'\n  },\n  components: {\n    DateSlider: DateSlider\n  },\n  model: {\n    prop: 'value',\n    event: 'ShopHourPickerChange'\n  },\n  props: {\n    // TODO: shop hour picker后续修改，不能有默认值\n    value: {\n      type: Array,\n      default: function _default() {\n        return [];\n      }\n    },\n    isInfo: {\n      type: Boolean,\n      default: false\n    },\n    min: {\n      type: Number,\n      default: 0\n    },\n    max: {\n      type: Number,\n      default: 24\n    },\n    step: {\n      type: Number,\n      default: 0.5\n    }\n  },\n  data: function data() {\n    return {\n      defaultWeekList: WEEK,\n      time: TIMER,\n      slider: cloneDeep(SLIDER),\n      copeSlider: {},\n      // 复制到功能需要,为中间值\n      weekSelects: [],\n      isInit: true\n    };\n  },\n  computed: {\n    currentTime: function currentTime() {\n      return this.time[this.isInfo ? 'info' : 'edit'];\n    }\n  },\n  watch: {\n    slider: {\n      handler: function handler(n, o) {\n        var _this = this;\n\n        // console.log('slider 变化', n, o)\n        var value = this.slider.filter(function (item) {\n          return item.show;\n        });\n        value = value.map(function (item) {\n          return {\n            week_day: item.week_day,\n            range: item.range,\n            start_time: _this.timeFilter(item.value[0]),\n            end_time: _this.timeFilter(item.value[1])\n          };\n        });\n        this.$emit('ShopHourPickerChange', value);\n      },\n      deep: true\n    },\n    weekSelects: function weekSelects(n, o) {\n      if (this.isInit) return; // console.log('weekSelects', n, o)\n\n      if (n.length === o.length) return;\n      n.length > o.length ? this.addSlider(n, o) : this.removeSlider(n, o);\n    }\n  },\n  created: function created() {\n    var _this2 = this;\n\n    this.$nextTick(function () {\n      _this2.init();\n    });\n  },\n  methods: {\n    // 获取日期选择数组\n    init: function init() {\n      // console.log('init', this.value)\n      this.weekSelects = this.value.map(function (item) {\n        return item.week_day;\n      });\n      if (this.weekSelects.length) this.getSliderInfoList();else this.isInit = false;\n    },\n    // 获取的数据对格式进行处理\n    getSliderInfoList: function getSliderInfoList() {\n      var _this3 = this;\n\n      // console.log('获取的数据对格式进行处理 => value', this.value)\n      this.value.map(function (item) {\n        var week_day = cloneDeep(item.week_day);\n        var index = --week_day;\n        _this3.slider[index].value = [item.start_time.replace(/:00/gi, '').replace(/:30/gi, '.5') - 0, item.end_time.replace(/:00/gi, '').replace(/:30/gi, '.5') - 0];\n        _this3.slider[index].show = true;\n        _this3.slider[index].range = cloneDeep(item.range); // console.log('sliderByweekDay end', this.slider[index].value)\n      });\n      this.isInit = false; // console.log('根据value值,设置slider => slider', this.slider)\n    },\n    // 新增slider\n    addSlider: function addSlider(n, o) {\n      var _this4 = this;\n\n      var index = difference(n, o); // console.log('addSlider', index)\n\n      index.forEach(function (i) {\n        var endIndex = --i;\n        if (_this4.slider[endIndex].show) return;\n        _this4.slider[endIndex].show = true;\n        _this4.slider[endIndex].value = [10, 24];\n      });\n    },\n    // 删除slider\n    removeSlider: function removeSlider(n, o) {\n      var _this5 = this;\n\n      var index = difference(o, n);\n      index.forEach(function (i) {\n        var endIndex = --i;\n        _this5.slider[endIndex].show = false;\n        _this5.slider[endIndex].value = [];\n      });\n    },\n    // 时间过滤器\n    timeFilter: function timeFilter(time) {\n      return /^\\d+$/.test(time) && time >= 10 ? time + ':00' : /^\\d+$/.test(time) && time < 10 ? '0' + time + ':00' : !/^\\d+$/.test(time) && time < 10 ? '0' + (time + '').replace(/.5/gi, ':30') : (time + '').replace(/.5/gi, ':30') + '';\n    },\n    // tooltip格式处理\n    formatter: function formatter(value) {\n      var valueHalf = value >= 10 ? \"\".concat(parseInt(value), \":30\") : \"0\".concat(parseInt(value), \":30\");\n      var valueInt = value >= 10 ? \"\".concat(value, \":00\") : \"0\".concat(value, \":00\");\n      return value % 1 === 0 ? valueInt : valueHalf;\n    },\n    onChange: function onChange(sliders) {\n      var _this6 = this;\n\n      Array.isArray(sliders) && sliders.forEach(function (key) {\n        if (_this6.slider[key]) _this6.slider[key].value = _this6.copeSlider.value;\n      });\n    },\n    copyTo: function copyTo(item, index) {\n      this.copeSlider = cloneDeep(item);\n      var week = cloneDeep(WEEK_NO_SELF); // WEEK_NO_SELF中对应weekArr中的值设置为true,非对应的或\n\n      this.weekSelects.forEach(function (selectWeekDay) {\n        if (selectWeekDay !== item.week_day) {\n          week[selectWeekDay - 1] = true;\n        }\n      });\n      item.week = week;\n    }\n  },\n  filters: {\n    filterWeekDay: function filterWeekDay(value) {\n      var filterValue = --value;\n      return WEEK[filterValue] && WEEK[filterValue]['label'];\n    },\n    filterOperation: function filterOperation(value) {\n      return WEEK[value] && WEEK[value]['label'];\n    }\n  },\n  beforeDestory: function beforeDestory() {\n    this.weekSelects = [];\n    this.init = true; // console.log('beforeDestory')\n  }\n};",null]}