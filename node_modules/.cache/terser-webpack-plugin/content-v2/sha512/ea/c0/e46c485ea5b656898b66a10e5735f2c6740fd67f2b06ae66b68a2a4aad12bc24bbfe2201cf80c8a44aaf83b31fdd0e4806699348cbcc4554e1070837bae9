{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"brand-marketing-plugin-invitation-index\"],{\"25e1\":function(t,e,n){\"use strict\";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n(\"div\",{class:t.coupon()},[n(\"span\",[t._v(t._s(t.name))]),n(\"st-icon\",{staticClass:\"mg-l8 cursor-pointer\",attrs:{type:\"anticon:close\"},on:{click:t.onClose}})],1)},o=[],a={name:\"StCoupon\",bem:{coupon:\"st-coupon\"},props:{name:{type:String,required:!0}},methods:{onClose:function(){this.$emit(\"close\")}}},s=a,r=n(\"2877\"),c=Object(r[\"a\"])(s,i,o,!1,null,null,null);e[\"a\"]=c.exports},\"48ee\":function(t,e,n){\"use strict\";n.r(e);var i,o,a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n(\"div\",{class:t.inviation()},[n(\"st-form\",{attrs:{form:t.form,labelWidth:\"108px\"}},[t.auth.add?n(\"st-form-item\",{attrs:{label:\"功能开关\",required:\"\"}},[n(\"st-switch\",{on:{change:t.onOpenStatusChange},model:{value:t.openStatus,callback:function(e){t.openStatus=e},expression:\"openStatus\"}}),n(\"span\",{staticClass:\"mg-l12 mg-r12\"},[t._v(t._s(t.openStatus?\"已\":\"未\")+\"开启\")]),t.openStatus?t._e():n(\"span\",[t._v(\"\\n        （一旦开启，将会在小程序展示，如需关闭，请谨慎操作。）\\n      \")])],1):t._e(),t.openStatus?[n(\"st-form-item\",{attrs:{label:\"成功规则\"}},[t._v(\"\\n        每邀请1人成功购买卡项或课程（成功支付）\\n      \")]),t.isOpen?[n(\"st-form-item\",{attrs:{label:\"邀请人奖励\",required:\"\",help:t.inviterHelpText}},[n(\"div\",{class:t.inviation(\"coupon\")},[n(\"span\",{staticClass:\"mg-r8\"},[t._v(\"可获得\")]),n(\"st-input-number\",{staticStyle:{width:\"142px\"},attrs:{min:1,max:99},model:{value:t.inviterCouponNum,callback:function(e){t.inviterCouponNum=e},expression:\"inviterCouponNum\"}},[n(\"span\",{attrs:{slot:\"addonAfter\"},slot:\"addonAfter\"},[t._v(\"张\")])]),n(\"span\",{staticClass:\"mg-l24 mg-r8\"},[t._v(\"选择券\")]),n(\"coupon-tag\",{key:\"3\",staticClass:\"mg-r8\",attrs:{name:t.inviterCoupon.coupon_name?t.inviterCoupon.coupon_name:\"\"},on:{close:function(e){return t.onEditCoupon(\"inviter\")}}})],1)]),n(\"st-form-item\",{attrs:{label:\"被邀请人奖励\",required:\"\",help:t.inviteeHelpText}},[n(\"div\",{class:t.inviation(\"coupon\")},[n(\"span\",{staticClass:\"mg-r8\"},[t._v(\"可获得\")]),n(\"st-input-number\",{staticStyle:{width:\"142px\"},attrs:{min:1,max:99},model:{value:t.inviteeCouponNum,callback:function(e){t.inviteeCouponNum=e},expression:\"inviteeCouponNum\"}},[n(\"span\",{attrs:{slot:\"addonAfter\"},slot:\"addonAfter\"},[t._v(\"张\")])]),n(\"span\",{staticClass:\"mg-l24 mg-r8\"},[t._v(\"选择券\")]),n(\"coupon-tag\",{key:\"3\",staticClass:\"mg-r8\",attrs:{name:t.inviteeCoupon.coupon_name?t.inviteeCoupon.coupon_name:\"\"},on:{close:function(e){return t.onEditCoupon(\"invitee\")}}})],1)])]:[n(\"st-form-item\",{attrs:{label:\"邀请人奖励\",required:\"\",help:t.inviterHelpText}},[n(\"div\",{class:t.inviation(\"coupon\")},[n(\"span\",{staticClass:\"mg-r8\"},[t._v(\"可获得\")]),n(\"st-input-number\",{staticStyle:{width:\"142px\"},attrs:{min:1,max:99},model:{value:t.inviterCouponNum,callback:function(e){t.inviterCouponNum=e},expression:\"inviterCouponNum\"}},[n(\"span\",{attrs:{slot:\"addonAfter\"},slot:\"addonAfter\"},[t._v(\"张\")])]),n(\"span\",{staticClass:\"mg-l24 mg-r8\"},[t._v(\"选择券\")]),t.inviterCoupon.id?[n(\"coupon-tag\",{key:\"1\",staticClass:\"mg-r8\",attrs:{name:t.inviterCoupon.coupon_name?t.inviterCoupon.coupon_name:\"\"},on:{close:function(e){return t.onClose(\"inviter\")}}}),n(\"st-button\",{on:{click:function(e){return t.onEditCoupon(\"inviter\")}}},[t._v(\"\\n                重新选择\\n              \")])]:[n(\"st-button\",{attrs:{icon:\"anticon:plus\"},on:{click:function(e){return t.onAddCoupon(\"inviter\")}}},[t._v(\"\\n                新增券\\n              \")])]],2)]),n(\"st-form-item\",{attrs:{label:\"被邀请人奖励\",required:\"\",help:t.inviteeHelpText}},[n(\"div\",{class:t.inviation(\"coupon\")},[n(\"span\",{staticClass:\"mg-r8\"},[t._v(\"可获得\")]),n(\"st-input-number\",{staticStyle:{width:\"142px\"},attrs:{min:1,max:99},model:{value:t.inviteeCouponNum,callback:function(e){t.inviteeCouponNum=e},expression:\"inviteeCouponNum\"}},[n(\"span\",{attrs:{slot:\"addonAfter\"},slot:\"addonAfter\"},[t._v(\"张\")])]),n(\"span\",{staticClass:\"mg-l24 mg-r8\"},[t._v(\"选择券\")]),t.inviteeCoupon.id?[n(\"coupon-tag\",{key:\"2\",staticClass:\"mg-r8\",attrs:{name:t.inviteeCoupon.coupon_name?t.inviteeCoupon.coupon_name:\"\"},on:{close:function(e){return t.onClose(\"invitee\")}}}),n(\"st-button\",{on:{click:function(e){return t.onEditCoupon(\"invitee\")}}},[t._v(\"\\n                重新选择\\n              \")])]:[n(\"st-button\",{attrs:{icon:\"anticon:plus\"},on:{click:function(e){return t.onAddCoupon(\"invitee\")}}},[t._v(\"\\n                新增券\\n              \")])]],2)])],n(\"st-form-item\",{attrs:{label:\"邀请海报\"}},[n(\"st-invitation-bg-radio\",{model:{value:t.invite_poster,callback:function(e){t.invite_poster=e},expression:\"invite_poster\"}})],1),t.auth.edit?n(\"st-form-item\",{attrs:{\"label-fix\":\"\"}},[n(\"st-button\",{attrs:{type:\"primary\",loading:t.loading.edit||t.loading.add},on:{click:t.onSubmit}},[t._v(\"\\n          保存\\n        \")]),n(\"st-button\",{staticClass:\"mg-l16\",on:{click:t.onConfigHandle}},[t._v(\"\\n          配置到小程序\\n        \")])],1):t._e()]:t._e()],2)],1)},s=[],r=(n(\"8e6e\"),n(\"ac6a\"),n(\"456d\"),n(\"bd86\")),c=n(\"57e8\"),u=n(\"5c8a\"),d=n(\"c542\"),p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n(\"div\",{class:t.cardRadio()},[n(\"a-radio-group\",{model:{value:t.radioIndex,callback:function(e){t.radioIndex=e},expression:\"radioIndex\"}},[t._l(t.cardBgList,(function(t,e){return n(\"a-radio\",{key:e,class:t.className,attrs:{value:t.index}})})),n(\"a-radio\",{attrs:{value:0}},[t._v(\"自定义背景\")])],2),n(\"div\",{class:t.cardRadio(\"image\")},[0!==t.radioIndex&&t.cardBgList[t.bgIndex]?n(\"img\",{directives:[{name:\"viewer\",rawName:\"v-viewer\",value:{url:\"data-src\",toolbar:!1},expression:\"{ url: 'data-src', toolbar: false }\"}],attrs:{src:t._f(\"imgFilter\")(t.cardBgList[t.bgIndex].image_url,{w:192,h:108}),\"data-src\":t._f(\"imgFilter\")(t.cardBgList[t.bgIndex].image_url,{w:1e3}),width:\"192\",height:\"108\",alt:\"邀请有礼背景\"}}):n(\"div\",{class:t.cardRadio(\"upload\")},[n(\"st-image-upload\",{attrs:{width:\"192px\",height:\"108px\",cropperModal:t.cropperModal,maskOptions:t.maskOptions,list:t.fileList,sizeLimit:2,placeholder:\"上传照片\"},on:{change:t.imageUploadChange}}),n(\"div\",{class:t.cardRadio(\"describe\")},[t._m(0),t._m(1)])],1)])],1)},l=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n(\"p\",[n(\"span\",[t._v(\"1.\")]),n(\"span\",[t._v(\"\\n            图片格式必须为：png,bmp,jpeg,jpg,gif,建议使用png格\\n            式图片，以保存最佳效果\\n          \")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n(\"p\",[n(\"span\",[t._v(\"2.\")]),n(\"span\",[t._v(\"建议尺寸为750像素X1334像素， 不可大于2M\")])])}],v=(n(\"28a5\"),n(\"7ce1\")),m=n(\"2138\"),g=[\"first custom\",\"second custom\",\"third custom\",\"fourth custom\"],h={name:\"StInvitationBgRadio\",bem:{cardRadio:\"invitation-bg-radio\"},components:{StImageUpload:v[\"a\"]},serviceInject:function(){return{userService:m[\"a\"]}},rxState:function(){return{pluginEnums:this.userService.getOptions$(\"plugin.invite_poster\")}},created:function(){this.init()},computed:{bgIndex:function(){return 0===this.radioIndex?4:this.radioIndex-1},cardBgList:function(){var t=[];return this.invite_poster.forEach((function(e,n){e.className=g[n],e.index=++n,t.push(e)})),t}},data:function(){return{cropperModal:{cropper:{aspectRatio:.6}},maskOptions:{flag:!0,width:750,height:1334,maskUrl:\"https://styd-saas-test.oss-cn-shanghai.aliyuncs.com/image/default/bg-invitation-4.png\"},invite_poster:this.pluginEnums,list:[],radioIndex:1,cardBg:{image_id:0,image_key:this.pluginEnums[0].image_key,image_url:this.pluginEnums[0].image_url,index:1},customCardBg:{image_id:0,image_key:\"\",image_url:\"\",index:0},fileList:[]}},watch:{value:{handler:function(t){this.setdata(t)},deep:!0},radioIndex:function(t){if(0===t)this.cardBg=Object(u[\"a\"])(this.customCardBg);else{var e=t;--e,this.cardBg=Object(u[\"a\"])(this.invite_poster[e]),this.cardBg.index=t}this.$emit(\"input\",this.cardBg),this.$emit(\"change\",this.cardBg)}},props:{value:{type:Object,default:function(){return{image_id:0,image_key:\"\",image_url:\"\",index:1}}}},mounted:function(){this.setRadioColor()},methods:{init:function(){this.list=Object(u[\"a\"])(this.invite_poster),this.setdata(this.value)},setRadioColor:function(){var t=\"\";this.cardBgList.forEach((function(e){t+=\"\\n          .invitation-bg-radio .\".concat(e.className.split(\"custom\")[0],\"\\n          .ant-radio-inner::after {\\n            background-color: \").concat(e.color,\";\\n          }\\n        \")}));var e=document.createElement(\"style\");e.innerHTML=t,document.head.appendChild(e)},setdata:function(t){if(this.radioIndex=t.index,0===t.index)this.customCardBg=Object(u[\"a\"])(t),t.image_url&&(this.fileList=[{image_id:t.image_id,image_url:t.image_url}]);else{this.invite_poster=Object(u[\"a\"])(this.list);var e=t.index;--e,this.invite_poster[e].image_id=t.image_id}},imageUploadChange:function(t){t.length?this.customCardBg={image_id:t[0].image_id,image_key:t[0].image_key,image_url:t[0].image_url,image_host:t[0].image_host,index:0}:(this.fileList=[],this.customCardBg={image_id:0,image_key:\"\",image_url:\"\",image_host:\"\",index:0}),this.cardBg=Object(u[\"a\"])(this.customCardBg),this.$emit(\"input\",this.cardBg),this.$emit(\"change\",this.cardBg)}}},f=h,b=n(\"2877\"),_=Object(b[\"a\"])(f,p,l,!1,null,null,null),y=_.exports,O=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n(\"st-modal\",{attrs:{title:\"选择优惠券\",wrapClassName:\"modal-marketing-add-coupon\"},model:{value:t.show,callback:function(e){t.show=e},expression:\"show\"}},[n(\"div\",{class:t.add(\"content\")},[n(\"div\",{staticClass:\"mg-b24\",class:t.add(\"content-search\")},[n(\"st-input-search\",{staticStyle:{width:\"291px\"},attrs:{placeholder:\"输入优惠券名称\"},on:{search:t.onSearch}}),n(\"st-button\",{attrs:{type:\"primary\"},on:{click:t.onGoCouponList}},[t._v(\"优惠券列表\")])],1),n(\"div\",{directives:[{name:\"scrollBar\",rawName:\"v-scrollBar\",value:{stopPropagation:!0},expression:\"{ stopPropagation: true }\"}],class:t.add(\"table\")},[n(\"st-table\",{attrs:{size:\"middle\",rowSelection:{selectedRowKeys:t.selectedRowKeys,type:\"radio\",columnTitle:\" \",onChange:t.onSelectChange},columns:t.columns,dataSource:t.list,pagination:!1,rowKey:\"id\"},scopedSlots:t._u([{key:\"is_shop_range\",fn:function(e,n){return[t._v(\"\\n          \"+t._s(e===t.COUPON.IS_SHOP_RANGE?\"全门店\":n.shop_num+\"家\")+\"\\n        \")]}},{key:\"price\",fn:function(e){return[t._v(t._s(e)+\"元\")]}},{key:\"use_type\",fn:function(e,n){return[t._v(\"\\n          \"+t._s(e===t.COUPON.USE_TYPE?\"无门槛\":\"满\"+n.full_price+\"元使用\")+\"\\n        \")]}}])})],1)]),n(\"template\",{slot:\"footer\"},[n(\"st-button\",{on:{click:function(e){t.show=!1}}},[t._v(\"取消\")]),n(\"st-button\",{attrs:{disabled:!t.selectedRows.length,type:\"primary\"},on:{click:t.onSubmit}},[t._v(\"\\n      确定\\n    \")])],1)],2)},C=[],S=(n(\"c5f6\"),n(\"d225\")),I=n(\"b0b4\"),x=n(\"9ab4\"),j=n(\"0cd5\"),k=n(\"df29\"),w=n(\"7aeb\"),R=n(\"c4cc\"),$=function(){function t(e){Object(S[\"a\"])(this,t),this.marketingApi=e,this.loading$=new k[\"d\"]({}),this.list$=new k[\"d\"]([])}return Object(I[\"a\"])(t,[{key:\"getList\",value:function(t){var e=this;return this.marketingApi.getInviteCouponList(t).pipe(Object(R[\"a\"])((function(t){e.list$.commit((function(){return t.list}))})))}}]),t}();Object(x[\"b\"])([Object(k[\"c\"])(),Object(x[\"d\"])(\"design:type\",Function),Object(x[\"d\"])(\"design:paramtypes\",[\"function\"===typeof(i=\"undefined\"!==typeof w[\"InviteCouponListInput\"]&&w[\"InviteCouponListInput\"])?i:Object]),Object(x[\"d\"])(\"design:returntype\",void 0)],$.prototype,\"getList\",null),$=Object(x[\"b\"])([Object(j[\"b\"])(),Object(x[\"d\"])(\"design:paramtypes\",[\"function\"===typeof(o=\"undefined\"!==typeof w[\"d\"]&&w[\"d\"])?o:Object])],$);var E,P=function(t){return[{title:\"优惠券名称\",dataIndex:\"coupon_name\",scopedSlots:{customRender:\"coupon_name\"}},{title:\"可用门店\",dataIndex:\"is_shop_range\",scopedSlots:{customRender:\"is_shop_range\"}},{title:\"面额\",dataIndex:\"price\",scopedSlots:{customRender:\"price\"}},{title:\"门槛\",dataIndex:\"use_type\",scopedSlots:{customRender:\"use_type\"}},{title:\"剩余数量\",dataIndex:\"margin\",scopedSlots:{customRender:\"margin\"}}]};(function(t){t[t[\"IS_SHOP_RANGE\"]=1]=\"IS_SHOP_RANGE\",t[t[\"USE_TYPE\"]=1]=\"USE_TYPE\"})(E||(E={}));var L={name:\"ModalMarketingAddCoupon\",bem:{add:\"modal-marketing-add-coupon\"},serviceInject:function(){return{addCouponService:$}},rxState:function(){return{loading:this.addCouponService.loading$,list:this.addCouponService.list$}},props:{id:{type:Number}},data:function(){return{COUPON:E,show:!1,selectedRowKeys:[],selectedRows:[]}},computed:{columns:P},mounted:function(){this.getList({coupon_name:\"\"})},methods:{onGoCouponList:function(){this.show=!1,this.$router.push({path:\"/brand/marketing/plugin/coupon/list\"})},getList:function(t){var e=this;this.addCouponService.getList(t).subscribe((function(t){e.list.some((function(t){return t.id===e.id}))?(e.selectedRowKeys=[e.id],e.selectedRows=Object(u[\"a\"])(e.list.filter((function(t){return t.id===e.id})))):(e.selectedRowKeys=[],e.selectedRows=[])}))},onSearch:function(t){this.getList({coupon_name:t})},onSelectChange:function(t,e){this.selectedRowKeys=t,this.selectedRows=e},onSubmit:function(){this.show=!1,this.$emit(\"success\",{coupon:this.selectedRows[0]})}}},A=L,T=Object(b[\"a\"])(A,O,C,!1,null,null,null),N=T.exports,B=n(\"25e1\");function H(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function M(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?H(Object(n),!0).forEach((function(e){Object(r[\"a\"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var U={name:\"PageBrandMarketingInviationSetting\",bem:{inviation:\"page-brand-marketing-inviation-setting\"},modals:{MarketingAddCoupon:N},serviceInject:function(){return{settingService:c[\"SettingService\"],indexService:d[\"IndexService\"]}},rxState:function(){return{isOpen:this.indexService.isOpen$,loading:this.settingService.loading$,settingInfo:this.settingService.settingInfo$,auth:this.settingService.auth$}},data:function(){return{settingInfoHistory:null,form:this.$form.createForm(this),openStatus:1,inviteeCoupon:{},inviteeHelpText:\"\",inviteeCouponNum:void 0,inviterCoupon:{},inviterHelpText:\"\",inviterCouponNum:void 0,invite_poster:{image_id:0,image_key:\"image/VZ0RGBwTX7FA1yKb.png\",image_url:\"\",index:1}}},computed:{inviteeIsOk:function(){return\"\"===this.inviteeHelpText},inviterIsOk:function(){return\"\"===this.inviterHelpText}},watch:{settingInfo:{deep:!0,handler:function(){this.init()}}},methods:{onConfigHandle:function(){this.$router.push({path:\"/brand/setting/mina/index\"})},init:function(){this.settingInfoHistory=Object(u[\"a\"])(this.settingInfo),this.inviteeHelpText=\"\",this.inviterHelpText=\"\",this.openStatus=1===this.settingInfo.activity_status?1:0,this.settingInfo.invitee_coupon_id&&(this.inviterCoupon={id:this.settingInfo.inviter_coupon_id,coupon_name:this.settingInfo.inviter_coupon_name},this.inviterCouponNum=this.settingInfo.inviter_coupon_num,this.inviteeCoupon={id:this.settingInfo.invitee_coupon_id,coupon_name:this.settingInfo.invitee_coupon_name},this.inviteeCouponNum=this.settingInfo.invitee_coupon_num,this.invite_poster=this.settingInfo.invite_poster)},onOpenStatusChange:function(t){var e=this;!t&&1===this.settingInfoHistory.activity_status&&this.settingInfoHistory.invitee_coupon_id&&this.$confirm({title:\"提示\",content:\"一旦关闭，全部推广功能将失效，请谨慎操作。\",onCancel:function(){e.openStatus=1},onOk:function(){var t=M({},e.settingInfoHistory,{activity_status:2});return e.settingService.edit(t).toPromise().then((function(){e.$router.push({path:\"/brand/marketing/plugin/invitation/index/data\"})}))}})},onValidate:function(t){this[\"\".concat(t,\"Coupon\")]?this[\"\".concat(t,\"CouponNum\")]?this[\"\".concat(t,\"HelpText\")]=\"\":this[\"\".concat(t,\"HelpText\")]=\"请输入优惠券数量\":this[\"\".concat(t,\"HelpText\")]=\"请选择优惠券\"},onAddCoupon:function(t){var e=this;this.$modalRouter.push({name:\"marketing-add-coupon\",on:{success:function(n){e[\"\".concat(t,\"Coupon\")]=Object(u[\"a\"])(n.coupon)}}})},onEditCoupon:function(t){var e=this;this.$modalRouter.push({name:\"marketing-add-coupon\",props:{id:this[\"\".concat(t,\"Coupon\")].id},on:{success:function(n){e[\"\".concat(t,\"Coupon\")]=Object(u[\"a\"])(n.coupon)}}})},onClose:function(t){this[\"\".concat(t,\"Coupon\")]={}},onSubmit:function(){var t=this;if(this.onValidate(\"invitee\"),this.onValidate(\"inviter\"),this.inviteeIsOk&&this.inviterIsOk){var e=this.isOpen?\"edit\":\"add\";this.settingService[e]({activity_status:this.openStatus?1:2,inviter_coupon_id:this.inviterCoupon.id,inviter_coupon_num:+this.inviterCouponNum,invitee_coupon_id:this.inviteeCoupon.id,invitee_coupon_num:+this.inviteeCouponNum,invite_poster:this.invite_poster}).subscribe((function(){t.$router.push({path:\"./data\"})}))}}},mounted:function(){this.init()},components:{StInvitationBgRadio:y,CouponTag:B[\"a\"]}},D=U,G=Object(b[\"a\"])(D,a,s,!1,null,null,null);e[\"default\"]=G.exports},\"55ab\":function(t,e,n){\"use strict\";n.r(e),n.d(e,\"DataService\",(function(){return l}));n(\"456d\"),n(\"ac6a\");var i,o=n(\"d225\"),a=n(\"b0b4\"),s=n(\"9ab4\"),r=n(\"0cd5\"),c=n(\"df29\"),u=n(\"7aeb\"),d=n(\"c4cc\"),p=n(\"54da\"),l=function(){function t(e){Object(o[\"a\"])(this,t),this.marketingApi=e,this.loading$=new c[\"d\"]({}),this.statInfo$=new c[\"d\"]({}),this.reportList$=new c[\"d\"]([]),this.reportPage$=new c[\"d\"]({}),this.inviteeList$=new c[\"d\"]([]),this.inviteePage$=new c[\"d\"]({})}return Object(a[\"a\"])(t,[{key:\"getInviteStat\",value:function(){var t=this;return this.marketingApi.getInviteStat().pipe(Object(d[\"a\"])((function(e){Object.keys(e.info).forEach((function(t){e.info[t]=null===e.info[t]?0:+e.info[t]})),t.statInfo$.commit((function(){return e.info}))})))}},{key:\"getInviteReport\",value:function(t){var e=this;return this.marketingApi.getInviteReport(t).pipe(Object(d[\"a\"])((function(t){e.reportList$.commit((function(){return t.list})),e.reportPage$.commit((function(){return t.page}))})))}},{key:\"getInviteInvitee\",value:function(t){var e=this;return this.marketingApi.getInviteInvitee(t).pipe(Object(d[\"a\"])((function(t){e.inviteeList$.commit((function(){return t.list})),e.inviteePage$.commit((function(){return t.page}))})))}},{key:\"init\",value:function(){return Object(p[\"a\"])(this.getInviteStat(),this.getInviteReport({page:1,size:20}),this.getInviteInvitee({page:1,size:20}))}},{key:\"beforeEach\",value:function(){return this.init()}}]),t}();l=Object(s[\"b\"])([Object(r[\"b\"])(),Object(s[\"d\"])(\"design:paramtypes\",[\"function\"===typeof(i=\"undefined\"!==typeof u[\"d\"]&&u[\"d\"])?i:Object])],l)},\"57e8\":function(t,e,n){\"use strict\";n.r(e),n.d(e,\"SettingService\",(function(){return g}));var i,o,a,s,r=n(\"d225\"),c=n(\"b0b4\"),u=n(\"9ab4\"),d=n(\"0cd5\"),p=n(\"df29\"),l=n(\"7aeb\"),v=n(\"c4cc\"),m=n(\"2cbb\"),g=function(){function t(e,n){Object(r[\"a\"])(this,t),this.marketingApi=e,this.authService=n,this.loading$=new p[\"d\"]({}),this.settingInfo$=new p[\"d\"]({}),this.auth$=this.authService.authMap$({add:\"brand:activity:invite|add\",edit:\"brand:activity:invite|edit\"})}return Object(c[\"a\"])(t,[{key:\"getInviteEditInfo\",value:function(t){var e=this;return this.marketingApi.getInviteEditInfo().pipe(Object(v[\"a\"])((function(n){\"data\"===t.from&&(n.info.activity_status=1),e.settingInfo$.commit((function(){return n.info}))})))}},{key:\"add\",value:function(t){return this.marketingApi.setInviteAdd(t)}},{key:\"edit\",value:function(t){return this.marketingApi.setInviteEdit(t)}},{key:\"beforeEach\",value:function(t){return this.getInviteEditInfo(t.params)}}]),t}();Object(u[\"b\"])([Object(p[\"c\"])(),Object(u[\"d\"])(\"design:type\",Function),Object(u[\"d\"])(\"design:paramtypes\",[\"function\"===typeof(i=\"undefined\"!==typeof l[\"SetInviteEditInput\"]&&l[\"SetInviteEditInput\"])?i:Object]),Object(u[\"d\"])(\"design:returntype\",void 0)],g.prototype,\"add\",null),Object(u[\"b\"])([Object(p[\"c\"])(),Object(u[\"d\"])(\"design:type\",Function),Object(u[\"d\"])(\"design:paramtypes\",[\"function\"===typeof(o=\"undefined\"!==typeof l[\"SetInviteEditInput\"]&&l[\"SetInviteEditInput\"])?o:Object]),Object(u[\"d\"])(\"design:returntype\",void 0)],g.prototype,\"edit\",null),g=Object(u[\"b\"])([Object(d[\"b\"])(),Object(u[\"d\"])(\"design:paramtypes\",[\"function\"===typeof(a=\"undefined\"!==typeof l[\"d\"]&&l[\"d\"])?a:Object,\"function\"===typeof(s=\"undefined\"!==typeof m[\"a\"]&&m[\"a\"])?s:Object])],g)},a2be:function(t,e,n){\"use strict\";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n(\"div\",{class:t.inviation()},[n(\"a-row\",{class:t.inviation(\"acount\")},[n(\"a-col\",{attrs:{span:6}},[n(\"p\",{class:t.inviation(\"acount-title\")},[t._v(\"\\n        参与活动邀请人\\n        \"),n(\"st-help-tooltip\",{attrs:{id:\"TBMGM001\"}})],1),n(\"ICountUp\",{staticClass:\"number-up font-number\",attrs:{endVal:t.statInfo.total_inviter_num}})],1),n(\"a-col\",{attrs:{span:6}},[n(\"p\",{class:t.inviation(\"acount-title\")},[t._v(\"\\n        拉新注册人数\\n        \"),n(\"st-help-tooltip\",{attrs:{id:\"TBMGM002\"}})],1),n(\"ICountUp\",{staticClass:\"number-up font-number\",attrs:{endVal:t.statInfo.total_newbie_register_num}})],1),n(\"a-col\",{attrs:{span:6}},[n(\"p\",{class:t.inviation(\"acount-title\")},[t._v(\"\\n        拉新领券人数\\n        \"),n(\"st-help-tooltip\",{attrs:{id:\"TBMGM003\"}})],1),n(\"ICountUp\",{staticClass:\"number-up font-number\",attrs:{endVal:t.statInfo.total_coupon_num}})],1),n(\"a-col\",{attrs:{span:6}},[n(\"p\",{class:t.inviation(\"acount-title\")},[t._v(\"\\n        拉新交易人数\\n        \"),n(\"st-help-tooltip\",{attrs:{id:\"TBMGM004\"}})],1),n(\"ICountUp\",{staticClass:\"number-up font-number\",attrs:{endVal:t.statInfo.total_order_num}})],1)],1),t.isOpen?n(\"div\",{class:t.inviation(\"table\")},[n(\"div\",{staticClass:\"mg-b16\",class:t.inviation(\"table-operation\")},[n(\"a-radio-group\",{attrs:{buttonStyle:\"solid\"},on:{change:t.onTabChange},model:{value:t.tableType,callback:function(e){t.tableType=e},expression:\"tableType\"}},[n(\"a-radio-button\",{attrs:{value:0}},[t._v(\"活动效果\")]),n(\"a-radio-button\",{attrs:{value:1}},[t._v(\"邀请用户\")])],1)],1),t.tableType?t._e():n(\"st-table\",{attrs:{columns:t.columnsActivity,dataSource:t.stReportList,pagination:{current:t.reportPage.current_page,total:t.reportPage.total_counts,pageSize:t.reportPage.size},rowKey:\"key\"},on:{change:t.onReportPageChange}}),t.tableType?n(\"st-table\",{attrs:{columns:t.columnsUser,dataSource:t.stInviteeList,pagination:{current:t.inviteePage.current_page,total:t.inviteePage.total_counts,pageSize:t.inviteePage.size},rowKey:\"key\"},on:{change:t.onInviteePageChange}}):t._e()],1):n(\"div\",{class:t.inviation(\"data-none\")},[n(\"img\",{attrs:{src:t._f(\"imgFilter\")(t.config.PLACEHOLDER_IMG.NODATA,{w:197,h:136}),width:\"197\",height:\"136\",alt:\"暂无数据\"}}),n(\"p\",[t._v(\"还未开启邀请有礼功能，立即开启吧！\")]),n(\"st-button\",{attrs:{type:\"primary\"},on:{click:t.onGoOpen}},[t._v(\"立即开启\")])],1)],1)},o=[],a=(n(\"8e6e\"),n(\"456d\"),n(\"bd86\")),s=(n(\"6b54\"),n(\"ac6a\"),n(\"74d8\")),r=[{title:\"时间\",dataIndex:\"date\",scopedSlots:{customRender:\"date\"}},{title:\"参与活动邀请人\",dataIndex:\"inviter_num\",scopedSlots:{customRender:\"inviter_num\"}},{title:\"邀请人带来的交易额(元)\",dataIndex:\"inviter_revenue\",scopedSlots:{customRender:\"inviter_revenue\"}},{title:\"拉新注册人数\",dataIndex:\"newbie_register_num\",scopedSlots:{customRender:\"newbie_register_num\"}},{title:\"拉新领券人数\",dataIndex:\"coupon_num\",scopedSlots:{customRender:\"coupon_num\"}},{title:\"拉新交易人数\",dataIndex:\"order_num\",scopedSlots:{customRender:\"order_num\"}},{title:\"拉新带来的交易额(元)\",dataIndex:\"newbie_revenue\",scopedSlots:{customRender:\"newbie_revenue\"}}],c=[{title:\"邀请人姓名\",dataIndex:\"inviter_name\",scopedSlots:{customRender:\"inviter_name\"}},{title:\"邀请人手机号\",dataIndex:\"inviter_mobile\",scopedSlots:{customRender:\"inviter_mobile\"}},{title:\"拉新用户姓名\",dataIndex:\"invitee_name\",scopedSlots:{customRender:\"invitee_name\"}},{title:\"拉新用户手机号\",dataIndex:\"invitee_mobile\",scopedSlots:{customRender:\"invitee_mobile\"}},{title:\"拉新带来的交易额(元)\",dataIndex:\"newbie_revenue\",scopedSlots:{customRender:\"newbie_revenue\"}}],u=n(\"55ab\"),d=n(\"c542\");function p(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function l(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?p(Object(n),!0).forEach((function(e){Object(a[\"a\"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var v={name:\"PageBrandMarketingInviationData\",bem:{inviation:\"page-brand-marketing-inviation-data\"},serviceInject:function(){return{config:s[\"a\"],dataService:u[\"DataService\"],indexService:d[\"IndexService\"]}},rxState:function(){return{isOpen:this.indexService.isOpen$,dataLoading:this.dataService.loading$,statInfo:this.dataService.statInfo$,reportList:this.dataService.reportList$,reportPage:this.dataService.reportPage$,inviteeList:this.dataService.inviteeList$,inviteePage:this.dataService.inviteePage$}},computed:{stReportList:function(){var t=[];return this.reportList.forEach((function(e){var n=parseInt(999999*Math.random()).toString();t.push(l({},e,{key:n}))})),t},stInviteeList:function(){var t=[];return this.inviteeList.forEach((function(e){var n=parseInt(999999*Math.random()).toString();t.push(l({},e,{key:n}))})),t}},data:function(){return{columnsActivity:r,columnsUser:c,selectedRowKeys:[],selectedRows:[],tableType:0}},methods:{onGoOpen:function(){this.$router.push({name:\"brand-marketing-plugin-invitation-index-setting\",params:{from:\"data\"}})},onClear:function(){this.selectedRowKeys=[],this.selectedRows=[]},onSelectChange:function(t,e){this.selectedRowKeys=t,this.selectedRows=e},onReportPageChange:function(t){this.onClear(),this.dataService.getInviteReport({page:t.current,size:t.pageSize}).subscribe()},onInviteePageChange:function(t){this.onClear(),this.dataService.getInviteInvitee({page:t.current,size:t.pageSize}).subscribe()},onExport:function(){this.onClear()},onTabChange:function(){this.onClear()}}},m=v,g=n(\"2877\"),h=Object(g[\"a\"])(m,i,o,!1,null,null,null);e[\"default\"]=h.exports},c542:function(t,e,n){\"use strict\";n.r(e),n.d(e,\"IndexService\",(function(){return v}));var i,o,a=n(\"d225\"),s=n(\"b0b4\"),r=n(\"9ab4\"),c=n(\"0cd5\"),u=n(\"df29\"),d=n(\"7aeb\"),p=n(\"c4cc\"),l=n(\"2cbb\"),v=function(){function t(e,n){Object(a[\"a\"])(this,t),this.marketingApi=e,this.authService=n,this.isOpen$=new u[\"d\"](!1),this.authTabs$=this.authService.getAuthTabs$(\"brand-marketing-plugin-invitation-index\")}return Object(s[\"a\"])(t,[{key:\"getOpenStatus\",value:function(){var t=this;return this.marketingApi.getInviteOpenStatus().pipe(Object(p[\"a\"])((function(e){t.isOpen$.commit((function(){return e.info.has_opened}))})))}},{key:\"beforeRouteEnter\",value:function(){return this.getOpenStatus()}}]),t}();v=Object(r[\"b\"])([Object(c[\"b\"])(),Object(r[\"d\"])(\"design:paramtypes\",[\"function\"===typeof(i=\"undefined\"!==typeof d[\"d\"]&&d[\"d\"])?i:Object,\"function\"===typeof(o=\"undefined\"!==typeof l[\"a\"]&&l[\"a\"])?o:Object])],v)}}]);","extractedComments":[]}