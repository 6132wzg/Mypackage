{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js!/Users/wangzhigang/Desktop/styd/web/node_modules/ts-loader/index.js??ref--13-2!/Users/wangzhigang/Desktop/styd/web/src/services/import.service.ts","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/services/import.service.ts","mtime":1591147717086},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/ts-loader/index.js","mtime":1591062571609}],"contextDependencies":[],"result":["import \"core-js/modules/es6.string.iterator\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es7.array.includes\";\nimport \"core-js/modules/es6.string.includes\";\nimport _classCallCheck from \"/Users/wangzhigang/Desktop/styd/web/node_modules/@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/wangzhigang/Desktop/styd/web/node_modules/@babel/runtime-corejs2/helpers/esm/createClass\";\n\nvar _a;\n\nimport { __decorate, __metadata } from \"tslib\";\nimport { AppConfig } from '@/constants/config';\nimport { Injectable } from 'vue-service-app';\n/**\n * 资源按需加载服务\n * webpack 不支持加载 浏览器协议资源\n */\n\nvar ImportService = /*#__PURE__*/function () {\n  function ImportService(appConfig) {\n    _classCallCheck(this, ImportService);\n\n    this.appConfig = appConfig;\n  }\n\n  _createClass(ImportService, [{\n    key: \"isJs\",\n    value: function isJs(src) {\n      return src.indexOf('.js') > -1;\n    }\n  }, {\n    key: \"isCss\",\n    value: function isCss(src) {\n      return src.indexOf('.css') > -1;\n    }\n  }, {\n    key: \"loadJs\",\n    value: function loadJs(src) {\n      var s = document.createElement('script');\n      var url = src.includes('http') ? src : this.appConfig.BASE_URL + src;\n\n      if (document.querySelector(\"script[src='\".concat(url, \"']\"))) {\n        return Promise.resolve();\n      }\n\n      return new Promise(function (resolve, reject) {\n        s.src = url;\n        document.head.appendChild(s);\n\n        s.onload = function () {\n          resolve();\n        };\n\n        s.onerror = function (err) {\n          reject(err);\n        };\n      });\n    }\n  }, {\n    key: \"loadCss\",\n    value: function loadCss(href) {\n      var link = document.createElement('link');\n      link.rel = 'stylesheet';\n      var url = href.includes('http:') ? href : this.appConfig.BASE_URL + href;\n\n      if (document.querySelector(\"link[href='\".concat(href, \"']\"))) {\n        return Promise.resolve();\n      }\n\n      return new Promise(function (resolve, reject) {\n        link.href = url;\n        document.head.appendChild(link);\n\n        link.onload = function () {\n          resolve();\n        };\n\n        link.onerror = function (err) {\n          reject(err);\n        };\n      });\n    }\n  }, {\n    key: \"load\",\n    value: function load() {\n      var _this = this;\n\n      var srcs = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n      var tasks = [];\n      srcs.forEach(function (src) {\n        if (_this.isJs(src)) {\n          tasks.push(_this.loadJs(src));\n        }\n\n        if (_this.isCss(src)) {\n          tasks.push(_this.loadCss(src));\n        }\n      });\n      return Promise.all(tasks);\n    }\n  }]);\n\n  return ImportService;\n}();\n\nImportService = __decorate([Injectable(), __metadata(\"design:paramtypes\", [typeof (_a = typeof AppConfig !== \"undefined\" && AppConfig) === \"function\" ? _a : Object])], ImportService);\nexport { ImportService };",{"version":3,"sources":["/Users/wangzhigang/Desktop/styd/web/src/services/import.service.ts"],"names":[],"mappings":"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","sourcesContent":["import { AppConfig } from '@/constants/config'\nimport { Injectable } from 'vue-service-app'\n\n/**\n * 资源按需加载服务\n * webpack 不支持加载 浏览器协议资源\n */\n@Injectable()\nexport class ImportService {\n  constructor(private appConfig: AppConfig) {}\n  private isJs(src: string) {\n    return src.indexOf('.js') > -1\n  }\n  private isCss(src: string) {\n    return src.indexOf('.css') > -1\n  }\n  loadJs(src: string) {\n    const s = document.createElement('script')\n    const url = src.includes('http') ? src : this.appConfig.BASE_URL + src\n    if (document.querySelector(`script[src='${url}']`)) {\n      return Promise.resolve()\n    }\n    return new Promise((resolve, reject) => {\n      s.src = url\n      document.head.appendChild(s)\n      s.onload = () => {\n        resolve()\n      }\n      s.onerror = err => {\n        reject(err)\n      }\n    })\n  }\n  loadCss(href: string) {\n    const link = document.createElement('link')\n    link.rel = 'stylesheet'\n    const url = href.includes('http:') ? href : this.appConfig.BASE_URL + href\n    if (document.querySelector(`link[href='${href}']`)) {\n      return Promise.resolve()\n    }\n    return new Promise((resolve, reject) => {\n      link.href = url\n      document.head.appendChild(link)\n      link.onload = () => {\n        resolve()\n      }\n      link.onerror = err => {\n        reject(err)\n      }\n    })\n  }\n\n  load(srcs = []) {\n    const tasks: any[] = []\n    srcs.forEach(src => {\n      if (this.isJs(src)) {\n        tasks.push(this.loadJs(src))\n      }\n      if (this.isCss(src)) {\n        tasks.push(this.loadCss(src))\n      }\n    })\n    return Promise.all(tasks)\n  }\n}\n"],"sourceRoot":""}]}