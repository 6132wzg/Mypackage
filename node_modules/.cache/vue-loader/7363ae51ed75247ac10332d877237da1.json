{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhigang/Desktop/styd/web/src/views/pages/brand/marketing/plugin/member-points/list/member-points.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/pages/brand/marketing/plugin/member-points/list/member-points.vue","mtime":1600926556150},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js","mtime":1591062572376}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport tableMixin from '@/mixins/table.mixin'\n\nimport { columns, totalColumns } from './member-points.config'\nimport { MemberPointsService } from './member-points.service'\nimport PointsAddOrMinus from '@/views/biz-modals/brand/marketing/points/add-or-minus'\nexport default {\n  name: 'BrandPlaginPointsMall',\n  bem: {\n    b: 'brand-plagin-member-points-member-points'\n  },\n  modals: {\n    PointsAddOrMinus\n  },\n  serviceInject() {\n    return {\n      service: MemberPointsService\n    }\n  },\n  rxState() {\n    let { total$, list$, page$, auth$ } = this.service\n    return {\n      total$,\n      list$,\n      page$,\n      auth$\n    }\n  },\n  mixins: [tableMixin],\n  computed: {\n    columns,\n    totalColumns,\n    buttonDisable() {\n      return !this.selectedRowKeys.length\n    }\n  },\n  methods: {\n    onClear() {\n      console.log('onClear')\n    },\n    onSuccess() {\n      this.selectedRowKeys = []\n      this.$router.reload()\n    },\n    addPoints(record) {\n      this.$modalRouter.push({\n        name: 'points-add-or-minus',\n        props: {\n          type: 'add',\n          query: {\n            memberName: record.member_name,\n            memberId: record.member_id\n          }\n        },\n        on: {\n          done: this.onSuccess\n        }\n      })\n    },\n    miusPoints(record) {\n      this.$modalRouter.push({\n        name: 'points-add-or-minus',\n        props: {\n          type: 'minus',\n          query: {\n            memberName: record.member_name,\n            memberId: record.member_id\n          }\n        },\n        on: {\n          done: this.onSuccess\n        }\n      })\n    },\n    addPointsByBatch() {\n      const ids = this.selectedRowKeys\n      this.$modalRouter.push({\n        name: 'points-add-or-minus',\n        props: {\n          type: 'add-by-batch',\n          query: {\n            member_ids: ids\n          }\n        },\n        on: {\n          done: this.onSuccess\n        }\n      })\n    },\n    minusPointsByBatch() {\n      const ids = this.selectedRowKeys\n      this.$modalRouter.push({\n        name: 'points-add-or-minus',\n        props: {\n          type: 'minus-by-batch',\n          query: {\n            member_ids: ids\n          }\n        },\n        on: {\n          done: this.onSuccess\n        }\n      })\n    },\n    showPoints(record) {\n      this.$router.push({\n        name: 'brand-marketing-plugin-member-points-list-flow-record',\n        query: {\n          keyword: record.member_name\n        }\n      })\n    }\n  }\n}\n",{"version":3,"sources":["member-points.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqFA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"member-points.vue","sourceRoot":"src/views/pages/brand/marketing/plugin/member-points/list","sourcesContent":["<template>\n  <div :class=\"b()\">\n    <portal to=\"BRAND_PLUGIN_POINTS_MALL_SEARCH\">\n      <st-input-search\n        v-model=\"$searchQuery.keyword\"\n        @search=\"onKeywordsSearch('keyword', $event)\"\n        placeholder=\"搜索会员姓名或手机号\"\n        style=\"width:400px\"\n      />\n    </portal>\n    <div :class=\"b('total')\">\n      <div :class=\"b('total-item')\">\n        <span class=\"label\">积分总额</span>\n        <i-count-up class=\"value\" :endVal=\"+total$.total_points\"></i-count-up>\n      </div>\n      <div :class=\"b('total-item')\">\n        <span class=\"label\">已用积分</span>\n        <i-count-up class=\"value\" :endVal=\"+total$.used_points\"></i-count-up>\n      </div>\n      <div :class=\"b('total-item')\">\n        <span class=\"label\">过期积分</span>\n        <i-count-up class=\"value\" :endVal=\"+total$.expired_points\"></i-count-up>\n      </div>\n      <div :class=\"b('total-item')\">\n        <span class=\"label\">剩余积分</span>\n        <i-count-up class=\"value\" :endVal=\"+total$.remain_points\"></i-count-up>\n      </div>\n    </div>\n    <div :class=\"b('button')\" class=\"mg-t24\">\n      <st-button\n        type=\"primary\"\n        class=\"mg-r16\"\n        :disabled=\"buttonDisable\"\n        @click=\"addPointsByBatch\"\n        v-if=\"auth$.batch_add\"\n      >\n        批量增加\n      </st-button>\n      <st-button\n        @click=\"minusPointsByBatch\"\n        :disabled=\"buttonDisable\"\n        v-if=\"auth$.batch_reduce\"\n      >\n        批量扣减\n      </st-button>\n    </div>\n    <div :class=\"b('content')\" class=\"mg-t16\">\n      <st-table\n        :page=\"page$\"\n        rowKey=\"member_id\"\n        :columns=\"columns\"\n        @change=\"onTableChange\"\n        :rowSelection=\"{ selectedRowKeys, onChange: onSelectionChange }\"\n        :scroll=\"{ x: 860 }\"\n        :alertSelection=\"{ onReset: onSelectionReset }\"\n        :dataSource=\"list$\"\n      >\n        <div slot=\"action\" slot-scope=\"text, record\">\n          <st-table-actions>\n            <a\n              @click=\"addPoints(record)\"\n              v-if=\"record.auth['brand:activity:points|add']\"\n            >\n              增加\n            </a>\n            <a\n              @click=\"miusPoints(record)\"\n              v-if=\"record.auth['brand:activity:points|reduce']\"\n            >\n              扣减\n            </a>\n            <a\n              @click=\"showPoints(record)\"\n              v-if=\"record.auth['brand:activity:points|get_flow']\"\n            >\n              查看\n            </a>\n          </st-table-actions>\n        </div>\n      </st-table>\n    </div>\n  </div>\n</template>\n\n<script>\nimport tableMixin from '@/mixins/table.mixin'\n\nimport { columns, totalColumns } from './member-points.config'\nimport { MemberPointsService } from './member-points.service'\nimport PointsAddOrMinus from '@/views/biz-modals/brand/marketing/points/add-or-minus'\nexport default {\n  name: 'BrandPlaginPointsMall',\n  bem: {\n    b: 'brand-plagin-member-points-member-points'\n  },\n  modals: {\n    PointsAddOrMinus\n  },\n  serviceInject() {\n    return {\n      service: MemberPointsService\n    }\n  },\n  rxState() {\n    let { total$, list$, page$, auth$ } = this.service\n    return {\n      total$,\n      list$,\n      page$,\n      auth$\n    }\n  },\n  mixins: [tableMixin],\n  computed: {\n    columns,\n    totalColumns,\n    buttonDisable() {\n      return !this.selectedRowKeys.length\n    }\n  },\n  methods: {\n    onClear() {\n      console.log('onClear')\n    },\n    onSuccess() {\n      this.selectedRowKeys = []\n      this.$router.reload()\n    },\n    addPoints(record) {\n      this.$modalRouter.push({\n        name: 'points-add-or-minus',\n        props: {\n          type: 'add',\n          query: {\n            memberName: record.member_name,\n            memberId: record.member_id\n          }\n        },\n        on: {\n          done: this.onSuccess\n        }\n      })\n    },\n    miusPoints(record) {\n      this.$modalRouter.push({\n        name: 'points-add-or-minus',\n        props: {\n          type: 'minus',\n          query: {\n            memberName: record.member_name,\n            memberId: record.member_id\n          }\n        },\n        on: {\n          done: this.onSuccess\n        }\n      })\n    },\n    addPointsByBatch() {\n      const ids = this.selectedRowKeys\n      this.$modalRouter.push({\n        name: 'points-add-or-minus',\n        props: {\n          type: 'add-by-batch',\n          query: {\n            member_ids: ids\n          }\n        },\n        on: {\n          done: this.onSuccess\n        }\n      })\n    },\n    minusPointsByBatch() {\n      const ids = this.selectedRowKeys\n      this.$modalRouter.push({\n        name: 'points-add-or-minus',\n        props: {\n          type: 'minus-by-batch',\n          query: {\n            member_ids: ids\n          }\n        },\n        on: {\n          done: this.onSuccess\n        }\n      })\n    },\n    showPoints(record) {\n      this.$router.push({\n        name: 'brand-marketing-plugin-member-points-list-flow-record',\n        query: {\n          keyword: record.member_name\n        }\n      })\n    }\n  }\n}\n</script>\n\n<style></style>\n"]}]}