{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"shop-store\"],{\"0912\":function(t,e,s){\"use strict\";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"router-view\")},a=[],n=s(\"2877\"),o={},r=Object(n[\"a\"])(o,i,a,!1,null,null,null);e[\"default\"]=r.exports},4917:function(t,e,s){\"use strict\";var i=s(\"cb7c\"),a=s(\"9def\"),n=s(\"0390\"),o=s(\"5f1b\");s(\"214f\")(\"match\",1,(function(t,e,s,r){return[function(s){var i=t(this),a=void 0==s?void 0:s[e];return void 0!==a?a.call(s,i):new RegExp(s)[e](String(i))},function(t){var e=r(s,t,this);if(e.done)return e.value;var c=i(t),l=String(this);if(!c.global)return o(c,l);var u=c.unicode;c.lastIndex=0;var d,p=[],h=0;while(null!==(d=o(c,l))){var _=String(d[0]);p[h]=_,\"\"===_&&(c.lastIndex=n(l,a(c.lastIndex),u)),h++}return 0===h?null:p}]}))},\"6ada\":function(t,e,s){\"use strict\";s.r(e),s.d(e,\"AddService\",(function(){return p}));s(\"c5f6\");var i,a,n,o=s(\"d225\"),r=s(\"b0b4\"),c=s(\"9ab4\"),l=s(\"0cd5\"),u=s(\"df29\"),d=s(\"b57f\"),p=function(){function t(e){Object(o[\"a\"])(this,t),this.storeApi=e,this.loading$=new u[\"d\"]({}),this.list$=new u[\"d\"]({})}return Object(r[\"a\"])(t,[{key:\"addGoods\",value:function(t){return this.storeApi.addGoods(t)}},{key:\"editGoods\",value:function(t,e){return this.storeApi.editGoods(t,e)}},{key:\"getList\",value:function(){return this.storeApi.categoryList()}},{key:\"beforeRouteEnter\",value:function(t){return this.getList()}}]),t}();Object(c[\"b\"])([Object(u[\"c\"])(),Object(c[\"d\"])(\"design:type\",Function),Object(c[\"d\"])(\"design:paramtypes\",[\"function\"===typeof(i=\"undefined\"!==typeof d[\"AddParams\"]&&d[\"AddParams\"])?i:Object]),Object(c[\"d\"])(\"design:returntype\",void 0)],p.prototype,\"addGoods\",null),Object(c[\"b\"])([Object(u[\"c\"])(),Object(c[\"d\"])(\"design:type\",Function),Object(c[\"d\"])(\"design:paramtypes\",[Number,\"function\"===typeof(a=\"undefined\"!==typeof d[\"EditParams\"]&&d[\"EditParams\"])?a:Object]),Object(c[\"d\"])(\"design:returntype\",void 0)],p.prototype,\"editGoods\",null),Object(c[\"b\"])([Object(u[\"c\"])(),Object(c[\"d\"])(\"design:type\",Function),Object(c[\"d\"])(\"design:paramtypes\",[]),Object(c[\"d\"])(\"design:returntype\",void 0)],p.prototype,\"getList\",null),p=Object(c[\"b\"])([Object(l[\"b\"])(),Object(c[\"d\"])(\"design:paramtypes\",[\"function\"===typeof(n=\"undefined\"!==typeof d[\"e\"]&&d[\"e\"])?n:Object])],p)},\"814c\":function(t,e,s){\"use strict\";s.r(e),s.d(e,\"ListService\",(function(){return g}));var i,a,n,o,r=s(\"d225\"),c=s(\"b0b4\"),l=s(\"9ab4\"),u=s(\"0cd5\"),d=s(\"df29\"),p=s(\"b57f\"),h=s(\"c4cc\"),_=s(\"2cbb\"),m=s(\"54da\"),f=s(\"2138\"),g=function(){function t(e,s,i){Object(r[\"a\"])(this,t),this.storeApi=e,this.userService=s,this.authService=i,this.list$=new d[\"d\"]([]),this.page$=new d[\"d\"]({}),this.loading$=new d[\"d\"]({}),this.info$=new d[\"d\"]({}),this.goodsList$=new d[\"d\"]({}),this.shelvesStatus$=this.userService.getOptions$(\"cloud_store.shelves_status\",{addAll:!0}),this.auth$=this.authService.authMap$({add:\"shop:cloud_store:goods|add\"})}return Object(c[\"a\"])(t,[{key:\"getList\",value:function(t){var e=this;return this.storeApi.getList(t).pipe(Object(h[\"a\"])((function(t){e.list$.commit((function(){return t.list})),e.page$.commit((function(){return t.page}))})))}},{key:\"getGoodsCategory\",value:function(){var t=this;return this.storeApi.getCategory().pipe(Object(h[\"a\"])((function(e){t.goodsList$.commit((function(){return e.list}))})))}},{key:\"delproduct\",value:function(t){return this.storeApi.delProduct(t).pipe(Object(h[\"a\"])((function(t){})))}},{key:\"onShelf\",value:function(t,e){return this.storeApi.onShelf(t,e).pipe(Object(h[\"a\"])((function(t){})))}},{key:\"init\",value:function(t){return Object(m[\"a\"])(this.getList(t),this.getGoodsCategory())}},{key:\"beforeEach\",value:function(t,e){return this.init(t.meta.query)}}]),t}();Object(l[\"b\"])([Object(d[\"c\"])(),Object(l[\"d\"])(\"design:type\",Function),Object(l[\"d\"])(\"design:paramtypes\",[\"function\"===typeof(i=\"undefined\"!==typeof p[\"StoreList\"]&&p[\"StoreList\"])?i:Object]),Object(l[\"d\"])(\"design:returntype\",void 0)],g.prototype,\"getList\",null),Object(l[\"b\"])([Object(d[\"c\"])(),Object(l[\"d\"])(\"design:type\",Function),Object(l[\"d\"])(\"design:paramtypes\",[]),Object(l[\"d\"])(\"design:returntype\",void 0)],g.prototype,\"getGoodsCategory\",null),g=Object(l[\"b\"])([Object(u[\"b\"])(),Object(l[\"d\"])(\"design:paramtypes\",[\"function\"===typeof(a=\"undefined\"!==typeof p[\"e\"]&&p[\"e\"])?a:Object,\"function\"===typeof(n=\"undefined\"!==typeof f[\"a\"]&&f[\"a\"])?n:Object,\"function\"===typeof(o=\"undefined\"!==typeof _[\"a\"]&&_[\"a\"])?o:Object])],g)},9788:function(t,e,s){\"use strict\";s.r(e);var i,a,n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"st-mina-panel\",{attrs:{app:\"\"}},[s(\"div\",{attrs:{slot:\"actions\"},slot:\"actions\"},[s(\"st-button\",{attrs:{type:\"primary\",loading:t.isEditMode?t.loading.editGoods:t.loading.addGoods},on:{click:t.onSubmit}},[t._v(\"\\n      保 存\\n    \")])],1),s(\"div\",{class:t.basic()},[s(\"st-form\",{attrs:{form:t.form,labelWidth:\"118px\"}},[s(\"a-row\",{attrs:{gutter:8}},[s(\"a-col\",{attrs:{span:10}},[s(\"st-form-item\",{attrs:{label:\"商品名称\",required:\"\"}},[s(\"a-input\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:t.decorators.product_name,expression:\"decorators.product_name\"}],attrs:{placeholder:\"请输入商品名称\",maxlength:\"30\"},on:{change:t.changeName}},[s(\"span\",{class:t.basic(\"name--gray\"),attrs:{slot:\"suffix\"},slot:\"suffix\"},[t._v(\"\\n                \"+t._s(t.name.length)+\"\\n                /30\\n              \")])])],1)],1)],1),s(\"a-row\",{attrs:{gutter:8}},[s(\"a-col\",{attrs:{span:10}},[s(\"st-form-item\",{attrs:{label:\"商品分类\",required:\"\"}},[s(\"a-select\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:t.decorators.category_id,expression:\"decorators.category_id\"}],attrs:{showSearch:\"\",placeholder:\"请选择分类\"}},t._l(t.classList,(function(e){return s(\"a-select-option\",{key:e.category_id,attrs:{value:e.category_id}},[t._v(\"\\n                \"+t._s(e.category_name)+\"\\n              \")])})),1)],1)],1),s(\"a-col\",{class:t.basic(\"class--manage\"),attrs:{span:6}},[s(\"a\",{on:{click:t.openClass}},[t._v(\"\\n            分类管理\\n          \")])])],1),s(\"a-row\",{attrs:{gutter:8}},[s(\"a-col\",{attrs:{span:16}},[s(\"st-form-item\",{attrs:{label:\"商品图片\",required:\"\"}},[s(\"ul\",{class:t.basic(\"img--container\")},[t._l(t.imgList,(function(e,i){return s(\"li\",{key:i,class:[\"mg-r12\",\"mg-t12\",t.basic(\"img\")]},[s(\"img\",{attrs:{\"data-src\":t._f(\"imgFilter\")(e.image_url,{w:1e3}),src:t._f(\"imgFilter\")(e.image_url,{w:126,h:126}),width:\"126\",height:\"126\",alt:\"商品图片\"}}),s(\"div\",{class:t.basic(\"img--del\")},[s(\"span\",{class:t.basic(\"img--del-text\"),on:{click:function(s){return t.delImg(e,i)}}},[t._v(\"\\n                    删除\\n                  \")])])])})),s(\"li\",{class:t.basic(\"img\")},[t.imgList.length<5?s(\"st-image-upload\",{staticClass:\"mg-t12\",attrs:{width:\"126px\",height:\"126px\",cropperModal:t.cropperModal,list:t.fileList,numLimit:5,sizeLimit:2,placeholder:\"上传图片\"},on:{change:t.getImage},scopedSlots:t._u([{key:\"description\",fn:function(){return[s(\"p\",[t._v(\"建议尺寸为750px*750px\")])]},proxy:!0}],null,!1,830765370)}):t._e(),s(\"div\",{class:t.basic(\"img--tip\")},[t._v(\"可上传5张商品图片\")])],1)],2),t.isImgError?s(\"div\",{staticClass:\"color-danger\"},[t._v(\"请上传商品图片\")]):t._e()]),s(\"st-form-item\",{attrs:{label:\"售卖方式\",required:\"\"}},[s(\"a-checkbox-group\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:t.decorators.sale_type,expression:\"decorators.sale_type\"}],on:{change:t.changeSale}},t._l(t.saleType,(function(e){return s(\"a-checkbox\",{key:e.value,staticStyle:{\"margin-right\":\"16px\"},attrs:{value:e.value}},[t._v(\"\\n                \"+t._s(e.label)+\"\\n              \")])})),1)],1),s(\"st-form-item\",{attrs:{label:\"配送方式\",required:\"\"}},[s(\"a-checkbox-group\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:t.decorators.delivery_type,expression:\"decorators.delivery_type\"}]},t._l(t.shippingMode,(function(e){return s(\"a-checkbox\",{key:e.value,staticStyle:{\"margin-right\":\"16px\"},attrs:{value:e.value,disabled:t.isChoose&&1===e.value||t.isDisabledCourier&&2===e.value}},[t._v(\"\\n                \"+t._s(e.label)+\"\\n              \")])})),1)],1)],1)],1),s(\"a-row\",{attrs:{gutter:8}},[s(\"a-col\",{attrs:{span:18}},[s(\"st-form-item\",{attrs:{label:\"商品介绍\"}},[s(\"st-editor\",{on:{\"image-change\":t.getImageUrl,input:t.onChangeEditor},model:{value:t.content,callback:function(e){t.content=e},expression:\"content\"}}),t.isEditor?s(\"div\",{staticClass:\"color-danger\"},[t._v(\"请输入活动详情\")]):t._e()],1)],1)],1),s(\"a-row\",{attrs:{gutter:8}},[s(\"a-col\",{attrs:{span:20}},[s(\"st-form-item\",{attrs:{label:\"规格设置\",required:\"\"}},[s(\"a-radio-group\",{attrs:{disabled:t.isEditMode},on:{change:t.changeMore},model:{value:t.isMore,callback:function(e){t.isMore=e},expression:\"isMore\"}},[s(\"a-radio\",{attrs:{value:1}},[t._v(\"单规格\")]),s(\"a-radio\",{attrs:{value:2}},[t._v(\"多规格\")])],1),2===t.isMore&&!t.isEditMode&&t.skuList.length<3?s(\"st-button\",{class:t.basic(\"sku--add\"),attrs:{type:\"dashed\"},on:{click:t.addSku}},[s(\"a-icon\",{class:t.basic(\"sku--add-icon\"),attrs:{type:\"plus\"}}),s(\"span\",[t._v(\"新增规格项（\"+t._s(t.skuList.length)+\"/3）\")])],1):t._e(),t._l(t.skuList,(function(e,i){return s(\"div\",{key:i,class:t.skuItem()},[s(\"st-form-item\",{attrs:{label:\"规格项名称\",help:e.isNameErr?\"请正确填写规格项\":\"\",validateStatus:e.isNameErr?\"error\":\"\"}},[s(\"a-input\",{staticStyle:{width:\"220px\"},attrs:{placeholder:\"请输入规格项名称\",disabled:t.isEditMode,maxlength:\"20\"},model:{value:e.spec_name,callback:function(s){t.$set(e,\"spec_name\",s)},expression:\"item.spec_name\"}}),t.isEditMode?t._e():s(\"span\",{class:t.skuItem(\"del\"),on:{click:function(e){return t.delSku(i)}}},[s(\"st-icon\",{class:t.skuItem(\"icon\"),attrs:{type:\"delete\",color:\"#3F66F6\"}}),s(\"span\",{class:t.skuItem(\"text\")},[t._v(\"\\n                    删除\\n                  \")])],1)],1),s(\"st-form-item\",{attrs:{label:\"规格项设置\",help:e.isErr?\"请正确填写规格\":\"\",validateStatus:e.isErr?\"error\":\"\"}},[t._l(e.spec_item_name,(function(a,n){return s(\"span\",{key:n,class:t.basic(\"sku--tag\")},[t._v(\"\\n                  \"+t._s(a)+\"\\n                  \"),!t.isEditMode||e.spec_item_name.length>1?s(\"a-icon\",{attrs:{type:\"close\"},on:{click:function(e){return t.delSkuItem(i,n)}}}):t._e()],1)})),e.spec_item_name.length<=10?s(\"a\",{class:t.skuItem(\"add\"),on:{click:function(e){return t.addSkuItem(i)}}},[t._v(\"\\n                  新增规格\\n                \")]):t._e()],2)],1)}))],2),s(\"st-form-item\",{attrs:{\"label-fix\":\"\",help:t.tableTips,validateStatus:t.tableErr?\"error\":\"\"}},[s(\"st-container\",[s(\"st-table\",{attrs:{rowKey:\"key\",columns:t.skuColumns,dataSource:t.tableData,pagination:!1},scopedSlots:t._u([{key:\"market_price\",fn:function(e,i){return[s(\"div\",{class:t.basic(\"apply\")},[s(\"st-input-number\",{staticStyle:{width:\"110px\"},attrs:{float:!0},on:{change:function(t){i.is_update=1}},model:{value:i.market_price,callback:function(e){t.$set(i,\"market_price\",e)},expression:\"record.market_price\"}},[s(\"template\",{slot:\"addonAfter\"},[t._v(\"\\n                        元\\n                      \")])],2),2===t.isMore&&t.tableData.length>1?s(\"a\",{class:t.basic(\"apply--all\"),staticStyle:{\"margin-left\":\"8px\"},on:{click:function(e){return t.allApply(\"market_price\",i.market_price)}}},[t._v(\"\\n                      批量应用\\n                    \")]):t._e()],1)]}},{key:\"selling_price\",fn:function(e,i){return[s(\"div\",{class:t.basic(\"apply\")},[s(\"st-input-number\",{staticStyle:{width:\"110px\"},attrs:{float:!0},on:{change:function(t){i.is_update=1}},model:{value:i.selling_price,callback:function(e){t.$set(i,\"selling_price\",e)},expression:\"record.selling_price\"}},[s(\"template\",{slot:\"addonAfter\"},[t._v(\"\\n                        元\\n                      \")])],2),2===t.isMore&&t.tableData.length>1?s(\"a\",{class:t.basic(\"apply--all\"),staticStyle:{\"margin-left\":\"8px\"},on:{click:function(e){return t.allApply(\"selling_price\",i.selling_price)}}},[t._v(\"\\n                      批量应用\\n                    \")]):t._e()],1)]}},{key:\"stock_amount\",fn:function(e,i){return[s(\"div\",{class:t.basic(\"apply\")},[s(\"st-input-number\",{staticStyle:{width:\"110px\"},attrs:{disabled:t.isEditMode},model:{value:i.stock_amount,callback:function(e){t.$set(i,\"stock_amount\",e)},expression:\"record.stock_amount\"}}),2===t.isMore&&t.tableData.length>1?s(\"a\",{class:t.basic(\"apply--all\"),staticStyle:{\"margin-left\":\"8px\"},on:{click:function(e){return t.allApply(\"stock_amount\",i.stock_amount)}}},[t._v(\"\\n                      批量应用\\n                    \")]):t._e()],1)]}}])})],1)],1)],1)],1),s(\"a-row\",{attrs:{gutter:8}},[s(\"a-col\",{attrs:{span:10}},[s(\"st-form-item\",{attrs:{label:\"上架状态\",required:\"\"}},[s(\"a-radio-group\",{model:{value:t.shelves_status,callback:function(e){t.shelves_status=e},expression:\"shelves_status\"}},t._l(t.shelvesStatus,(function(e){return s(\"a-radio\",{key:e.value,attrs:{value:e.value}},[t._v(\"\\n                \"+t._s(e.label)+\"\\n              \")])})),1)],1)],1)],1)],1)],1)])},o=[],r=(s(\"ac6a\"),s(\"6b54\"),s(\"4917\"),function(t){var e=t.pattern;return{product_name:{rules:[{validator:function(t,s,i){return s?s.match(e.CN_EN_NUM_SPACE(\"1-30\"))?void 0:\"请输入商品名称，支持格式长度1~30中英文\":\"请填写商品名称\"}}]},category_id:{rules:[{validator:function(e,s,i){if(t.classList.some((function(t){return t.category_id===s}))||(s=\"\"),!s)return\"请选择商品分类\"}}]},delivery_type:{rules:[{validator:function(t,e,s){if(!e)return\"请选择配送方式\"}}]},sale_type:{rules:[{validator:function(t,e,s){if(!e)return\"请选择售卖方式\"}}]}}}),c=function(t){var e=[{title:\"划线价\",dataIndex:\"market_price\",width:208,slots:{title:\"market_price\"},scopedSlots:{customRender:\"market_price\"}},{title:\"售价\",dataIndex:\"selling_price\",width:208,slots:{title:\"selling_price\"},scopedSlots:{customRender:\"selling_price\"}}];return e=t.sku.concat(e),t.isEditMode||e.push({title:\"库存\",dataIndex:\"stock_amount\",width:208,slots:{title:\"stock_amount\"},scopedSlots:{customRender:\"stock_amount\"}}),e},l=s(\"7ce1\"),u=s(\"972a\"),d=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"st-modal\",{attrs:{loading:1===t.loadingStatus?t.loading.getList:2===t.loadingStatus?t.loading.addClass:3===t.loadingStatus?t.loading.delClass:t.loading.editClass,title:\"分类管理\"},on:{ok:t.onSubmit},model:{value:t.show,callback:function(e){t.show=e},expression:\"show\"}},[s(\"st-container\",[s(\"st-form-table\",[s(\"thead\",[s(\"tr\",[s(\"th\",{staticStyle:{\"padding-left\":\"42px\"}},[t._v(\"分类名称\")]),s(\"th\",{staticStyle:{width:\"20%\"}},[t._v(\"操作\")])])]),s(\"tbody\",[t.tableData.length<10?s(\"tr\",[s(\"td\",{staticClass:\"st-form-table__add\",attrs:{colspan:\"3\"}},[s(\"st-button\",{attrs:{type:\"dashed\",icon:\"add\",block:\"\"},on:{click:t.addClass}},[t._v(\"\\n              新增（\"+t._s(t.tableData.length)+\"/10）\\n            \")])],1)]):t._e(),t._l(t.tableData,(function(e,i){return s(\"tr\",{key:i},[e.isEdit?s(\"td\",{staticStyle:{\"padding-left\":\"42px\"}},[s(\"a-input\",{staticStyle:{width:\"150px\"},attrs:{maxlength:\"6\"},model:{value:e.category_name,callback:function(s){t.$set(e,\"category_name\",s)},expression:\"item.category_name\"}})],1):s(\"td\",{staticStyle:{\"padding-left\":\"42px\"}},[t._v(t._s(e.category_name))]),s(\"td\",[s(\"st-table-actions\",[e.isEdit?s(\"a\",{on:{click:function(s){return t.saveHandle(e,i)}}},[t._v(\"\\n                保存\\n              \")]):s(\"a\",{on:{click:function(s){return t.editHandle(e,i)}}},[t._v(\"\\n                编辑\\n              \")]),t._v(\"\\n              |\\n              \"),e.isEdit?s(\"a\",{on:{click:function(s){return t.cancelHandle(e,i)}}},[t._v(\"\\n                取消\\n              \")]):s(\"a\",{on:{click:function(s){return t.delHandle(e,i)}}},[t._v(\"\\n                删除\\n              \")])])],1)])}))],2)])],1)],1)},p=[],h=(s(\"c5f6\"),s(\"d225\")),_=s(\"b0b4\"),m=s(\"9ab4\"),f=s(\"0cd5\"),g=s(\"df29\"),b=s(\"b57f\"),v=s(\"e69b\"),y=function(){function t(e,s){Object(h[\"a\"])(this,t),this.storeApi=e,this.msg=s,this.list$=new g[\"d\"]([]),this.loading$=new g[\"d\"]({})}return Object(_[\"a\"])(t,[{key:\"getList\",value:function(){return this.storeApi.categoryList()}},{key:\"addClass\",value:function(t){return this.storeApi.addCategory(t)}},{key:\"editClass\",value:function(t,e){return this.storeApi.editCategory(t,e)}},{key:\"delClass\",value:function(t){return this.storeApi.delCategory(t)}}]),t}();Object(m[\"b\"])([Object(g[\"c\"])(),Object(m[\"d\"])(\"design:type\",Function),Object(m[\"d\"])(\"design:paramtypes\",[]),Object(m[\"d\"])(\"design:returntype\",void 0)],y.prototype,\"getList\",null),Object(m[\"b\"])([Object(g[\"c\"])(),Object(m[\"d\"])(\"design:type\",Function),Object(m[\"d\"])(\"design:paramtypes\",[Object]),Object(m[\"d\"])(\"design:returntype\",void 0)],y.prototype,\"addClass\",null),Object(m[\"b\"])([Object(g[\"c\"])(),Object(m[\"d\"])(\"design:type\",Function),Object(m[\"d\"])(\"design:paramtypes\",[Number,Object]),Object(m[\"d\"])(\"design:returntype\",void 0)],y.prototype,\"editClass\",null),Object(m[\"b\"])([Object(g[\"c\"])(),Object(m[\"d\"])(\"design:type\",Function),Object(m[\"d\"])(\"design:paramtypes\",[Number]),Object(m[\"d\"])(\"design:returntype\",void 0)],y.prototype,\"delClass\",null),y=Object(m[\"b\"])([Object(f[\"b\"])(),Object(m[\"d\"])(\"design:paramtypes\",[\"function\"===typeof(i=\"undefined\"!==typeof b[\"e\"]&&b[\"e\"])?i:Object,\"function\"===typeof(a=\"undefined\"!==typeof v[\"a\"]&&v[\"a\"])?a:Object])],y);var k=s(\"5c8a\"),S={serviceInject:function(){return{classManageService:y}},rxState:function(){return{loading:this.classManageService.loading$}},data:function(){return{show:!1,tableData:[],oldTableData:[],loadingStatus:1}},mounted:function(){this.getList()},methods:{getList:function(){var t=this;this.loadingStatus=1,this.classManageService.getList().subscribe((function(e){e.list.map((function(t){return t.isEdit=!1})),t.tableData=e.list,t.oldTableData=Object(k[\"a\"])(e.list)}))},onSubmit:function(){this.show=!1,this.$emit(\"success\",this.tableData)},addClass:function(){this.tableData.unshift({category_name:\"\",isEdit:!0,isNew:!0}),this.oldTableData.unshift({category_name:\"\",isEdit:!0,isNew:!0})},saveHandle:function(t,e){var s=this;t.isNew?(this.loadingStatus=2,this.classManageService.addClass({category_name:t.category_name}).subscribe((function(i){t.category_id=i.category_id,t.isEdit=!1,s.oldTableData[e]=t}))):(this.loadingStatus=4,this.classManageService.editClass(t.category_id,{category_name:t.category_name}).subscribe((function(i){t.isEdit=!1,s.oldTableData[e]=t})))},editHandle:function(t){t.isEdit=!0},cancelHandle:function(t,e){t.category_name&&t.category_id?(t.category_name=this.oldTableData[e].category_name,t.isEdit=!1):(this.tableData.splice(e,1),this.oldTableData.splice(e,1))},delHandle:function(t,e){var s=this;this.loadingStatus=3,this.classManageService.delClass(t.category_id).subscribe((function(t){s.getList()}))}}},O=S,j=s(\"2877\"),E=Object(j[\"a\"])(O,d,p,!1,null,null,null),x=E.exports,L=s(\"2527\"),w=s(\"6ada\"),$=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"st-modal\",{attrs:{title:\"新增规格\",size:\"small\"},on:{ok:t.handleSubmit},model:{value:t.show,callback:function(e){t.show=e},expression:\"show\"}},[s(\"st-form\",{attrs:{form:t.form,labelWidth:\"67px\"}},[s(\"st-form-item\",{attrs:{label:\"规格名称\",required:\"\"}},[s(\"a-input\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:t.decorators.sku_name,expression:\"decorators.sku_name\"}],attrs:{placeholder:\"请输规格名称\",maxlength:\"20\"}})],1)],1)],1)},I=[],M=function(t){return{sku_name:{rules:[{validator:function(e,s,i){return s?s.match(t.pattern.CN_EN_NUM_SPACE(\"1-20\"))?void 0:\"请输入规格名称，支持格式长度1~20中英文\":\"请填写规格名称\"}}]}}},C={serviceInject:function(){return{message:v[\"a\"],pattern:L[\"a\"]}},props:{list:{type:Array,default:function(){return[]}}},data:function(){var t=this.$stForm.create(),e=t.decorators(M);return{form:t,decorators:e,show:!1}},methods:{handleSubmit:function(t){var e=this;this.form.validate().then((function(t){var s=e.list.some((function(e){return e===t.sku_name}));s?e.message.warn({content:\"相同的规格项不可重复新增\"}):(e.$emit(\"success\",t.sku_name),e.message.success({content:\"新增成功\"}),e.show=!1)}))}}},D=C,N=Object(j[\"a\"])(D,$,I,!1,null,null,null),A=N.exports,F=s(\"2138\"),G={bem:{basic:\"shop-store-add\",skuItem:\"sku-item\"},serviceInject:function(){return{pattern:L[\"a\"],addService:w[\"AddService\"],userService:F[\"a\"]}},rxState:function(){return{loading:this.addService.loading$,saleType:this.userService.getOptions$(\"cloud_store.sale_type\"),shippingMode:this.userService.getOptions$(\"cloud_store.shipping_mode\"),shelvesStatus:this.userService.getOptions$(\"cloud_store.edit_shelves_status\")}},modals:{StoreClassManage:x,StoreAddSku:A},props:{isEditMode:{type:Boolean,default:!1},info:{type:Object,default:function(){}}},data:function(){var t=this.$stForm.create(),e=t.decorators(r);return{form:t,decorators:e,cropperModal:{cropper:{aspectRatio:1}},name:\"\",isMore:1,tableData:[{market_price:\"\",selling_price:\"\",stock_amount:\"\",key:parseInt(999999*Math.random()).toString()}],skuList:[],content:\"\",isEditor:!1,fileList:[],imgList:[],isImgError:!1,shelves_status:1,product_images_del:[],product_images_add:[],classList:[],tableErr:!1,tableTips:\"\",isChoose:!1,isDisabledCourier:!1}},components:{StEditor:u[\"a\"],StImageUpload:l[\"a\"]},computed:{skuColumns:c,sku:function(){var t=[];return this.skuList.forEach((function(e,s){var i={title:e.spec_name,dataIndex:s};t.push(i)})),t}},mounted:function(){var t=this;this.addService.getList().subscribe((function(e){t.classList=e.list})),this.isEditMode&&this.goodDetail()},methods:{changeSale:function(t){var e=this.form.getFieldValue(\"delivery_type\"),s=[];-1!==t.indexOf(1)?(this.isChoose=!0,void 0!==e&&(s=e),-1===s.indexOf(1)&&(s.push(1),this.form.setFieldsValue({delivery_type:s}))):this.isChoose=!1,-1!==t.indexOf(1)&&-1===t.indexOf(2)?this.isDisabledCourier=!0:this.isDisabledCourier=!1},onSubmit:function(){var t=this,e=!1,s=!1;this.imgList.length||(this.isReturn=!0,this.isImgError=!0),this.skuList.forEach((function(t){t.isErr=!1,t.isNameErr=!1,t.spec_item_name.length||(t.isErr=!0,e=!0),t.spec_name||(t.isNameErr=!0,e=!0)})),this.tableData.forEach((function(i){i.market_price&&i.selling_price&&(t.isEditMode||i.stock_amount)||(s=!0,t.tableTips=\"请正确填写表格\",t.tableErr=!0,e=!0)})),s||(this.tableTips=\"\",this.tableErr=!1),this.form.validate().then((function(s){e||(t.isEditMode?t.editGoodOld(s):t.addGoodNew(s))}))},addGoodNew:function(t){var e=this,s={},i=[],a=[];this.tableData.forEach((function(t,s){var a={};a.market_price=t.market_price,a.selling_price=t.selling_price,a.stock_amount=t.stock_amount,a.spec_arr=[],e.skuList.length>0&&a.spec_arr.push({spec_name:e.skuList[0].spec_name,spec_item_name:t[\"0\"]}),e.skuList.length>1&&a.spec_arr.push({spec_name:e.skuList[1].spec_name,spec_item_name:t[\"1\"]}),e.skuList.length>2&&a.spec_arr.push({spec_name:e.skuList[2].spec_name,spec_item_name:t[\"2\"]}),i.push(a)})),this.skuList.forEach((function(t){a.push(t.spec_name)})),s={product_images:this.imgList,product_intro:this.content,product_sku:i,shelves_status:this.shelves_status,product_name:t.product_name,category_id:t.category_id,delivery_type:t.delivery_type.length===this.shippingMode.length?-1:t.delivery_type[0],sale_type:t.sale_type.length===this.saleType.length?-1:t.sale_type[0],spec_name_arr:a},this.addService.addGoods(s).subscribe((function(t){e.$router.push({path:\"./list\"})}))},editGoodOld:function(t){var e=this,s={},i=[];this.tableData.forEach((function(t,s){var a={};if(a.market_price=t.market_price,a.selling_price=t.selling_price,a.stock_amount=t.stock_amount,t.sku_id&&(a.is_update=t.is_update,a.sku_id=t.sku_id),a.spec_arr=[],e.skuList.length>0){var n={};e.info.all_spec[0].spec_item_arr.forEach((function(s){n.spec_id=e.info.all_spec[0].spec_id,s.spec_item_name===t[\"0\"]&&(n.spec_item_id=s.spec_item_id)})),n.spec_name=e.skuList[0].spec_name,n.spec_item_name=t[\"0\"],a.spec_arr.push(n)}if(e.skuList.length>1){var o={};e.info.all_spec[1].spec_item_arr.forEach((function(s){o.spec_id=e.info.all_spec[1].spec_id,s.spec_item_name===t[\"1\"]&&(o.spec_item_id=s.spec_item_id)})),o.spec_name=e.skuList[1].spec_name,o.spec_item_name=t[\"1\"],a.spec_arr.push(o)}if(e.skuList.length>2){var r={};e.info.all_spec[2].spec_item_arr.forEach((function(s){r.spec_id=e.info.all_spec[2].spec_id,s.spec_item_name===t[\"2\"]&&(r.spec_item_id=s.spec_item_id)})),r.spec_name=e.skuList[2].spec_name,r.spec_item_name=t[\"2\"],a.spec_arr.push(r)}i.push(a)})),s={product_images_del:this.product_images_del,product_images_add:this.imgList.filter((function(t){return t.isNew})),product_intro:this.content,product_sku:i,shelves_status:this.shelves_status,product_name:t.product_name,category_id:t.category_id,delivery_type:t.delivery_type.length===this.shippingMode.length?-1:t.delivery_type[0],sale_type:t.sale_type.length===this.saleType.length?-1:t.sale_type[0]},this.addService.editGoods(this.$route.query.id,s).subscribe((function(t){e.$router.push({path:\"./list\"})}))},goodDetail:function(){var t=this;this.form.setFieldsValue({product_name:this.info.product_name,category_id:this.info.category_id,delivery_type:-1===this.info.delivery_type?this.shippingMode.map((function(t){return t.value})):[this.info.delivery_type],sale_type:-1===this.info.sale_type?this.saleType.map((function(t){return t.value})):[this.info.sale_type]}),this.name=this.info.product_name,this.isMore=this.info.all_spec?2:1,this.imgList=this.info.product_images,this.content=this.info.product_intro,this.shelves_status=this.info.shelves_status,this.skuList=[],this.info.all_spec&&this.info.all_spec.forEach((function(e){var s=[];e.spec_item_arr&&(e.spec_item_arr.forEach((function(t){s.push(t.spec_item_name)})),t.skuList.push({spec_name:e.spec_name,spec_item_name:s,isErr:!1,isNameErr:!1}))}));var e=[];this.info.product_sku.forEach((function(t,s){var i={};i.market_price=t.market_price,i.selling_price=t.selling_price,i.stock_amount=t.stock_amount,i.sku_id=t.sku_id,i.is_update=0,i.key=parseInt(999999*Math.random()).toString(),t.spec_arr&&t.spec_arr.forEach((function(t,e){i[e]=t.spec_item_name})),e.push(i)})),this.tableData=e},changeName:function(t){this.name=t.target.value},delImg:function(t,e){this.isEditMode&&t.image_id&&this.product_images_del.push(t.image_id),this.imgList.splice(e,1)},addSku:function(){this.skuList.push({spec_name:\"\",spec_item_name:[],isErr:!1,isNameErr:!1})},addSkuItem:function(t){var e=this;this.$modalRouter.push({name:\"store-add-sku\",props:{list:this.skuList[t].spec_item_name},on:{success:function(s){e.skuList[t].spec_item_name.push(s),e.changeTable()}}})},delSkuItem:function(t,e){this.skuList[t].spec_item_name.splice(e,1),this.changeTable()},delSku:function(t){this.skuList.splice(t,1),this.skuList.length||(this.isMore=1,this.tableData=[{market_price:\"\",selling_price:\"\",stock_amount:\"\",key:parseInt(999999*Math.random()).toString()}])},getImageUrl:function(t){var e=\"<img src='\".concat(t.url,\"' width='400' height='400'>\");this.content=this.content+e},onChangeEditor:function(){return this.isEditor=0===this.content.length,0===this.content.length},getImage:function(t){var e={image_id:t[0].image_id,image_key:t[0].image_key,image_url:t[0].image_url,is_cover:0};this.imgList.push(e),this.isEditMode&&(e.isNew=!0),this.isImgError=!1,this.fileList=[]},changeTable:function(){var t=[],e=[];this.skuList.forEach((function(t,s){0!==t.spec_item_name.length&&e.push(t)})),e[0].spec_item_name.forEach((function(s,i){var a={market_price:\"\",selling_price:\"\",stock_amount:\"\"};a[\"0\"]=s,e[1]&&e[1].spec_item_name.length?e[1].spec_item_name.forEach((function(s,i){a[\"1\"]=s,e[2]&&e[2].spec_item_name.length?e[2].spec_item_name.forEach((function(e,s){a[\"2\"]=e,t.push(Object(k[\"a\"])(a))})):t.push(Object(k[\"a\"])(a))})):t.push(Object(k[\"a\"])(a))})),t.forEach((function(t){t.key=parseInt(999999*Math.random()).toString()})),this.tableData=t},openClass:function(){var t=this;this.$modalRouter.push({name:\"store-class-manage\",props:{shopList:1},on:{success:function(e){t.addService.getList().subscribe((function(e){t.classList=e.list;var s=t.form.getFieldsValue();t.classList.some((function(t){return t.id===s.category_id}))||t.form.setFieldsValue({category_id:\"\"})}))}}})},changeMore:function(){this.skuList=[],this.tableData=[{market_price:\"\",selling_price:\"\",stock_amount:\"\",key:parseInt(999999*Math.random()).toString()}]},allApply:function(t,e){this.tableData.map((function(s){return s[t]=e}))}}},T=G,R=Object(j[\"a\"])(T,n,o,!1,null,null,null);e[\"default\"]=R.exports},aab0:function(t,e,s){\"use strict\";s.r(e),s.d(e,\"EditService\",(function(){return d}));s(\"c5f6\");var i,a=s(\"d225\"),n=s(\"b0b4\"),o=s(\"9ab4\"),r=s(\"0cd5\"),c=s(\"df29\"),l=s(\"c4cc\"),u=s(\"b57f\"),d=function(){function t(e){Object(a[\"a\"])(this,t),this.StoreApi=e,this.loading$=new c[\"d\"]({}),this.info$=new c[\"d\"]({})}return Object(n[\"a\"])(t,[{key:\"goodsDetail\",value:function(t){var e=this;return this.StoreApi.goodsDetail(t).pipe(Object(l[\"a\"])((function(t){e.info$.commit((function(){return t}))})))}},{key:\"beforeRouteEnter\",value:function(t){if(t.meta.query.id)return this.goodsDetail(t.meta.query.id)}}]),t}();Object(o[\"b\"])([Object(c[\"c\"])(),Object(o[\"d\"])(\"design:type\",Function),Object(o[\"d\"])(\"design:paramtypes\",[Number]),Object(o[\"d\"])(\"design:returntype\",void 0)],d.prototype,\"goodsDetail\",null),d=Object(o[\"b\"])([Object(r[\"b\"])(),Object(o[\"d\"])(\"design:paramtypes\",[\"function\"===typeof(i=\"undefined\"!==typeof u[\"e\"]&&u[\"e\"])?i:Object])],d)},c8bf:function(t,e,s){\"use strict\";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"st-panel\",{class:t.basic(),attrs:{app:\"\"}},[s(\"div\",{class:t.basic(\"search\")},[s(\"div\",{class:t.basic(\"add\")},[t.auth.add?s(\"st-button\",{attrs:{icon:\"add\",type:\"primary\"},on:{click:t.onAddGoods}},[t._v(\"\\n        新增商品\\n      \")]):t._e()],1),s(\"a-select\",{class:t.basic(\"select\"),staticStyle:{width:\"130px\"},attrs:{placeholder:\"商品分类\"},on:{change:function(e){return t.onSingleSearch(\"category_id\",e)}},model:{value:t.categoryId,callback:function(e){t.categoryId=e},expression:\"categoryId\"}},t._l(t.goods_sort,(function(e){return s(\"a-select-option\",{key:e.value},[t._v(\"\\n        \"+t._s(e.label)+\"\\n      \")])})),1),s(\"a-select\",{class:t.basic(\"select\"),staticStyle:{width:\"130px\",margin:\"0 12px\"},attrs:{placeholder:\"所有上架状态\"},on:{change:function(e){return t.onSingleSearch(\"shelves_status\",e)}},model:{value:t.shelvesStatus,callback:function(e){t.shelvesStatus=e},expression:\"shelvesStatus\"}},t._l(t.cloudStore,(function(e){return s(\"a-select-option\",{key:e.value},[t._v(\"\\n        \"+t._s(e.label)+\"\\n      \")])})),1),s(\"st-input-search\",{attrs:{placeholder:\"请输入商品名称\",maxlength:\"50\"},on:{search:function(e){return t.onSingleSearch(\"product_name\",e)}},model:{value:t.goodsName,callback:function(e){t.goodsName=e},expression:\"goodsName\"}})],1),s(\"div\",{class:t.basic(\"content\")},[s(\"st-table\",{attrs:{rowKey:\"product_id\",page:t.page,columns:t.columns,dataSource:t.list},on:{change:t.onTableChange},scopedSlots:t._u([{key:\"action\",fn:function(e,i){return[s(\"st-table-actions\",{attrs:{sytle:\"width: 120px\"}},[i.auth[\"shop:cloud_store:goods|edit\"]?s(\"a\",{on:{click:function(e){return t.onEdit(i)}}},[t._v(\"\\n            编辑\\n          \")]):t._e(),i.auth[\"shop:cloud_store:goods|up\"]?s(\"a\",{on:{click:function(e){return t.onShelf(i)}}},[t._v(\"\\n            上架\\n          \")]):t._e(),i.auth[\"shop:cloud_store:goods|down\"]?s(\"a\",{on:{click:function(e){return t.onShelf(i)}}},[t._v(\"\\n            下架\\n          \")]):t._e(),i.auth[\"shop:cloud_store:goods|del\"]?s(\"a\",{on:{click:function(e){return t.onDel(i)}}},[t._v(\"\\n            删除\\n          \")]):t._e()])]}}])})],1)])},a=[],n=(s(\"ac6a\"),s(\"ea3e\")),o=function(t){return[{title:\"商品名称\",dataIndex:\"product_name\",width:175,scopedSlots:{customRender:\"product_name\"}},{title:\"商品分类\",dataIndex:\"category_name\",scopedSlots:{customRender:\"category_name\"}},{title:\"售卖方式\",dataIndex:\"sale_type_name\",scopedSlots:{customRender:\"sale_type_name\"}},{title:\"上架状态\",dataIndex:\"product_shelves_name\",scopedSlots:{customRender:\"product_shelves_name\"}},{title:\"销量\",dataIndex:\"sales_volume\",scopedSlots:{customRender:\"sales_volume\"}},{title:\"单价(元)\",dataIndex:\"selling_price\",scopedSlots:{customRender:\"selling_price\"}},{title:\"库存\",dataIndex:\"stock_amount\",scopedSlots:{customRender:\"stock_amount\"}},{title:\"操作\",dataIndex:\"action\",width:140,scopedSlots:{customRender:\"action\"}}]},r=s(\"814c\"),c=(s(\"2138\"),{mixins:[n[\"a\"]],name:\"PageShopStoreList\",bem:{basic:\"page-shop-store-list\"},serviceInject:function(){return{listService:r[\"ListService\"]}},rxState:function(){return{list:this.listService.list$,page:this.listService.page$,loading:this.listService.loading$,goodsList:this.listService.goodsList$,cloudStore:this.listService.shelvesStatus$,auth:this.listService.auth$}},data:function(t){return{goodsName:\"\",shelvesStatus:-1,categoryId:-1,columns:o(t)}},computed:{goods_sort:function(){var t=[];return this.goodsList.forEach((function(e){t.push({value:+e.category_id,label:e.category_name})})),[{value:-1,label:\"所有商品分类\"}].concat(t)}},mounted:function(){this.setSearchData()},watch:{query:function(t){this.setSearchData()}},methods:{setSearchData:function(){var t=this.$searchQuery,e=t.product_name,s=t.shelves_status,i=t.category_id;this.goodsName=e,this.categoryId=i||-1,this.shelvesStatus=s||-1},onAddGoods:function(){this.$router.push({path:\"./add\"})},onShelf:function(t){var e=this,s=1===t.product_shelves?2:1;this.$confirm({title:\"提示\",content:\"确定\".concat(1===s?\"上架\":\"下架\",\"该商品吗？\"),onOk:function(){e.listService.onShelf(t.product_id,{shelves_status:s}).subscribe((function(t){e.$router.reload()}))},onCancel:function(){}})},onDel:function(t){var e=this;this.$confirm({title:\"提示\",content:\"一旦删除则无法恢复，确定删除\".concat(t.product_name,\"？\"),onOk:function(){e.listService.delproduct(t.product_id).subscribe((function(t){e.$router.reload()}))},onCancel:function(){}})},onEdit:function(t){this.$router.push({path:\"./edit\",query:{id:t.product_id}})}}}),l=c,u=s(\"2877\"),d=Object(u[\"a\"])(l,i,a,!1,null,null,null);e[\"default\"]=d.exports},d7eb:function(t,e,s){\"use strict\";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"good-add\",{attrs:{isEditMode:!0,info:t.info}})},a=[],n=s(\"9788\"),o=s(\"aab0\"),r={serviceInject:function(){return{editService:o[\"EditService\"]}},rxState:function(){return{info:this.editService.info$}},components:{GoodAdd:n[\"default\"]}},c=r,l=s(\"2877\"),u=Object(l[\"a\"])(c,i,a,!1,null,null,null);e[\"default\"]=u.exports},e316:function(t,e,s){\"use strict\";s.r(e);var i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"router-view\")},a=[],n=s(\"2877\"),o={},r=Object(n[\"a\"])(o,i,a,!1,null,null,null);e[\"default\"]=r.exports}}]);","extractedComments":[]}