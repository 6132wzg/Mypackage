{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js!/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhigang/Desktop/styd/web/src/views/pages/brand/setting/general/user-level.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/pages/brand/setting/general/user-level.vue","mtime":1591147717348},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js","mtime":1591062572376}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { UserLevelService } from \"./user-level.service\";\nimport { MessageService } from '@/services/message.service';\nimport SelectCondition from \"./components#/select-condition\";\nimport SelectRights from \"./components#/select-rights\";\nexport default {\n  bem: {\n    b: 'page-user-level'\n  },\n  serviceInject: function serviceInject() {\n    return {\n      userLevelService: UserLevelService,\n      messageService: MessageService\n    };\n  },\n  rxState: function rxState() {\n    var userLevelService = this.userLevelService;\n    return {\n      list: userLevelService.list$,\n      info: userLevelService.info$,\n      loading: userLevelService.loading$,\n      auth: userLevelService.auth$\n    };\n  },\n  data: function data() {\n    return {\n      condition: [],\n      rights: []\n    };\n  },\n  filters: {\n    textFilter: function textFilter(text, list, index) {\n      return text + (index < list.length - 1 ? '、' : '');\n    }\n  },\n  components: {\n    SelectCondition: SelectCondition,\n    SelectRights: SelectRights\n  },\n  computed: {\n    isEdit: function isEdit() {\n      return this.$searchQuery.type === 'edit';\n    },\n\n    /**\n     * 潜在会员\n     */\n    potential: function potential() {\n      return this.list[0];\n    },\n\n    /**\n     * 正式会员\n     */\n    member: function member() {\n      return this.list[1];\n    },\n\n    /**\n     * 流失会员\n     */\n    lost: function lost() {\n      return this.list[2];\n    }\n  },\n  methods: {\n    onEdit: function onEdit() {\n      this.$router.push({\n        query: {\n          type: 'edit'\n        }\n      });\n    },\n    onSave: function onSave() {\n      var _this = this;\n\n      var params = this.getData();\n\n      if (!this.inputCheck(params)) {\n        this.messageService.error({\n          content: '请至少选择一个升级到正式会员所需条件'\n        });\n        return;\n      }\n\n      this.userLevelService.update(params).subscribe(function () {\n        _this.messageService.success({\n          content: '保存成功'\n        });\n\n        _this.$router.push({\n          query: {}\n        });\n      });\n    },\n    onCancel: function onCancel() {\n      this.$router.push({\n        query: {}\n      });\n    },\n    onConditionChange: function onConditionChange(val) {\n      this.condition = val;\n    },\n    onRightsChange: function onRightsChange(val) {\n      this.rights = val;\n    },\n    getData: function getData() {\n      return {\n        condition: this.condition,\n        rights: this.rights\n      };\n    },\n    inputCheck: function inputCheck(params) {\n      var condition = params.condition;\n\n      if (!condition.length) {\n        return false;\n      }\n\n      return true;\n    }\n  }\n};",{"version":3,"sources":["user-level.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <st-panel app v-if=\"auth.get\">\n    <div :class=\"b()\">\n      <st-t2>用户等级设置</st-t2>\n      <a-row :gutter=\"12\" class=\"mg-t24 ta-c\">\n        <!-- 潜在会员 -->\n        <a-col :span=\"7\">\n          <div :class=\"b('item')\">\n            <st-t2>{{ potential.level_name }}</st-t2>\n            <div>\n              <img\n                :class=\"b('item-icon')\"\n                src=\"~@/assets/img/member_potential.png\"\n                alt=\"潜在会员\"\n              />\n            </div>\n            <div :class=\"b('sub-title')\">条件</div>\n            <ul>\n              <li v-if=\"potential.condition.length\" :class=\"b('list-item')\">\n                <i\n                  class=\"icon-member-checked icon-member-checked--potential\"\n                ></i>\n                <span v-for=\"(item, index) in potential.condition\" :key=\"index\">\n                  {{\n                    item.condition_name | textFilter(potential.condition, index)\n                  }}\n                </span>\n              </li>\n            </ul>\n          </div>\n        </a-col>\n        <!-- 正式会员 -->\n        <a-col :span=\"10\">\n          <div :class=\"b('item')\">\n            <st-t2>{{ member.level_name }}</st-t2>\n            <st-info-action\n              icon=\"edit\"\n              text=\"编辑\"\n              :class=\"b('item-edit')\"\n              v-if=\"auth.edit && !isEdit\"\n              @click=\"onEdit\"\n            />\n            <div>\n              <img\n                :class=\"b('item-icon')\"\n                src=\"~@/assets/img/member.png\"\n                alt=\"正式会员\"\n              />\n            </div>\n            <div :class=\"b('sub-title')\">\n              条件\n              <st-help-tooltip id=\"TBYHDJ001\" />\n            </div>\n            <select-condition\n              v-if=\"isEdit && info.condition\"\n              v-model=\"info.condition\"\n              @change=\"onConditionChange\"\n            />\n            <ul v-else>\n              <li v-if=\"member.condition.length\" :class=\"b('list-item')\">\n                <i\n                  class=\"icon-member-checked icon-member-checked--potential\"\n                ></i>\n                <span v-for=\"(item, index) in member.condition\" :key=\"index\">\n                  {{\n                    item.condition_name | textFilter(member.condition, index)\n                  }}\n                </span>\n              </li>\n            </ul>\n            <div :class=\"b('sub-title')\">\n              特权类目\n              <st-help-tooltip id=\"TBYHDJ002\" />\n            </div>\n            <select-rights\n              v-if=\"isEdit && info.rights\"\n              v-model=\"info.rights\"\n              @change=\"onRightsChange\"\n            />\n            <ul v-else>\n              <li :class=\"b('list-item')\" v-if=\"member.rights.length\">\n                <i class=\"icon-member-checked\"></i>\n                <span v-for=\"(item, index) in member.rights\" :key=\"index\">\n                  {{ item.rights_name | textFilter(member.rights, index) }}\n                </span>\n              </li>\n              <li v-else class=\"st-des mg-t8\">暂无特权类目～</li>\n            </ul>\n          </div>\n        </a-col>\n        <!-- 流失会员 -->\n        <a-col :span=\"7\">\n          <div :class=\"b('item')\">\n            <st-t2>{{ lost.level_name }}</st-t2>\n            <div>\n              <img\n                :class=\"b('item-icon')\"\n                src=\"~@/assets/img/member_lost.png\"\n                alt=\"流失会员\"\n              />\n            </div>\n            <div :class=\"b('sub-title')\">条件</div>\n            <ul>\n              <li v-if=\"lost.condition.length\" :class=\"b('list-item')\">\n                <i\n                  class=\"icon-member-checked icon-member-checked--potential\"\n                ></i>\n                <span v-for=\"(item, index) in lost.condition\" :key=\"index\">\n                  {{ item.condition_name | textFilter(lost.condition, index) }}\n                </span>\n              </li>\n            </ul>\n          </div>\n        </a-col>\n      </a-row>\n      <div class=\"ta-c mg-t24\" v-if=\"isEdit\">\n        <st-button type=\"primary\" @click=\"onSave\" :loading=\"loading.update\">\n          保存\n        </st-button>\n        <st-button class=\"mg-l8\" @click=\"onCancel\">取消</st-button>\n      </div>\n    </div>\n  </st-panel>\n</template>\n<script>\nimport { UserLevelService } from './user-level.service'\nimport { MessageService } from '@/services/message.service'\nimport SelectCondition from './components#/select-condition'\nimport SelectRights from './components#/select-rights'\nexport default {\n  bem: {\n    b: 'page-user-level'\n  },\n  serviceInject() {\n    return {\n      userLevelService: UserLevelService,\n      messageService: MessageService\n    }\n  },\n  rxState() {\n    const { userLevelService } = this\n    return {\n      list: userLevelService.list$,\n      info: userLevelService.info$,\n      loading: userLevelService.loading$,\n      auth: userLevelService.auth$\n    }\n  },\n  data() {\n    return {\n      condition: [],\n      rights: []\n    }\n  },\n  filters: {\n    textFilter(text, list, index) {\n      return text + (index < list.length - 1 ? '、' : '')\n    }\n  },\n  components: {\n    SelectCondition,\n    SelectRights\n  },\n  computed: {\n    isEdit() {\n      return this.$searchQuery.type === 'edit'\n    },\n    /**\n     * 潜在会员\n     */\n    potential() {\n      return this.list[0]\n    },\n    /**\n     * 正式会员\n     */\n    member() {\n      return this.list[1]\n    },\n    /**\n     * 流失会员\n     */\n    lost() {\n      return this.list[2]\n    }\n  },\n  methods: {\n    onEdit() {\n      this.$router.push({\n        query: {\n          type: 'edit'\n        }\n      })\n    },\n    onSave() {\n      const params = this.getData()\n      if (!this.inputCheck(params)) {\n        this.messageService.error({\n          content: '请至少选择一个升级到正式会员所需条件'\n        })\n        return\n      }\n      this.userLevelService.update(params).subscribe(() => {\n        this.messageService.success({\n          content: '保存成功'\n        })\n        this.$router.push({\n          query: {}\n        })\n      })\n    },\n    onCancel() {\n      this.$router.push({\n        query: {}\n      })\n    },\n    onConditionChange(val) {\n      this.condition = val\n    },\n    onRightsChange(val) {\n      this.rights = val\n    },\n    getData() {\n      return {\n        condition: this.condition,\n        rights: this.rights\n      }\n    },\n    inputCheck(params) {\n      const { condition } = params\n      if (!condition.length) {\n        return false\n      }\n      return true\n    }\n  }\n}\n</script>\n"],"sourceRoot":"src/views/pages/brand/setting/general"}]}