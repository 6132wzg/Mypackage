{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/thread-loader/dist/cjs.js!/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js!/Users/wangzhigang/Desktop/styd/web/node_modules/ts-loader/index.js??ref--13-3!/Users/wangzhigang/Desktop/styd/web/src/views/pages/shop/member/info/reserve.service.ts","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/pages/shop/member/info/reserve.service.ts","mtime":1596188219706},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/thread-loader/dist/cjs.js","mtime":1591062572352},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/ts-loader/index.js","mtime":1591062571609}],"contextDependencies":[],"result":["import _classCallCheck from \"/Users/wangzhigang/Desktop/styd/web/node_modules/@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/wangzhigang/Desktop/styd/web/node_modules/@babel/runtime-corejs2/helpers/esm/createClass\";\n\nvar _a;\n\nimport { __decorate, __metadata } from \"tslib\";\nimport { Injectable } from 'vue-service-app';\nimport { State } from 'rx-state';\nimport { tap } from 'rxjs/operators';\nimport { MemberApi } from '@/api/v1/member';\nimport { anyAll } from '@/operators';\n\nvar ReserveService = /*#__PURE__*/function () {\n  function ReserveService(memberApi) {\n    _classCallCheck(this, ReserveService);\n\n    this.memberApi = memberApi;\n    this.memberCardList$ = new State([]);\n    this.depositCardList$ = new State([]);\n    this.personalCourseList$ = new State([]);\n    this.packageList$ = new State([]);\n    this.smallCourseList$ = new State([]);\n    this.memberCardPage$ = new State({});\n    this.depositCardPage$ = new State({});\n    this.personalCoursePage$ = new State({});\n    this.packagePage$ = new State({});\n    this.smallCoursePage$ = new State({});\n  }\n\n  _createClass(ReserveService, [{\n    key: \"SET_MEMBER_CARD_LIST\",\n    value: function SET_MEMBER_CARD_LIST(list) {\n      list = list.map(function (item) {\n        item.initAmount = \"\".concat(item.init_amount.number).concat(item.init_amount.type);\n        item.remainAmount = \"\".concat(item.remain_amount.number).concat(item.remain_amount.type);\n        item.memberList = item.member_info.members.map(function (member) {\n          if (member.is_purchaser) {\n            return \"\\u8D2D\\u4E70\\u4EBA: \".concat(member.member_info);\n          } else {\n            return \"\\u6210\\u5458: \".concat(member.member_info);\n          }\n        });\n        return item;\n      });\n      this.memberCardList$.commit(function () {\n        return list;\n      });\n    }\n  }, {\n    key: \"SET_DEPOSIT_CARD_LIST\",\n    value: function SET_DEPOSIT_CARD_LIST(list) {\n      list = list.map(function (item) {\n        item.initAmount = \"\".concat(item.init_amount.number).concat(item.init_amount.type);\n        item.remainAmount = \"\".concat(item.remain_amount.number).concat(item.remain_amount.type);\n        return item;\n      });\n      this.depositCardList$.commit(function () {\n        return list;\n      });\n    }\n  }, {\n    key: \"SET_PERSONAL_COURSE_LIST\",\n    value: function SET_PERSONAL_COURSE_LIST(list) {\n      this.personalCourseList$.commit(function () {\n        return list;\n      });\n    }\n  }, {\n    key: \"SET_PACKAGE_LIST\",\n    value: function SET_PACKAGE_LIST(list) {\n      list = list.map(function (item) {\n        item.init = \"\".concat(item.team_course_init, \"/\").concat(item.personal_course_init);\n        item.remain = \"\".concat(item.team_course_remain, \"/\").concat(item.personal_course_remain);\n        item.memberList = item.member_info.members.map(function (member) {\n          if (member.is_purchaser) {\n            return \"\\u8D2D\\u4E70\\u4EBA: \".concat(member.member_info);\n          } else {\n            return \"\\u6210\\u5458: \".concat(member.member_info);\n          }\n        });\n        return item;\n      });\n      this.packageList$.commit(function () {\n        return list;\n      });\n    }\n  }, {\n    key: \"getMemberCardList\",\n    value: function getMemberCardList(query) {\n      var _this = this;\n\n      return this.memberApi.getMemberCardList(query).pipe(tap(function (res) {\n        _this.SET_MEMBER_CARD_LIST(res.list);\n\n        _this.memberCardPage$.commit(function () {\n          return res.page;\n        });\n      }));\n    }\n  }, {\n    key: \"getDepositCardList\",\n    value: function getDepositCardList(query) {\n      var _this2 = this;\n\n      return this.memberApi.getDepositCardList(query).pipe(tap(function (res) {\n        _this2.SET_DEPOSIT_CARD_LIST(res.list);\n\n        _this2.depositCardPage$.commit(function () {\n          return res.page;\n        });\n      }));\n    }\n  }, {\n    key: \"getPersonalCourseList\",\n    value: function getPersonalCourseList(query) {\n      var _this3 = this;\n\n      return this.memberApi.getPersonalCourseList(query).pipe(tap(function (res) {\n        _this3.SET_PERSONAL_COURSE_LIST(res.list);\n\n        _this3.personalCoursePage$.commit(function () {\n          return res.page;\n        });\n      }));\n    }\n  }, {\n    key: \"getPackageList\",\n    value: function getPackageList(query) {\n      var _this4 = this;\n\n      return this.memberApi.getPackageList(query).pipe(tap(function (res) {\n        _this4.SET_PACKAGE_LIST(res.list);\n\n        _this4.packagePage$.commit(function () {\n          return res.page;\n        });\n      }));\n    }\n  }, {\n    key: \"getSmallCourseList\",\n    value: function getSmallCourseList(query) {\n      var _this5 = this;\n\n      return this.memberApi.getSmallCourseList(query).pipe(tap(function (res) {\n        _this5.smallCourseList$.commit(function () {\n          return res.list;\n        });\n\n        _this5.smallCoursePage$.commit(function () {\n          return res.page;\n        });\n      }));\n    }\n  }, {\n    key: \"changePage\",\n    value: function changePage(query) {\n      var type = query.type;\n\n      switch (type) {\n        case 'member':\n          return this.getMemberCardList(query);\n\n        case 'deposit':\n          return this.getDepositCardList(query);\n\n        case 'package':\n          return this.getPackageList(query);\n\n        case 'personal':\n          return this.getPersonalCourseList(query);\n\n        case 'small':\n          return this.getSmallCourseList(query);\n\n        default:\n          return anyAll(this.getMemberCardList(query), this.getDepositCardList(query), this.getPackageList(query), this.getPersonalCourseList(query), this.getSmallCourseList(query));\n      }\n    }\n  }, {\n    key: \"init\",\n    value: function init(query) {\n      return this.changePage(query);\n    }\n  }, {\n    key: \"beforeRouteEnter\",\n    value: function beforeRouteEnter(to, from) {\n      return this.init(to.query);\n    }\n  }]);\n\n  return ReserveService;\n}();\n\nReserveService = __decorate([Injectable(), __metadata(\"design:paramtypes\", [typeof (_a = typeof MemberApi !== \"undefined\" && MemberApi) === \"function\" ? _a : Object])], ReserveService);\nexport { ReserveService };",null]}