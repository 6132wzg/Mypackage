{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js!/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhigang/Desktop/styd/web/src/views/biz-modals/finance/add-performance-template.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/biz-modals/finance/add-performance-template.vue","mtime":1600926555854},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js","mtime":1591062572376}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { MessageService } from '@/services/message.service';\nimport { AddTemplateService } from \"./add-performance-template.service\";\nimport { UserService } from '@/services/user.service';\nimport { ruleOptions } from \"./performance-template.config\";\nimport { PERFORMANCE } from '@/constants/finance/performance';\nexport default {\n  serviceInject: function serviceInject() {\n    return {\n      service: AddTemplateService,\n      message: MessageService\n    };\n  },\n  rxState: function rxState() {\n    return {\n      performanceModes: this.service.performanceModes$,\n      performanceTypes: this.service.performanceTypes$\n    };\n  },\n  data: function data() {\n    var form = this.$stForm.create();\n    var decorators = form.decorators(ruleOptions);\n    return {\n      PERFORMANCE: PERFORMANCE,\n      form: form,\n      decorators: decorators,\n      data: [],\n      gradients: {\n        range_min: '',\n        royalty_num: ''\n      },\n      show: false,\n      choose: 1,\n      // 1 百分比 0 金额\n      isChooseks: true,\n      // 是否选中课时\n      performance_type: 1,\n      performance_mode: 1\n    };\n  },\n  computed: {\n    placeholderGradient: function placeholderGradient() {\n      if (this.performance_type == this.PERFORMANCE.PERFORMANCE_TYPE_1) {\n        return '请输入月销售额';\n      }\n\n      if (this.performance_type == this.PERFORMANCE.PERFORMANCE_TYPE_2) {\n        return '请输入月课时价值';\n      }\n\n      if (this.performance_type == this.PERFORMANCE.PERFORMANCE_TYPE_3) {\n        return '请输入月课时数';\n      }\n\n      return '请输入';\n    },\n    errorMessageTip: function errorMessageTip() {\n      if (this.performance_type == this.PERFORMANCE.PERFORMANCE_TYPE_1) {\n        return '月销售额不能重复';\n      }\n\n      if (this.performance_type == this.PERFORMANCE.PERFORMANCE_TYPE_2) {\n        return '月课时价值不能重复';\n      }\n\n      if (this.performance_type == this.PERFORMANCE.PERFORMANCE_TYPE_3) {\n        return '月课时数不能重复';\n      }\n\n      return '请输入';\n    },\n    placeholderGradientFee: function placeholderGradientFee() {\n      if (this.performance_type == this.PERFORMANCE.PERFORMANCE_TYPE_3) {\n        return '请输入课时费';\n      }\n\n      return '请输入月销售额';\n    }\n  },\n  methods: {\n    selectType: function selectType(e) {\n      this.performance_type = e;\n\n      if (e === this.PERFORMANCE.PERFORMANCE_TYPE_1 || e === this.PERFORMANCE.PERFORMANCE_TYPE_2) {\n        this.isChooseks = true;\n      } else if (e === this.PERFORMANCE.PERFORMANCE_TYPE_3) {\n        this.isChooseks = false;\n      }\n    },\n    submitEdit: function submitEdit(e) {\n      var range_min = this.data[e].range_min;\n      var royalty_num = this.data[e].royalty_num;\n\n      if (!this.data[e].range_min || !this.data[e].royalty_num) {\n        this.message.warn({\n          content: '请填写完整'\n        });\n        return;\n      }\n\n      if (this.performance_type == this.PERFORMANCE.PERFORMANCE_TYPE_3) {\n        range_min = parseInt(range_min);\n      } else {\n        range_min = parseFloat(range_min).toFixed(1);\n      }\n\n      royalty_num = parseFloat(royalty_num).toFixed(1);\n      var arr = this.data.filter(function (item, index) {\n        return item.range_min === range_min && index !== e;\n      });\n\n      if (arr.length > 0) {\n        this.message.warn({\n          content: this.errorMessageTip\n        });\n        return;\n      }\n\n      this.data[e].range_min = range_min;\n      this.data[e].royalty_num = royalty_num;\n      delete this.data[e].range_min_bak;\n      delete this.data[e].royalty_num_bak;\n      this.data[e].isEdit = false;\n    },\n    cancelEdit: function cancelEdit(e) {\n      this.data[e].isEdit = false;\n      this.data[e].range_min = this.data[e].range_min_bak;\n      this.data[e].royalty_num = this.data[e].royalty_num_bak;\n      delete this.data[e].range_min_bak;\n      delete this.data[e].royalty_num_bak;\n    },\n    editPerformanceNum: function editPerformanceNum(e) {\n      this.data[e].isEdit = true;\n      this.data[e].range_min_bak = this.data[e].range_min;\n      this.data[e].royalty_num_bak = this.data[e].royalty_num;\n    },\n    deletePerformanceNum: function deletePerformanceNum(e) {\n      this.data.splice(e, 1);\n    },\n    addGradients: function addGradients(e) {\n      // 加校验\n      var _this$gradients = this.gradients,\n          range_min = _this$gradients.range_min,\n          royalty_num = _this$gradients.royalty_num;\n\n      if (!range_min || !royalty_num) {\n        this.message.warn({\n          content: '请填写完整'\n        });\n        return;\n      }\n\n      if (this.performance_type == this.PERFORMANCE.PERFORMANCE_TYPE_3) {\n        range_min = parseInt(range_min);\n      } else {\n        range_min = parseFloat(range_min).toFixed(1);\n      }\n\n      royalty_num = parseFloat(royalty_num).toFixed(1);\n      var arr = this.data.filter(function (item) {\n        return item.range_min === range_min;\n      });\n\n      if (arr.length > 0) {\n        this.message.warn({\n          content: this.errorMessageTip\n        });\n        return;\n      }\n\n      this.data.push({\n        id: 0,\n        range_min: range_min,\n        royalty_num: royalty_num,\n        isEdit: false\n      });\n      this.gradients.range_min = '';\n      this.gradients.royalty_num = '';\n    },\n    handleSubmit: function handleSubmit(e) {\n      var _this = this;\n\n      e.preventDefault();\n      this.form.validate().then(function (values) {\n        values.gradients = _this.data;\n\n        if (values.performance_type === _this.PERFORMANCE.PERFORMANCE_TYPE_3) {\n          values.performance_mode = 0;\n        }\n\n        _this.service.addTemplate(values).subscribe(function () {\n          _this.$emit('change');\n\n          _this.message.success({\n            content: '新增成功'\n          });\n\n          _this.show = false;\n        });\n      });\n    },\n    onChooseRadio: function onChooseRadio(e) {\n      this.performance_mode = e.target.value;\n      this.data = [];\n    }\n  }\n};",{"version":3,"sources":["add-performance-template.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <st-modal title=\"新增业绩模板\" v-model=\"show\" @ok=\"handleSubmit\">\n    <st-form\n      :form=\"form\"\n      labelWidth=\"102px\"\n      @submit=\"handleSubmit\"\n      class=\"modal-add-perfromance-contaner\"\n    >\n      <a-row :gutter=\"8\">\n        <a-col :lg=\"24\">\n          <st-form-item label=\"模板名称\" required>\n            <a-input\n              placeholder=\"请输模板名称\"\n              v-decorator=\"decorators.template_name\"\n            />\n          </st-form-item>\n        </a-col>\n        <a-col :lg=\"24\">\n          <st-form-item label=\"业绩类型\" required>\n            <a-select\n              v-decorator=\"decorators.performance_type\"\n              placeholder=\"请选择\"\n              @change=\"selectType\"\n            >\n              <template v-for=\"(item, key) in performanceTypes\">\n                <a-select-option :key=\"key\" :value=\"+item.value\">\n                  {{ item.label }}\n                </a-select-option>\n              </template>\n            </a-select>\n          </st-form-item>\n        </a-col>\n        <a-col :lg=\"24\" v-if=\"isChooseks\">\n          <st-form-item label=\"提成模式\" required>\n            <a-radio-group\n              @change=\"onChooseRadio\"\n              v-decorator=\"decorators.performance_mode\"\n            >\n              <template v-for=\"(item, key) in performanceModes\">\n                <a-radio :key=\"key\" :value=\"+item.value\">\n                  {{ item.label }}\n                </a-radio>\n              </template>\n            </a-radio-group>\n          </st-form-item>\n        </a-col>\n        <a-col :lg=\"24\">\n          <st-form-item required>\n            <template\n              slot=\"label\"\n              v-if=\"\n                performance_type == PERFORMANCE.PERFORMANCE_TYPE_1 ||\n                  performance_type == PERFORMANCE.PERFORMANCE_TYPE_2\n              \"\n            >\n              默认提成\n              <st-help-tooltip id=\"TBPT001\" />\n            </template>\n            <template\n              slot=\"label\"\n              v-if=\"performance_type == PERFORMANCE.PERFORMANCE_TYPE_3\"\n            >\n              默认课时费\n              <st-help-tooltip id=\"TBPT001\" />\n            </template>\n            <st-input-number\n              :float=\"true\"\n              :min=\"0\"\n              :max=\"\n                performance_mode === PERFORMANCE.PERFORMANCE_MODE_1\n                  ? 100\n                  : 999999\n              \"\n              placeholder=\"请输入默认提成\"\n              v-decorator=\"decorators.performance_num\"\n            >\n              <template\n                v-if=\"\n                  performance_type == PERFORMANCE.PERFORMANCE_TYPE_1 ||\n                    performance_type == PERFORMANCE.PERFORMANCE_TYPE_2\n                \"\n              >\n                <template\n                  v-if=\"performance_mode == PERFORMANCE.PERFORMANCE_MODE_1\"\n                >\n                  <template slot=\"addonAfter\">\n                    %\n                  </template>\n                </template>\n                <template\n                  v-if=\"performance_mode == PERFORMANCE.PERFORMANCE_MODE_2\"\n                >\n                  <template slot=\"addonAfter\">\n                    元\n                  </template>\n                </template>\n              </template>\n              <template\n                v-if=\"performance_type == PERFORMANCE.PERFORMANCE_TYPE_3\"\n              >\n                <template slot=\"addonAfter\">\n                  元/节\n                </template>\n              </template>\n            </st-input-number>\n          </st-form-item>\n        </a-col>\n        <a-col :lg=\"24\">\n          <st-form-item label=\"梯度提成\">\n            <div\n              style=\"padding:12px; box-size: border-box; border-radius:4px;border:1px solid rgba(205,212,223,1); \"\n            >\n              <st-form-table hoverable>\n                <thead>\n                  <tr>\n                    <template\n                      v-if=\"performance_type == PERFORMANCE.PERFORMANCE_TYPE_1\"\n                    >\n                      <template\n                        v-if=\"\n                          performance_mode == PERFORMANCE.PERFORMANCE_MODE_1\n                        \"\n                      >\n                        <th>月销售额（万及以上）</th>\n                        <th>提成（%）</th>\n                      </template>\n                      <template\n                        v-if=\"\n                          performance_mode == PERFORMANCE.PERFORMANCE_MODE_2\n                        \"\n                      >\n                        <th>月销售额（万及以上）</th>\n                        <th>提成(元)</th>\n                      </template>\n                    </template>\n                    <template\n                      v-if=\"performance_type == PERFORMANCE.PERFORMANCE_TYPE_2\"\n                    >\n                      <template\n                        v-if=\"\n                          performance_mode == PERFORMANCE.PERFORMANCE_MODE_1\n                        \"\n                      >\n                        <th>月课时价值（万及以上）</th>\n                        <th>提成（%）</th>\n                      </template>\n                      <template\n                        v-if=\"\n                          performance_mode == PERFORMANCE.PERFORMANCE_MODE_2\n                        \"\n                      >\n                        <th>月课时价值（万及以上）</th>\n                        <th>提成(元)</th>\n                      </template>\n                    </template>\n                    <template\n                      v-if=\"performance_type == PERFORMANCE.PERFORMANCE_TYPE_3\"\n                    >\n                      <th>月课时数（节及以上）</th>\n                      <th>课时费（元/节）</th>\n                    </template>\n                    <th style=\"width:135px\">操作</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  <tr v-if=\"data.length < 15\">\n                    <td>\n                      <st-input-number\n                        :float=\"\n                          performance_type != PERFORMANCE.PERFORMANCE_TYPE_3\n                        \"\n                        :min=\"0\"\n                        :max=\"999.9\"\n                        :placeholder=\"placeholderGradient\"\n                        v-model=\"gradients.range_min\"\n                      />\n                    </td>\n                    <td>\n                      <st-input-number\n                        :float=\"true\"\n                        :min=\"0\"\n                        :max=\"\n                          isChooseks &&\n                          performance_mode == PERFORMANCE.PERFORMANCE_MODE_1\n                            ? 100\n                            : 999999\n                        \"\n                        :placeholder=\"placeholderGradientFee\"\n                        v-model=\"gradients.royalty_num\"\n                      />\n                    </td>\n                    <td>\n                      <a @click=\"addGradients\">\n                        新增梯度({{ data.length }}/15)\n                      </a>\n                    </td>\n                  </tr>\n\n                  <template v-for=\"(item, index) in data\">\n                    <tr :key=\"index\">\n                      <template v-if=\"item.isEdit\">\n                        <td>\n                          <st-input-number\n                            :float=\"\n                              performance_type != PERFORMANCE.PERFORMANCE_TYPE_3\n                            \"\n                            :min=\"0\"\n                            :max=\"999.9\"\n                            :placeholder=\"placeholderGradient\"\n                            v-model=\"item.range_min\"\n                          />\n                        </td>\n                        <td>\n                          <st-input-number\n                            :float=\"true\"\n                            :min=\"0\"\n                            :max=\"\n                              isChooseks &&\n                              performance_mode == PERFORMANCE.PERFORMANCE_MODE_1\n                                ? 100\n                                : 999999\n                            \"\n                            :placeholder=\"placeholderGradientFee\"\n                            v-model=\"item.royalty_num\"\n                          />\n                        </td>\n                      </template>\n                      <template v-else>\n                        <td>{{ item.range_min }}</td>\n                        <td>{{ item.royalty_num }}</td>\n                      </template>\n                      <td>\n                        <template v-if=\"item.isEdit\">\n                          <a @click=\"submitEdit(index)\">\n                            提交\n                          </a>\n                          <a-divider type=\"vertical\"></a-divider>\n                          <a @click=\"cancelEdit(index)\">\n                            取消\n                          </a>\n                        </template>\n                        <template v-else>\n                          <a @click=\"editPerformanceNum(index)\">\n                            编辑\n                          </a>\n                          <a-divider type=\"vertical\"></a-divider>\n                          <a @click=\"deletePerformanceNum(index)\">\n                            删除\n                          </a>\n                        </template>\n                      </td>\n                    </tr>\n                  </template>\n                </tbody>\n              </st-form-table>\n            </div>\n          </st-form-item>\n        </a-col>\n      </a-row>\n    </st-form>\n  </st-modal>\n</template>\n<script>\nimport { MessageService } from '@/services/message.service'\nimport { AddTemplateService } from './add-performance-template.service'\nimport { UserService } from '@/services/user.service'\nimport { ruleOptions } from './performance-template.config'\nimport { PERFORMANCE } from '@/constants/finance/performance'\nexport default {\n  serviceInject() {\n    return {\n      service: AddTemplateService,\n      message: MessageService\n    }\n  },\n  rxState() {\n    return {\n      performanceModes: this.service.performanceModes$,\n      performanceTypes: this.service.performanceTypes$\n    }\n  },\n  data() {\n    const form = this.$stForm.create()\n    const decorators = form.decorators(ruleOptions)\n    return {\n      PERFORMANCE,\n      form,\n      decorators,\n      data: [],\n      gradients: {\n        range_min: '',\n        royalty_num: ''\n      },\n      show: false,\n      choose: 1, // 1 百分比 0 金额\n      isChooseks: true, // 是否选中课时\n      performance_type: 1,\n      performance_mode: 1\n    }\n  },\n  computed: {\n    placeholderGradient() {\n      if (this.performance_type == this.PERFORMANCE.PERFORMANCE_TYPE_1) {\n        return '请输入月销售额'\n      }\n      if (this.performance_type == this.PERFORMANCE.PERFORMANCE_TYPE_2) {\n        return '请输入月课时价值'\n      }\n      if (this.performance_type == this.PERFORMANCE.PERFORMANCE_TYPE_3) {\n        return '请输入月课时数'\n      }\n      return '请输入'\n    },\n    errorMessageTip() {\n      if (this.performance_type == this.PERFORMANCE.PERFORMANCE_TYPE_1) {\n        return '月销售额不能重复'\n      }\n      if (this.performance_type == this.PERFORMANCE.PERFORMANCE_TYPE_2) {\n        return '月课时价值不能重复'\n      }\n      if (this.performance_type == this.PERFORMANCE.PERFORMANCE_TYPE_3) {\n        return '月课时数不能重复'\n      }\n      return '请输入'\n    },\n    placeholderGradientFee() {\n      if (this.performance_type == this.PERFORMANCE.PERFORMANCE_TYPE_3) {\n        return '请输入课时费'\n      }\n      return '请输入月销售额'\n    }\n  },\n  methods: {\n    selectType(e) {\n      this.performance_type = e\n      if (\n        e === this.PERFORMANCE.PERFORMANCE_TYPE_1 ||\n        e === this.PERFORMANCE.PERFORMANCE_TYPE_2\n      ) {\n        this.isChooseks = true\n      } else if (e === this.PERFORMANCE.PERFORMANCE_TYPE_3) {\n        this.isChooseks = false\n      }\n    },\n    submitEdit(e) {\n      let range_min = this.data[e].range_min\n      let royalty_num = this.data[e].royalty_num\n      if (!this.data[e].range_min || !this.data[e].royalty_num) {\n        this.message.warn({ content: '请填写完整' })\n        return\n      }\n      if (this.performance_type == this.PERFORMANCE.PERFORMANCE_TYPE_3) {\n        range_min = parseInt(range_min)\n      } else {\n        range_min = parseFloat(range_min).toFixed(1)\n      }\n      royalty_num = parseFloat(royalty_num).toFixed(1)\n      const arr = this.data.filter(\n        (item, index) => item.range_min === range_min && index !== e\n      )\n      if (arr.length > 0) {\n        this.message.warn({ content: this.errorMessageTip })\n        return\n      }\n      this.data[e].range_min = range_min\n      this.data[e].royalty_num = royalty_num\n      delete this.data[e].range_min_bak\n      delete this.data[e].royalty_num_bak\n      this.data[e].isEdit = false\n    },\n    cancelEdit(e) {\n      this.data[e].isEdit = false\n      this.data[e].range_min = this.data[e].range_min_bak\n      this.data[e].royalty_num = this.data[e].royalty_num_bak\n      delete this.data[e].range_min_bak\n      delete this.data[e].royalty_num_bak\n    },\n    editPerformanceNum(e) {\n      this.data[e].isEdit = true\n      this.data[e].range_min_bak = this.data[e].range_min\n      this.data[e].royalty_num_bak = this.data[e].royalty_num\n    },\n    deletePerformanceNum(e) {\n      this.data.splice(e, 1)\n    },\n    addGradients(e) {\n      // 加校验\n      let { range_min, royalty_num } = this.gradients\n      if (!range_min || !royalty_num) {\n        this.message.warn({ content: '请填写完整' })\n        return\n      }\n      if (this.performance_type == this.PERFORMANCE.PERFORMANCE_TYPE_3) {\n        range_min = parseInt(range_min)\n      } else {\n        range_min = parseFloat(range_min).toFixed(1)\n      }\n      royalty_num = parseFloat(royalty_num).toFixed(1)\n      const arr = this.data.filter(item => item.range_min === range_min)\n      if (arr.length > 0) {\n        this.message.warn({ content: this.errorMessageTip })\n        return\n      }\n      this.data.push({\n        id: 0,\n        range_min,\n        royalty_num,\n        isEdit: false\n      })\n      this.gradients.range_min = ''\n      this.gradients.royalty_num = ''\n    },\n    handleSubmit(e) {\n      e.preventDefault()\n      this.form.validate().then(values => {\n        values.gradients = this.data\n        if (values.performance_type === this.PERFORMANCE.PERFORMANCE_TYPE_3) {\n          values.performance_mode = 0\n        }\n        this.service.addTemplate(values).subscribe(() => {\n          this.$emit('change')\n          this.message.success({ content: '新增成功' })\n          this.show = false\n        })\n      })\n    },\n    onChooseRadio(e) {\n      this.performance_mode = e.target.value\n      this.data = []\n    }\n  }\n}\n</script>\n"],"sourceRoot":"src/views/biz-modals/finance"}]}