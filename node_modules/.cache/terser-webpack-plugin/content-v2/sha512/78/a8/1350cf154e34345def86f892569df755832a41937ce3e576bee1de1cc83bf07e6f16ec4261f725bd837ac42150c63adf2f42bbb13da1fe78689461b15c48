{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"brand-marketing-plugin-lottery\"],{\"06c9\":function(e,t,i){e.exports=i.p+\"img/title_bg.f2d93593.png\"},\"09a5\":function(e,t,i){\"use strict\";i.r(t);var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i(\"div\",[i(\"st-panel\",{staticClass:\"mg-b12\",attrs:{app:\"\"}},[i(\"Header\",{attrs:{id:e.$searchQuery.id}})],1),i(\"router-view\")],1)},a=[],n=i(\"164d\"),s=i(\"35d3\"),o=i(\"ea3e\"),c=i(\"bef4\"),u={name:\"PluginLotteryInfoPrize\",mixins:[o[\"a\"]],data:function(){return{}},serviceInject:function(){return{infoService:n[\"InfoService\"]}},rxState:function(){return{list:this.infoService.list$,page:this.infoService.page$,loading:this.infoService.loading$}},components:{Header:c[\"a\"]},computed:{columns:s[\"a\"]}},l=u,d=i(\"2877\"),p=Object(d[\"a\"])(l,r,a,!1,null,null,null);t[\"default\"]=p.exports},\"164d\":function(e,t,i){\"use strict\";i.r(t),i.d(t,\"InfoService\",(function(){return c}));var r,a=i(\"d225\"),n=i(\"9ab4\"),s=i(\"0cd5\"),o=i(\"75caf\"),c=function e(t){Object(a[\"a\"])(this,e),this.lotteryApi=t};c=Object(n[\"b\"])([Object(s[\"b\"])(),Object(n[\"d\"])(\"design:paramtypes\",[\"function\"===typeof(r=\"undefined\"!==typeof o[\"b\"]&&o[\"b\"])?r:Object])],c)},\"338c\":function(e,t,i){\"use strict\";i.r(t),i.d(t,\"AddService\",(function(){return v}));var r,a,n=i(\"d225\"),s=i(\"b0b4\"),o=i(\"9ab4\"),c=i(\"0cd5\"),u=i(\"75caf\"),l=i(\"c4cc\"),d=i(\"df29\"),p=i(\"2138\"),v=function(){function e(t,i){Object(n[\"a\"])(this,e),this.lotteryApi=t,this.userService=i,this.prizeInfoList$=new d[\"d\"]({}),this.drawCondition$=this.userService.getOptions$(\"plugin.draw_condition\"),this.drawTimesType$=this.userService.getOptions$(\"plugin.draw_times_type\"),this.invitePoster$=this.userService.getOptions$(\"plugin.invite_poster\"),this.wheelDefault$=this.userService.getOptions$(\"plugin_wheel.default\"),this.wheelTurnAround$=this.userService.getOptions$(\"plugin_wheel.turn_around\"),this.joinCrowdAll$=this.userService.getOptions$(\"plugin.join_crowd_all\"),this.crowd$=this.userService.getOptions$(\"plugin.crowd\"),this.imgType$=this.userService.getOptions$(\"plugin.img_type\"),this.lucky$=this.userService.getOptions$(\"plugin_wheel.lucky\"),this.prize$=this.userService.getOptions$(\"plugin_wheel.prize\"),this.share$=this.userService.getOptions$(\"plugin_wheel.share\")}return Object(s[\"a\"])(e,[{key:\"add\",value:function(e){return this.lotteryApi.add(e)}},{key:\"edit\",value:function(e){return this.lotteryApi.edit(e)}},{key:\"editVIew\",value:function(e){return this.lotteryApi.editVIew(e)}},{key:\"getPrizeInfoList\",value:function(){var e=this;return this.lotteryApi.getPrizeInfoList().pipe(Object(l[\"a\"])((function(t){e.prizeInfoList$.commit((function(){return t.list}))})))}},{key:\"beforeRouteEnter\",value:function(e,t){return this.getPrizeInfoList()}}]),e}();v=Object(o[\"b\"])([Object(c[\"b\"])(),Object(o[\"d\"])(\"design:paramtypes\",[\"function\"===typeof(r=\"undefined\"!==typeof u[\"b\"]&&u[\"b\"])?r:Object,\"function\"===typeof(a=\"undefined\"!==typeof p[\"a\"]&&p[\"a\"])?a:Object])],v)},\"35d3\":function(e,t,i){\"use strict\";i.d(t,\"a\",(function(){return r}));var r=function(){return[{title:\"奖品名称\",dataIndex:\"prize_name\"},{title:\"奖品类型\",dataIndex:\"prize_type_name\"},{title:\"奖品总数量\",dataIndex:\"prize_total_num\"},{title:\"已抽中数量\",dataIndex:\"prize_win_num\"},{title:\"已核销/使用数量\",dataIndex:\"prize_check_num\"}]}},\"3d06\":function(e,t,i){e.exports=i.p+\"img/checkin.e675d048.png\"},\"513d\":function(e,t,i){\"use strict\";i.r(t),i.d(t,\"CheckinService\",(function(){return d}));var r,a=i(\"d225\"),n=i(\"b0b4\"),s=i(\"9ab4\"),o=i(\"0cd5\"),c=i(\"75caf\"),u=i(\"c4cc\"),l=i(\"df29\"),d=function(){function e(t){Object(a[\"a\"])(this,e),this.lotteryApi=t,this.list$=new l[\"d\"]({}),this.loading$=new l[\"d\"]({})}return Object(n[\"a\"])(e,[{key:\"getCheckinList\",value:function(e){var t=this;return this.lotteryApi.getCheckinList(e).pipe(Object(u[\"a\"])((function(e){t.list$.commit((function(){return e.list}))})))}},{key:\"checkin\",value:function(e){return this.lotteryApi.checkin(e)}},{key:\"init\",value:function(){}},{key:\"beforeEach\",value:function(){return this.init()}}]),e}();Object(s[\"b\"])([Object(l[\"c\"])(),Object(s[\"d\"])(\"design:type\",Function),Object(s[\"d\"])(\"design:paramtypes\",[String]),Object(s[\"d\"])(\"design:returntype\",void 0)],d.prototype,\"getCheckinList\",null),d=Object(s[\"b\"])([Object(o[\"b\"])(),Object(s[\"d\"])(\"design:paramtypes\",[\"function\"===typeof(r=\"undefined\"!==typeof c[\"b\"]&&c[\"b\"])?r:Object])],d)},\"5b33\":function(e,t,i){\"use strict\";i.r(t),i.d(t,\"IndexService\",(function(){return f}));var r,a,n,s,o=i(\"d225\"),c=i(\"b0b4\"),u=i(\"9ab4\"),l=i(\"0cd5\"),d=i(\"75caf\"),p=i(\"54da\"),v=i(\"c4cc\"),h=i(\"df29\"),m=i(\"2138\"),_=i(\"2cbb\"),f=function(){function e(t,i,r){Object(o[\"a\"])(this,e),this.lotteryApi=t,this.userService=i,this.authService=r,this.list$=new h[\"d\"]({}),this.page$=new h[\"d\"]({}),this.loading$=new h[\"d\"]({}),this.info$=new h[\"d\"]({}),this.status$=this.userService.getOptions$(\"plugin.activity_status\",{addAll:\"全部状态\"}),this.auth$=this.authService.authMap$({add:\"brand:activity:turn|add\",destory:\"brand:activity:prize|add\"})}return Object(c[\"a\"])(e,[{key:\"getActivityList\",value:function(e){var t=this;return this.lotteryApi.getActivityList(e).pipe(Object(v[\"a\"])((function(e){t.list$.commit((function(){return e.list})),t.page$.commit((function(){return e.page}))})))}},{key:\"getPosterInfo\",value:function(e){var t=this;return this.lotteryApi.getPosterInfo(e).pipe(Object(v[\"a\"])((function(e){t.info$.commit((function(){return e.info}))})))}},{key:\"stopActivity\",value:function(e){return this.lotteryApi.stopActivity(e)}},{key:\"init\",value:function(e){return Object(p[\"a\"])(this.getActivityList(e))}},{key:\"beforeEach\",value:function(e,t){return this.init(e.meta.query)}}]),e}();Object(u[\"b\"])([Object(h[\"c\"])(),Object(u[\"d\"])(\"design:type\",Function),Object(u[\"d\"])(\"design:paramtypes\",[\"function\"===typeof(r=\"undefined\"!==typeof d[\"GetActivityListQuery\"]&&d[\"GetActivityListQuery\"])?r:Object]),Object(u[\"d\"])(\"design:returntype\",void 0)],f.prototype,\"getActivityList\",null),f=Object(u[\"b\"])([Object(l[\"b\"])(),Object(u[\"d\"])(\"design:paramtypes\",[\"function\"===typeof(a=\"undefined\"!==typeof d[\"b\"]&&d[\"b\"])?a:Object,\"function\"===typeof(n=\"undefined\"!==typeof m[\"a\"]&&m[\"a\"])?n:Object,\"function\"===typeof(s=\"undefined\"!==typeof _[\"a\"]&&_[\"a\"])?s:Object])],f)},\"5e1e\":function(e,t,i){\"use strict\";i.r(t);var r,a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i(\"st-panel-layout\",{class:e.bPage()},[i(\"MarkteingPluginTitle\",{attrs:{type:e.TYPE.LOTTERY}}),i(\"st-panel\",{attrs:{app:\"\"}},[i(\"div\",{staticClass:\"mg-b16\",class:e.bPage(\"action\")},[i(\"div\",[e.auth.add?i(\"router-link\",{attrs:{to:\"./add\"}},[i(\"st-button\",{staticClass:\"mg-r16\",attrs:{type:\"primary\",icon:\"add\"}},[e._v(\"\\n            新增活动\\n          \")])],1):e._e(),e.auth.destory?i(\"router-link\",{attrs:{to:\"./checkin\"}},[i(\"st-button\",{attrs:{type:\"default\"}},[e._v(\"核销兑换码\")])],1):e._e(),i(\"st-button\",{staticClass:\"mg-l16\",on:{click:e.onConfigHandle}},[e._v(\"\\n          配置到小程序\\n        \")])],1),i(\"div\",{staticStyle:{\"text-align\":\"right\"}},[i(\"a-select\",{staticClass:\"mg-r16\",staticStyle:{width:\"100px\",display:\"inline-block\"},attrs:{placeholder:\"活动状态\"},on:{change:function(t){return e.onSingleSearch(\"activity_status\",t)}},model:{value:e.$searchQuery.activity_status,callback:function(t){e.$set(e.$searchQuery,\"activity_status\",t)},expression:\"$searchQuery.activity_status\"}},e._l(e.status,(function(t,r){return i(\"a-select-option\",{key:r,attrs:{value:t.value}},[e._v(\"\\n            \"+e._s(t.label)+\"\\n          \")])})),1),i(\"st-input-search\",{staticStyle:{display:\"inline-block\"},attrs:{placeholder:\"请输入活动名称\"},on:{search:function(t){return e.onKeywordsSearch(\"keyword\",t)}},model:{value:e.$searchQuery.keyword,callback:function(t){e.$set(e.$searchQuery,\"keyword\",t)},expression:\"$searchQuery.keyword\"}})],1)]),i(\"st-table\",{attrs:{page:e.page,loading:e.loading.getActivityList,columns:e.columns,dataSource:e.list,rowKey:\"id\"},on:{change:e.onTableChange},scopedSlots:e._u([{key:\"join_num\",fn:function(t){return i(\"span\",{},[i(\"router-link\",{attrs:{to:{name:\"brand-marketing-plugin-lottery-info-users\",query:{id:t.id}}}},[e._v(\"\\n          \"+e._s(t.activity_join_num)+\"\\n        \")])],1)}},{key:\"activity_status_name\",fn:function(t,r){return[i(\"st-text\",{attrs:{status:{error:2===r.activity_status,success:1===r.activity_status,default:3===r.activity_status}}},[e._v(\"\\n          \"+e._s(t)+\"\\n        \")])]}},{key:\"time\",fn:function(t){return i(\"span\",{},[e._v(\"\\n        \"+e._s(t.activity_start_time)+\"~\"+e._s(t.activity_end_time)+\"\\n      \")])}},{key:\"prize_num\",fn:function(t){return i(\"span\",{},[i(\"router-link\",{attrs:{to:{name:\"brand-marketing-plugin-lottery-info-users\",query:{id:t.id,prize_status:1}}}},[e._v(\"\\n          \"+e._s(t.activity_prize_num)+\"\\n        \")])],1)}},{key:\"action\",fn:function(t,r){return i(\"div\",{},[i(\"st-table-actions\",[r.activity_status!==e.ACTIVITY_STATUS.ISSTOPED?i(\"a\",{directives:[{name:\"modal-link\",rawName:\"v-modal-link\",value:{name:\"brand-marketing-plugin-lottery-table\",props:{id:r.id,type:\"Sale\",title:\"奖品数据\"}},expression:\"{\\n              name: 'brand-marketing-plugin-lottery-table',\\n              props: { id: record.id, type: 'Sale', title: '奖品数据' }\\n            }\"}]},[e._v(\"\\n            奖品数据\\n          \")]):e._e(),r.activity_status!==e.ACTIVITY_STATUS.ISSTOPED?i(\"a\",{on:{click:function(t){return e.onGeneralize(r)}}},[e._v(\"\\n            推广\\n          \")]):e._e(),r.activity_status!==e.ACTIVITY_STATUS.ISSTOPED?i(\"router-link\",{attrs:{to:{name:\"brand-marketing-plugin-lottery-add\",query:{activity_id:r.id,status:r.activity_status}}}},[e._v(\"\\n            编辑\\n          \")]):e._e(),i(\"a\",{on:{click:function(t){return e.onStop(r)}}},[e._v(\"\\n            \"+e._s(r.activity_status===e.ACTIVITY_STATUS.ISSTOPED?\"奖品数据\":r.activity_status===e.ACTIVITY_STATUS.DISABLED?\"结束\":\"取消\")+\"\\n          \")])],1)],1)}}])})],1)],1)},n=[],s=i(\"5b33\"),o=i(\"aa7d\"),c=function(){return[{title:\"活动名称\",width:175,dataIndex:\"activity_name\"},{title:\"活动时间\",scopedSlots:{customRender:\"time\"}},{title:\"参与用户\",dataIndex:\"crowd_name\"},{title:\"参与人数\",scopedSlots:{customRender:\"join_num\"}},{title:\"中奖人数\",scopedSlots:{customRender:\"prize_num\"}},{title:\"活动状态\",dataIndex:\"activity_status_name\",scopedSlots:{customRender:\"activity_status_name\"}},{title:\"操作\",dataIndex:\"action\",width:140,scopedSlots:{customRender:\"action\"}}]},u=i(\"ea3e\"),l=i(\"720e\"),d=i(\"6c94\"),p=i(\"5ffc\"),v=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i(\"st-modal\",{attrs:{title:e.title,footer:null,wrapClassName:\"scroll-modal\"},model:{value:e.show,callback:function(t){e.show=t},expression:\"show\"}},[i(\"st-table\",{attrs:{page:e.page,loading:e.loading.getPrizedList,columns:e.columns,dataSource:e.list,rowKey:\"id\"},on:{change:e.onPageChange}})],1)},h=[],m=i(\"d225\"),_=i(\"b0b4\"),f=i(\"9ab4\"),y=i(\"0cd5\"),g=i(\"75caf\"),b=i(\"c4cc\"),T=i(\"df29\"),S=function(){function e(t){Object(m[\"a\"])(this,e),this.lotteryApi=t,this.list$=new T[\"d\"]({}),this.page$=new T[\"d\"]({}),this.loading$=new T[\"d\"]({})}return Object(_[\"a\"])(e,[{key:\"getPrizedList\",value:function(e){var t=this;return this.lotteryApi.getPrizedList(e).pipe(Object(b[\"a\"])((function(e){t.list$.commit((function(){return e.list})),t.page$.commit((function(){return e.page}))})))}}]),e}();Object(f[\"b\"])([Object(T[\"c\"])(),Object(f[\"d\"])(\"design:type\",Function),Object(f[\"d\"])(\"design:paramtypes\",[Object]),Object(f[\"d\"])(\"design:returntype\",void 0)],S.prototype,\"getPrizedList\",null),S=Object(f[\"b\"])([Object(y[\"b\"])(),Object(f[\"d\"])(\"design:paramtypes\",[\"function\"===typeof(r=\"undefined\"!==typeof g[\"b\"]&&g[\"b\"])?r:Object])],S);var w=function(){return[{title:\"奖品名称\",dataIndex:\"prize_name\",width:\"19%\"},{title:\"奖品类型\",width:\"19%\",dataIndex:\"prize_type_name\"},{title:\"奖品总数量\",width:\"19%\",dataIndex:\"prize_total_num\"},{title:\"已抽中数量\",width:\"19%\",dataIndex:\"prize_win_num\"},{title:\"已核销/使用数量\",width:\"24%\",dataIndex:\"prize_check_num\"}]},I={name:\"ModalBrandMarketingLotteryTable\",serviceInject:function(){return{prizeService:S}},rxState:function(){return{loading:this.prizeService.loading$,list:this.prizeService.list$,page:this.prizeService.page$}},computed:{columns:w},props:[\"id\",\"title\"],data:function(){return{show:!1}},created:function(){this.getList({size:20,current_page:1,id:this.id})},methods:{getList:function(e){this.prizeService.getPrizedList(e).subscribe()},onPageChange:function(e){this.getList({size:e.pageSize,current_page:e.current,id:this.id})}}},z=I,k=i(\"2877\"),x=Object(k[\"a\"])(z,v,h,!1,null,null,null),P=x.exports,O={name:\"PluginLotteryIndex\",mixins:[u[\"a\"]],modals:{BrandMarketingPluginLotteryTable:P},data:function(){return{ACTIVITY_STATUS:l[\"a\"],TYPE:d[\"a\"]}},bem:{bPage:\"page-brand-marketing-plugin-lottery-index\"},serviceInject:function(){return{indexService:s[\"IndexService\"]}},hooks:function(){return{share:Object(p[\"a\"])()}},rxState:function(){return{list:this.indexService.list$,page:this.indexService.page$,loading:this.indexService.loading$,info:this.indexService.info$,status:this.indexService.status$,auth:this.indexService.auth$}},components:{MarkteingPluginTitle:o[\"a\"]},computed:{columns:c},methods:{onConfigHandle:function(){this.$router.push({path:\"/brand/setting/mina/index\"})},onGeneralize:function(e){var t=this;this.indexService.getPosterInfo(e.id).subscribe((function(e){var i=t.info,r={qrcode_url:i.qrcode_url,sub_name:i.sub_name},a=e.is_auth;t.share.poster({isAuth:a,shsInfo:r,shsPath:\"/saas/lottery_poster\"})}))},onStop:function(e){if(e.activity_status!==this.ACTIVITY_STATUS.ISSTOPED){var t=this;this.$confirm({title:\"提示\",okText:e.activity_status===this.ACTIVITY_STATUS.ISHOLDING?\"取消\":\"结束\",cancelText:\"我再想想\",content:e.activity_status===this.ACTIVITY_STATUS.ISHOLDING?\"确认取消该活动\":\"确认要结束\",onOk:function(){t.indexService.stopActivity(e.id).subscribe((function(e){t.$router.reload()}))}})}else this.$modalRouter.push({name:\"brand-marketing-plugin-lottery-table\",props:{id:e.id,title:\"奖品数据\"}})}}},C=O,A=Object(k[\"a\"])(C,a,n,!1,null,null,null);t[\"default\"]=A.exports},\"720e\":function(e,t,i){\"use strict\";var r,a,n,s,o,c,u,l,d;i.d(t,\"i\",(function(){return r})),i.d(t,\"b\",(function(){return a})),i.d(t,\"f\",(function(){return n})),i.d(t,\"h\",(function(){return s})),i.d(t,\"a\",(function(){return o})),i.d(t,\"d\",(function(){return c})),i.d(t,\"c\",(function(){return u})),i.d(t,\"g\",(function(){return l})),i.d(t,\"e\",(function(){return d})),function(e){e[e[\"DEFAULT\"]=1]=\"DEFAULT\"}(r||(r={})),function(e){e[e[\"DEFAULT\"]=1]=\"DEFAULT\",e[e[\"CUSTOM\"]=2]=\"CUSTOM\"}(a||(a={})),function(e){e[e[\"DEFAULT\"]=1]=\"DEFAULT\",e[e[\"CUSTOM\"]=2]=\"CUSTOM\"}(n||(n={})),function(e){e[e[\"DEFAULT\"]=1]=\"DEFAULT\"}(s||(s={})),function(e){e[e[\"DISABLED\"]=1]=\"DISABLED\",e[e[\"ISHOLDING\"]=2]=\"ISHOLDING\",e[e[\"ISSTOPED\"]=3]=\"ISSTOPED\"}(o||(o={})),function(e){e[e[\"DEFAULT\"]=1]=\"DEFAULT\",e[e[\"CUSTOM\"]=2]=\"CUSTOM\"}(c||(c={})),function(e){e[e[\"DEFAULT\"]=1]=\"DEFAULT\",e[e[\"CUSTOM\"]=2]=\"CUSTOM\"}(u||(u={})),function(e){e[e[\"DEFAULT\"]=1]=\"DEFAULT\",e[e[\"CUSTOM\"]=2]=\"CUSTOM\"}(l||(l={})),function(e){e[e[\"DEFAULT\"]=1]=\"DEFAULT\",e[e[\"CUSTOM\"]=2]=\"CUSTOM\"}(d||(d={}))},\"78da\":function(e,t,i){\"use strict\";i.r(t),i.d(t,\"SuccessService\",(function(){return v}));i(\"c5f6\");var r,a,n=i(\"d225\"),s=i(\"b0b4\"),o=i(\"9ab4\"),c=i(\"0cd5\"),u=i(\"df29\"),l=i(\"c4cc\"),d=i(\"2138\"),p=i(\"75caf\"),v=function(){function e(t,i){Object(n[\"a\"])(this,e),this.api=t,this.userService=i,this.loading$=new u[\"d\"]({}),this.info$=new u[\"d\"]({}),this.qrcode$=new u[\"d\"]({}),this.brand$=this.userService.brand$}return Object(s[\"a\"])(e,[{key:\"getSharePosterInfo\",value:function(e){var t=this;return this.api.getPosterInfo(e).pipe(Object(l[\"a\"])((function(e){t.info$.commit((function(){return e.info}))})))}},{key:\"getQrCode\",value:function(e){var t=this;return this.api.getQrcode(e).pipe(Object(l[\"a\"])((function(e){t.qrcode$.commit((function(){return e.qrcode}))})))}}]),e}();Object(o[\"b\"])([Object(u[\"c\"])(),Object(o[\"d\"])(\"design:type\",Function),Object(o[\"d\"])(\"design:paramtypes\",[Number]),Object(o[\"d\"])(\"design:returntype\",void 0)],v.prototype,\"getSharePosterInfo\",null),Object(o[\"b\"])([Object(u[\"c\"])(),Object(o[\"d\"])(\"design:type\",Function),Object(o[\"d\"])(\"design:paramtypes\",[Number]),Object(o[\"d\"])(\"design:returntype\",void 0)],v.prototype,\"getQrCode\",null),v=Object(o[\"b\"])([Object(c[\"b\"])(),Object(o[\"d\"])(\"design:paramtypes\",[\"function\"===typeof(r=\"undefined\"!==typeof p[\"b\"]&&p[\"b\"])?r:Object,\"function\"===typeof(a=\"undefined\"!==typeof d[\"a\"]&&d[\"a\"])?a:Object])],v)},\"9b51\":function(e,t,i){\"use strict\";i.r(t);var r,a,n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r(\"st-mina-panel\",[r(\"h5-container\",{attrs:{slot:\"preview\",fixed:\"\"},slot:\"preview\",scopedSlots:e._u([{key:\"title\",fn:function(){return[e._v(\"\\n      幸运大转盘\\n    \")]},proxy:!0}])},[r(\"div\",{class:e.bPage(\"lottery\")},[e.isStopSwiper===e.STOP_SWIPER.DEFAULT?r(\"div\",{class:e.bPage(\"swiper\")},[r(\"swiper\",{attrs:{options:e.sliderOptions}},e._l(e.prizeInfoList,(function(t,i){return r(\"swiper-slide\",{key:i},[r(\"span\",{class:e.bPage(\"swiper-text\")},[e._v(e._s(t))])])})),1)],1):e._e(),r(\"img\",{class:e.bPage(\"lottery-banner\"),attrs:{src:i(\"9f92\")}}),r(\"img\",{class:e.bPage(\"lottery-title-bg\"),attrs:{src:i(\"06c9\")}}),r(\"span\",{class:e.bPage(\"lottery-subtitle\")},[e._v(e._s(e.preview.title))]),r(\"div\",{class:e.bPage(\"lottery-turntable\")},[e.prizeList.length>0?r(\"div\",{staticStyle:{position:\"relative\"}},e._l(e.prizeListFilters,(function(t,i){return r(\"div\",{key:i,staticClass:\"img-wrap\",class:\"run-item-\"+i},[r(\"img\",{staticClass:\"img\",attrs:{src:t.prize.image_url,alt:\"奖品图片\"}}),r(\"div\",{staticClass:\"text\"},[e._v(e._s(t.prize_name))])])})),0):e._e(),e.notPrize.prize_name?r(\"div\",{staticClass:\"img-wrap run-item-7\"},[r(\"div\",{staticClass:\"img\"},[r(\"img\",{staticStyle:{width:\"100%\",height:\"100%\"},attrs:{src:e.notPrizeImgType===e.NOT_PRIZE_IMG_TYPE.CUSTOM?e.notPrize.prize.image_url:e.lucky[0].image_url,alt:\"奖品图片\"}})]),r(\"div\",{staticClass:\"text\"},[e._v(e._s(e.notPrize.prize_name))])]):e._e()]),r(\"div\",{class:e.bPage(\"lottery-footer\")},[r(\"div\",{class:e.bPage(\"lottery-title\")},[e._v(\"活动规则\")]),r(\"div\",{staticClass:\"mg-b24\"},[r(\"span\",{staticClass:\"mg-r8\"},[e._v(\"活动时间:\")]),r(\"span\",[e._v(e._s(e.preview.startTime)+\"--\"+e._s(e.preview.endTime))])]),r(\"div\",{staticClass:\"mg-b24\"},[r(\"span\",{staticClass:\"mg-r8\"},[e._v(\"抽奖规则:\")]),1===e.timesType?r(\"span\",[e._v(\"\\n            每人每天有\"+e._s(e.preview.perTimes)+\"次机会\\n          \")]):r(\"span\",[e._v(\"每人总共有\"+e._s(e.preview.totalTimes)+\"次机会\")])]),r(\"div\",{staticClass:\"mg-b24\"},[r(\"span\",{staticClass:\"mg-r8\"},[e._v(\"活动说明:\")]),r(\"span\",[e._v(e._s(e.preview.description))])])])])]),r(\"div\",{attrs:{slot:\"actions\"},slot:\"actions\"},[r(\"st-button\",{directives:[{name:\"show\",rawName:\"v-show\",value:0===e.currentIndex,expression:\"currentIndex === 0\"}],attrs:{type:\"primary\"},on:{click:function(t){return e.next(1)}}},[e._v(\"\\n      下一步\\n    \")]),r(\"st-button\",{directives:[{name:\"show\",rawName:\"v-show\",value:1===e.currentIndex,expression:\"currentIndex === 1\"}],attrs:{type:\"primary\"},on:{click:function(t){return e.next(2)}}},[e._v(\"\\n      下一步\\n    \")]),r(\"st-button\",{directives:[{name:\"show\",rawName:\"v-show\",value:2===e.currentIndex,expression:\"currentIndex === 2\"}],attrs:{type:\"primary\"},on:{click:e.onSubmit}},[e._v(\"\\n      完成\\n    \")])],1),r(\"div\",{class:e.bPage(\"form\")},[r(\"Steps\",{attrs:{value:e.currentIndex,stepArr:e.stepArr},on:{skip:e.next}}),r(\"div\",{staticStyle:{padding:\"24px\"}},[r(\"st-form\",{directives:[{name:\"show\",rawName:\"v-show\",value:0==e.currentIndex,expression:\"currentIndex == 0\"}],staticStyle:{width:\"500px\"},attrs:{form:e.form,labelGutter:\"0\",labelWidth:\"124px\"}},[r(\"st-form-item\",{attrs:{label:\"活动名称\",required:\"\"}},[r(\"a-input\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:e.decorators.activity_base.activity_name,expression:\"decorators.activity_base.activity_name\"}],attrs:{disabled:e.info.activity_status===e.ACTIVITY_STATUS.DISABLED,placeholder:\"请输入活动名称\"}})],1),r(\"st-form-item\",{attrs:{label:\"活动标题\",required:\"\"}},[r(\"a-input\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:e.decorators.activity_base.activity_sub_name,expression:\"decorators.activity_base.activity_sub_name\"}],attrs:{disabled:e.info.activity_status===e.ACTIVITY_STATUS.DISABLED,placeholder:\"请输入活动标题\"},on:{change:e.getTitle}})],1),r(\"st-form-item\",{attrs:{label:\"活动时间\",required:\"\"}},[r(\"a-range-picker\",{attrs:{disabled:e.info.activity_status===e.ACTIVITY_STATUS.DISABLED,disabledDate:e.disabledDate,showTime:{hideDisabledOptions:!0,defaultValue:e.defaultValue},format:\"YYYY-MM-DD HH:mm\"},on:{change:e.onDateChange},model:{value:e.dateRangeVal,callback:function(t){e.dateRangeVal=t},expression:\"dateRangeVal\"}})],1),r(\"st-form-item\",{attrs:{label:\"活动说明\"}},[r(\"st-textarea\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:e.decorators.activity_base.activity_description,expression:\"decorators.activity_base.activity_description\"}],attrs:{rows:4,maxlength:500,disabled:e.info.activity_status===e.ACTIVITY_STATUS.DISABLED,placeholder:\"请输入活动说明\"},on:{change:e.getDescription}})],1),r(\"st-form-item\",{attrs:{label:\"轮播获奖\"}},[r(\"a-radio-group\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:e.decorators.activity_base.wheel_turn_around,expression:\"decorators.activity_base.wheel_turn_around\"}],attrs:{disabled:e.info.activity_status===e.ACTIVITY_STATUS.DISABLED},on:{change:e.stopSwiper}},e._l(e.wheelTurnAround,(function(t,i){return r(\"a-radio\",{key:i,attrs:{value:t.value}},[e._v(\"\\n              \"+e._s(t.label)+\"\\n            \")])})),1)],1),r(\"st-form-item\",{attrs:{label:\"分享设置\"}},[r(\"a-radio-group\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:e.decorators.activity_base.wheel_share_default,expression:\"decorators.activity_base.wheel_share_default\"}],attrs:{disabled:e.info.activity_status===e.ACTIVITY_STATUS.DISABLED},on:{change:e.getCurShareType}},e._l(e.wheelDefault,(function(t,i){return r(\"a-radio\",{key:i,attrs:{value:t.value}},[e._v(\"\\n              \"+e._s(t.label)+\"\\n            \")])})),1),2===e.shareType?r(\"div\",{class:e.bPage(\"share-upload\")},[r(\"st-form-item\",{attrs:{label:\"选择图片\",labelWidth:\"60px\"}},[r(\"st-image-upload\",{attrs:{width:\"96px\",height:\"96px\",list:e.fileShareList,placeholder:\"上传图片\"},on:{change:e.onShareChangeGetAvatar}}),r(\"span\",{class:e.bPage(\"share-upload-text\")},[e._v(\"\\n                请上传jpg、png格式的图片\\n              \")])],1),r(\"st-form-item\",{attrs:{label:\"分享标题\",labelWidth:\"60px\"}},[r(\"a-input\",{attrs:{placeholder:\"分享标题\"},model:{value:e.shareTitle,callback:function(t){e.shareTitle=t},expression:\"shareTitle\"}})],1)],1):r(\"img\",{staticClass:\"default-img\",attrs:{src:e.share[0].image_url,alt:\"默认图片\"}})],1)],1),r(\"st-form\",{directives:[{name:\"show\",rawName:\"v-show\",value:1==e.currentIndex,expression:\"currentIndex == 1\"}],staticStyle:{width:\"500px\"},attrs:{form:e.form,labelGutter:\"0\",labelWidth:\"124px\"}},[r(\"st-form-item\",{attrs:{label:\"参与用户\",required:\"\"}},[r(\"a-radio-group\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:e.decorators.activity_rule.join_crowd_all,expression:\"decorators.activity_rule.join_crowd_all\"}],on:{change:e.getCurCrowdType}},e._l(e.joinCrowdAll,(function(t,i){return r(\"a-radio\",{key:i,attrs:{value:t.value}},[e._v(\"\\n              \"+e._s(t.label)+\"\\n            \")])})),1),e.crowdType===e.CROWD_TYPE.CUSTOM?r(\"a-select\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:e.decorators.activity_rule.crowd_id,expression:\"decorators.activity_rule.crowd_id\"}],attrs:{placeholder:\"请选择参与用户\"}},e._l(e.crowd,(function(t,i){return r(\"a-select-option\",{key:i,attrs:{value:t.value}},[e._v(\"\\n              \"+e._s(t.label)+\"\\n            \")])})),1):e._e()],1),r(\"st-form-item\",{attrs:{label:\"抽奖条件\",required:\"\"}},[r(\"a-radio-group\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:e.decorators.activity_rule.draw_condition,expression:\"decorators.activity_rule.draw_condition\"}]},e._l(e.drawCondition,(function(t,i){return r(\"a-radio\",{key:i,attrs:{value:t.value}},[e._v(\"\\n              \"+e._s(t.label)+\"\\n            \")])})),1)],1),r(\"st-form-item\",{attrs:{label:\"抽奖机会\",required:\"\"}},[r(\"a-radio-group\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:e.decorators.activity_rule.draw_times_type,expression:\"decorators.activity_rule.draw_times_type\"}],on:{change:e.getCurTimesType}},e._l(e.drawTimesType,(function(t,i){return r(\"a-radio\",{key:i,attrs:{value:t.value}},[e._v(\"\\n              \"+e._s(t.label)+\"\\n            \")])})),1),[r(\"a-form-item\",{directives:[{name:\"show\",rawName:\"v-show\",value:1===e.timesType,expression:\"timesType === 1\"}]},[e._v(\"\\n              每人每天有\\n              \"),r(\"a-input-number\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:e.decorators.activity_rule.per_times,expression:\"decorators.activity_rule.per_times\"}],staticStyle:{width:\"100px\"},attrs:{min:1,max:999,step:1,precision:0,placeholder:\"请输入\"}}),e._v(\"\\n              次\\n            \")],1)],[r(\"a-form-item\",{directives:[{name:\"show\",rawName:\"v-show\",value:2===e.timesType,expression:\"timesType === 2\"}]},[e._v(\"\\n              每人总共有\\n              \"),r(\"a-input-number\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:e.decorators.activity_rule.total_times,expression:\"decorators.activity_rule.total_times\"}],staticStyle:{width:\"100px\"},attrs:{min:1,max:999,step:1,precision:0,placeholder:\"请输入\"}}),e._v(\"\\n              次\\n            \")],1)]],2),r(\"st-form-item\",{attrs:{label:\" 中奖次数\"}},[e._v(\"\\n          每人最多可中奖\\n          \"),r(\"a-input-number\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:e.decorators.activity_rule.prize_times,expression:\"decorators.activity_rule.prize_times\"}],staticStyle:{width:\"100px\"},attrs:{min:1,max:999,step:1,precision:0,placeholder:\"请输入\"}}),e._v(\"\\n          次\\n        \")],1)],1),r(\"st-form\",{directives:[{name:\"show\",rawName:\"v-show\",value:2==e.currentIndex,expression:\"currentIndex == 2\"}],staticStyle:{width:\"756px\",\"padding-left\":\"62px\"},attrs:{form:e.form}},[r(\"st-t3\",{staticClass:\"mg-b24\"},[e._v(\"奖品设置\")]),r(\"st-form-table\",{staticStyle:{border:\"1px solid rgba(205,212,223,1)\",padding:\"12px\"}},[r(\"thead\",[r(\"tr\",[e._l(e.columsTitlelist,(function(t,i){return[r(\"th\",{key:i},[e._v(e._s(t))])]}))],2)]),r(\"tbody\",[r(\"tr\",[r(\"td\",{staticClass:\"st-form-table__add\",attrs:{colspan:\"6\"}},[e.prizeList.length<7?r(\"st-button\",{directives:[{name:\"modal-link\",rawName:\"v-modal-link\",value:{name:\"brand-marketing-plugin-add-prize\",on:{change:e.getPrizeInfo}},expression:\"{\\n                    name: 'brand-marketing-plugin-add-prize',\\n                    on: { change: getPrizeInfo }\\n                  }\"}],attrs:{disabled:e.$searchQuery.activity_id&&1===e.$searchQuery.status,type:\"dashed\",block:\"\"},on:{click:function(t){return e.getCurPrizeIndex(-1)}}},[e._v(\"\\n                  新增奖品\\n                \")]):e._e()],1)]),e._l(e.prizeList,(function(t,i){return[r(\"tr\",{key:t.id},[r(\"td\",[e._v(e._s(t.prize_name))]),r(\"td\",[e._v(e._s(1===t.prize_type?\"优惠券\":\"兑换码\"))]),r(\"td\",[e._v(\"\\n                  \"+e._s(1===t.prize_type&&t.shop_num||t.support_shop_ids.length)+\"\\n                \")]),r(\"td\",[r(\"span\",{directives:[{name:\"show\",rawName:\"v-show\",value:e.isShowEditTable!==i,expression:\"isShowEditTable !== index\"}]},[e._v(\"\\n                    \"+e._s(t.number)+\"\\n                  \")]),r(\"st-input-number\",{directives:[{name:\"show\",rawName:\"v-show\",value:e.isShowEditTable===i,expression:\"isShowEditTable === index\"}],attrs:{min:1,max:99999,step:1,precision:0,value:t.number,index:i},on:{change:function(t){return e.editTableNum(t,i)}}})],1),r(\"td\",[r(\"span\",{directives:[{name:\"show\",rawName:\"v-show\",value:e.isShowEditTable!==i,expression:\"isShowEditTable !== index\"}]},[e._v(\"\\n                    \"+e._s(t.rate)+\"\\n                  \")]),r(\"st-input-number\",{directives:[{name:\"show\",rawName:\"v-show\",value:e.isShowEditTable===i,expression:\"isShowEditTable === index\"}],attrs:{min:0,max:100,float:!0,value:t.rate},on:{change:function(t){return e.editTableRate(t,i)}}})],1),r(\"td\",[r(\"st-table-actions\",[r(\"a\",{on:{click:function(t){return e.showEditTable(i)}}},[e._v(\"\\n                      \"+e._s(e.isShowEditTable===i?\"确认\":\"编辑\")+\"\\n                    \")]),r(\"a\",{attrs:{disabled:e.deleteBtnStatus,href:\"javascript:;\"},on:{click:function(t){return e.onDelete(i)}}},[e._v(\"\\n                      \"+e._s(e.isShowEditTable===i?\"取消\":\"删除\")+\"\\n                    \")])])],1)])]}))],2)]),r(\"st-t3\",{staticClass:\"mg-b24 mg-t32\"},[e._v(\"未中奖设置\")]),r(\"st-form-item\",{attrs:{label:\"名称\",labelWidth:\"40px\",required:\"\"}},[r(\"a-input\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:e.decorators.activity_lucky.lucky_name,expression:\"decorators.activity_lucky.lucky_name\"}],attrs:{disabled:e.info.activity_status===e.ACTIVITY_STATUS.DISABLED,placeholder:\"请输入未奖品名称\"},on:{change:e.getName}})],1),r(\"st-form-item\",{attrs:{label:\" 图片\",labelWidth:\"43px\",required:\"\"}},[r(\"a-radio-group\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:e.decorators.activity_lucky.image_default,expression:\"decorators.activity_lucky.image_default\"}],attrs:{disabled:e.info.activity_status===e.ACTIVITY_STATUS.DISABLED},on:{change:e.getNotImgType}},e._l(e.imgType,(function(t,i){return r(\"a-radio\",{key:i,attrs:{value:t.value}},[e._v(\"\\n              \"+e._s(t.label)+\"\\n            \")])})),1),e.notPrizeImgType===e.NOT_PRIZE_IMG_TYPE.CUSTOM?r(\"div\",{class:e.bPage(\"lucky-upload\")},[r(\"st-image-upload\",{attrs:{width:\"96px\",height:\"96px\",list:e.fileList,placeholder:\"上传图片\"},on:{change:e.onChangeGetAvatar}}),r(\"span\",{class:e.bPage(\"lucky-upload-text\")},[e._v(\"\\n              请上传jpg、png格式的图片\\n            \")])],1):r(\"img\",{staticClass:\"default-img\",attrs:{src:e.lucky[0].image_url,alt:\"默认图片\"}})],1)],1)],1)],1)],1)},s=[],o=(i(\"ac6a\"),i(\"e69b\")),c=i(\"338c\"),u=i(\"5bfd\"),l=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i(\"a-steps\",{attrs:{current:e.value}},e._l(e.stepArr,(function(t){return i(\"a-step\",{key:t.key,staticClass:\"cursor-pointer\",attrs:{title:t.title},on:{click:function(i){return e.skip(t.key)}}})})),1)},d=[],p=(i(\"c5f6\"),{name:\"Steps\",props:{stepArr:{type:Array,default:function(){return[]}},value:{type:Number,default:0}},methods:{skip:function(e){this.$emit(\"skip\",{index:e})}}}),v=p,h=i(\"2877\"),m=Object(h[\"a\"])(v,l,d,!1,null,null,null),_=m.exports,f=function(e){var t=e.pattern;return{\"activity_base.activity_name\":{rules:[{required:!0,message:\"请输入活动名称\"},{validator:function(e,t,i){if(t&&t.length>15)return\"请输入1-15个字符\"}}]},\"activity_base.activity_description\":{rules:[{required:!0,message:\"请输入活动说明\"}]},\"activity_base.wheel_turn_around\":{initialValue:1,rules:[{required:!0,message:\"请选择轮播获奖\"}]},\"activity_base.wheel_share_default\":{initialValue:1,rules:[{required:!0,message:\"请选择分享设置\"}]},\"activity_base.activity_sub_name\":{rules:[{required:!0,message:\"请输入活动标题\"},{validator:function(e,t,i){if(t&&t.length>15)return\"请输入1-15个字符\"}}]},\"activity_base.share_bg\":{},\"activity_base.share_title\":{},\"activity_rule.join_crowd_all\":{initialValue:1,rules:[{required:!0,message:\"请选择用户类型\"}]},\"activity_rule.crowd_id\":{rules:[{message:\"请选择用户\"}]},\"activity_rule.draw_condition\":{initialValue:1,rules:[{required:!0,message:\"请选择抽奖条件\"}]},\"activity_rule.draw_times_type\":{initialValue:1,rules:[{required:!0,message:\"请选择抽奖机会\"}]},\"activity_rule.per_times\":{rules:[{validator:function(e,t,i){if(1===i.activity_rule.draw_times_type&&!t)return\"请填写抽奖次数\"}}]},\"activity_rule.total_times\":{rules:[{validator:function(e,t,i){if(2===i.activity_rule.draw_times_type&&!t)return\"请填写抽奖次数\"}}]},\"activity_rule.prize_times\":{},\"activity_lucky.lucky_name\":{initialValue:\"未中奖\",rules:[{required:!0,message:\"请填写未中奖奖品名称\"},{pattern:t.CN_EN_NUM(\"1-10\"),message:\"请输入1~10个字符\"}]},\"activity_lucky.image_default\":{initialValue:1}}},y=i(\"2527\"),g=i(\"7ce1\"),b=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i(\"st-modal\",{attrs:{title:\"奖品设置\"},on:{ok:e.onSubmit},model:{value:e.show,callback:function(t){e.show=t},expression:\"show\"}},[i(\"st-form\",{attrs:{form:e.form,labelGutter:\"0\",labelWidth:\"84px\"}},[i(\"st-form-item\",{attrs:{label:\"奖品名称\",required:\"\"}},[i(\"a-input\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:e.decorators.prize_name,expression:\"decorators.prize_name\"}],attrs:{placeholder:\"请输入奖品名称\",disabled:e.id&&1===e.status}})],1),i(\"st-form-item\",{attrs:{label:\"奖品类型\",required:\"\"}},[i(\"a-radio-group\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:e.decorators.prize_type,expression:\"decorators.prize_type\"}],on:{change:e.getCurPrizeType}},e._l(e.prizeType,(function(t,r){return i(\"a-radio\",{key:r,attrs:{value:t.value}},[e._v(\"\\n          \"+e._s(t.label)+\"\\n        \")])})),1),i(\"div\",[e.curPrizeType===e.PRIZE_TYPE.DEFAULT?i(\"a-select\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:e.decorators.coupon_id,expression:\"decorators.coupon_id\"}],staticClass:\"mg-t8\",attrs:{placeholder:\"请选择优惠券\"},on:{select:e.getCurCouponShops}},e._l(e.couponList,(function(t,r){return i(\"a-select-option\",{key:r,attrs:{value:t.id}},[e._v(\"\\n            \"+e._s(t.name)+\"\\n          \")])})),1):i(\"span\",[e._v(\"\\n          获得当日起\\n          \"),i(\"a-input-number\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:e.decorators.valid_days,expression:\"decorators.valid_days\"}],staticClass:\"width100px\",attrs:{min:1,max:999,step:1,precision:0,placeholder:\"输入天数\"}}),e._v(\"\\n\\n          天内有效\\n        \")],1)],1)],1),e.curPrizeType===e.PRIZE_TYPE.CUSTOM?i(\"st-form-item\",{attrs:{label:\"兑换门店\",required:\"\"}},[i(\"a-radio-group\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:e.decorators.is_shop_range,expression:\"decorators.is_shop_range\"}],on:{change:e.getCurShopType}},e._l(e.shops,(function(t){return i(\"a-radio\",{key:t.value,attrs:{value:t.value}},[e._v(\"\\n          \"+e._s(t.label)+\"\\n        \")])})),1),2===e.curShopType?i(\"select-shop\",{attrs:{shopIds:e.shopIds},on:{change:e.onChangeShopSetting}}):e._e()],1):e._e(),i(\"st-form-item\",{attrs:{label:\"奖品数量\",required:\"\"}},[i(\"st-input-number\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:e.decorators.number,expression:\"decorators.number\"}],attrs:{min:1,max:999999,step:1,precision:0,placeholder:\"请输入奖品数量\"}},[i(\"span\",{attrs:{slot:\"addonAfter\"},slot:\"addonAfter\"},[e._v(\"个\")])])],1),i(\"st-form-item\",{attrs:{label:\"中奖概率\",required:\"\"}},[i(\"st-input-number\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:e.decorators.rate,expression:\"decorators.rate\"}],attrs:{min:0,max:100,float:!0,placeholder:\"请输入中奖概率\"}},[i(\"span\",{attrs:{slot:\"addonAfter\"},slot:\"addonAfter\"},[e._v(\"%\")])])],1),i(\"st-form-item\",{attrs:{label:\"奖品图片\"}},[i(\"a-radio-group\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:e.decorators.image_default,expression:\"decorators.image_default\"}],on:{change:e.getCurImgType}},e._l(e.imgType,(function(t,r){return i(\"a-radio\",{key:r,attrs:{value:t.value}},[e._v(\"\\n          \"+e._s(t.label)+\"\\n        \")])})),1),2===e.curImgType?i(\"div\",{staticClass:\"prize-upload\"},[i(\"st-image-upload\",{attrs:{list:e.fileList,width:\"96px\",height:\"96px\",sizeLimit:2,placeholder:\"上传图片\"},on:{change:e.onChangeGetAvatar}}),i(\"div\",{staticClass:\"prize-upload-text\"},[e._v(\"请上传jpg、png格式的图片\")])],1):i(\"div\",[i(\"img\",{staticClass:\"default-img\",attrs:{src:e.prize[0].image_url,alt:\"默认图片\"}})])],1)],1)],1)},T=[],S=i(\"d225\"),w=i(\"b0b4\"),I=i(\"9ab4\"),z=i(\"0cd5\"),k=i(\"2138\"),x=i(\"75caf\"),P=function(){function e(t,i){Object(S[\"a\"])(this,e),this.userService=t,this.lotteryApi=i,this.shops$=this.userService.getOptions$(\"plugin.shop_setting\"),this.prizeType$=this.userService.getOptions$(\"plugin.prize_type_setting\"),this.imgType$=this.userService.getOptions$(\"plugin.img_type\"),this.prize$=this.userService.getOptions$(\"plugin_wheel.prize\")}return Object(w[\"a\"])(e,[{key:\"getCouponList\",value:function(e){return this.lotteryApi.getCouponList(e)}}]),e}();P=Object(I[\"b\"])([Object(z[\"b\"])(),Object(I[\"d\"])(\"design:paramtypes\",[\"function\"===typeof(r=\"undefined\"!==typeof k[\"a\"]&&k[\"a\"])?r:Object,\"function\"===typeof(a=\"undefined\"!==typeof x[\"b\"]&&x[\"b\"])?a:Object])],P);i(\"4917\");var O=function(e){e.pattern;return{prize_name:{rules:[{validator:function(t,i,r){if(!i||!i.match(e.pattern.CN_EN_NUM_SPACE(\"1-10\")))return\"请输入奖品名称，支持格式长度1-10个字符\"}}]},prize_type:{initialValue:2,rules:[{required:!0,message:\"请选择类型\"}]},coupon_id:{},prize_id:{},activity_prize_id:{},is_shop_range:{initialValue:2,rules:[{required:!0,message:\"请选择门店类型\"}]},support_shop_ids:{rules:[{message:\"请门店id\"}]},image_default:{initialValue:1,rules:[{required:!0,message:\"请选择图片类型\"}]},rate:{rules:[{required:!0,message:\"请填写概率\"}]},number:{rules:[{required:!0,message:\"请填写数量\"}]},valid_days:{initialValue:1},prize:{initialValue:1,rules:[{required:!0,message:\"请选择图片\"}]}}},C=i(\"5c8a\"),A=i(\"d2d7\"),$=i(\"720e\"),L={name:\"BrandMarketingPoster\",bem:{basic:\"brand-marketing-poster\"},serviceInject:function(){return{addPrizeService:P,pattern:y[\"a\"],messageService:o[\"a\"]}},rxState:function(){return{shops:this.addPrizeService.shops$,prizeType:this.addPrizeService.prizeType$,imgType:this.addPrizeService.imgType$,prize:this.addPrizeService.prize$}},props:{info:{type:Object},id:{type:String},status:{type:Number}},data:function(e){var t=this.$stForm.create(),i=t.decorators(O);return{form:t,decorators:i,IMG_TYPE:$[\"c\"],PRIZE_TYPE:$[\"e\"],SHOP_TYPE:$[\"g\"],show:!1,shopIds:[],shopNum:0,fileList:[],couponList:[],curPrizeType:$[\"e\"].CUSTOM,curImgType:$[\"c\"].DEFAULT,curShopType:$[\"g\"].CUSTOM}},mounted:function(){this.info&&this.form.setFieldsValue({prize_name:this.info.prize_name,prize_type:this.info.prize_type,coupon_id:this.info.coupon_id,prize_id:this.info.prize_id,activity_prize_id:this.info.activity_prize_id,is_shop_range:this.info.is_shop_range,support_shop_ids:this.info.support_shop_ids,rate:this.info.rate,number:this.info.number,image:this.info.image,image_default:this.info.image_default})},created:function(){this.getCouponList(),this.info&&(this.curImgType=this.info.image_default,this.curPrizeType=this.info.prize_type,this.fileList[0]=this.info.prize,this.shopIds=this.info.support_shop_ids)},components:{SelectShop:A[\"a\"],StImageUpload:g[\"a\"]},methods:{getCurCouponShops:function(e){var t=this;this.couponList.filter((function(i){i.id===e&&(t.shopNum=i.shop_num)}))},onChangeShopSetting:function(e){this.shopIds=e},getCouponList:function(){var e=this,t=this.info?this.info.coupon_id:0;return this.addPrizeService.getCouponList(t).subscribe((function(t){e.couponList=t.list}))},onChangeGetAvatar:function(e){this.fileList=Object(C[\"a\"])(e)},getCurPrizeType:function(e){this.curPrizeType=e.target.value},getCurShopType:function(e){this.curShopType=e.target.value},getCurImgType:function(e){this.curImgType=e.target.value},onSubmit:function(){var e=this;this.curPrizeType!==this.PRIZE_TYPE.CUSTOM||0!==this.shopIds.length?this.form.validate().then((function(t){t.prize=e.curImgType===e.IMG_TYPE.CUSTOM&&e.fileList[0]||e.prize[0],t.support_shop_ids=e.shopIds,t.shop_num=e.shopNum,t.prize_id=e.info?e.info.prize_id:0,t.activity_prize_id=e.info?e.info.activity_prize_id:0,e.curPrizeType!==e.PRIZE_TYPE.DEFAULT||t.coupon_id?(e.$emit(\"change\",t),e.show=!1):e.messageService.warn({content:\"请选择优惠券\"})})):this.messageService.warn({content:\"请选择门店\"})}}},j=L,E=Object(h[\"a\"])(j,b,T,!1,null,null,null),D=E.exports,U=(i(\"dfa4\"),i(\"7212\")),N={name:\"PluginLotteryAdd\",data:function(e){var t=this.$stForm.create(),i=t.decorators(f);return{form:t,decorators:i,TIMES_TYPE:$[\"i\"],CROWD_TYPE:$[\"b\"],SHARE_TYPE:$[\"f\"],STOP_SWIPER:$[\"h\"],ACTIVITY_STATUS:$[\"a\"],NOT_PRIZE_IMG_TYPE:$[\"d\"],columsTitlelist:[\"奖品名称\",\"奖品类型\",\"可用门店（家）\",\"奖品数量（个）\",\"中奖概率 (%)\",\"操作\"],info:{},preview:{title:\"\",startTime:\"\",endTime:\"\",perTimes:0,totalTimes:0,description:\"\"},shareTitle:\"\",fileList:[],fileShareList:[],prizeList:[],timesType:$[\"i\"].DEFAULT,crowdType:$[\"b\"].DEFAULT,shareType:$[\"f\"].DEFAULT,isStopSwiper:$[\"h\"].DEFAULT,stepArr:[{title:\"基础信息\",key:1},{title:\"抽奖规则\",key:2},{title:\"奖项设置\",key:3}],currentIndex:0,curPrizeIndex:-1,notPrizeImgType:$[\"d\"].DEFAULT,dateRangeVal:[],notPrize:{prize_name:\"未中奖\",prize:{image_url:\"\"}},sliderOptions:{autoplay:{delay:3e3,disableOnInteraction:!1}},swiperOption:{spaceBetween:6,slidesPerView:1.05},defaultValue:[moment().format(\"HH:mm\"),moment(\"11:59\",\"HH:mm\")],isShowEditTable:-1,prizeRate:[],prizeNum:[],prizeSort:[[],[],[0,1,2,-1,0,1,2,-1],[0,-1,1,-1,2,-1,3,-1],[0,-1,1,-1,2,3,4,-1],[0,1,2,-1,3,4,5,-1],[0,1,2,3,4,5,6,-1]]}},bem:{bPage:\"page-brand-marketing-plugin-lottery-add\"},serviceInject:function(){return{addService:c[\"AddService\"],pattern:y[\"a\"],messageService:o[\"a\"]}},rxState:function(){return{drawCondition:this.addService.drawCondition$,drawTimesType:this.addService.drawTimesType$,invitePoster:this.addService.invitePoster$,wheelDefault:this.addService.wheelDefault$,wheelTurnAround:this.addService.wheelTurnAround$,joinCrowdAll:this.addService.joinCrowdAll$,crowd:this.addService.crowd$,imgType:this.addService.imgType$,prizeInfoList:this.addService.prizeInfoList$,lucky:this.addService.lucky$,prize:this.addService.prize$,share:this.addService.share$}},modals:{BrandMarketingPluginAddPrize:D},components:{H5Container:u[\"a\"],Steps:_,swiper:U[\"swiper\"],swiperSlide:U[\"swiperSlide\"],StImageUpload:g[\"a\"]},mounted:function(){this.$searchQuery.activity_id&&this.editVIew(this.$searchQuery.activity_id)},computed:{deleteBtnStatus:function(){return this.$searchQuery.activity_id&&1===this.$searchQuery.status},prizeListFilters:function(e){var t=this;return this.prizeList.length<=2?this.prizeList:this.prizeSort[this.prizeList.length-1].map((function(e,i){return e>-1?t.prizeList[e]:{prize:{image_url:t.notPrizeImgType===t.NOT_PRIZE_IMG_TYPE.CUSTOM?t.notPrize.prize.image_url:t.lucky[0].image_url},prize_name:t.notPrize.prize_name}}))}},methods:{showEditTable:function(e){this.isShowEditTable===e?(this.prizeList[e].number=this.prizeNum[e],this.prizeList[e].rate=this.prizeRate[e],this.isShowEditTable=-1):this.isShowEditTable=e},next:function(e){var t=this;e.index&&(e=e.index-1),0===e&&(this.currentIndex=0),1===e&&this.form.validate([\"activity_base.activity_name\",\"activity_base.activity_description\",\"activity_base.wheel_turn_around\",\"activity_base.wheel_share_default\",\"activity_base.share_title\",\"activity_base.activity_sub_name\"]).then((function(){t.currentIndex=e})),2===e&&this.form.validate([\"activity_base.activity_name\",\"activity_base.activity_description\",\"activity_base.wheel_turn_around\",\"activity_base.wheel_share_default\",\"activity_base.share_title\",\"activity_base.activity_sub_name\",\"activity_rule.join_crowd_all\",\"activity_rule.draw_condition\",\"activity_rule.draw_times_type\",\"activity_rule.per_times\",\"activity_rule.total_times\"]).then((function(){t.currentIndex=e}))},onChangeGetAvatar:function(e){this.fileList=Object(C[\"a\"])(e),this.notPrize.prize=this.fileList[0]},onShareChangeGetAvatar:function(e){this.fileShareList=Object(C[\"a\"])(e)},onSubmit:function(){var e=this;this.form.validate().then((function(t){t.activity_base.start_time=e.preview.startTime,t.activity_base.end_time=e.preview.endTime,t.activity_base.share_title=e.shareTitle,t.activity_base.share_bg=e.shareType===$[\"f\"].CUSTOM&&e.fileShareList[0]||e.share[0],t.activity_prizes=e.prizeList,t.activity_lucky.lucky=e.notPrizeImgType===$[\"d\"].CUSTOM?e.fileList[0]||e.prize[0]:e.lucky[0],(1!==e.timesType||t.activity_rule.per_times)&&(2!==e.timesType||t.activity_rule.total_times)?(t.activity_rule.prize_sort=e.prizeSort[e.prizeList.length-1],e.$searchQuery.activity_id?(t.activity_id=e.$searchQuery.activity_id,e.addService.edit(t).subscribe((function(t){e.$router.push(\"./success?id=\"+t.id)}))):e.addService.add(t).subscribe((function(t){e.$router.push(\"./success?id=\"+t.id)}))):e.messageService.warn({content:\"请填写抽奖次数\"})}))},getTitle:function(e){this.preview.title=e.target.value},getName:function(e){this.notPrize.prize_name=e.target.value},getPerTimes:function(e){this.preview.perTimes=e},getTotalTimes:function(e){this.preview.totalTimes=e},getDescription:function(e){this.preview.description=e},getCurTimesType:function(e){this.timesType=e.target.value},getCurCrowdType:function(e){this.crowdType=e.target.value},getCurShareType:function(e){this.shareType=e.target.value},stopSwiper:function(e){this.isStopSwiper=e.target.value},onDateChange:function(e,t){this.preview.startTime=t[0],this.preview.endTime=t[1]},getNotImgType:function(e){this.notPrizeImgType=e.target.value},getPrizeInfo:function(e){this.curPrizeIndex>-1?this.prizeList.splice(this.curPrizeIndex,1,e):(this.prizeList.push(e),this.prizeRate.push(e.rate),this.prizeNum.push(e.number))},getCurPrizeIndex:function(e){this.curPrizeIndex=e},disabledDate:function(e){return e&&e.format(\"YYYY-MM-DD\")<moment().format(\"YYYY-MM-DD\")},onDelete:function(e){if(this.isShowEditTable===e)return this.isShowEditTable=-1,!1;this.prizeRate.splice(e,1),this.prizeNum.splice(e,1),this.prizeList=this.prizeList.filter((function(t,i){return i!==e}))},editTableNum:function(e,t){this.prizeNum[t]=e},editTableRate:function(e,t){this.prizeRate[t]=e},editVIew:function(e){var t=this;return this.addService.editVIew(e).subscribe((function(e){t.info=e,t.form.setFieldsValue({activity_base:e.activity_base,activity_lucky:e.activity_lucky,activity_prizes:e.activity_prizes,activity_rule:e.activity_rule}),t.dateRangeVal=[moment(e.activity_base.start_time.trim()),moment(e.activity_base.end_time.trim())],t.prizeList=e.activity_prizes,e.activity_prizes.forEach((function(e,i){t.prizeNum[i]=e.number,t.prizeRate[i]=e.rate})),t.preview.startTime=e.activity_base.start_time,t.preview.endTime=e.activity_base.end_time,t.preview.perTimes=e.activity_rule.per_times,t.preview.totalTimes=e.activity_rule.total_times,t.preview.description=e.activity_base.activity_description,t.preview.title=e.activity_base.activity_sub_name,t.notPrize.prize_name=e.activity_lucky.lucky_name,t.shareType=e.activity_base.wheel_share_default,t.timesType=e.activity_rule.draw_times_type,t.isStopSwiper=e.activity_base.wheel_turn_around,t.notPrizeImgType=e.activity_lucky.image_default,t.shareTitle=e.activity_base.share_title,t.share[0].image_id=e.activity_base.share_bg.image_id,e.activity_lucky.lucky&&(t.fileList[0]=e.activity_lucky.lucky),t.fileShareList[0]=e.activity_base.share_bg,t.prize[0]=e.activity_lucky.lucky,t.notPrizeImgType===t.NOT_PRIZE_IMG_TYPE.CUSTOM?t.notPrize.prize=e.activity_lucky.lucky:t.notPrize.prize=t.lucky[0]}))}}},M=N,Y=Object(h[\"a\"])(M,n,s,!1,null,null,null);t[\"default\"]=Y.exports},\"9f92\":function(e,t,i){e.exports=i.p+\"img/bg.33237185.png\"},c3c3:function(e,t,i){\"use strict\";i.r(t);var r=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r(\"div\",{class:e.bPage()},[r(\"st-panel\",{attrs:{app:\"\"}},[r(\"div\",{class:e.bPage(\"content\")},[r(\"img\",{class:e.bPage(\"content-success-img\"),attrs:{src:i(\"d018\"),alt:\"success\"}}),r(\"div\",{staticClass:\"mg-b16 mg-t24\"},[e._v(\"活动新增成功\")]),r(\"div\",{staticClass:\"mg-b24\",class:e.bPage(\"content-text\")},[e._v(\"\\n        更多曝光推广，获得更多客户与订单\\n      \")]),r(\"div\",{class:e.bPage(\"content-action\")},[r(\"span\",{class:e.bPage(\"content-action-item\"),on:{click:e.pushSharePosterModal}},[r(\"img\",{class:e.bPage(\"content-action-img\"),attrs:{src:i(\"1370\"),alt:\"success\"}}),r(\"a\",[e._v(\"\\n            分享海报\\n          \")])]),r(\"span\",{class:e.bPage(\"content-action-item\")},[r(\"img\",{class:e.bPage(\"content-action-img\"),attrs:{src:i(\"30b1\"),alt:\"success\"}}),r(\"router-link\",{attrs:{to:\"/brand/marketing/activity\"}},[e._v(\"\\n            设置活动广告\\n          \")])],1),r(\"span\",{class:e.bPage(\"content-action-item\"),on:{click:function(t){return e.pushQrCodeModal()}}},[r(\"img\",{class:e.bPage(\"content-action-img\"),attrs:{src:i(\"d277\"),alt:\"success\"}}),r(\"a\",[e._v(\"\\n            小程序码\\n          \")])])]),r(\"div\",{class:e.bPage(\"content-btn\")},[r(\"router-link\",{attrs:{to:\"./add\"}},[r(\"st-button\",{staticClass:\"mg-r16\"},[e._v(\"\\n            新增活动\\n          \")])],1),r(\"router-link\",{attrs:{to:\"./index\"}},[r(\"st-button\",{attrs:{type:\"primary\"}},[e._v(\"\\n            返回活动列表页\\n          \")])],1)],1)])])],1)},a=[],n=i(\"78da\"),s=i(\"5ffc\"),o={name:\"PluginLotteryAdd\",data:function(){return{}},bem:{bPage:\"page-brand-marketing-plugin-lottery-success\"},serviceInject:function(){return{service:n[\"SuccessService\"]}},rxState:function(){var e=this.service,t=e.info$,i=e.qrcode$;return{info$:t,qrcode$:i}},hooks:function(){return{share:Object(s[\"a\"])()}},computed:{lotteryId:function(){return this.$searchQuery.id}},methods:{pushSharePosterModal:function(){var e=this;this.service.getSharePosterInfo(this.lotteryId).subscribe((function(t){var i=e.info$,r={qrcode_url:i.qrcode_url,sub_name:i.sub_name},a=t.is_auth;e.share.poster({isAuth:a,shsInfo:r,shsPath:\"/saas/lottery_poster\"})}))},pushQrCodeModal:function(){var e=this;this.service.getQrCode(this.lotteryId).subscribe((function(t){e.share.qrCode({isAuth:t.is_auth,qrCodeUrl:e.qrcode$})}))}}},c=o,u=i(\"2877\"),l=Object(u[\"a\"])(c,r,a,!1,null,null,null);t[\"default\"]=l.exports},d018:function(e,t,i){e.exports=i.p+\"img/success.c90c2656.png\"},fc9c:function(e,t,i){\"use strict\";i.r(t);var r=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r(\"st-panel\",{class:e.bPage(),attrs:{app:\"\"}},[r(\"div\",{class:e.bPage(\"header\")},[r(\"a-input-search\",{staticStyle:{width:\"722px\"},attrs:{placeholder:\"输入需要核销的兑换码\",enterButton:\"搜索\"},on:{search:e.getCheckinList},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:\"keyword\"}})],1),r(\"div\",{class:e.bPage(\"shadow\")}),r(\"st-panel\",{attrs:{app:\"\"}},[e.isShowTable?r(\"div\",[r(\"st-table\",{class:e.bPage(\"table\"),attrs:{page:!1,loading:e.loading.getCheckinList,columns:e.columns,dataSource:e.list,rowKey:\"id\"},scopedSlots:e._u([{key:\"action\",fn:function(t,i){return r(\"div\",{},[r(\"st-table-actions\",[r(\"st-button\",{staticClass:\"text-center mg-t24\",attrs:{disabled:0!==i.code_status,type:\"primary\"},on:{click:e.checkin}},[e._v(\"\\n              核销\\n            \")])],1)],1)}}],null,!1,1140266499)})],1):r(\"div\",{class:e.bPage(\"content\")},[r(\"img\",{class:e.bPage(\"content-img\"),attrs:{src:i(\"3d06\"),alt:\"checkin\"}}),r(\"div\",{class:e.bPage(\"step\")},[r(\"a-steps\",{attrs:{direction:\"vertical\",current:4}},[r(\"a-step\",{attrs:{title:\"搜索卡劵\",description:\"核销员输入由客户提供的奖品券号\"}},[r(\"div\",{class:e.bPage(\"step-circle\"),attrs:{slot:\"icon\"},slot:\"icon\"},[r(\"span\",[e._v(\"1\")])])]),r(\"a-step\",{attrs:{title:\" 校验\",description:\"检查券信息是否对应有效\"}},[r(\"div\",{class:e.bPage(\"step-circle\"),attrs:{slot:\"icon\"},slot:\"icon\"},[e._v(\"\\n              2\\n            \")])]),r(\"a-step\",{attrs:{title:\"完成使用\",description:\"校验无误后向客户进行减免或赠送礼品，并核销卡券\"}},[r(\"div\",{class:e.bPage(\"step-circle\"),attrs:{slot:\"icon\"},slot:\"icon\"},[e._v(\"\\n              3\\n            \")])])],1)],1)])])],1)},a=[],n=i(\"513d\"),s=function(){return[{title:\"中奖用户姓名\",dataIndex:\"prize_member_name\"},{title:\"中奖用户手机号\",dataIndex:\"mobile\"},{title:\"活动名称\",dataIndex:\"activity_name\"},{title:\"中奖时间\",dataIndex:\"prize_time\"},{title:\"奖品名称\",dataIndex:\"prize_name\"},{title:\"兑换码\",dataIndex:\"code\"},{title:\"可用门店\",dataIndex:\"shops\"},{title:\"兑换码状态\",dataIndex:\"code_status_name\"},{title:\"操作\",dataIndex:\"action\",scopedSlots:{customRender:\"action\"}}]},o=i(\"e69b\"),c={name:\"PluginLotteryCheckin\",data:function(){return{keyword:\"\",isShowTable:!1}},bem:{bPage:\"page-brand-marketing-plugin-lottery-checkin\"},serviceInject:function(){return{checkinService:n[\"CheckinService\"],message:o[\"a\"]}},rxState:function(){return{list:this.checkinService.list$,loading:this.checkinService.loading$}},computed:{columns:s},methods:{getCheckinList:function(){var e=this;if(this.keyword)return this.checkinService.getCheckinList(this.keyword).subscribe((function(t){e.isShowTable=!0}));this.message.warn({content:\"请输入核销码\"})},checkin:function(){var e=this;return this.checkinService.checkin(this.keyword).subscribe((function(t){e.message.success({content:\"核销成功\"}),e.getCheckinList()}))}}},u=c,l=i(\"2877\"),d=Object(l[\"a\"])(u,r,a,!1,null,null,null);t[\"default\"]=d.exports}}]);","extractedComments":[]}