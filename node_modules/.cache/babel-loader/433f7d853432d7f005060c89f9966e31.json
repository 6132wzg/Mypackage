{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js!/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhigang/Desktop/styd/web/src/views/biz-modals/hardware/area.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/biz-modals/hardware/area.vue","mtime":1600926555859},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js","mtime":1591062572376}],"contextDependencies":[],"result":["import \"core-js/modules/es6.number.constructor\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { ruleOptions, formItemSwitches, alertMsg, timesCardRules } from \"./area.config\";\nimport { AreaService } from \"./area.service\";\nimport { LEAVE_LIMIT, CHECKIN, PEOPLE_TYPE, ENTRY } from '@/constants/setting/hardware';\nexport default {\n  name: 'Area',\n  serviceProviders: function serviceProviders() {\n    return [AreaService];\n  },\n  serviceInject: function serviceInject() {\n    return {\n      areaService: AreaService\n    };\n  },\n  rxState: function rxState() {\n    var areaService = this.areaService;\n    return {\n      rule: areaService.rule$,\n      timeCardRange: areaService.timeCardRange$,\n      info: areaService.info$,\n      loading: areaService.loading$,\n      whiteList: areaService.whiteList$\n    };\n  },\n  bem: {\n    bPage: 'modal-shop-blacklist'\n  },\n  props: {\n    isEdit: {\n      type: Boolean,\n      default: false\n    },\n    id: {\n      type: Number\n    }\n  },\n  data: function data() {\n    var form = this.$stForm.create();\n    var decorators = form.decorators(ruleOptions);\n    return {\n      show: false,\n      form: form,\n      decorators: decorators,\n      LEAVE_LIMIT: LEAVE_LIMIT,\n      ENTRY: ENTRY,\n      CHECKIN: CHECKIN,\n      PEOPLE_TYPE: PEOPLE_TYPE,\n      peopleType: 0,\n      white_list: [],\n      type: ENTRY.GATE // area类型\n\n    };\n  },\n  computed: {\n    /**\n     * 根据场地类型控制特定 form-item 的显示隐藏\n     */\n    formItemSwitches: formItemSwitches,\n    alertMsg: alertMsg,\n    timesCardRules: timesCardRules\n  },\n  mounted: function mounted() {\n    this.getWhiteList('');\n    this.getInfo();\n  },\n  methods: {\n    getWhiteList: function getWhiteList(val) {\n      this.areaService.getWhiteList(val).subscribe();\n    },\n    getInfo: function getInfo() {\n      var _this = this;\n\n      this.areaService.getAreaInfo(this.id).subscribe(function (res) {\n        var _res$info = res.info,\n            area_id = _res$info.area_id,\n            course_time = _res$info.course_time,\n            people_type = _res$info.people_type,\n            leave_limit = _res$info.leave_limit,\n            checkin = _res$info.checkin,\n            white_list = _res$info.white_list,\n            charge_type = _res$info.charge_type,\n            charge_value = _res$info.charge_value,\n            is_course = _res$info.is_course;\n        _this.peopleType = people_type;\n\n        _this.$nextTick(function () {\n          _this.form.setFieldsValue({\n            area_id: area_id,\n            course_time: course_time,\n            people_type: people_type,\n\n            /**\n             * 请不要再这么定义了！\n             */\n            leave_limit: leave_limit === LEAVE_LIMIT.TRUE,\n            checkin: checkin,\n            white_list: white_list,\n            charge_type: charge_type,\n            charge_value: charge_value,\n            is_course: is_course\n          });\n        });\n      });\n    },\n    getCurPeopleType: function getCurPeopleType(e) {\n      this.peopleType = e.target.value;\n    },\n    putAreaSetting: function putAreaSetting(e) {\n      var _this2 = this;\n\n      if (!this.isEdit) {\n        this.show = false;\n      }\n\n      e.preventDefault();\n      this.form.validate().then(function (values) {\n        values.area_type = _this2.type;\n        values.leave_limit = values.leave_limit ? LEAVE_LIMIT.TRUE : LEAVE_LIMIT.FALSE;\n\n        _this2.areaService.putAreaSetting(values).subscribe(function () {\n          _this2.$emit('success');\n\n          _this2.show = false;\n        });\n      });\n    }\n  }\n};",{"version":3,"sources":["area.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <st-modal\n    title=\"区域通行设置\"\n    v-model=\"show\"\n    @ok=\"putAreaSetting\"\n    size=\"small\"\n    :loading=\"loading.getAreaInfo\"\n  >\n    <st-alert>{{ alertMsg }}</st-alert>\n    <st-form :form=\"form\" labelWidth=\"120px\" class=\"mg-t24\">\n      <st-form-item v-show=\"false\" label=\"id\">\n        <input type=\"hidden\" v-decorator=\"decorators.area_id\" />\n      </st-form-item>\n      <st-form-item label=\"所属区域名称\">{{ info.area_name }}</st-form-item>\n      <st-form-item v-if=\"info.area_type\" label=\"所属区域类型\">\n        {{ info.area_type.name }}\n      </st-form-item>\n      <st-form-item\n        v-if=\"formItemSwitches.entrancePeopleType\"\n        label=\"进入人员范围\"\n        required\n      >\n        <a-radio-group\n          @change=\"getCurPeopleType\"\n          v-decorator=\"decorators.people_type\"\n          :disabled=\"!isEdit\"\n        >\n          <a-radio\n            v-for=\"(item, index) in rule\"\n            :key=\"index\"\n            :value=\"item.value\"\n          >\n            {{ item.label }}\n          </a-radio>\n        </a-radio-group>\n      </st-form-item>\n\n      <st-form-item label=\"指定员工\" v-if=\"peopleType === PEOPLE_TYPE.ONLY\">\n        <a-select\n          mode=\"multiple\"\n          showSearch\n          :filterOption=\"false\"\n          :defaultActiveFirstOption=\"false\"\n          @search=\"getWhiteList\"\n          v-decorator=\"decorators.white_list\"\n          placeholder=\"搜索指定员工\"\n          :disabled=\"!isEdit\"\n        >\n          <a-select-option\n            v-for=\"(item, index) in whiteList\"\n            :key=\"index\"\n            :value=\"item.staff_id\"\n          >\n            {{ item.staff_name }}\n          </a-select-option>\n        </a-select>\n      </st-form-item>\n\n      <st-form-item v-if=\"formItemSwitches.exitanceRestriction\">\n        <template slot=\"label\">\n          离场限制\n          <st-help-tooltip id=\"TSTXGZ001\" />\n        </template>\n        <st-checkbox\n          v-decorator=\"decorators.leave_limit\"\n          :disabled=\"!isEdit\"\n          class=\"mg-r8\"\n        ></st-checkbox>\n        未归还的临时储物柜，不允许离场\n      </st-form-item>\n      <st-form-item required v-if=\"formItemSwitches.courseEntranceRestriction\">\n        <template slot=\"label\">\n          约课入场限制\n          <st-help-tooltip id=\"TSTXGZ004\" />\n        </template>\n        约课用户在课程开始前\n        <st-input-number\n          :min=\"0\"\n          :max=\"180\"\n          v-decorator=\"decorators.course_time\"\n          :disabled=\"!isEdit\"\n          style=\"width:50px;\"\n        ></st-input-number>\n        分钟可入场\n      </st-form-item>\n      <!-- 预约限制与场地预约限制后端接口字段相同，这里产品强制要求区分 -->\n      <st-form-item required v-if=\"formItemSwitches.gateOrderRestriction\">\n        <template slot=\"label\">\n          预约限制\n          <st-help-tooltip id=\"TSTXGZ002\" />\n        </template>\n        预约用户在预约开始前\n        <st-input-number\n          :min=\"0\"\n          :max=\"180\"\n          v-decorator=\"decorators.course_time\"\n          :disabled=\"!isEdit\"\n          style=\"width:50px;\"\n        ></st-input-number>\n        分钟可入场\n      </st-form-item>\n      <!-- 预约限制与场地预约限制后端接口字段相同，这里产品强制要求区分 -->\n      <st-form-item required v-if=\"formItemSwitches.venueOrderRestriction\">\n        <template slot=\"label\">\n          场地预约限制\n          <st-help-tooltip id=\"TSTXGZ007\" />\n        </template>\n        场地预约用户在预约开始前\n        <st-input-number\n          :min=\"0\"\n          :max=\"180\"\n          v-decorator=\"decorators.course_time\"\n          :disabled=\"!isEdit\"\n          style=\"width:50px;\"\n        ></st-input-number>\n        分钟可入场\n      </st-form-item>\n      <st-form-item label=\"入场签课\" v-if=\"formItemSwitches.entranceCheckIn\">\n        <st-checkbox\n          v-decorator=\"decorators.checkin\"\n          :disabled=\"!isEdit\"\n        ></st-checkbox>\n        当预约课程与场地排期课程一致，在用户入场同时，\n        在可签到时间内自动为用户完成此课程签到\n      </st-form-item>\n      <st-form-item v-if=\"formItemSwitches.timesCardRule\">\n        <template slot=\"label\">\n          次卡扣费规则\n          <st-help-tooltip id=\"TSTXGZ005\" />\n        </template>\n        <div>\n          <a-radio-group\n            :disabled=\"!isEdit\"\n            v-decorator=\"decorators.charge_type\"\n          >\n            <a-radio\n              v-for=\"(item, index) in timesCardRules\"\n              :key=\"index\"\n              :value=\"item.value\"\n            >\n              <!-- 每xx小时内进入此区域只扣1次 这地方比较特殊，没有复用性，不定义常量了 -->\n              <!-- 2 对应 radio 的第 2 条 -->\n              <template v-if=\"item.value === 2\">\n                每\n                <a-select\n                  :options=\"timeCardRange\"\n                  v-decorator=\"decorators.charge_value\"\n                  :disabled=\"!isEdit\"\n                  style=\"width: 66px\"\n                ></a-select>\n              </template>\n              {{ item.label }}\n            </a-radio>\n          </a-radio-group>\n        </div>\n      </st-form-item>\n      <st-form-item v-if=\"formItemSwitches.entranceRestriction\">\n        <template slot=\"label\">\n          进入此区域限制\n          <st-help-tooltip id=\"TSTXGZ006\" />\n        </template>\n        <st-checkbox\n          v-decorator=\"decorators.is_course\"\n          :disabled=\"!isEdit\"\n          class=\"mg-r8\"\n        ></st-checkbox>\n        仅允许在此区域约课的用户入场\n      </st-form-item>\n    </st-form>\n  </st-modal>\n</template>\n<script>\nimport {\n  ruleOptions,\n  formItemSwitches,\n  alertMsg,\n  timesCardRules\n} from './area.config'\nimport { AreaService } from './area.service'\nimport {\n  LEAVE_LIMIT,\n  CHECKIN,\n  PEOPLE_TYPE,\n  ENTRY\n} from '@/constants/setting/hardware'\n\nexport default {\n  name: 'Area',\n  serviceProviders() {\n    return [AreaService]\n  },\n  serviceInject() {\n    return {\n      areaService: AreaService\n    }\n  },\n  rxState() {\n    const { areaService } = this\n    return {\n      rule: areaService.rule$,\n      timeCardRange: areaService.timeCardRange$,\n      info: areaService.info$,\n      loading: areaService.loading$,\n      whiteList: areaService.whiteList$\n    }\n  },\n  bem: {\n    bPage: 'modal-shop-blacklist'\n  },\n  props: {\n    isEdit: {\n      type: Boolean,\n      default: false\n    },\n    id: {\n      type: Number\n    }\n  },\n  data() {\n    const form = this.$stForm.create()\n    const decorators = form.decorators(ruleOptions)\n    return {\n      show: false,\n      form,\n      decorators,\n      LEAVE_LIMIT,\n      ENTRY,\n      CHECKIN,\n      PEOPLE_TYPE,\n      peopleType: 0,\n      white_list: [],\n      type: ENTRY.GATE // area类型\n    }\n  },\n  computed: {\n    /**\n     * 根据场地类型控制特定 form-item 的显示隐藏\n     */\n    formItemSwitches,\n    alertMsg,\n    timesCardRules\n  },\n  mounted() {\n    this.getWhiteList('')\n    this.getInfo()\n  },\n  methods: {\n    getWhiteList(val) {\n      this.areaService.getWhiteList(val).subscribe()\n    },\n    getInfo() {\n      this.areaService.getAreaInfo(this.id).subscribe(res => {\n        const {\n          area_id,\n          course_time,\n          people_type,\n          leave_limit,\n          checkin,\n          white_list,\n          charge_type,\n          charge_value,\n          is_course\n        } = res.info\n        this.peopleType = people_type\n        this.$nextTick(() => {\n          this.form.setFieldsValue({\n            area_id,\n            course_time,\n            people_type,\n            /**\n             * 请不要再这么定义了！\n             */\n            leave_limit: leave_limit === LEAVE_LIMIT.TRUE,\n            checkin,\n            white_list,\n            charge_type,\n            charge_value,\n            is_course\n          })\n        })\n      })\n    },\n    getCurPeopleType(e) {\n      this.peopleType = e.target.value\n    },\n    putAreaSetting(e) {\n      if (!this.isEdit) {\n        this.show = false\n      }\n      e.preventDefault()\n      this.form.validate().then(values => {\n        values.area_type = this.type\n        values.leave_limit = values.leave_limit\n          ? LEAVE_LIMIT.TRUE\n          : LEAVE_LIMIT.FALSE\n        this.areaService.putAreaSetting(values).subscribe(() => {\n          this.$emit('success')\n          this.show = false\n        })\n      })\n    }\n  }\n}\n</script>\n"],"sourceRoot":"src/views/biz-modals/hardware"}]}