{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhigang/Desktop/styd/web/src/views/pages/brand/finance/salary/list.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/pages/brand/finance/salary/list.vue","mtime":1600926556114},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js","mtime":1591062572376}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { ListService } from './list.service'\nimport { columns } from './list.config.ts'\nimport tableMixin from '@/mixins/table.mixin'\nimport { UserService } from '@/services/user.service'\nimport BrandFinanceClassCommission from '@/views/biz-modals/brand/finance/class-commission'\nimport BrandFinanceSaleCommission from '@/views/biz-modals/brand/finance/sale-commission'\nimport BrandFinanceStaffShop from '@/views/biz-modals/brand/finance/staff-shop'\nimport moment from 'moment'\nimport { cloneDeep } from 'lodash-es'\nexport default {\n  name: 'BrandFinanceSalary',\n  mixins: [tableMixin],\n  data() {\n    return {\n      monthRange: [],\n      start_month: null,\n      end_month: null\n    }\n  },\n  bem: {\n    b: 'page-brand-finance-salary',\n    bDate: 'st-recent-radio-group'\n  },\n  modals: {\n    BrandFinanceClassCommission,\n    BrandFinanceSaleCommission,\n    BrandFinanceStaffShop\n  },\n  serviceInject() {\n    return {\n      listService: ListService,\n      userService: UserService\n    }\n  },\n  rxState() {\n    return {\n      list: this.listService.list$,\n      page: this.listService.page$,\n      loading: this.listService.loading$,\n      info: this.listService.info$,\n      department: this.listService.department$,\n      shopList: this.userService.shopList$,\n      auth: this.listService.auth$\n    }\n  },\n  computed: {\n    columns\n  },\n  mounted() {\n    this.setQueryParams()\n  },\n  watch: {\n    $searchQuery() {\n      this.setQueryParams()\n    }\n  },\n  methods: {\n    setQueryParams() {\n      this.start_month = null\n      this.end_month = null\n      if (this.$searchQuery.start_month && this.$searchQuery.end_month) {\n        this.start_month = moment(this.$searchQuery.start_month)\n        this.end_month = moment(this.$searchQuery.end_month)\n      }\n    },\n    change() {\n      if (this.start_month && this.end_month) {\n        this.$searchQuery.start_month = this.start_month.format('YYYY-MM')\n        this.$searchQuery.end_month = this.end_month.format('YYYY-MM')\n        this.onSearch()\n      }\n      if (!this.start_month && !this.end_month) {\n        this.$searchQuery.start_month = ''\n        this.$searchQuery.end_month = ''\n        this.onSearch()\n      }\n    },\n    disabledStartDate(current) {\n      if (this.end_month) {\n        const startMonth = cloneDeep(current).startOf('month')\n        const endMonth = cloneDeep(this.end_month).startOf('month')\n        return (\n          startMonth > cloneDeep(this.end_month).startOf('month') ||\n          startMonth <= endMonth.subtract(12, 'M')\n        )\n      }\n      return false\n    },\n    disabledEndDate(current) {\n      if (this.start_month) {\n        const startMonth = cloneDeep(this.start_month).startOf('month')\n        const endMonth = cloneDeep(current).startOf('month')\n        return (\n          endMonth < cloneDeep(this.start_month).startOf('month') ||\n          endMonth >= startMonth.add(1, 'y')\n        )\n      }\n      return false\n    }\n  }\n}\n",{"version":3,"sources":["list.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"list.vue","sourceRoot":"src/views/pages/brand/finance/salary","sourcesContent":["<template>\n  <st-panel-layout :class=\"b()\">\n    <st-panel app>\n      <div :class=\"b('action')\">\n        <a-select\n          placeholder=\"请选择部门\"\n          v-model=\"$searchQuery.department_id\"\n          :class=\"b('select')\"\n          @change=\"onSingleSearch('department_id', $event)\"\n        >\n          <a-select-option :value=\"-1\">\n            全部部门\n          </a-select-option>\n          <a-select-option\n            v-for=\"(item, index) of department\"\n            :key=\"index\"\n            :value=\"item.id\"\n          >\n            {{ item.name }}\n          </a-select-option>\n        </a-select>\n        <a-select\n          placeholder=\"请选择门店\"\n          v-model=\"$searchQuery.shop_id\"\n          @change=\"onSingleSearch('shop_id', $event)\"\n          :class=\"b('select')\"\n        >\n          <a-select-option :value=\"-1\">\n            全部门店\n          </a-select-option>\n          <a-select-option\n            v-for=\"(item, index) of shopList\"\n            :key=\"index\"\n            :value=\"item.shop_id\"\n          >\n            {{ item.shop_name }}\n          </a-select-option>\n        </a-select>\n        <!-- <a-range-picker\n          :class=\"[bDate('range'), b('range')]\"\n          :placeholder=\"['开始月份', '结束月份']\"\n          format=\"YYYY-MM\"\n          :mode=\"['month', 'month']\"\n          @change=\"change\"\n          @panelChange=\"panelChange\"\n          v-model=\"monthRange\"\n        /> -->\n        <a-month-picker\n          @change=\"change\"\n          v-model=\"start_month\"\n          placeholder=\"开始月份\"\n          :class=\"b('range')\"\n          :disabledDate=\"disabledStartDate\"\n        />\n        ~\n        <a-month-picker\n          @change=\"change\"\n          v-model=\"end_month\"\n          placeholder=\"结束月份\"\n          :class=\"b('range')\"\n          :disabledDate=\"disabledEndDate\"\n        />\n\n        <st-input-search\n          :class=\"b('search')\"\n          style=\"width: 255px\"\n          v-model=\"$searchQuery.search\"\n          @search=\"onKeywordsSearch('search', $event)\"\n          placeholder=\"搜索员工姓名、手机号及工号\"\n        ></st-input-search>\n      </div>\n\n      <st-table\n        :page=\"page\"\n        @change=\"onTableChange\"\n        :loading=\"loading.getList\"\n        :columns=\"columns\"\n        :dataSource=\"list\"\n        rowKey=\"id\"\n      >\n        <span class=\"word-break\" slot=\"staff_num\" slot-scope=\"text\">\n          {{ text }}\n        </span>\n        <template slot=\"shop\" slot-scope=\"text, record\">\n          <a\n            v-if=\"text.count > 1\"\n            v-modal-link=\"{\n              name: 'brand-finance-staff-shop',\n              props: {\n                id: record.id\n              }\n            }\"\n          >\n            共{{ text.count }}家门店\n          </a>\n          <span v-else>\n            {{ text.name }}\n          </span>\n        </template>\n        <template slot=\"sales_commission\" slot-scope=\"text, record\">\n          <a\n            v-modal-link=\"{\n              name: 'brand-finance-sale-commission',\n              props: {\n                id: record.id\n              }\n            }\"\n          >\n            {{ text }}\n          </a>\n        </template>\n        <template slot=\"course_commission\" slot-scope=\"text, record\">\n          <a\n            v-modal-link=\"{\n              name: 'brand-finance-class-commission',\n              props: {\n                id: record.id\n              }\n            }\"\n          >\n            {{ text }}\n          </a>\n        </template>\n      </st-table>\n    </st-panel>\n  </st-panel-layout>\n</template>\n<script>\nimport { ListService } from './list.service'\nimport { columns } from './list.config.ts'\nimport tableMixin from '@/mixins/table.mixin'\nimport { UserService } from '@/services/user.service'\nimport BrandFinanceClassCommission from '@/views/biz-modals/brand/finance/class-commission'\nimport BrandFinanceSaleCommission from '@/views/biz-modals/brand/finance/sale-commission'\nimport BrandFinanceStaffShop from '@/views/biz-modals/brand/finance/staff-shop'\nimport moment from 'moment'\nimport { cloneDeep } from 'lodash-es'\nexport default {\n  name: 'BrandFinanceSalary',\n  mixins: [tableMixin],\n  data() {\n    return {\n      monthRange: [],\n      start_month: null,\n      end_month: null\n    }\n  },\n  bem: {\n    b: 'page-brand-finance-salary',\n    bDate: 'st-recent-radio-group'\n  },\n  modals: {\n    BrandFinanceClassCommission,\n    BrandFinanceSaleCommission,\n    BrandFinanceStaffShop\n  },\n  serviceInject() {\n    return {\n      listService: ListService,\n      userService: UserService\n    }\n  },\n  rxState() {\n    return {\n      list: this.listService.list$,\n      page: this.listService.page$,\n      loading: this.listService.loading$,\n      info: this.listService.info$,\n      department: this.listService.department$,\n      shopList: this.userService.shopList$,\n      auth: this.listService.auth$\n    }\n  },\n  computed: {\n    columns\n  },\n  mounted() {\n    this.setQueryParams()\n  },\n  watch: {\n    $searchQuery() {\n      this.setQueryParams()\n    }\n  },\n  methods: {\n    setQueryParams() {\n      this.start_month = null\n      this.end_month = null\n      if (this.$searchQuery.start_month && this.$searchQuery.end_month) {\n        this.start_month = moment(this.$searchQuery.start_month)\n        this.end_month = moment(this.$searchQuery.end_month)\n      }\n    },\n    change() {\n      if (this.start_month && this.end_month) {\n        this.$searchQuery.start_month = this.start_month.format('YYYY-MM')\n        this.$searchQuery.end_month = this.end_month.format('YYYY-MM')\n        this.onSearch()\n      }\n      if (!this.start_month && !this.end_month) {\n        this.$searchQuery.start_month = ''\n        this.$searchQuery.end_month = ''\n        this.onSearch()\n      }\n    },\n    disabledStartDate(current) {\n      if (this.end_month) {\n        const startMonth = cloneDeep(current).startOf('month')\n        const endMonth = cloneDeep(this.end_month).startOf('month')\n        return (\n          startMonth > cloneDeep(this.end_month).startOf('month') ||\n          startMonth <= endMonth.subtract(12, 'M')\n        )\n      }\n      return false\n    },\n    disabledEndDate(current) {\n      if (this.start_month) {\n        const startMonth = cloneDeep(this.start_month).startOf('month')\n        const endMonth = cloneDeep(current).startOf('month')\n        return (\n          endMonth < cloneDeep(this.start_month).startOf('month') ||\n          endMonth >= startMonth.add(1, 'y')\n        )\n      }\n      return false\n    }\n  }\n}\n</script>\n"]}]}