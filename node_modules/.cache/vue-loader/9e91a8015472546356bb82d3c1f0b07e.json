{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhigang/Desktop/styd/web/src/views/biz-modals/shop/finance/gathering/earnest/deal.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/biz-modals/shop/finance/gathering/earnest/deal.vue","mtime":1591147717215},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js","mtime":1591062572376}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { DealService } from './deal.service'\nimport { cloneDeep } from 'lodash-es'\nimport { ruleOptions } from './deal.config'\nexport default {\n  name: 'ModalShopFinanceGatheringEarnestDeal',\n  bem: {\n    sale: 'modal-sold-deal-sale'\n  },\n  serviceProviders() {\n    return [DealService]\n  },\n  serviceInject() {\n    return {\n      dealService: DealService\n    }\n  },\n  rxState() {\n    return {\n      loading: this.dealService.loading$,\n      list: this.dealService.list$,\n      productTypes: this.dealService.productTypes$,\n      info: this.dealService.info$\n    }\n  },\n  props: {\n    id: {\n      type: Number,\n      required: true\n    }\n  },\n  data() {\n    const form = this.$stForm.create()\n    const decorators = form.decorators(ruleOptions)\n    return {\n      form,\n      decorators,\n      show: false,\n      // 搜索会员\n      memberSearchText: '',\n      searchMemberIsShow: true\n    }\n  },\n  created() {\n    this.dealService.init(this.id).subscribe()\n  },\n  methods: {\n    // 搜索产品\n    onProductSearch(data) {\n      this.memberSearchText = data\n      if (data === '') {\n        this.dealService.list$.commit(() => [])\n        this.form.resetFields(['product_name'])\n      } else {\n        const params = {\n          product_type: this.form.getFieldValue('product_type'),\n          product_name: data\n        }\n        this.dealService.getList(params).subscribe(res => {\n          if (!res.list.length) {\n            this.form.resetFields(['product_name'])\n          }\n        })\n      }\n    },\n    onCancel() {\n      this.show = false\n    },\n    onNext() {\n      this.form.validate().then(values => {\n        // 到签单页面\n        const obj = Object.assign(this.info, {\n          id: values.product_name,\n          product_type: values.product_type\n        })\n        this.$emit('success', obj)\n        this.show = false\n      })\n    }\n  }\n}\n",{"version":3,"sources":["deal.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"deal.vue","sourceRoot":"src/views/biz-modals/shop/finance/gathering/earnest","sourcesContent":["<template>\n  <st-modal title=\"定金签单\" v-model=\"show\" @cancel=\"onCancel\" size=\"small\">\n    <div :class=\"sale('content')\">\n      <a-row :class=\"[sale('info'), 'mg-b24']\">\n        <a-col :span=\"13\">\n          <st-info>\n            <st-info-item label=\"定金金额\">\n              {{ info.price }}\n            </st-info-item>\n            <st-info-item label=\"收款时间\">\n              {{ info.pay_time }}\n            </st-info-item>\n            <st-info-item label=\"销售人员\">\n              {{ info.sale_name }}\n            </st-info-item>\n            <st-info-item class=\"mg-b24\" label=\"收款人员\">\n              {{ info.operator_name }}\n            </st-info-item>\n          </st-info>\n        </a-col>\n        <a-col :span=\"11\">\n          <st-info>\n            <st-info-item label=\"会员姓名\">\n              {{ info.member_name }}\n            </st-info-item>\n            <template v-if=\"info.is_minors === 1\">\n              <st-info-item label=\"家长手机号\">\n                {{ info.parent_mobile }}\n              </st-info-item>\n              <st-info-item label=\"家长姓名\">\n                {{ info.parent_name }}\n              </st-info-item>\n            </template>\n            <st-info-item label=\"手机号\" v-else>\n              {{ info.mobile }}\n            </st-info-item>\n            <st-info-item label=\"订单号\">{{ info.order_id }}</st-info-item>\n            <st-info-item class=\"mg-b24\" label=\"订单状态\">\n              {{ info.order_status }}\n            </st-info-item>\n          </st-info>\n        </a-col>\n      </a-row>\n      <st-form :form=\"form\" labelWidth=\"88px\">\n        <st-form-item labelGutter=\"12px\" label=\"商品类型\" required>\n          <a-select\n            allowClear\n            placeholder=\"输入选择商品类型\"\n            :defaultActiveFirstOption=\"false\"\n            :showArrow=\"false\"\n            :filterOption=\"false\"\n            v-decorator=\"decorators.product_type\"\n          >\n            <a-select-option\n              v-for=\"(item, index) in productTypes\"\n              :value=\"item.value\"\n              :key=\"index\"\n            >\n              {{ item.label }}\n            </a-select-option>\n          </a-select>\n        </st-form-item>\n        <st-form-item labelGutter=\"12px\" label=\"商品名称\" required>\n          <a-select\n            showSearch\n            allowClear\n            placeholder=\"输入商品名称搜索\"\n            :defaultActiveFirstOption=\"false\"\n            :showArrow=\"false\"\n            :filterOption=\"false\"\n            v-decorator=\"decorators.product_name\"\n            @search=\"onProductSearch\"\n            notFoundContent=\"无搜索结果\"\n          >\n            <a-select-option\n              v-for=\"(item, index) in list\"\n              :value=\"item.id\"\n              :key=\"index\"\n            >\n              <span\n                v-html=\"\n                  `${item.product_name}`.replace(\n                    new RegExp(memberSearchText, 'g'),\n                    `\\<span class='global-highlight-color'\\>${memberSearchText}\\<\\/span\\>`\n                  )\n                \"\n              >\n                {{ item.product_name }}\n              </span>\n            </a-select-option>\n          </a-select>\n        </st-form-item>\n      </st-form>\n    </div>\n    <template slot=\"footer\">\n      <st-button @click=\"onNext\" type=\"primary\">\n        下一步\n      </st-button>\n    </template>\n  </st-modal>\n</template>\n\n<script>\nimport { DealService } from './deal.service'\nimport { cloneDeep } from 'lodash-es'\nimport { ruleOptions } from './deal.config'\nexport default {\n  name: 'ModalShopFinanceGatheringEarnestDeal',\n  bem: {\n    sale: 'modal-sold-deal-sale'\n  },\n  serviceProviders() {\n    return [DealService]\n  },\n  serviceInject() {\n    return {\n      dealService: DealService\n    }\n  },\n  rxState() {\n    return {\n      loading: this.dealService.loading$,\n      list: this.dealService.list$,\n      productTypes: this.dealService.productTypes$,\n      info: this.dealService.info$\n    }\n  },\n  props: {\n    id: {\n      type: Number,\n      required: true\n    }\n  },\n  data() {\n    const form = this.$stForm.create()\n    const decorators = form.decorators(ruleOptions)\n    return {\n      form,\n      decorators,\n      show: false,\n      // 搜索会员\n      memberSearchText: '',\n      searchMemberIsShow: true\n    }\n  },\n  created() {\n    this.dealService.init(this.id).subscribe()\n  },\n  methods: {\n    // 搜索产品\n    onProductSearch(data) {\n      this.memberSearchText = data\n      if (data === '') {\n        this.dealService.list$.commit(() => [])\n        this.form.resetFields(['product_name'])\n      } else {\n        const params = {\n          product_type: this.form.getFieldValue('product_type'),\n          product_name: data\n        }\n        this.dealService.getList(params).subscribe(res => {\n          if (!res.list.length) {\n            this.form.resetFields(['product_name'])\n          }\n        })\n      }\n    },\n    onCancel() {\n      this.show = false\n    },\n    onNext() {\n      this.form.validate().then(values => {\n        // 到签单页面\n        const obj = Object.assign(this.info, {\n          id: values.product_name,\n          product_type: values.product_type\n        })\n        this.$emit('success', obj)\n        this.show = false\n      })\n    }\n  }\n}\n</script>\n"]}]}