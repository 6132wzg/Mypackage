{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js!/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhigang/Desktop/styd/web/src/views/pages/shop/staff/list.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/pages/shop/staff/list.vue","mtime":1600926556521},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js","mtime":1591062572376}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { UserService } from '@/services/user.service';\nimport { ListService } from \"./list.service\";\nimport ChangeStaffPostion from \"./list#/change-staff-postion\";\nimport { columns } from \"./list.config\";\nimport tableMixin from '@/mixins/table.mixin';\nimport ShopStaffBatchImport from '@/views/biz-modals/shop-staff/batch-import';\nimport ShopStaffBindCard from '@/views/biz-modals/shop-staff/bind-card';\nimport ShopStaffLeaveCurrentShop from '@/views/biz-modals/shop-staff/leave-current-shop';\nimport ShopStaffRePassword from '@/views/biz-modals/shop-staff/re-password';\nimport ShopStaffSalaryAccountSetting from '@/views/biz-modals/shop-staff/salary-account-setting';\nimport ShopStaffUpdateStaffPosition from '@/views/biz-modals/shop-staff/update-staff-position';\nimport StaffUpdateStaffPosition from '@/views/biz-modals/staff/update-staff-position';\nexport default {\n  mixins: [tableMixin],\n  modals: {\n    ShopStaffBatchImport: ShopStaffBatchImport,\n    ShopStaffBindCard: ShopStaffBindCard,\n    ShopStaffLeaveCurrentShop: ShopStaffLeaveCurrentShop,\n    ShopStaffRePassword: ShopStaffRePassword,\n    ShopStaffSalaryAccountSetting: ShopStaffSalaryAccountSetting,\n    ShopStaffUpdateStaffPosition: ShopStaffUpdateStaffPosition,\n    StaffUpdateStaffPosition: StaffUpdateStaffPosition\n  },\n  components: {\n    ChangeStaffPostion: ChangeStaffPostion\n  },\n  serviceInject: function serviceInject() {\n    return {\n      userService: UserService,\n      service: ListService\n    };\n  },\n  rxState: function rxState() {\n    return {\n      staffList: this.service.staffList$,\n      page: this.service.page$,\n      roleOptions: this.service.roleOptions$,\n      loading: this.service.loading$,\n      department: this.service.department$,\n      identityList: this.service.identityList$,\n      workStatusList: this.service.workStatusList$,\n      auth: this.service.auth$\n    };\n  },\n  data: function data() {\n    return {\n      visible: false,\n      value: '',\n      enums: {},\n      modaldata: {}\n    };\n  },\n  computed: {\n    columns: columns\n  },\n  methods: {\n    getShopName: function getShopName(record) {\n      console.log('get shop name', record);\n\n      if (record.is_super_admin) {\n        return '全部';\n      }\n\n      return record.shop.filter(Boolean).map(function (item) {\n        return item.name;\n      }).join(',');\n    },\n    changeStaffPosition: function changeStaffPosition(id) {\n      var _this = this;\n\n      this.userService.getEnums().subscribe(function (res) {\n        _this.enums = res.staff;\n        _this.visible = true;\n        _this.modaldata = {\n          nature_work: 1,\n          identity: [1, 2]\n        };\n      });\n    },\n    selectDepartment: function selectDepartment(e) {\n      console.log(e);\n      this.value = e + '';\n    },\n    joinok: function joinok() {\n      this.onSearchReset();\n    },\n    onJoinDepartment: function onJoinDepartment(e) {\n      console.log('批量加入部门');\n      this.$modalRouter.push({\n        name: 'shop-staff-batch-import',\n        props: {\n          ids: this.selectedRowKeys\n        },\n        on: {\n          change: this.joinok\n        }\n      });\n    },\n    onAddStaff: function onAddStaff() {\n      this.$router.push({\n        name: 'shop-staff-add'\n      });\n    },\n    onExportStaff: function onExportStaff() {\n      console.log('导入员工');\n    },\n    // 详情\n    onSearchDetail: function onSearchDetail(e) {\n      var identity = e.identity.map(function (ele) {\n        return ele.id;\n      });\n      this.$router.push({\n        name: 'shop-staff-info-basic',\n        query: {\n          id: e.id\n        }\n      });\n    },\n    onEdit: function onEdit(e) {\n      this.$router.push({\n        name: 'shop-staff-edit',\n        query: {\n          id: e.id\n        }\n      });\n    },\n    onChooseDepartment: function onChooseDepartment(e) {\n      console.log('选择部门', e);\n      this.$router.push({\n        query: {\n          shop_id: e\n        }\n      });\n    },\n    onChooseStaffFn: function onChooseStaffFn(e) {\n      console.log('选择员工职能', e);\n    },\n    onChooseStaffStatus: function onChooseStaffStatus(e) {\n      console.log('选择在职状态', e);\n      this.$router.push({\n        query: {\n          work_status: e\n        }\n      });\n    },\n    onSearch: function onSearch(e) {\n      console.log('搜索员工', e);\n    },\n    // 清空指纹信息\n    onClearFingerprintInfo: function onClearFingerprintInfo(record) {\n      var _this2 = this;\n\n      this.$confirm({\n        title: '提示信息',\n        content: '确认清空指纹信息？',\n        onOk: function onOk() {\n          _this2.service.deleteStaffFinger(record.id).subscribe();\n        }\n      });\n    },\n    // 清空硬件密码\n    onClearHardwarePassword: function onClearHardwarePassword(record) {\n      var _this3 = this;\n\n      this.$confirm({\n        title: '提示信息',\n        content: '确认清空硬件密码吗？',\n        onOk: function onOk() {\n          _this3.service.deleteStaffCabinetPassword(record.id).subscribe();\n        }\n      });\n    }\n  }\n};",{"version":3,"sources":["list.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <st-panel class=\"page-shop-staff-list\" app>\n    <a-row type=\"flex\" justify=\"space-between\">\n      <a-col :span=\"10\">\n        <div class=\"page-shop-staff-list__selectRow\">\n          <st-button\n            v-if=\"auth.add\"\n            type=\"primary\"\n            class=\"mg-r8\"\n            icon=\"add\"\n            @click=\"onAddStaff\"\n          >\n            新增员工\n          </st-button>\n          <st-button\n            v-if=\"auth.export\"\n            type=\"primary\"\n            class=\"mg-r8\"\n            v-export-excel=\"{\n              type: 'staff',\n              query: { conditions: $searchQuery }\n            }\"\n          >\n            全部导出\n          </st-button>\n          <!-- NOTE: 导入 -->\n          <!-- <st-button v-if=\"auth.import\" class=\"mg-r8\" @click=\"onExportStaff\">导入员工</st-button> -->\n          <st-button\n            :disabled=\"!selectedRowKeys.length\"\n            @click=\"onJoinDepartment\"\n            v-if=\"auth.join\"\n            icon=\"add\"\n          >\n            批量加入部门\n          </st-button>\n        </div>\n      </a-col>\n      <a-col :span=\"14\">\n        <div class=\"filter-staff \">\n          <a-select\n            placeholder=\"全部角色\"\n            :dropdownMatchSelectWidth=\"false\"\n            v-model=\"$searchQuery.role_id\"\n            @change=\"onSingleSearch('role_id', $event)\"\n            class=\"mg-r8\"\n          >\n            <a-select-option\n              v-for=\"role in roleOptions\"\n              :value=\"role.id\"\n              :key=\"role.id\"\n            >\n              {{ role.name }}\n            </a-select-option>\n          </a-select>\n          <a-tree-select\n            showSearch\n            class=\"mg-r8\"\n            :dropdownMatchSelectWidth=\"false\"\n            v-model=\"$searchQuery.department_id\"\n            :dropdownStyle=\"{ maxHeight: '400px', overflow: 'auto' }\"\n            placeholder=\"请选择部门\"\n            treeDefaultExpandAll\n            @change=\"onSingleSearch('department_id', $event)\"\n          >\n            <a-tree-select-node\n              v-for=\"item in department\"\n              :value=\"item.id\"\n              :title=\"item.name\"\n              :key=\"item.id\"\n            >\n              <a-tree-select-node\n                v-for=\"item1 in item.children\"\n                :value=\"item1.id\"\n                :title=\"item1.name\"\n                :key=\"item1.id\"\n              >\n                <a-tree-select-node\n                  v-for=\"item2 in item1.children\"\n                  :value=\"item2.id\"\n                  :title=\"item2.name\"\n                  :key=\"item2.id\"\n                >\n                  <a-tree-select-node\n                    v-for=\"item3 in item2.children\"\n                    :value=\"item3.id\"\n                    :title=\"item3.name\"\n                    :key=\"item3.id\"\n                  >\n                    <a-tree-select-node\n                      v-for=\"item4 in item3.children\"\n                      :value=\"item4.id\"\n                      :title=\"item4.name\"\n                      :key=\"item4.id\"\n                    />\n                  </a-tree-select-node>\n                </a-tree-select-node>\n              </a-tree-select-node>\n            </a-tree-select-node>\n          </a-tree-select>\n          <a-select\n            class=\"mg-r8\"\n            placeholder=\"请选择员工职能\"\n            v-model=\"$searchQuery.identity\"\n            @change=\"onSingleSearch('identity', $event)\"\n            :options=\"identityList\"\n          ></a-select>\n          <a-select\n            class=\"mg-r8\"\n            placeholder=\"请选择在职状态\"\n            v-model=\"$searchQuery.work_status\"\n            @change=\"onSingleSearch('work_status', $event)\"\n            :options=\"workStatusList\"\n          ></a-select>\n          <st-input-search\n            placeholder=\"搜索员工\"\n            v-model=\"$searchQuery.keyword\"\n            @search=\"onKeywordsSearch('keyword', $event)\"\n          />\n        </div>\n      </a-col>\n    </a-row>\n    <a-row class=\"mg-t16\">\n      <st-table\n        :rowSelection=\"{\n          selectedRowKeys: selectedRowKeys,\n          onChange: onSelectionChange\n        }\"\n        :loading=\"loading.getStaffList\"\n        :columns=\"columns\"\n        :dataSource=\"staffList\"\n        class=\"page-shop-staff-table\"\n        rowKey=\"id\"\n        :page=\"page\"\n        @change=\"onTableChange\"\n      >\n        <template slot=\"staff_name\" slot-scope=\"text, record\">\n          {{ text }}\n          <img\n            v-if=\"record.is_super_admin === 1\"\n            class=\"page-shop-staff-list__staff-role\"\n            src=\"~@/assets/img/icon_superadmin.png\"\n            alt=\"超级管理员\"\n          />\n        </template>\n        <st-overflow-text\n          title=\"所在门店\"\n          max-width=\"150px\"\n          slot=\"shop\"\n          slot-scope=\"text, record\"\n          :value=\"getShopName(record)\"\n        />\n        <template slot=\"identity\" slot-scope=\"text, record\">\n          <template v-for=\"item in record.identity\">\n            <span :key=\"item.id\" class=\"mg-r8\">{{ item.name }}</span>\n          </template>\n        </template>\n        <template slot=\"sex\" slot-scope=\"text\">\n          <span>{{ text.name }}</span>\n        </template>\n        <template slot=\"work_status\" slot-scope=\"text\">\n          <st-text\n            :status=\"{\n              success: text.id === 1,\n              error: text.id === 2\n            }\"\n          >\n            {{ text.name }}\n          </st-text>\n        </template>\n        <template slot=\"action\" slot-scope=\"text, record\">\n          <st-table-actions>\n            <a\n              href=\"javascript: void(0)\"\n              v-if=\"record.auth['shop:staff:staff|get']\"\n              @click=\"onSearchDetail(record)\"\n            >\n              详情\n            </a>\n            <template v-if=\"record.work_status.name === '在职'\">\n              <a\n                href=\"javascript: void(0)\"\n                v-if=\"record.auth['shop:staff:staff|edit']\"\n                @click=\"onEdit(record)\"\n              >\n                编辑\n              </a>\n              <a\n                href=\"javascript: void(0)\"\n                v-if=\"record.auth['shop:staff:staff|bind_card']\"\n                v-modal-link=\"{\n                  name: 'shop-staff-bind-card',\n                  props: { staff: record }\n                }\"\n              >\n                绑定实体卡\n              </a>\n              <a\n                href=\"javascript: void(0)\"\n                v-if=\"record.auth['shop:staff:staff|rebind_card']\"\n                v-modal-link=\"{\n                  name: 'shop-staff-bind-card',\n                  props: { staff: record }\n                }\"\n              >\n                重绑实体卡\n              </a>\n              <a\n                href=\"javascript: void(0)\"\n                v-if=\"record.auth['shop:staff:account|save']\"\n                v-modal-link=\"{\n                  name: 'shop-staff-re-password',\n                  props: { staff: record }\n                }\"\n              >\n                管理登录账号\n              </a>\n              <a\n                href=\"javascript: void(0)\"\n                v-if=\"record.auth['shop:staff:staff|position']\"\n                v-modal-link=\"{\n                  name: 'shop-staff-update-staff-position',\n                  props: { staff: record }\n                }\"\n              >\n                职位和薪资变更\n              </a>\n              <a\n                href=\"javascript: void(0)\"\n                v-if=\"record.auth['shop:staff:staff|salary']\"\n                v-modal-link=\"{\n                  name: 'shop-staff-salary-account-setting',\n                  props: { staff: record }\n                }\"\n              >\n                设置提现账户\n              </a>\n              <a\n                href=\"javascript: void(0)\"\n                v-if=\"record.auth['shop:staff:staff|shop_leave']\"\n                v-modal-link=\"{\n                  name: 'shop-staff-leave-current-shop',\n                  props: { staff: record }\n                }\"\n              >\n                解除门店关系\n              </a>\n              <a\n                href=\"javascript: void(0)\"\n                v-if=\"record.auth['shop:staff:staff|finger_del']\"\n                @click=\"onClearFingerprintInfo(record)\"\n              >\n                清空指纹信息\n              </a>\n              <a\n                href=\"javascript: void(0)\"\n                v-if=\"record.auth['shop:staff:staff|cabinet_pwd_del']\"\n                @click=\"onClearHardwarePassword(record)\"\n              >\n                清空硬件密码\n              </a>\n            </template>\n          </st-table-actions>\n        </template>\n      </st-table>\n    </a-row>\n    <change-staff-postion :show=\"visible\" :enums=\"enums\" :data=\"modaldata\" />\n  </st-panel>\n</template>\n\n<script>\nimport { UserService } from '@/services/user.service'\nimport { ListService } from './list.service'\nimport ChangeStaffPostion from './list#/change-staff-postion'\nimport { columns } from './list.config'\nimport tableMixin from '@/mixins/table.mixin'\nimport ShopStaffBatchImport from '@/views/biz-modals/shop-staff/batch-import'\nimport ShopStaffBindCard from '@/views/biz-modals/shop-staff/bind-card'\nimport ShopStaffLeaveCurrentShop from '@/views/biz-modals/shop-staff/leave-current-shop'\nimport ShopStaffRePassword from '@/views/biz-modals/shop-staff/re-password'\nimport ShopStaffSalaryAccountSetting from '@/views/biz-modals/shop-staff/salary-account-setting'\nimport ShopStaffUpdateStaffPosition from '@/views/biz-modals/shop-staff/update-staff-position'\nimport StaffUpdateStaffPosition from '@/views/biz-modals/staff/update-staff-position'\nexport default {\n  mixins: [tableMixin],\n  modals: {\n    ShopStaffBatchImport,\n    ShopStaffBindCard,\n    ShopStaffLeaveCurrentShop,\n    ShopStaffRePassword,\n    ShopStaffSalaryAccountSetting,\n    ShopStaffUpdateStaffPosition,\n    StaffUpdateStaffPosition\n  },\n  components: {\n    ChangeStaffPostion\n  },\n  serviceInject() {\n    return {\n      userService: UserService,\n      service: ListService\n    }\n  },\n  rxState() {\n    return {\n      staffList: this.service.staffList$,\n      page: this.service.page$,\n      roleOptions: this.service.roleOptions$,\n      loading: this.service.loading$,\n      department: this.service.department$,\n      identityList: this.service.identityList$,\n      workStatusList: this.service.workStatusList$,\n      auth: this.service.auth$\n    }\n  },\n  data() {\n    return {\n      visible: false,\n      value: '',\n      enums: {},\n      modaldata: {}\n    }\n  },\n  computed: {\n    columns\n  },\n  methods: {\n    getShopName(record) {\n      console.log('get shop name', record)\n      if (record.is_super_admin) {\n        return '全部'\n      }\n      return record.shop\n        .filter(Boolean)\n        .map(item => item.name)\n        .join(',')\n    },\n    changeStaffPosition(id) {\n      this.userService.getEnums().subscribe(res => {\n        this.enums = res.staff\n        this.visible = true\n        this.modaldata = {\n          nature_work: 1,\n          identity: [1, 2]\n        }\n      })\n    },\n    selectDepartment(e) {\n      console.log(e)\n      this.value = e + ''\n    },\n    joinok() {\n      this.onSearchReset()\n    },\n    onJoinDepartment(e) {\n      console.log('批量加入部门')\n      this.$modalRouter.push({\n        name: 'shop-staff-batch-import',\n        props: {\n          ids: this.selectedRowKeys\n        },\n        on: {\n          change: this.joinok\n        }\n      })\n    },\n    onAddStaff() {\n      this.$router.push({\n        name: 'shop-staff-add'\n      })\n    },\n    onExportStaff() {\n      console.log('导入员工')\n    },\n    // 详情\n    onSearchDetail(e) {\n      let identity = e.identity.map(ele => {\n        return ele.id\n      })\n      this.$router.push({\n        name: 'shop-staff-info-basic',\n        query: {\n          id: e.id\n        }\n      })\n    },\n    onEdit(e) {\n      this.$router.push({\n        name: 'shop-staff-edit',\n        query: {\n          id: e.id\n        }\n      })\n    },\n    onChooseDepartment(e) {\n      console.log('选择部门', e)\n      this.$router.push({\n        query: {\n          shop_id: e\n        }\n      })\n    },\n    onChooseStaffFn(e) {\n      console.log('选择员工职能', e)\n    },\n    onChooseStaffStatus(e) {\n      console.log('选择在职状态', e)\n      this.$router.push({\n        query: {\n          work_status: e\n        }\n      })\n    },\n    onSearch(e) {\n      console.log('搜索员工', e)\n    },\n    // 清空指纹信息\n    onClearFingerprintInfo(record) {\n      this.$confirm({\n        title: '提示信息',\n        content: '确认清空指纹信息？',\n        onOk: () => {\n          this.service.deleteStaffFinger(record.id).subscribe()\n        }\n      })\n    },\n    // 清空硬件密码\n    onClearHardwarePassword(record) {\n      this.$confirm({\n        title: '提示信息',\n        content: '确认清空硬件密码吗？',\n        onOk: () => {\n          this.service.deleteStaffCabinetPassword(record.id).subscribe()\n        }\n      })\n    }\n  }\n}\n</script>\n"],"sourceRoot":"src/views/pages/shop/staff"}]}