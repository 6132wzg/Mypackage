{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/thread-loader/dist/cjs.js!/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js!/Users/wangzhigang/Desktop/styd/web/node_modules/ts-loader/index.js??ref--13-3!/Users/wangzhigang/Desktop/styd/web/src/services/import.service.ts","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/services/import.service.ts","mtime":1591147717086},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/thread-loader/dist/cjs.js","mtime":1591062572352},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/ts-loader/index.js","mtime":1591062571609}],"contextDependencies":[],"result":["import \"core-js/modules/es6.string.iterator\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es7.array.includes\";\nimport \"core-js/modules/es6.string.includes\";\nimport _classCallCheck from \"/Users/wangzhigang/Desktop/styd/web/node_modules/@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/wangzhigang/Desktop/styd/web/node_modules/@babel/runtime-corejs2/helpers/esm/createClass\";\n\nvar _a;\n\nimport { __decorate, __metadata } from \"tslib\";\nimport { AppConfig } from '@/constants/config';\nimport { Injectable } from 'vue-service-app';\n/**\n * 资源按需加载服务\n * webpack 不支持加载 浏览器协议资源\n */\n\nvar ImportService = /*#__PURE__*/function () {\n  function ImportService(appConfig) {\n    _classCallCheck(this, ImportService);\n\n    this.appConfig = appConfig;\n  }\n\n  _createClass(ImportService, [{\n    key: \"isJs\",\n    value: function isJs(src) {\n      return src.indexOf('.js') > -1;\n    }\n  }, {\n    key: \"isCss\",\n    value: function isCss(src) {\n      return src.indexOf('.css') > -1;\n    }\n  }, {\n    key: \"loadJs\",\n    value: function loadJs(src) {\n      var s = document.createElement('script');\n      var url = src.includes('http') ? src : this.appConfig.BASE_URL + src;\n\n      if (document.querySelector(\"script[src='\".concat(url, \"']\"))) {\n        return Promise.resolve();\n      }\n\n      return new Promise(function (resolve, reject) {\n        s.src = url;\n        document.head.appendChild(s);\n\n        s.onload = function () {\n          resolve();\n        };\n\n        s.onerror = function (err) {\n          reject(err);\n        };\n      });\n    }\n  }, {\n    key: \"loadCss\",\n    value: function loadCss(href) {\n      var link = document.createElement('link');\n      link.rel = 'stylesheet';\n      var url = href.includes('http:') ? href : this.appConfig.BASE_URL + href;\n\n      if (document.querySelector(\"link[href='\".concat(href, \"']\"))) {\n        return Promise.resolve();\n      }\n\n      return new Promise(function (resolve, reject) {\n        link.href = url;\n        document.head.appendChild(link);\n\n        link.onload = function () {\n          resolve();\n        };\n\n        link.onerror = function (err) {\n          reject(err);\n        };\n      });\n    }\n  }, {\n    key: \"load\",\n    value: function load() {\n      var _this = this;\n\n      var srcs = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n      var tasks = [];\n      srcs.forEach(function (src) {\n        if (_this.isJs(src)) {\n          tasks.push(_this.loadJs(src));\n        }\n\n        if (_this.isCss(src)) {\n          tasks.push(_this.loadCss(src));\n        }\n      });\n      return Promise.all(tasks);\n    }\n  }]);\n\n  return ImportService;\n}();\n\nImportService = __decorate([Injectable(), __metadata(\"design:paramtypes\", [typeof (_a = typeof AppConfig !== \"undefined\" && AppConfig) === \"function\" ? _a : Object])], ImportService);\nexport { ImportService };",null]}