{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js!/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhigang/Desktop/styd/web/src/views/pages/brand/finance/salary/list.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/pages/brand/finance/salary/list.vue","mtime":1600926556114},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js","mtime":1591062572376}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { ListService } from \"./list.service\";\nimport { columns } from \"./list.config.ts\";\nimport tableMixin from '@/mixins/table.mixin';\nimport { UserService } from '@/services/user.service';\nimport BrandFinanceClassCommission from '@/views/biz-modals/brand/finance/class-commission';\nimport BrandFinanceSaleCommission from '@/views/biz-modals/brand/finance/sale-commission';\nimport BrandFinanceStaffShop from '@/views/biz-modals/brand/finance/staff-shop';\nimport moment from 'moment';\nimport { cloneDeep } from 'lodash-es';\nexport default {\n  name: 'BrandFinanceSalary',\n  mixins: [tableMixin],\n  data: function data() {\n    return {\n      monthRange: [],\n      start_month: null,\n      end_month: null\n    };\n  },\n  bem: {\n    b: 'page-brand-finance-salary',\n    bDate: 'st-recent-radio-group'\n  },\n  modals: {\n    BrandFinanceClassCommission: BrandFinanceClassCommission,\n    BrandFinanceSaleCommission: BrandFinanceSaleCommission,\n    BrandFinanceStaffShop: BrandFinanceStaffShop\n  },\n  serviceInject: function serviceInject() {\n    return {\n      listService: ListService,\n      userService: UserService\n    };\n  },\n  rxState: function rxState() {\n    return {\n      list: this.listService.list$,\n      page: this.listService.page$,\n      loading: this.listService.loading$,\n      info: this.listService.info$,\n      department: this.listService.department$,\n      shopList: this.userService.shopList$,\n      auth: this.listService.auth$\n    };\n  },\n  computed: {\n    columns: columns\n  },\n  mounted: function mounted() {\n    this.setQueryParams();\n  },\n  watch: {\n    $searchQuery: function $searchQuery() {\n      this.setQueryParams();\n    }\n  },\n  methods: {\n    setQueryParams: function setQueryParams() {\n      this.start_month = null;\n      this.end_month = null;\n\n      if (this.$searchQuery.start_month && this.$searchQuery.end_month) {\n        this.start_month = moment(this.$searchQuery.start_month);\n        this.end_month = moment(this.$searchQuery.end_month);\n      }\n    },\n    change: function change() {\n      if (this.start_month && this.end_month) {\n        this.$searchQuery.start_month = this.start_month.format('YYYY-MM');\n        this.$searchQuery.end_month = this.end_month.format('YYYY-MM');\n        this.onSearch();\n      }\n\n      if (!this.start_month && !this.end_month) {\n        this.$searchQuery.start_month = '';\n        this.$searchQuery.end_month = '';\n        this.onSearch();\n      }\n    },\n    disabledStartDate: function disabledStartDate(current) {\n      if (this.end_month) {\n        var startMonth = cloneDeep(current).startOf('month');\n        var endMonth = cloneDeep(this.end_month).startOf('month');\n        return startMonth > cloneDeep(this.end_month).startOf('month') || startMonth <= endMonth.subtract(12, 'M');\n      }\n\n      return false;\n    },\n    disabledEndDate: function disabledEndDate(current) {\n      if (this.start_month) {\n        var startMonth = cloneDeep(this.start_month).startOf('month');\n        var endMonth = cloneDeep(current).startOf('month');\n        return endMonth < cloneDeep(this.start_month).startOf('month') || endMonth >= startMonth.add(1, 'y');\n      }\n\n      return false;\n    }\n  }\n};",{"version":3,"sources":["list.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <st-panel-layout :class=\"b()\">\n    <st-panel app>\n      <div :class=\"b('action')\">\n        <a-select\n          placeholder=\"请选择部门\"\n          v-model=\"$searchQuery.department_id\"\n          :class=\"b('select')\"\n          @change=\"onSingleSearch('department_id', $event)\"\n        >\n          <a-select-option :value=\"-1\">\n            全部部门\n          </a-select-option>\n          <a-select-option\n            v-for=\"(item, index) of department\"\n            :key=\"index\"\n            :value=\"item.id\"\n          >\n            {{ item.name }}\n          </a-select-option>\n        </a-select>\n        <a-select\n          placeholder=\"请选择门店\"\n          v-model=\"$searchQuery.shop_id\"\n          @change=\"onSingleSearch('shop_id', $event)\"\n          :class=\"b('select')\"\n        >\n          <a-select-option :value=\"-1\">\n            全部门店\n          </a-select-option>\n          <a-select-option\n            v-for=\"(item, index) of shopList\"\n            :key=\"index\"\n            :value=\"item.shop_id\"\n          >\n            {{ item.shop_name }}\n          </a-select-option>\n        </a-select>\n        <!-- <a-range-picker\n          :class=\"[bDate('range'), b('range')]\"\n          :placeholder=\"['开始月份', '结束月份']\"\n          format=\"YYYY-MM\"\n          :mode=\"['month', 'month']\"\n          @change=\"change\"\n          @panelChange=\"panelChange\"\n          v-model=\"monthRange\"\n        /> -->\n        <a-month-picker\n          @change=\"change\"\n          v-model=\"start_month\"\n          placeholder=\"开始月份\"\n          :class=\"b('range')\"\n          :disabledDate=\"disabledStartDate\"\n        />\n        ~\n        <a-month-picker\n          @change=\"change\"\n          v-model=\"end_month\"\n          placeholder=\"结束月份\"\n          :class=\"b('range')\"\n          :disabledDate=\"disabledEndDate\"\n        />\n\n        <st-input-search\n          :class=\"b('search')\"\n          style=\"width: 255px\"\n          v-model=\"$searchQuery.search\"\n          @search=\"onKeywordsSearch('search', $event)\"\n          placeholder=\"搜索员工姓名、手机号及工号\"\n        ></st-input-search>\n      </div>\n\n      <st-table\n        :page=\"page\"\n        @change=\"onTableChange\"\n        :loading=\"loading.getList\"\n        :columns=\"columns\"\n        :dataSource=\"list\"\n        rowKey=\"id\"\n      >\n        <span class=\"word-break\" slot=\"staff_num\" slot-scope=\"text\">\n          {{ text }}\n        </span>\n        <template slot=\"shop\" slot-scope=\"text, record\">\n          <a\n            v-if=\"text.count > 1\"\n            v-modal-link=\"{\n              name: 'brand-finance-staff-shop',\n              props: {\n                id: record.id\n              }\n            }\"\n          >\n            共{{ text.count }}家门店\n          </a>\n          <span v-else>\n            {{ text.name }}\n          </span>\n        </template>\n        <template slot=\"sales_commission\" slot-scope=\"text, record\">\n          <a\n            v-modal-link=\"{\n              name: 'brand-finance-sale-commission',\n              props: {\n                id: record.id\n              }\n            }\"\n          >\n            {{ text }}\n          </a>\n        </template>\n        <template slot=\"course_commission\" slot-scope=\"text, record\">\n          <a\n            v-modal-link=\"{\n              name: 'brand-finance-class-commission',\n              props: {\n                id: record.id\n              }\n            }\"\n          >\n            {{ text }}\n          </a>\n        </template>\n      </st-table>\n    </st-panel>\n  </st-panel-layout>\n</template>\n<script>\nimport { ListService } from './list.service'\nimport { columns } from './list.config.ts'\nimport tableMixin from '@/mixins/table.mixin'\nimport { UserService } from '@/services/user.service'\nimport BrandFinanceClassCommission from '@/views/biz-modals/brand/finance/class-commission'\nimport BrandFinanceSaleCommission from '@/views/biz-modals/brand/finance/sale-commission'\nimport BrandFinanceStaffShop from '@/views/biz-modals/brand/finance/staff-shop'\nimport moment from 'moment'\nimport { cloneDeep } from 'lodash-es'\nexport default {\n  name: 'BrandFinanceSalary',\n  mixins: [tableMixin],\n  data() {\n    return {\n      monthRange: [],\n      start_month: null,\n      end_month: null\n    }\n  },\n  bem: {\n    b: 'page-brand-finance-salary',\n    bDate: 'st-recent-radio-group'\n  },\n  modals: {\n    BrandFinanceClassCommission,\n    BrandFinanceSaleCommission,\n    BrandFinanceStaffShop\n  },\n  serviceInject() {\n    return {\n      listService: ListService,\n      userService: UserService\n    }\n  },\n  rxState() {\n    return {\n      list: this.listService.list$,\n      page: this.listService.page$,\n      loading: this.listService.loading$,\n      info: this.listService.info$,\n      department: this.listService.department$,\n      shopList: this.userService.shopList$,\n      auth: this.listService.auth$\n    }\n  },\n  computed: {\n    columns\n  },\n  mounted() {\n    this.setQueryParams()\n  },\n  watch: {\n    $searchQuery() {\n      this.setQueryParams()\n    }\n  },\n  methods: {\n    setQueryParams() {\n      this.start_month = null\n      this.end_month = null\n      if (this.$searchQuery.start_month && this.$searchQuery.end_month) {\n        this.start_month = moment(this.$searchQuery.start_month)\n        this.end_month = moment(this.$searchQuery.end_month)\n      }\n    },\n    change() {\n      if (this.start_month && this.end_month) {\n        this.$searchQuery.start_month = this.start_month.format('YYYY-MM')\n        this.$searchQuery.end_month = this.end_month.format('YYYY-MM')\n        this.onSearch()\n      }\n      if (!this.start_month && !this.end_month) {\n        this.$searchQuery.start_month = ''\n        this.$searchQuery.end_month = ''\n        this.onSearch()\n      }\n    },\n    disabledStartDate(current) {\n      if (this.end_month) {\n        const startMonth = cloneDeep(current).startOf('month')\n        const endMonth = cloneDeep(this.end_month).startOf('month')\n        return (\n          startMonth > cloneDeep(this.end_month).startOf('month') ||\n          startMonth <= endMonth.subtract(12, 'M')\n        )\n      }\n      return false\n    },\n    disabledEndDate(current) {\n      if (this.start_month) {\n        const startMonth = cloneDeep(this.start_month).startOf('month')\n        const endMonth = cloneDeep(current).startOf('month')\n        return (\n          endMonth < cloneDeep(this.start_month).startOf('month') ||\n          endMonth >= startMonth.add(1, 'y')\n        )\n      }\n      return false\n    }\n  }\n}\n</script>\n"],"sourceRoot":"src/views/pages/brand/finance/salary"}]}