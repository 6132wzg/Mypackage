{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"tier-2~brand-staff~shop-staff\"],{\"20d6\":function(e,t,a){\"use strict\";var i=a(\"5ca1\"),n=a(\"0a49\")(6),r=\"findIndex\",s=!0;r in[]&&Array(1)[r]((function(){s=!1})),i(i.P+i.F*s,\"Array\",{findIndex:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}}),a(\"9c6c\")(r)},3949:function(e,t,a){\"use strict\";var i;a.d(t,\"a\",(function(){return i})),function(e){e[e[\"MALE\"]=2]=\"MALE\",e[e[\"FEMALE\"]=1]=\"FEMALE\"}(i||(i={}))},\"462b\":function(e,t,a){\"use strict\";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"a-select\",{attrs:{mode:e.mode,allowClear:\"\",placeholder:e.placeholder||\"全部\",value:e.value},on:{change:e.onChange}},e._l(e.coachLevelOptions,(function(t){return a(\"a-select-option\",{key:t.id,attrs:{value:t.id}},[e._v(\"\\n    \"+e._s(t.name)+\"\\n  \")])})),1)},n=[],r=a(\"75fc\"),s=(a(\"c5f6\"),a(\"2f8f\")),o={model:{prop:\"value\",event:\"change\"},name:\"CoachLevelSelect\",data:function(){return{coachLevelOptions:[]}},serviceInject:function(){return{coachLevelApi:s[\"b\"]}},props:{mode:{type:String},placeholder:{type:String},useType:{type:String},value:{type:[Number,String,Array]}},methods:{onChange:function(e){this.$emit(\"change\",e)},getShopList:function(){var e=this;this.coachLevelApi.getCoachLevelListAll().subscribe((function(t){var a=\"form\"===e.useType?{}:{id:-1,name:\" 全部\"};e.coachLevelOptions=[a].concat(Object(r[\"a\"])(t.list))}))}},created:function(){this.getShopList()}},c=o,l=a(\"2877\"),f=Object(l[\"a\"])(c,i,n,!1,null,null,null);t[\"a\"]=f.exports},\"58c8\":function(e,t,a){\"use strict\";var i,n,r,s,o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"st-modal\",{attrs:{title:\"更改员工职位\",size:\"small\"},on:{ok:e.onSubmit},model:{value:e.show,callback:function(t){e.show=t},expression:\"show\"}},[a(\"staff-info\",{attrs:{staff:e.staff}}),a(\"st-form\",{attrs:{labelWidth:\"70px\",form:e.form}},[a(\"st-form-item\",{attrs:{label:\"工作性质\"}},[a(\"a-select\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:e.decorators.nature_work,expression:\"decorators.nature_work\"}],attrs:{placeholder:\"请选择工作性质\"}},e._l(e.natureWork,(function(t){return a(\"a-select-option\",{key:t.value,attrs:{value:t.value}},[e._v(\"\\n          \"+e._s(t.label)+\"\\n        \")])})),1)],1),a(\"st-form-item\",{attrs:{label:\"员工职能\",required:\"\"}},[a(\"a-select\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:e.decorators.identity,expression:\"decorators.identity\"}],attrs:{mode:\"multiple\",placeholder:\"请选择员工职能\"},on:{change:e.onChangeIdentity,deselect:e.onDeselectIndentity}},e._l(e.identityList,(function(t){return a(\"a-select-option\",{key:t.value,attrs:{value:t.value}},[e._v(\"\\n          \"+e._s(t.label)+\"\\n        \")])})),1),e.canDeleteIdentity?e._e():a(\"staff-modal-tips\",{attrs:{list:e.tips,canNotDelete:!e.operate}})],1),a(\"st-form-item\",{directives:[{name:\"show\",rawName:\"v-show\",value:!e.canDeleteIdentity||e.coach_level_required,expression:\"!canDeleteIdentity || coach_level_required\"}],attrs:{label:e.$c(\"coach\")+\"等级\",required:!e.canDeleteIdentity||e.coach_level_required}},[a(\"a-select\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:e.decorators.coach_level_id,expression:\"decorators.coach_level_id\"}],attrs:{placeholder:\"请选择\"+e.$c(\"coach\")+\"等级\"}},e._l(e.coachLevelList,(function(t){return a(\"a-select-option\",{key:t.id,attrs:{value:+t.id}},[e._v(\"\\n          \"+e._s(t.name)+\"\\n        \")])})),1)],1),a(\"st-form-item\",{attrs:{label:\"薪资模板\"}},[a(\"a-select\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:e.decorators.basic_salary,expression:\"decorators.basic_salary\"}],attrs:{placeholder:\"请选择底薪模版\",allowClear:\"\"}},e._l(e.salaryBasic,(function(t){return a(\"a-select-option\",{key:t.id,attrs:{value:+t.id,disabled:!t.id}},[e._v(\"\\n          \"+e._s(t.name)+\"\\n        \")])})),1)],1),a(\"st-form-item\",{attrs:{\"label-fix\":\"\"}},[a(\"a-select\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:e.decorators.sale_percentage,expression:\"decorators.sale_percentage\"}],attrs:{placeholder:\"请选择薪资模板\",allowClear:\"\"}},e._l(e.salarySale,(function(t){return a(\"a-select-option\",{key:t.id,attrs:{value:+t.id,disabled:!t.id}},[e._v(\"\\n          \"+e._s(t.name)+\"\\n        \")])})),1)],1),a(\"st-form-item\",{attrs:{\"label-fix\":\"\"}},[a(\"a-select\",{directives:[{name:\"decorator\",rawName:\"v-decorator\",value:e.decorators.course_percentage,expression:\"decorators.course_percentage\"},{name:\"show\",rawName:\"v-show\",value:e.isSalaryCourse,expression:\"isSalaryCourse\"}],attrs:{placeholder:\"请选择课程模板\",allowClear:\"\"}},e._l(e.salaryCourse,(function(t){return a(\"a-select-option\",{key:t.id,attrs:{value:+t.id,disabled:!t.id}},[e._v(\"\\n          \"+e._s(t.name)+\"\\n        \")])})),1)],1)],1)],1)},c=[],l=(a(\"8e6e\"),a(\"ac6a\"),a(\"456d\"),a(\"bd86\")),f=a(\"75fc\"),u=(a(\"6762\"),a(\"2fdb\"),a(\"c5f6\"),a(\"d225\")),d=a(\"b0b4\"),p=a(\"9ab4\"),h=a(\"e69b\"),v=a(\"2138\"),y=a(\"2f8f\"),m=a(\"0cd5\"),b=a(\"df29\"),S=a(\"c4cc\"),g=a(\"dcb5\"),_=a(\"54da\"),j=function(){function e(t,a,i,n){Object(u[\"a\"])(this,e),this.staffApi=t,this.coachLevel=a,this.userService=i,this.msg=n,this.positionInfo$=new b[\"d\"]({}),this.coachLevelList$=new b[\"d\"]({}),this.salaryBasic$=new b[\"d\"]({}),this.salarySale$=new b[\"d\"]({}),this.salaryCourse$=new b[\"d\"]({}),this.identityList$=this.userService.getOptions$(\"staff.identity\"),this.natureWork$=this.userService.getOptions$(\"staff.nature_work\")}return Object(d[\"a\"])(e,[{key:\"getCoachLevel\",value:function(){var e=this;return this.coachLevel.getCoachLevelListAll().pipe(Object(S[\"a\"])((function(t){e.coachLevelList$.commit((function(){return t.list}))})))}},{key:\"getStaffSalaryBasic\",value:function(){var e=this;return this.staffApi.getStaffSalaryBasic().pipe(Object(S[\"a\"])((function(t){e.salaryBasic$.commit((function(){return[{id:0,name:\"请选择\"}].concat(Object(f[\"a\"])(t.basic_templates))}))})))}},{key:\"getStaffSalarySale\",value:function(){var e=this;return this.staffApi.getStaffSalarySale().pipe(Object(S[\"a\"])((function(t){e.salarySale$.commit((function(){return[{id:0,name:\"请选择\"}].concat(Object(f[\"a\"])(t.sale_templates))}))})))}},{key:\"getStaffSalaryCourse\",value:function(){var e=this;return this.staffApi.getStaffSalaryCourse().pipe(Object(S[\"a\"])((function(t){e.salaryCourse$.commit((function(){return[{id:0,name:\"请选择\"}].concat(Object(f[\"a\"])(t.course_templates))}))})))}},{key:\"getStaffBrandPosition\",value:function(e){var t=this;return this.staffApi.getStaffBrandPosition({id:e}).pipe(Object(S[\"a\"])((function(e){t.positionInfo$.commit((function(){return e.position}))})))}},{key:\"init\",value:function(e){return Object(_[\"a\"])(this.getStaffBrandPosition(e),this.getCoachLevel(),this.getStaffSalaryCourse(),this.getStaffSalaryBasic(),this.getStaffSalarySale())}},{key:\"putStaffBindPosition\",value:function(e){var t=this;return this.staffApi.putStaffBindPosition(e).pipe(Object(S[\"a\"])((function(e){t.msg.success({content:\"提交成功\"})})))}},{key:\"validatStaffPosition\",value:function(e,t){return this.staffApi.validatStaffPosition(e,t)}}]),e}();Object(p[\"b\"])([Object(b[\"c\"])(),Object(p[\"d\"])(\"design:type\",Function),Object(p[\"d\"])(\"design:paramtypes\",[Number,Number]),Object(p[\"d\"])(\"design:returntype\",void 0)],j.prototype,\"validatStaffPosition\",null),j=Object(p[\"b\"])([Object(m[\"b\"])(),Object(p[\"d\"])(\"design:paramtypes\",[\"function\"===typeof(i=\"undefined\"!==typeof g[\"k\"]&&g[\"k\"])?i:Object,\"function\"===typeof(n=\"undefined\"!==typeof y[\"b\"]&&y[\"b\"])?n:Object,\"function\"===typeof(r=\"undefined\"!==typeof v[\"a\"]&&v[\"a\"])?r:Object,\"function\"===typeof(s=\"undefined\"!==typeof h[\"a\"]&&h[\"a\"])?s:Object])],j);var w=a(\"7a7f\"),A=a(\"88b8\"),O=function(e){return{nature_work:{},identity:{},coach_level_id:{rules:[{required:e.coach_level_required,message:\"请选择\".concat(e.$c(\"coach\"),\"等级\")}]},basic_salary:{},sale_percentage:{},course_percentage:{}}},C=a(\"5c8a\");function k(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function L(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?k(Object(a),!0).forEach((function(t){Object(l[\"a\"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):k(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var x={serviceInject:function(){return{updateStaffPositionService:j,userService:v[\"a\"],msg:h[\"a\"]}},rxState:function(){return{identityList:this.updateStaffPositionService.identityList$,natureWork:this.updateStaffPositionService.natureWork$,positionInfo:this.updateStaffPositionService.positionInfo$,coachLevelList:this.updateStaffPositionService.coachLevelList$,salaryBasic:this.updateStaffPositionService.salaryBasic$,salarySale:this.updateStaffPositionService.salarySale$,salaryCourse:this.updateStaffPositionService.salaryCourse$}},name:\"UpdateStaffPosition\",data:function(){var e=this.$stForm.create(),t=e.decorators(O);return{show:!1,form:e,decorators:t,isSalaryCourse:!1,coach_level_required:!1,canDeleteIdentity:!0,tips:[],operate:!1}},props:{staff:{type:Object,default:function(){}}},filters:{identityFilter:function(e){var t=[\"role-staff\",\"role-saler\",\"coach-personal\",\"coach-team\",\"swimming-coach\"];return t[e-1]}},components:{StaffInfo:w[\"a\"],StaffModalTips:A[\"a\"]},computed:{identity:function(){return this.staff&&this.staff.identity}},watch:{identity:function(e){this.isSalaryCourse=e.includes(3)||e.includes(4)}},mounted:function(){var e=this;this.updateStaffPositionService.init(this.staff.id).subscribe((function(t){var a=e.positionInfo,i=a.basic_salary,n=a.coach_level_id,r=a.course_percentage,s=a.identity,o=a.nature_work,c=a.sale_percentage;o||(o=void 0),e.onChangeIdentity(s);var l={coach_level_id:n,sale_percentage:c,course_percentage:r,basic_salary:i,identity:s,nature_work:o};e.form.setFieldsValue(l)}))},methods:{onChangeIdentity:function(e){this.isSalaryCourse=e.includes(3)||e.includes(4),this.coach_level_required=e.includes(4)},onDeselectIndentity:function(e){var t=this;this.updateStaffPositionService.validatStaffPosition(this.staff.id,e).subscribe((function(a){var i=a.operate;if(!i){var n=t.identity.filter((function(t){return t.id===e})),r=[].concat(Object(f[\"a\"])(n.map((function(e){return e.id}))),Object(f[\"a\"])(t.form.getFieldValue(\"identity\")));t.form.setFieldsValue({identity:r}),t.tips=a.list,t.operate=a.operate,t.canDeleteIdentity=!1}}))},onSubmit:function(e){var t=this;e.preventDefault(),this.form.validate().then((function(e){var a=Object(C[\"a\"])(e);!t.coach_level_required&&t.canDeleteIdentity&&(a.coach_level_id=void 0),t.updateStaffPositionService.putStaffBindPosition(L({id:t.staff.id},a)).subscribe((function(){t.show=!1,t.$router.reload()}))}))}}},P=x,z=a(\"2877\"),D=Object(z[\"a\"])(P,o,c,!1,null,null,null);t[\"a\"]=D.exports},\"7a7f\":function(e,t,a){\"use strict\";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"div\",{staticClass:\"modal-staff\"},[a(\"a-row\",{staticClass:\"staff-info mg-b16\",attrs:{type:\"flex\"}},[e.staff.avatar?a(\"a-col\",{staticClass:\"staff-info__img\"},[a(\"img\",{attrs:{src:e.staff.avatar,alt:\"\"}})]):e._e(),a(\"a-col\",{staticClass:\"staff-info__content\"},[a(\"st-t3\",[e._v(e._s(e.staff.staff_name))]),a(\"div\",{staticClass:\"staff-identity\"},e._l(e.identity,(function(t){return a(\"span\",{key:t.id,staticClass:\"staff-identity__item mg-r8\"},[e._v(\"\\n          \"+e._s(t.name)+\"\\n        \")])})),0)],1)],1)],1)},n=[],r={name:\"StaffInfo\",computed:{identity:function(){return this.staff.identity}},props:{staff:{type:Object,default:function(){}}}},s=r,o=a(\"2877\"),c=Object(o[\"a\"])(s,i,n,!1,null,null,null);t[\"a\"]=c.exports},\"88b8\":function(e,t,a){\"use strict\";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"div\",{staticClass:\"staff-modal-tips\",class:e.canNotDelete},[e.canNotDelete?a(\"p\",[e._v(\"该员工有以下任务项未完成,无法\"+e._s(e.suffix))]):e._e(),a(\"ul\",e._l(e.list,(function(t,i){return a(\"li\",{key:i,staticClass:\"item\"},[a(\"span\",{staticClass:\"count\"},[e._v(e._s(i+1))]),e._v(\"\\n      \"+e._s(t.num)+\" \"+e._s(t.name)+\"\\n      \")])})),0)])},n=[],r=(a(\"c5f6\"),{name:\"StaffModalTips\",bem:{tip:\"staff-modal-tips\"},props:{type:{type:Number,default:1},list:{type:Array,default:function(){return[]}},canNotDelete:{type:Boolean,default:!1}},computed:{suffix:function(){var e={1:\"删除此职能\",2:\"离职\",3:\"删除此员工\"};return e[this.type]}}}),s=r,o=a(\"2877\"),c=Object(o[\"a\"])(s,i,n,!1,null,null,null);t[\"a\"]=c.exports},\"89fa\":function(e,t,a){\"use strict\";function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n={keyRegExp:/^\\d+$/,keyName:\"\"};return t=Object.assign(n,t),e.map((function(e){var n=a,r=!0,s=t,o=s.keyRegExp,c=s.keyName;for(var l in e)c?e.key=e[c]:o.test(e[l])?e.key=e[l]:e.key=e.id,\"string\"===typeof e[l]&&(e.title=e[l]),e[l]instanceof Array&&(r=!1,e.children=e[l],e.children=i(e.children,t,++n));return e.key=JSON.stringify({isLeaf:r,key:e.key}),e}))}a.d(t,\"a\",(function(){return i}))},b346:function(e,t,a){\"use strict\";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"a-select\",{style:{width:e.width},attrs:{mode:e.mode,placeholder:e.placeholder||\"请选择门店\",value:e.cValue,dropdownMatchSelectWidth:!1,defaultValue:e.defaultValue,disabled:e.disabled,options:e.shopOptions},on:{change:e.onChange}})},n=[],r=(a(\"c5f6\"),a(\"75fc\")),s=a(\"2138\"),o={model:{prop:\"value\",event:\"change\"},name:\"ShopSelect\",serviceInject:function(){return{userService:s[\"a\"]}},rxState:function(){return{shopList:this.userService.shopList$}},computed:{cValue:{set:function(e){this.$emit(\"change\",e)},get:function(){return this.value||this.defaultValue}},shopOptions:function(){var e=\"form\"===this.useType?[]:[{label:\"全部门店\",value:-1}];return[].concat(e,Object(r[\"a\"])(this.shopList.map((function(e){return{label:e.shop_name,value:e.shop_id}}))))}},props:{mode:{type:String},placeholder:{type:String},useType:{type:String},width:{type:String,default:\"150px\"},value:{type:[Number,String,Array]},defaultValue:Number,disabled:{type:Boolean,default:!1}},methods:{onChange:function(e){this.$emit(\"change\",e)}}},c=o,l=a(\"2877\"),f=Object(l[\"a\"])(c,i,n,!1,null,null,null);t[\"a\"]=f.exports},fd89:function(e,t){e.exports=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAAgCAMAAAA7dZg3AAAB71BMVEUAAAD3VTj/YD3/wB7/1Vj+0lH/1Ff/32D+0Vz+0E/+zkj/wR3/01/90E7/wR73Vjr/wR3/1WD/0U//1Fr/wiH/xyX/xyL/ZkT/zCL/5Wv//3L3Vzn+0U79tUL3Vjn/0l3/xS3/wiP2Vzr/01z+0VL/wiL3Ujb/wSL+0Vf2Vjn2UTX/0lX3Vzr+zkj/1Fz3Vzr901r2Vzn/0mH/0mH4WDv/1WP2Vzn/qSX3WT36Vzz5Vzr/xib3XTv/gFX2VTj/wyb+z1P9y0r/z1D+zEH/xCj/wSD28cP2UDX+xjP2RS38qSP+zkf2TTP/xC3/wB3+z0r+yUX+yz//wiP+uCH08sj377z+0Vn9yVH+yE3+zUX1TDL/xi7/xSr277/47bn/0l3+0lv/0VX+zFH+0VD+yjv9xzv+yjj9tzf8tzP1SS/+wC71Qiz/viv+wCj7rCj8qiX+tSL8qCD8qh/467P+0E3+zkz+xUX+zUP9vzr+wzD+win9rSD75aD8y1r8ylX+xDz9wzr9uzf8tDH2STH8si39sC34Zyz8sCj9siT8rSD47bX46Kz70XD8xUr9x0H7mjn+yDP9ujL5eCz8rCX8sCD377715aT34Jn43ZD614T702r+0VP/y0r2XTT2XzL5hS76iC39tyz8oSv8oCn1PimOzqlhAAAAPnRSTlMA5BX5Rs0bEP3m28W7lIl+dXJYMSobFg8PCQT9+fn29fHx6+be3Nra2czJurm4qqKbj46JaFVVRD8vLCgeBuA/L+UAAAI/SURBVCjPZdFld9pQGMDxbKWl69p1lW1t5+7uRkIDARIgCQ4pDHd3Ke51mbt90F3GYFD+Jy9yzu/ekyf3Qp3mWVP37009ZEN7m7l12mh8BRodZ/XB/B2VUaUyazRmFVgwPvJfRoZNJrPDjwf8uN+hVqnOz3SEfcX0KRkoxc2ICYk7Ag7EdGb2H11HkJI/jliQRQSkqVZTsotzf2UaQRx+7mI3c70p4x9qycIFSzxAxWLcdp+5Vjgc5A8dAcSyWKrFKHc0l1NTlEat1kjS8hBfehjQhIXCuTHqrQJTridXDZFlNwyH5fyDgIajyUqMS2UVeuWHNaUhkvXBsuBr6RCgA1GnkyS1+XeYcmVFb1j2pmFYnuFLj0LQiWipSBLaDTWm1GN6Q9bHAxSWSmfBLtLpJAgtmn//RoHpwSZed9cwWawQ2gRqW8fAJLn0Eq/7rQlyA6cA0YWIAot4JYA6E7JIor6dQFE6r1Zga+4Wdf5rYYwo4DaUpm3uVYNXAsjXOQ1omtA6d22o1S7UfEwxzBIvk2mfIegmgVYCSavdLhQyjMTXbMpkl+faxB5LoNt43S0EeRuhBgyffd695ZMobfuxG8LxEN7w8XjBx1C3fZs0bbUKU+4UA8b49WV/D+m+bhbs9q0tISP5WdMJekngEolqO9++79RcIpeY00scsUvk8Xh+ezyisljQTwKduCwCuco6AaefOC0UgwfAAAG8dK0Fg3Tq9hMIenb33ABdfXCs/fry0Y3jvTT5FOrpxWR72R9c1MKLClFN9AAAAABJRU5ErkJggg==\"}}]);","extractedComments":[]}