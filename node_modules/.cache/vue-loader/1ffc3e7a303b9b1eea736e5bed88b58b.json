{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhigang/Desktop/styd/web/src/views/pages/shop/store/data/data.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/pages/shop/store/data/data.vue","mtime":1591147717472},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js","mtime":1591062572376}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport pieImg from '@/assets/img/shop/dashboard/pie.png'\nimport inoutNumImg from '@/assets/img/shop/dashboard/inoutNum.png'\nimport moment from 'moment'\nimport ShopStoreDataLine from '@/views/biz-components/stat/shop-store-data-line'\nimport WholeTabs from './components#/whole-tabs'\nimport BuyConsumptionTables from './components#/buy-consumption-tables'\nimport DatePicker from './components#/date-picker'\nimport SalesAnalysis from './components#/sales-analysis'\nimport BuyNumber from './components#/buy-number'\nimport WholeOrderMember from './components#/whole-order-member'\nimport ShopStoreDataRevenueRing from '@/views/biz-components/stat/shop-store-data-revenue-ring'\nimport { DataService } from './data.service'\nimport {\n  headerInfo,\n  wholeNav,\n  headerTitleItem,\n  fieldNav,\n  fieldInfo\n} from './data.config.ts'\nexport default {\n  serviceInject() {\n    return {\n      dataService: DataService\n    }\n  },\n  rxState() {\n    return {\n      dataProfile: this.dataService.dataProfile$,\n      storeBoard: this.dataService.storeBoard$,\n      storeSaleList: this.dataService.storeSaleList$,\n      storeCategoryRank: this.dataService.storeCategoryRank$,\n      storeMemberAnalysis: this.dataService.storeMemberAnalysis$\n    }\n  },\n  bem: {\n    basic: 'shop-store-data',\n    salesCategory: 'sales-category',\n    headerContent: 'header-content'\n  },\n  data() {\n    return {\n      wholenavIndex: 0,\n      pieImg,\n      inoutNumImg,\n      wholeNavcom: 'shop-store-data-ring',\n      headerInfo,\n      wholeNav,\n      headerTitleItem,\n      fieldNav,\n      fieldInfo,\n      tabsObjData: {\n        choose_type: 1,\n        date_type: 1,\n        date: null\n      }\n    }\n  },\n  components: {\n    ShopStoreDataLine,\n    DatePicker,\n    WholeTabs,\n    BuyConsumptionTables,\n    SalesAnalysis,\n    BuyNumber,\n    ShopStoreDataRevenueRing,\n    WholeOrderMember\n  },\n  mounted() {\n    this.$nextTick(() => {\n      this.wholenavFilter()\n    })\n  },\n  methods: {\n    // 整体看板时间\n    wholeTimesFn(value) {\n      this.dataService.getStoreBoard(value).subscribe(res => {\n        this.wholenavFilter()\n      })\n    },\n    // 销售分析时间\n    saleTimesFn(value) {\n      this.dataService.getStoreSaleList(value).subscribe()\n    },\n    // 类目分析时间\n    categoryTimesFn(value) {\n      this.dataService.getStoreCategoryRank(value).subscribe()\n    },\n    // 购买次数/消费金额时间\n    userAnalysisTimesFn(value) {\n      this.tabsObjData.date_type = value.date_type\n      this.tabsObjData.date = value.date\n      this.dataService.getStoreMemberAnalysis(this.tabsObjData).subscribe()\n    },\n    // 整体看板订单/会员折线图\n    filterLine(data, type) {\n      if (!data[this.fieldNav[this.wholenavIndex]].trend.length) return []\n      return data[this.fieldNav[this.wholenavIndex]].trend.map(item => {\n        return {\n          date: item.date,\n          amount: Number(item[this.fieldInfo[this.wholenavIndex]])\n        }\n      })\n    },\n    // 整体看板数据处理\n    wholenavFilter() {\n      let data = this.storeBoard\n      this.wholeNav.forEach((item, index) => {\n        let dataInfo = data[this.fieldNav[index]][this.fieldInfo[index]]\n        this.$set(item, 'num', dataInfo)\n        item.unit = data[this.fieldNav[index]].unit\n      })\n    },\n    onChangeTabs(query) {\n      this.tabsObjData = Object.assign(this.tabsObjData, { choose_type: query })\n      this.tabsObjData.date = this.tabsObjData.date\n        ? this.tabsObjData.date\n        : moment()\n            .subtract(1, 'days')\n            .format('YYYY-MM-DD') + ''\n      this.dataService.getStoreMemberAnalysis(this.tabsObjData).subscribe()\n    },\n    refresh() {\n      return this.dataService.getDataProfile(this.chartTodayShop)\n    },\n    wholenavFun(index, item) {\n      this.wholenavIndex = index\n      if (index > 1) {\n        this.wholeNavcom = 'brand-user-avg-bar'\n      } else {\n        this.wholeNavcom = 'shop-store-data-ring'\n      }\n    }\n  }\n}\n",null]}