(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["brand-stat-course-team"],{"50c6":function(e,t,a){"use strict";a.r(t),a.d(t,"CourseService",(function(){return v}));var n,r,s,i,o,c=a("75fc"),u=a("d225"),d=a("b0b4"),l=a("9ab4"),h=a("0cd5"),m=a("df29"),p=a("c4cc"),f=a("4387"),y=a("112a"),_=a("2cbb"),b=a("2138"),g=a("c170"),v=function(){function e(t,a,n,r){Object(u["a"])(this,e),this.api=t,this.commonApi=a,this.authService=n,this.userService=r,this.list$=new m["d"]([]),this.page$=new m["d"]({}),this.total$=new m["d"]({}),this.loading$=new m["d"]({}),this.courseList$=new m["d"]([]),this.categoryList$=new m["d"]([]),this.auth$=this.authService.authMap$({export:"brand:stat:course|team_member_export"}),this.productType$=this.userService.getOptions$("report.revenue_product_type")}return Object(d["a"])(e,[{key:"getList",value:function(e){var t=this;return this.api.getTeamCourseList(e).pipe(Object(p["a"])((function(e){t.list$.commit((function(){return e.list})),t.page$.commit((function(){return e.page}))})))}},{key:"getTotal",value:function(e){var t=this;return this.api.getTeamCourseTotal(e).pipe(Object(p["a"])((function(e){t.total$.commit((function(){return e.info}))})))}},{key:"getCourseList",value:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.commonApi.getCourseList(e).pipe(Object(p["a"])((function(n){var r=t.courseList$.getValue()||[],s=n.list||[],i=e.current_page;i<=n.page.total_pages&&(r=a?[{course_name:"全部团课课程",id:-1}].concat(Object(c["a"])(s)):[].concat(Object(c["a"])(r),Object(c["a"])(s)),t.courseList$.commit((function(){return r})))})))}},{key:"getCategoryList",value:function(){var e=this;return this.commonApi.getCourseCategoryList({}).pipe(Object(p["a"])((function(t){var a=t.list||[];e.categoryList$.commit((function(){return a.map((function(e){var t=e.id,a=e.setting_name;return{value:t,label:a}}))}))})))}},{key:"beforeEach",value:function(e,t){return Object(g["a"])(this.getList(e.meta.query),this.getTotal(e.meta.query))}}]),e}();Object(l["b"])([Object(m["c"])(),Object(l["d"])("design:type",Function),Object(l["d"])("design:paramtypes",["function"===typeof(n="undefined"!==typeof f["CourseDataParams"]&&f["CourseDataParams"])?n:Object]),Object(l["d"])("design:returntype",void 0)],v.prototype,"getList",null),v=Object(l["b"])([Object(h["b"])(),Object(l["d"])("design:paramtypes",["function"===typeof(r="undefined"!==typeof f["a"]&&f["a"])?r:Object,"function"===typeof(s="undefined"!==typeof y["a"]&&y["a"])?s:Object,"function"===typeof(i="undefined"!==typeof _["a"]&&_["a"])?i:Object,"function"===typeof(o="undefined"!==typeof b["a"]&&b["a"])?o:Object])],v)},a168:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{class:e.b("panne")},[a("div",{class:e.b("section")},[a("header",{class:e.bHeader("header")},[a("div",{class:e.bHeader("button-wapper")},[e.auth.export?a("st-button",{directives:[{name:"export-excel",rawName:"v-export-excel",value:{type:"brand/team_course/export",query:e.$searchQuery},expression:"{\n            type: 'brand/team_course/export',\n            query: $searchQuery\n          }"}],attrs:{type:"primary"}},[e._v("\n          全部导出\n        ")]):e._e()],1),a("div",{class:e.bHeader("actions")},[a("st-select",{attrs:{options:e.categoryList,defaultLabel:"全部课程类型"},on:{change:function(t){return e.onSingleSearch("category_id",t)}},model:{value:e.$searchQuery.category_id,callback:function(t){e.$set(e.$searchQuery,"category_id",t)},expression:"$searchQuery.category_id"}}),a("st-select-scroll",{staticStyle:{width:"150px"},attrs:{_label:"course_name",_value:"id",showArrow:"",isSrcoll:"",showSearch:!1,query:{category_id:e.$searchQuery.category_id},list:e.courseList},on:{change:function(t){return e.onSingleSearch("course_id",t)},refresh:function(t){return e.onStaffSelectRefresh(!0,t)},search:function(t){return e.onStaffSelectRefresh(!0,t)},scroll:function(t){return e.onStaffSelectRefresh(!1,t)}},model:{value:e.$searchQuery.course_id,callback:function(t){e.$set(e.$searchQuery,"course_id",t)},expression:"$searchQuery.course_id"}}),a("shop-select",{on:{change:function(t){return e.onSingleSearch("shop_id",t)}},model:{value:e.$searchQuery.shop_id,callback:function(t){e.$set(e.$searchQuery,"shop_id",t)},expression:"$searchQuery.shop_id"}}),a("st-recent-radio-group",{attrs:{value:e.value,disabledDate:function(t){return t.format("YYYY-MM-DD")&&t.format("YYYY-MM-DD")>=e.moment().format("YYYY-MM-DD")}},on:{change:e.onChangeTableDays}})],1)]),a("main",{class:e.b("mian")},[a("st-total",{class:e.b("total"),attrs:{indexs:e.totalColumns,dataSource:e.total,hasTitle:""},scopedSlots:e._u([{key:"total_num",fn:function(t){return a("a",{directives:[{name:"modal-link",rawName:"v-modal-link",value:{name:"brand-stat-team-reserve-modal",props:{query:e.$searchQuery,title:"预约明细",type:"brand-team-course"}},expression:"{\n            name: 'brand-stat-team-reserve-modal',\n            props: {\n              query: $searchQuery,\n              title: '预约明细',\n              type: 'brand-team-course'\n            }\n          }"}]},[a("st-total-item",{attrs:{unit:t.unit,label:t.label,value:t.value}})],1)}}])}),a("st-table",{staticClass:"mg-t16",attrs:{loading:e.loading.getList,columns:e.columns,scroll:{x:1400},rowKey:function(e,t){return t},page:e.page,dataSource:e.list},on:{change:e.onTableChange},scopedSlots:e._u([{key:"total_num",fn:function(t,n){return a("a",{directives:[{name:"modal-link",rawName:"v-modal-link",value:{name:"brand-stat-team-reserve-modal",props:{query:Object.assign({},e.$searchQuery,{course_id:n.course_id}),title:"预约明细",type:"brand-team-course"}},expression:"{\n            name: 'brand-stat-team-reserve-modal',\n            props: {\n              query: { ...$searchQuery, course_id: record.course_id },\n              title: '预约明细',\n              type: 'brand-team-course'\n            }\n          }"}]},[e._v("\n          "+e._s(t)+"\n        ")])}}])})],1)])])},r=[],s=(a("8e6e"),a("ac6a"),a("456d"),a("bd86")),i=(a("7514"),a("b346")),o=(a("a14b"),a("1044")),c=a("b513"),u=a("0db6"),d=a("50c6"),l=a("ea3e"),h=[{title:"课程名称",width:140,dataIndex:"course_name"},{title:"课程类型",width:100,dataIndex:"category_name"},{title:"上课节数",scopedSlots:{customRender:"total_num"},width:100,dataIndex:"total_num"},{title:"上课时长(h)",width:120,dataIndex:"total_time"},{title:"上课人数",width:100,dataIndex:"total_class_attendance"},{title:"有效预约",width:100,dataIndex:"effective_reserve_num"},{title:"未签预约",width:100,dataIndex:"not_signin_num"},{title:"已签预约",width:100,dataIndex:"use_signin_num"},{title:"消课价值(元)",width:120,dataIndex:"total_amount"},{title:"课均人数(人/节)",width:140,dataIndex:"avg_class_attendance"},{title:"课均价值(元/节)",width:140,dataIndex:"avg_amount"},{title:"时效价值(元/h)",width:140,dataIndex:"aging_amount"}],m=[{title:"课程数(节)",dataIndex:"class_coach_num"},{title:"上课节数",scopedSlots:{customRender:"total_num"},dataIndex:"total_num"},{title:"上课时长(h)",dataIndex:"total_time"},{title:"上课人数",dataIndex:"total_class_attendance"},{title:"有效预约",dataIndex:"effective_reserve_num"},{title:"未签预约",dataIndex:"not_signin_num"},{title:"已签预约",dataIndex:"use_signin_num"},{title:"消课价值",unit:"¥",dataIndex:"total_amount"},{title:"课均人数(人/节)",dataIndex:"avg_class_attendance"},{title:"课均价值(元/节)",unit:"¥",dataIndex:"avg_amount"},{title:"时效价值(元/h)",unit:"¥",dataIndex:"aging_amount"}],p=a("c32d"),f=a.n(p);function y(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function _(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?y(Object(a),!0).forEach((function(t){Object(s["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):y(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var b={name:"BrandCoachTeamCourse",mixins:[l["a"]],serviceInject:function(){return{service:d["CourseService"]}},rxState:function(){var e=this.service,t=e.list$,a=e.page$,n=e.total$,r=e.auth$,s=e.loading$,i=e.categoryList$,o=e.courseList$;return{list:t,page:a,total:n,auth:r,categoryList:i,courseList:o,loading:s}},modals:{BrandStatTeamReserveModal:u["a"]},bem:{b:"page-brand-coach-team-course",bHeader:"page-brand-stat-header"},watch:{courseList:{deep:!0,handler:function(){var e=this;!this.courseList.find((function(t){return t.id===e.$searchQuery.course_id}))&&this.$router.push({query:_({},this.finalSearchQuery,{course_id:-1})})}}},data:function(){return{columns:h,totalColumns:m,coursePage:{current_page:1,size:20}}},created:function(){this.service.getCourseList(_({type:2,category_id:this.$searchQuery.category_id},this.coursePage),!0).subscribe(),this.service.getCategoryList().subscribe()},computed:{value:function(){var e=this.$searchQuery.start_date?0:this.$searchQuery.day;return{day:e,start_date:this.$searchQuery.start_date,end_date:this.$searchQuery.end_date}}},methods:{moment:f.a,onChangeTableDays:function(e){this.$searchQuery.day=e.recently_day||void 0,this.$searchQuery.start_date=e.start_date||void 0,this.$searchQuery.end_date=e.end_date||void 0,this.onSearch()},onStaffSelectRefresh:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.coursePage.current_page=e?1:this.coursePage.current_page+1,this.service.getCourseList(_({type:2},t,{category_id:this.$searchQuery.category_id},this.coursePage),e).subscribe()}},components:{shopSelect:i["a"],StTotal:o["a"],StTotalItem:c["a"]}},g=b,v=a("2877"),$=Object(v["a"])(g,n,r,!1,null,null,null);t["default"]=$.exports},c5da:function(e,t,a){"use strict";a.r(t),a.d(t,"CoachService",(function(){return f}));var n,r,s,i=a("d225"),o=a("b0b4"),c=a("9ab4"),u=a("0cd5"),d=a("df29"),l=a("c4cc"),h=a("4387"),m=a("2cbb"),p=a("c170"),f=function(){function e(t,a){Object(i["a"])(this,e),this.api=t,this.authService=a,this.list$=new d["d"]([]),this.page$=new d["d"]({}),this.total$=new d["d"]({}),this.loading$=new d["d"]({}),this.auth$=this.authService.authMap$({export:"brand:stat:course|team_coach_export"})}return Object(o["a"])(e,[{key:"getList",value:function(e){var t=this;return this.api.getTeamCoachList(e).pipe(Object(l["a"])((function(e){t.list$.commit((function(){return e.list})),t.page$.commit((function(){return e.page}))})))}},{key:"getTotal",value:function(e){var t=this;return this.api.getTeamCoachTotal(e).pipe(Object(l["a"])((function(e){t.total$.commit((function(){return e.info}))})))}},{key:"beforeEach",value:function(e,t){return Object(p["a"])(this.getList(e.meta.query),this.getTotal(e.meta.query))}}]),e}();Object(c["b"])([Object(d["c"])(),Object(c["d"])("design:type",Function),Object(c["d"])("design:paramtypes",["function"===typeof(n="undefined"!==typeof h["CourseDataParams"]&&h["CourseDataParams"])?n:Object]),Object(c["d"])("design:returntype",void 0)],f.prototype,"getList",null),f=Object(c["b"])([Object(u["b"])(),Object(c["d"])("design:paramtypes",["function"===typeof(r="undefined"!==typeof h["a"]&&h["a"])?r:Object,"function"===typeof(s="undefined"!==typeof m["a"]&&m["a"])?s:Object])],f)},e691:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{class:e.b("panne")},[a("div",{class:e.b("section")},[a("header",{class:e.bHeader("header")},[a("div",{class:e.bHeader("button-wapper")},[e.auth.export?a("st-button",{directives:[{name:"export-excel",rawName:"v-export-excel",value:{type:"brand/team_coach/export",query:e.$searchQuery},expression:"{\n            type: 'brand/team_coach/export',\n            query: $searchQuery\n          }"}],attrs:{type:"primary"}},[e._v("\n          全部导出\n        ")]):e._e()],1),a("div",{class:e.bHeader("actions")},[a("shop-select",{on:{change:function(t){return e.onSingleSearch("shop_id",t)}},model:{value:e.$searchQuery.shop_id,callback:function(t){e.$set(e.$searchQuery,"shop_id",t)},expression:"$searchQuery.shop_id"}}),a("staff-select",{attrs:{query:{identity:3,shop_id:e.$searchQuery.shop_id},defaultLabel:"全部团教教练"},on:{change:function(t){return e.onSingleSearch("staff_id",t)}},model:{value:e.$searchQuery.staff_id,callback:function(t){e.$set(e.$searchQuery,"staff_id",t)},expression:"$searchQuery.staff_id"}}),a("st-recent-radio-group",{attrs:{value:e.value,disabledDate:function(t){return t.format("YYYY-MM-DD")&&t.format("YYYY-MM-DD")>=e.moment().format("YYYY-MM-DD")}},on:{change:e.onChangeTableDays}})],1)]),a("main",{class:e.b("mian")},[a("st-total",{class:e.b("total"),attrs:{indexs:e.totalColumns,dataSource:e.total,hasTitle:""},scopedSlots:e._u([{key:"total_num",fn:function(t){return a("a",{directives:[{name:"modal-link",rawName:"v-modal-link",value:{name:"brand-stat-team-reserve-modal",props:{query:e.$searchQuery,title:"预约明细",type:"brand-team-coach"}},expression:"{\n            name: 'brand-stat-team-reserve-modal',\n            props: {\n              query: $searchQuery,\n              title: '预约明细',\n              type: 'brand-team-coach'\n            }\n          }"}]},[a("st-total-item",{attrs:{unit:t.unit,label:t.label,value:t.value}})],1)}},{key:"free_coach_num",fn:function(t){return a("a",{directives:[{name:"modal-link",rawName:"v-modal-link",value:{name:"brand-stat-free-coach-modal",props:{query:e.$searchQuery,title:"查看员工",type:"brand-team-coach"}},expression:"{\n            name: 'brand-stat-free-coach-modal',\n            props: {\n              query: $searchQuery,\n              title: '查看员工',\n              type: 'brand-team-coach'\n            }\n          }"}]},[a("st-total-item",{attrs:{unit:t.unit,label:t.label,value:t.value}})],1)}}])}),a("st-table",{staticClass:"mg-t16",attrs:{loading:e.loading.getList,columns:e.columns,scroll:{x:1360},rowKey:"staff_id",page:e.page,dataSource:e.list},on:{change:e.onTableChange},scopedSlots:e._u([{key:"total_num",fn:function(t,n){return a("a",{directives:[{name:"modal-link",rawName:"v-modal-link",value:{name:"brand-stat-team-reserve-modal",props:{query:Object.assign({},e.$searchQuery,{staff_id:n.staff_id}),title:"预约明细",type:"brand-team-coach"}},expression:"{\n            name: 'brand-stat-team-reserve-modal',\n            props: {\n              query: { ...$searchQuery, staff_id: record.staff_id },\n              title: '预约明细',\n              type: 'brand-team-coach'\n            }\n          }"}]},[e._v("\n          "+e._s(t)+"\n        ")])}}])})],1)])])},r=[],s=a("b346"),i=a("a14b"),o=a("1044"),c=a("b513"),u=a("5315"),d=a("0db6"),l=a("c5da"),h=a("ea3e"),m=[{title:"教练姓名",width:100,dataIndex:"staff_name"},{title:"所属部门",width:100,dataIndex:"department_name"},{title:"上课节数",scopedSlots:{customRender:"total_num"},width:100,dataIndex:"total_num"},{title:"上课时长(h)",width:120,dataIndex:"total_time"},{title:"上课人数",width:100,dataIndex:"total_class_attendance"},{title:"有效预约",width:100,dataIndex:"effective_reserve_num"},{title:"未签预约",width:100,dataIndex:"not_signin_num"},{title:"已签预约",width:100,dataIndex:"use_signin_num"},{title:"消课价值(元)",width:120,dataIndex:"total_amount"},{title:"课均人数(人/节)",width:140,dataIndex:"avg_class_attendance"},{title:"课均价值(元/节)",width:140,dataIndex:"avg_amount"},{title:"时效价值(元/h)",width:140,dataIndex:"aging_amount"}],p=[{title:"上课教练数",dataIndex:"class_coach_num"},{title:"上课节数",scopedSlots:{customRender:"total_num"},dataIndex:"total_num"},{title:"人均上课(节)",dataIndex:"avg_num"},{title:"上课时长(h)",dataIndex:"total_time"},{title:"上课人数",dataIndex:"total_class_attendance"},{title:"有效预约",dataIndex:"effective_reserve_num"},{title:"未签预约",dataIndex:"not_signin_num"},{title:"已签预约",dataIndex:"use_signin_num"},{title:"消课价值",unit:"¥",dataIndex:"total_amount"},{title:"课均人数(人/节)",dataIndex:"avg_class_attendance"},{title:"课均价值(元/节)",unit:"¥",dataIndex:"avg_amount"},{title:"时效价值(元/h)",unit:"¥",dataIndex:"aging_amount"},{title:"空闲教练",scopedSlots:{customRender:"free_coach_num"},dataIndex:"free_coach_num"}],f=a("c32d"),y=a.n(f),_={name:"BrandCoachTeamCourse",mixins:[h["a"]],serviceInject:function(){return{service:l["CoachService"]}},rxState:function(){var e=this.service,t=e.list$,a=e.page$,n=e.total$,r=e.auth$,s=e.loading$;return{list:t,page:a,total:n,auth:r,loading:s}},modals:{BrandStatFreeCoachModal:u["a"],BrandStatTeamReserveModal:d["a"]},bem:{b:"page-brand-coach-team-course",bHeader:"page-brand-stat-header"},watch:{},data:function(){return{columns:m,totalColumns:p}},created:function(){},computed:{value:function(){var e=this.$searchQuery.start_date?0:this.$searchQuery.day;return{day:e,start_date:this.$searchQuery.start_date,end_date:this.$searchQuery.end_date}}},methods:{moment:y.a,onChangeTableDays:function(e){this.$searchQuery.day=e.recently_day||void 0,this.$searchQuery.start_date=e.start_date||void 0,this.$searchQuery.end_date=e.end_date||void 0,this.onSearch()}},components:{shopSelect:s["a"],StTotal:o["a"],StTotalItem:c["a"],StaffSelect:i["a"]}},b=_,g=a("2877"),v=Object(g["a"])(b,n,r,!1,null,null,null);t["default"]=v.exports}}]);