{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhigang/Desktop/styd/web/src/views/pages/shop/staff/info.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/pages/shop/staff/info.vue","mtime":1600926556511},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js","mtime":1591062572376}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { InfoService } from './info.service'\nimport ShopStaffBindCard from '@/views/biz-modals/shop-staff/bind-card'\nimport ShopStaffLeaveCurrentShop from '@/views/biz-modals/shop-staff/leave-current-shop'\nimport ShopStaffRePassword from '@/views/biz-modals/shop-staff/re-password'\nimport ShopStaffSalaryAccountSetting from '@/views/biz-modals/shop-staff/salary-account-setting'\nimport ShopStaffUpdateStaffPosition from '@/views/biz-modals/shop-staff/update-staff-position'\nimport StaffUpdateStaffPosition from '@/views/biz-modals/staff/update-staff-position'\nimport { forEach } from 'lodash-es'\nexport default {\n  modals: {\n    ShopStaffBindCard,\n    ShopStaffLeaveCurrentShop,\n    ShopStaffRePassword,\n    ShopStaffSalaryAccountSetting,\n    ShopStaffUpdateStaffPosition,\n    StaffUpdateStaffPosition\n  },\n  serviceInject() {\n    return {\n      infoService: InfoService\n    }\n  },\n  rxState() {\n    return {\n      info: this.infoService.info$,\n      auth: this.infoService.auth$\n    }\n  },\n  data() {\n    return {\n      basic: {\n        label: '员工资料',\n        route: {\n          name: 'shop-staff-info-basic',\n          query: { id: this.$searchQuery.id }\n        }\n      },\n      course: {\n        label: '上课记录',\n        route: {\n          name: 'shop-staff-info-course',\n          query: { id: this.$searchQuery.id }\n        }\n      },\n      follow: {\n        label: '跟进记录',\n        route: {\n          name: 'shop-staff-info-follow',\n          query: { id: this.$searchQuery.id }\n        }\n      },\n      sold: {\n        label: '售卖订单',\n        route: {\n          name: 'shop-staff-info-sold',\n          query: { id: this.$searchQuery.id }\n        }\n      },\n      member: {\n        label: '服务课程',\n        route: {\n          name: 'shop-staff-info-member',\n          query: { id: this.$searchQuery.id }\n        }\n      },\n      tabList: []\n    }\n  },\n  computed: {\n    image_avatar_url() {\n      return (\n        (this.info &&\n          this.info.image_avatar &&\n          this.info.image_avatar.image_url) ||\n        ''\n      )\n    },\n    btnOptions() {\n      return [\n        {\n          text: '编辑资料',\n          click: this.editStaffInfo,\n          if: this.auth['shop:staff:staff|edit']\n        },\n        {\n          text: '绑定实体卡',\n          click: this.openModalBindCard,\n          if: this.auth['shop:staff:staff|bind_card']\n        },\n        {\n          text: '重绑实体卡',\n          click: this.openModalRebindCard,\n          if: this.auth['shop:staff:staff|rebind_card']\n        },\n        {\n          text: '职位和薪资变更',\n          click: this.openModalPosition,\n          if: this.auth['shop:staff:staff|position']\n        },\n        {\n          text: '离职',\n          click: this.openModalLeave,\n          if: this.auth['shop:staff:staff|leave']\n        },\n        {\n          text: '复职',\n          click: this.openModalReinstate,\n          if: this.auth['shop:staff:staff|reinstate']\n        },\n        {\n          text: '管理登录账户',\n          click: this.openModalSave,\n          if: this.auth['shop:staff:account|save']\n        },\n        {\n          text: '设置提现账户',\n          click: this.openModalSalary,\n          if: this.auth['shop:staff:staff|salary']\n        },\n        {\n          text: '解除门店关系',\n          click: this.openModalShopLeave,\n          if: this.auth['shop:staff:staff|shop_leave']\n        },\n        {\n          text: '清空指纹信息',\n          click: this.onClearFingerprintInfo,\n          if: this.auth['shop:staff:staff|finger_del']\n        },\n        {\n          text: '清空硬件密码',\n          click: this.onClearHardwarePassword,\n          if: this.auth['shop:staff:staff|cabinet_pwd_del']\n        }\n      ]\n    }\n  },\n  created() {\n    // 团课教练：上课记录\n    // 私教教练：上课记录、跟进记录、服务课程 、销售订单\n    // 会籍销售：跟进记录、服务课程 、销售订单\n    // 1,普通员工 2-会籍销售；3-团课教练；4-私人教练\n    let { identity } = this.info\n    identity = identity.map(item => item.id)\n    let tabSet = new Set()\n    this.setIndentyList(['basic'], tabSet)\n    if (Array.isArray(identity) && identity.length) {\n      identity.forEach(ele => {\n        if (ele === 2) {\n          this.setIndentyList(['member', 'sold'], tabSet)\n        } else if (ele === 3) {\n          this.setIndentyList(['course'], tabSet)\n        } else if (ele === 4) {\n          this.setIndentyList(['course', 'follow', 'member', 'sold'], tabSet)\n        }\n      })\n    }\n    this.tabList = Array.from(tabSet).map(key => this[key])\n  },\n  methods: {\n    setIndentyList(arr, targetArr) {\n      arr.forEach(key => targetArr.add(key, this[key]))\n    },\n    openModal(modalType) {\n      const modalPathList = {\n        bind_card: 'shop-staff-bind-card',\n        rebind_card: 'shop-staff-bind-card',\n        leave: 'shop-staff-turnover',\n        reinstate: 'shop-staff-reinstatement',\n        save: 'shop-staff-re-password',\n        position: 'shop-staff-update-staff-position',\n        salary: 'shop-staff-salary-account-setting',\n        shop_leave: 'shop-staff-leave-current-shop'\n      }\n      const name = modalPathList[modalType]\n      this.$modalRouter.push({\n        name,\n        props: { staff: this.info }\n      })\n    },\n    openModalBindCard() {\n      this.openModal('bind_card')\n    },\n    openModalRebindCard() {\n      this.openModal('rebind_card')\n    },\n    openModalLeave() {\n      this.openModal('leave')\n    },\n    openModalReinstate() {\n      this.openModal('reinstate')\n    },\n    openModalSave() {\n      this.openModal('save')\n    },\n    openModalPosition() {\n      this.openModal('position')\n    },\n    openModalSalary() {\n      this.openModal('salary')\n    },\n    openModalShopLeave() {\n      this.openModal('shop_leave')\n    },\n    editStaffInfo() {\n      this.$router.push({\n        name: 'shop-staff-edit',\n        query: { id: this.info.id }\n      })\n    },\n    // 清空指纹信息\n    onClearFingerprintInfo() {\n      this.$confirm({\n        title: '提示信息',\n        content: '确认清空指纹信息？',\n        onOk: () => {\n          this.infoService.deleteStaffFinger(this.info.id).subscribe()\n        }\n      })\n    },\n    // 清空硬件密码\n    onClearHardwarePassword() {\n      this.$confirm({\n        title: '提示信息',\n        content: '确认清空硬件密码吗？',\n        onOk: () => {\n          this.infoService.deleteStaffCabinetPassword(this.info.id).subscribe()\n        }\n      })\n    }\n  }\n}\n",{"version":3,"sources":["info.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"info.vue","sourceRoot":"src/views/pages/shop/staff","sourcesContent":["<template>\n  <st-panel-layout class=\"pages-staffdata-container\">\n    <st-panel class=\"pages-staffdata-header\">\n      <a-row>\n        <a-col :span=\"15\" class=\"pages-staffdata-header-detail\">\n          <div class=\"staff-avatar-container st-preview-item\">\n            <img :src=\"image_avatar_url\" />\n            <div class=\"staff-avatar-tip\">\n              {{ info.work_status.name }}\n              <span v-if=\"info.nature_work.name\">\n                /{{ info.nature_work.name }}\n              </span>\n            </div>\n          </div>\n          <div class=\"staff-info-container\">\n            <div class=\"staff-info-name\">\n              {{ info.staff_name }}\n              <span v-if=\"info.nickname\">（{{ info.nickname }}）</span>\n              <st-icon\n                :type=\"info.sex === 1 ? 'female' : 'male'\"\n                :style=\"info.sex === 1 ? 'color:#FF5E41' : 'color:#3F66F6'\"\n              />\n            </div>\n            <div class=\"staff-info-cont\">\n              <span class=\"mg-r24\">手机号：{{ info.mobile }}</span>\n              <span class=\"mg-r24\" v-if=\"info.staff_num\">\n                工号：{{ info.staff_num }}\n              </span>\n              <span v-if=\"info.coach_level\">\n                {{ $c('coach') }}等级：{{ info.coach_level }}\n              </span>\n            </div>\n            <div class=\"staff-info-shops\">\n              <span class=\"mg-r24\">所在部门：{{ info.department }}</span>\n              <span>所在门店：{{ info.shop_num }}家门店</span>\n            </div>\n          </div>\n        </a-col>\n        <a-col\n          :span=\"9\"\n          style=\"text-align: right;\"\n          v-if=\"info.work_status.name === '在职'\"\n        >\n          <st-btn-actions :options=\"btnOptions\"></st-btn-actions>\n        </a-col>\n      </a-row>\n    </st-panel>\n    <st-panel app :tabs=\"tabList\">\n      <div slot=\"actions\"></div>\n      <router-view></router-view>\n    </st-panel>\n  </st-panel-layout>\n</template>\n<script>\nimport { InfoService } from './info.service'\nimport ShopStaffBindCard from '@/views/biz-modals/shop-staff/bind-card'\nimport ShopStaffLeaveCurrentShop from '@/views/biz-modals/shop-staff/leave-current-shop'\nimport ShopStaffRePassword from '@/views/biz-modals/shop-staff/re-password'\nimport ShopStaffSalaryAccountSetting from '@/views/biz-modals/shop-staff/salary-account-setting'\nimport ShopStaffUpdateStaffPosition from '@/views/biz-modals/shop-staff/update-staff-position'\nimport StaffUpdateStaffPosition from '@/views/biz-modals/staff/update-staff-position'\nimport { forEach } from 'lodash-es'\nexport default {\n  modals: {\n    ShopStaffBindCard,\n    ShopStaffLeaveCurrentShop,\n    ShopStaffRePassword,\n    ShopStaffSalaryAccountSetting,\n    ShopStaffUpdateStaffPosition,\n    StaffUpdateStaffPosition\n  },\n  serviceInject() {\n    return {\n      infoService: InfoService\n    }\n  },\n  rxState() {\n    return {\n      info: this.infoService.info$,\n      auth: this.infoService.auth$\n    }\n  },\n  data() {\n    return {\n      basic: {\n        label: '员工资料',\n        route: {\n          name: 'shop-staff-info-basic',\n          query: { id: this.$searchQuery.id }\n        }\n      },\n      course: {\n        label: '上课记录',\n        route: {\n          name: 'shop-staff-info-course',\n          query: { id: this.$searchQuery.id }\n        }\n      },\n      follow: {\n        label: '跟进记录',\n        route: {\n          name: 'shop-staff-info-follow',\n          query: { id: this.$searchQuery.id }\n        }\n      },\n      sold: {\n        label: '售卖订单',\n        route: {\n          name: 'shop-staff-info-sold',\n          query: { id: this.$searchQuery.id }\n        }\n      },\n      member: {\n        label: '服务课程',\n        route: {\n          name: 'shop-staff-info-member',\n          query: { id: this.$searchQuery.id }\n        }\n      },\n      tabList: []\n    }\n  },\n  computed: {\n    image_avatar_url() {\n      return (\n        (this.info &&\n          this.info.image_avatar &&\n          this.info.image_avatar.image_url) ||\n        ''\n      )\n    },\n    btnOptions() {\n      return [\n        {\n          text: '编辑资料',\n          click: this.editStaffInfo,\n          if: this.auth['shop:staff:staff|edit']\n        },\n        {\n          text: '绑定实体卡',\n          click: this.openModalBindCard,\n          if: this.auth['shop:staff:staff|bind_card']\n        },\n        {\n          text: '重绑实体卡',\n          click: this.openModalRebindCard,\n          if: this.auth['shop:staff:staff|rebind_card']\n        },\n        {\n          text: '职位和薪资变更',\n          click: this.openModalPosition,\n          if: this.auth['shop:staff:staff|position']\n        },\n        {\n          text: '离职',\n          click: this.openModalLeave,\n          if: this.auth['shop:staff:staff|leave']\n        },\n        {\n          text: '复职',\n          click: this.openModalReinstate,\n          if: this.auth['shop:staff:staff|reinstate']\n        },\n        {\n          text: '管理登录账户',\n          click: this.openModalSave,\n          if: this.auth['shop:staff:account|save']\n        },\n        {\n          text: '设置提现账户',\n          click: this.openModalSalary,\n          if: this.auth['shop:staff:staff|salary']\n        },\n        {\n          text: '解除门店关系',\n          click: this.openModalShopLeave,\n          if: this.auth['shop:staff:staff|shop_leave']\n        },\n        {\n          text: '清空指纹信息',\n          click: this.onClearFingerprintInfo,\n          if: this.auth['shop:staff:staff|finger_del']\n        },\n        {\n          text: '清空硬件密码',\n          click: this.onClearHardwarePassword,\n          if: this.auth['shop:staff:staff|cabinet_pwd_del']\n        }\n      ]\n    }\n  },\n  created() {\n    // 团课教练：上课记录\n    // 私教教练：上课记录、跟进记录、服务课程 、销售订单\n    // 会籍销售：跟进记录、服务课程 、销售订单\n    // 1,普通员工 2-会籍销售；3-团课教练；4-私人教练\n    let { identity } = this.info\n    identity = identity.map(item => item.id)\n    let tabSet = new Set()\n    this.setIndentyList(['basic'], tabSet)\n    if (Array.isArray(identity) && identity.length) {\n      identity.forEach(ele => {\n        if (ele === 2) {\n          this.setIndentyList(['member', 'sold'], tabSet)\n        } else if (ele === 3) {\n          this.setIndentyList(['course'], tabSet)\n        } else if (ele === 4) {\n          this.setIndentyList(['course', 'follow', 'member', 'sold'], tabSet)\n        }\n      })\n    }\n    this.tabList = Array.from(tabSet).map(key => this[key])\n  },\n  methods: {\n    setIndentyList(arr, targetArr) {\n      arr.forEach(key => targetArr.add(key, this[key]))\n    },\n    openModal(modalType) {\n      const modalPathList = {\n        bind_card: 'shop-staff-bind-card',\n        rebind_card: 'shop-staff-bind-card',\n        leave: 'shop-staff-turnover',\n        reinstate: 'shop-staff-reinstatement',\n        save: 'shop-staff-re-password',\n        position: 'shop-staff-update-staff-position',\n        salary: 'shop-staff-salary-account-setting',\n        shop_leave: 'shop-staff-leave-current-shop'\n      }\n      const name = modalPathList[modalType]\n      this.$modalRouter.push({\n        name,\n        props: { staff: this.info }\n      })\n    },\n    openModalBindCard() {\n      this.openModal('bind_card')\n    },\n    openModalRebindCard() {\n      this.openModal('rebind_card')\n    },\n    openModalLeave() {\n      this.openModal('leave')\n    },\n    openModalReinstate() {\n      this.openModal('reinstate')\n    },\n    openModalSave() {\n      this.openModal('save')\n    },\n    openModalPosition() {\n      this.openModal('position')\n    },\n    openModalSalary() {\n      this.openModal('salary')\n    },\n    openModalShopLeave() {\n      this.openModal('shop_leave')\n    },\n    editStaffInfo() {\n      this.$router.push({\n        name: 'shop-staff-edit',\n        query: { id: this.info.id }\n      })\n    },\n    // 清空指纹信息\n    onClearFingerprintInfo() {\n      this.$confirm({\n        title: '提示信息',\n        content: '确认清空指纹信息？',\n        onOk: () => {\n          this.infoService.deleteStaffFinger(this.info.id).subscribe()\n        }\n      })\n    },\n    // 清空硬件密码\n    onClearHardwarePassword() {\n      this.$confirm({\n        title: '提示信息',\n        content: '确认清空硬件密码吗？',\n        onOk: () => {\n          this.infoService.deleteStaffCabinetPassword(this.info.id).subscribe()\n        }\n      })\n    }\n  }\n}\n</script>\n"]}]}