{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js!/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhigang/Desktop/styd/web/src/views/pages/shop/reception/reserve/course.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/pages/shop/reception/reserve/course.vue","mtime":1600926556435},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js","mtime":1591062572376}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport tableMixin from '@/mixins/table.mixin';\nimport { mainColumns, childColumns } from \"./course.config\";\nimport { CourseService } from \"./course.service\";\nimport RecentRadioGroup from '@/views/components/recent-radio-group/recent-radio-group';\nimport moment from 'moment';\nexport default {\n  name: '',\n  bem: {\n    b: 'shop-reception-reserve-course'\n  },\n  components: {\n    RecentRadioGroup: RecentRadioGroup\n  },\n  modals: {},\n  serviceInject: function serviceInject() {\n    return {\n      courseService: CourseService\n    };\n  },\n  rxState: function rxState() {\n    var courseService = this.courseService;\n    return {\n      list: courseService.list$,\n      page: courseService.page$,\n      loading: courseService.loading$,\n      auth: courseService.auth$,\n      courseTypeOptions: courseService.courseTypeOptions$,\n      reserveStatusOptions: courseService.reserveStatusOptions$,\n      checkinOptions: courseService.checkinOptions$\n    };\n  },\n  mixins: [tableMixin],\n  props: {},\n  data: function data() {\n    return {\n      reserveQuery: {\n        end_time: '',\n        search_date: 1,\n        start_time: ''\n      },\n      customRadioDays: [{\n        value: 1,\n        label: '今日'\n      }, {\n        value: 2,\n        label: '昨日'\n      }, {\n        value: 3,\n        label: '明日'\n      }]\n    };\n  },\n  computed: {\n    mainColumns: mainColumns,\n    childColumns: childColumns\n  },\n  mounted: function mounted() {},\n  methods: {\n    moment: moment,\n    recentChange: function recentChange(data) {\n      var start_time = data.start_date ? \"\".concat(data.start_date, \" 00:00\") : '';\n      var end_time = data.end_date ? \"\".concat(data.end_date, \" 23:59\") : '';\n      var recently_day = data.recently_day;\n      this.$searchQuery.search_date = recently_day || undefined;\n      this.$searchQuery.start_time = start_time || undefined;\n      this.$searchQuery.end_time = end_time || undefined;\n\n      if (this.$searchQuery.start_time || this.$searchQuery.end_time) {\n        this.$searchQuery.search_date = undefined;\n        recently_day = undefined;\n      }\n\n      this.reserveQuery = {\n        start_time: start_time,\n        end_time: end_time,\n        search_date: recently_day\n      };\n      this.onMultiSearch(this.reserveQuery);\n    },\n    getCourseForm: function getCourseForm(record, index) {\n      var id = record.id,\n          member = record.member;\n      var reserve_type = this.list[index].sub_reserve_type;\n      return {\n        id: member.id,\n        reserve_type: reserve_type.id,\n        reserve_id: id\n      };\n    },\n    // 取消签到\n    cancelBooking: function cancelBooking(record, index) {\n      var _this = this;\n\n      var params = this.getCourseForm(record, index);\n      this.courseService.cancelVisitReserve(params).subscribe(function (res) {\n        _this.$router.reload();\n      });\n    },\n    // 签到\n    booking: function booking(record, index) {\n      var _this2 = this;\n\n      var params = this.getCourseForm(record, index);\n      this.courseService.confirmVisitReserve(params).subscribe(function (res) {\n        _this2.$router.reload();\n      });\n    },\n    onPrint: function onPrint(id) {\n      window.open('/ticket/print?id=' + id, '_blank', 'width=800,height=600');\n    },\n    onSearch: function onSearch() {\n      this.$router.push({\n        query: this.$searchQuery\n      });\n    },\n    disabledDate: function disabledDate(current) {\n      return current && current > moment().add(6, 'months');\n    }\n  }\n};",{"version":3,"sources":["course.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div :class=\"b()\">\n    <st-table-header-section class=\"mg-b16\" :class=\"b('nav')\">\n      <st-button\n        type=\"primary\"\n        v-if=\"auth.export\"\n        v-export-excel=\"{\n          type: 'reserve',\n          query: reserveQuery\n        }\"\n        class=\"mg-r8\"\n      >\n        全部导出\n      </st-button>\n      <div :class=\"b('actions')\" slot=\"actions\">\n        <recent-radio-group\n          _day=\"search_date\"\n          _start_date=\"start_time\"\n          _end_date=\"end_time\"\n          :showBtnRangeDate=\"false\"\n          :defaultRecent=\"1\"\n          :disabledDate=\"disabledDate\"\n          :days=\"customRadioDays\"\n          @change=\"recentChange\"\n        ></recent-radio-group>\n      </div>\n      <!-- 课程类型 -->\n      <a-select\n        class=\"mg-r8\"\n        v-model=\"$searchQuery.course_type\"\n        :options=\"courseTypeOptions\"\n        style=\"width: 140px\"\n        @change=\"onSearch\"\n      ></a-select>\n      <!-- 预约状态 -->\n      <a-select\n        class=\"mg-r8\"\n        v-model=\"$searchQuery.reserve_status\"\n        :options=\"reserveStatusOptions\"\n        style=\"width: 140px\"\n        @change=\"onSearch\"\n      ></a-select>\n      <!-- 签到状态 -->\n      <a-select\n        class=\"mg-r8\"\n        v-model=\"$searchQuery.is_checkin\"\n        :options=\"checkinOptions\"\n        style=\"width: 140px\"\n        @change=\"onSearch\"\n      ></a-select>\n    </st-table-header-section>\n    <div :class=\"b('table')\">\n      <st-table\n        :page=\"page\"\n        @change=\"onTableChange\"\n        :loading=\"loading.getList\"\n        :columns=\"mainColumns\"\n        :dataSource=\"list\"\n        :stripe=\"false\"\n        rowKey=\"id\"\n      >\n        <template slot=\"sub_reserve_type\" slot-scope=\"record\">\n          {{ record.name }}\n        </template>\n        <template slot=\"remark\" slot-scope=\"record\">\n          <st-overflow-text\n            :value=\"record.remark\"\n            maxWidth=\"200px\"\n            placement=\"bottomLeft\"\n            needOverflowTextContainer\n          ></st-overflow-text>\n        </template>\n        <st-table\n          class=\"reserve-course-child-table\"\n          slot=\"expandedRowRender\"\n          slot-scope=\"record, index\"\n          :columns=\"childColumns\"\n          :dataSource=\"record.list\"\n          :pagination=\"false\"\n          rowKey=\"id\"\n        >\n          <span slot=\"member\" slot-scope=\"record\">{{ record.name }}</span>\n          <template slot=\"reserve_status\" slot-scope=\"record\">\n            {{ record.name }}\n          </template>\n          <template slot=\"is_checkin\" slot-scope=\"record\">\n            {{ record.name }}\n          </template>\n          <template slot=\"checkin_method\" slot-scope=\"record\">\n            {{ record.name }}\n          </template>\n          <div slot=\"action\" slot-scope=\"text, record\">\n            <st-table-actions>\n              <a\n                v-if=\"record.auth['shop:reserve:course_reserve|del']\"\n                @click=\"cancelBooking(record, index)\"\n              >\n                取消预约\n              </a>\n              <a\n                v-if=\"record.auth['shop:reserve:course_reserve|checkin']\"\n                @click=\"booking(record, index)\"\n              >\n                签到\n              </a>\n              <a\n                @click=\"onPrint(record.id)\"\n                v-if=\"\n                  record.reserve_status.id === 1 && record.is_checkin.id === 1\n                \"\n              >\n                打印小票\n              </a>\n            </st-table-actions>\n          </div>\n        </st-table>\n      </st-table>\n    </div>\n  </div>\n</template>\n\n<script>\nimport tableMixin from '@/mixins/table.mixin'\nimport { mainColumns, childColumns } from './course.config'\nimport { CourseService } from './course.service'\nimport RecentRadioGroup from '@/views/components/recent-radio-group/recent-radio-group'\nimport moment from 'moment'\n\nexport default {\n  name: '',\n\n  bem: {\n    b: 'shop-reception-reserve-course'\n  },\n\n  components: { RecentRadioGroup },\n\n  modals: {},\n\n  serviceInject() {\n    return {\n      courseService: CourseService\n    }\n  },\n\n  rxState() {\n    const { courseService } = this\n    return {\n      list: courseService.list$,\n      page: courseService.page$,\n      loading: courseService.loading$,\n      auth: courseService.auth$,\n      courseTypeOptions: courseService.courseTypeOptions$,\n      reserveStatusOptions: courseService.reserveStatusOptions$,\n      checkinOptions: courseService.checkinOptions$\n    }\n  },\n\n  mixins: [tableMixin],\n\n  props: {},\n\n  data() {\n    return {\n      reserveQuery: {\n        end_time: '',\n        search_date: 1,\n        start_time: ''\n      },\n      customRadioDays: [\n        {\n          value: 1,\n          label: '今日'\n        },\n        {\n          value: 2,\n          label: '昨日'\n        },\n        {\n          value: 3,\n          label: '明日'\n        }\n      ]\n    }\n  },\n\n  computed: {\n    mainColumns,\n    childColumns\n  },\n\n  mounted() {},\n\n  methods: {\n    moment,\n    recentChange(data) {\n      const start_time = data.start_date ? `${data.start_date} 00:00` : ''\n      const end_time = data.end_date ? `${data.end_date} 23:59` : ''\n      let recently_day = data.recently_day\n      this.$searchQuery.search_date = recently_day || undefined\n      this.$searchQuery.start_time = start_time || undefined\n      this.$searchQuery.end_time = end_time || undefined\n      if (this.$searchQuery.start_time || this.$searchQuery.end_time) {\n        this.$searchQuery.search_date = undefined\n        recently_day = undefined\n      }\n      this.reserveQuery = {\n        start_time: start_time,\n        end_time: end_time,\n        search_date: recently_day\n      }\n      this.onMultiSearch(this.reserveQuery)\n    },\n    getCourseForm(record, index) {\n      const { id, member } = record\n      let reserve_type = this.list[index].sub_reserve_type\n      return {\n        id: member.id,\n        reserve_type: reserve_type.id,\n        reserve_id: id\n      }\n    },\n    // 取消签到\n    cancelBooking(record, index) {\n      let params = this.getCourseForm(record, index)\n      this.courseService.cancelVisitReserve(params).subscribe(res => {\n        this.$router.reload()\n      })\n    },\n    // 签到\n    booking(record, index) {\n      let params = this.getCourseForm(record, index)\n      this.courseService.confirmVisitReserve(params).subscribe(res => {\n        this.$router.reload()\n      })\n    },\n    onPrint(id) {\n      window.open('/ticket/print?id=' + id, '_blank', 'width=800,height=600')\n    },\n    onSearch() {\n      this.$router.push({ query: this.$searchQuery })\n    },\n    disabledDate(current) {\n      return current && current > moment().add(6, 'months')\n    }\n  }\n}\n</script>\n\n<style lang=\"less\" scoped></style>\n"],"sourceRoot":"src/views/pages/shop/reception/reserve"}]}