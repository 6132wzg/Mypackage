{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js!/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhigang/Desktop/styd/web/src/views/biz-components/schedule/date#/month-board.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/biz-components/schedule/date#/month-board.vue","mtime":1591147717112},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js","mtime":1591062572376}],"contextDependencies":[],"result":["import \"core-js/modules/es7.object.get-own-property-descriptors\";\nimport \"core-js/modules/es6.object.keys\";\nimport _defineProperty from \"/Users/wangzhigang/Desktop/styd/web/node_modules/@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.array.find-index\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport moment from 'moment';\nexport default {\n  name: 'MonthBoard',\n  bem: {\n    basic: 'months-group-board',\n    bHeader: 'board-header',\n    boardContent: 'board-content',\n    dayContent: 'day-content',\n    popoverBox: 'popover-box',\n    addBtnContent: 'add-btn-content'\n  },\n  props: {\n    addTitle: {\n      type: String,\n      default: '新增团体课'\n    },\n    courses: {\n      type: Array,\n      default: function _default() {\n        return [];\n      }\n    }\n  },\n  watch: {\n    $route: function $route(val) {\n      this.init();\n    },\n    courses: function courses() {\n      this.getCoursesList();\n    }\n  },\n  data: function data() {\n    return {\n      date: '',\n      // 星期一到星期日文字\n      weekList: moment().localeData().weekdays(),\n      // 日列表\n      dayList: []\n    };\n  },\n  created: function created() {\n    this.init();\n    this.getCoursesList();\n  },\n  methods: {\n    onPopoverMouseEnter: function onPopoverMouseEnter(day) {\n      day.popoverShow = true;\n    },\n    init: function init() {\n      this.date = this.$searchQuery.start_date;\n      this.dayList = this.getCurrentMonthDayList();\n    },\n    getCurrentMonthDayList: function getCurrentMonthDayList() {\n      // 当前日期的月份\n      var nowMonth = moment(this.date).month();\n      var dates = [];\n\n      for (var i = 0; i < 42; i++) {\n        var startDate = moment(this.date).date(1);\n        startDate.startOf('week');\n        dates[i] = startDate.weekday(i - 1);\n      } // 判断当前是否含有上个月7天的数据，如果有则删除\n\n\n      var startOfMonth = moment(this.date).startOf('month').format('YYYY-MM-DD');\n      var firstDay = dates.findIndex(function (item) {\n        return item.format('YYYY-MM-DD') === startOfMonth;\n      });\n\n      if (firstDay > 6) {\n        dates = dates.slice(7, dates.length);\n      } // 判断是否包含下个月7天的数据，如果有则删除\n\n\n      var startOfNextMonth = moment(this.date).month(moment(this.date).month() + 1).startOf('month').format('YYYY-MM-DD');\n      var nextMonthFirstDay = dates.findIndex(function (item) {\n        return item.format('YYYY-MM-DD') === startOfNextMonth;\n      });\n\n      if (nextMonthFirstDay !== -1 && dates.length - nextMonthFirstDay > 6) {\n        dates = dates.slice(0, dates.length - 7);\n      }\n\n      return dates.map(function (item) {\n        return {\n          date: item.date(),\n          fullDate: item.format('YYYY-MM-DD'),\n          current: item.format('YYYY-MM-DD') === moment().format('YYYY-MM-DD'),\n          isThisMonth: item.month() === nowMonth,\n          addBtnShow: false,\n          popoverShow: false,\n          courses: []\n        };\n      });\n    },\n    onMouseMove: function onMouseMove(day, er) {\n      if (day.courses.length !== 0) {\n        day.popoverShow = true;\n        return;\n      }\n\n      this.dayList.forEach(function (item) {\n        item.addBtnShow = item.fullDate === day.fullDate ? true : false;\n      });\n    },\n    onMouseLeave: function onMouseLeave(day) {\n      day.addBtnShow = false;\n    },\n    onClickAddBtn: function onClickAddBtn(e) {\n      this.$emit('onClickAddBtn', {\n        date: e.date,\n        fullDate: e.fullDate\n      });\n    },\n    hidePopover: function hidePopover(e) {\n      e.popoverShow = false;\n    },\n    onClickCourse: function onClickCourse(e) {\n      this.$emit('onClickCourse', _objectSpread({}, e));\n    },\n    getCoursesList: function getCoursesList() {\n      var _this = this;\n\n      this.dayList.forEach(function (day) {\n        _this.courses.forEach(function (course) {\n          if (day.fullDate === course.start_date) {\n            day.courses.push(course);\n          }\n        });\n      });\n    }\n  }\n};",{"version":3,"sources":["month-board.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div :class=\"basic()\">\n    <ul :class=\"bHeader()\">\n      <li :class=\"bHeader('item')\" v-for=\"(week, key) in weekList\" :key=\"key\">\n        {{ week }}\n      </li>\n    </ul>\n    <ul\n      :class=\"[\n        boardContent(),\n        { [boardContent('table', { small: true })]: dayList.length < 42 }\n      ]\"\n    >\n      <li\n        v-for=\"(day, key) in dayList\"\n        :key=\"key\"\n        :class=\"[\n          boardContent('day-item'),\n          { [boardContent('day-item', { current: true })]: day.current },\n          { [boardContent('day-item', { gray: true })]: !day.isThisMonth }\n        ]\"\n      >\n        <div\n          :class=\"boardContent('item-content')\"\n          @mouseover=\"onMouseMove(day)\"\n          @mouseleave=\"onMouseLeave(day)\"\n        >\n          <a-popover\n            placement=\"right\"\n            v-if=\"!day.addBtnShow\"\n            v-model=\"day.popoverShow\"\n            :class=\"boardContent('hover-content')\"\n          >\n            <!-- popover content -->\n            <span\n              slot=\"content\"\n              :class=\"popoverBox()\"\n              @mouseenter=\"onPopoverMouseEnter(day)\"\n              @click=\"hidePopover(day)\"\n            >\n              <st-button\n                :class=\"popoverBox('hover-add-btn')\"\n                type=\"default\"\n                plain\n                @click=\"onClickAddBtn(day)\"\n              >\n                <st-icon type=\"add\" size=\"12px\" color=\"#3E4D5C\"></st-icon>\n                新增排期\n              </st-button>\n              <div :class=\"popoverBox('course-list')\">\n                <div\n                  :class=\"popoverBox('list-item')\"\n                  v-for=\"course in day.courses\"\n                  :key=\"course.id\"\n                  @click=\"onClickCourse(course)\"\n                >\n                  <div\n                    :class=\"\n                      course.schedule_status <= 2\n                        ? [\n                            popoverBox('item-point'),\n                            popoverBox('item-point--active')\n                          ]\n                        : popoverBox('item-point')\n                    \"\n                  ></div>\n                  <div :class=\"popoverBox('item-text')\">\n                    {{ course.course_name }}\n                  </div>\n                </div>\n              </div>\n            </span>\n            <!-- popover element -->\n            <div\n              :class=\"dayContent()\"\n              @mouseover=\"onMouseMove(day)\"\n              @mouseleave=\"onMouseLeave(day)\"\n            >\n              <div :class=\"dayContent('popover')\">\n                <div class=\"font-number\">{{ day.date }}</div>\n                <div\n                  v-for=\"(course, key) in day.courses.slice(0, 2)\"\n                  :key=\"key\"\n                  :class=\"dayContent('course-item')\"\n                >\n                  <div\n                    :class=\"\n                      course.schedule_status <= 2\n                        ? [dayContent('point--active'), dayContent('point')]\n                        : dayContent('point')\n                    \"\n                  ></div>\n                  <div :class=\"dayContent('course-name')\">\n                    {{ course.course_name }}\n                  </div>\n                </div>\n                <div\n                  :class=\"dayContent('bottom-text')\"\n                  v-if=\"day.courses.length > 2\"\n                >\n                  还有{{ day.courses.length - 2 }}节课程\n                </div>\n              </div>\n            </div>\n          </a-popover>\n          <div\n            :class=\"addBtnContent()\"\n            @mouseover=\"onMouseMove(day)\"\n            @mouseleave=\"onMouseLeave(day)\"\n            @click=\"onClickAddBtn(day)\"\n            v-if=\"!day.courses.length && day.addBtnShow\"\n          >\n            <div :class=\"addBtnContent('add-btn')\">\n              <div class=\"mg-b8\" :class=\"addBtnContent('icon')\">\n                <st-icon type=\"add\"></st-icon>\n              </div>\n              <div :class=\"addBtnContent('text')\">{{ addTitle }}</div>\n            </div>\n          </div>\n        </div>\n      </li>\n    </ul>\n  </div>\n</template>\n<script>\nimport moment from 'moment'\n\nexport default {\n  name: 'MonthBoard',\n  bem: {\n    basic: 'months-group-board',\n    bHeader: 'board-header',\n    boardContent: 'board-content',\n    dayContent: 'day-content',\n    popoverBox: 'popover-box',\n    addBtnContent: 'add-btn-content'\n  },\n  props: {\n    addTitle: {\n      type: String,\n      default: '新增团体课'\n    },\n    courses: {\n      type: Array,\n      default: () => {\n        return []\n      }\n    }\n  },\n  watch: {\n    $route(val) {\n      this.init()\n    },\n    courses() {\n      this.getCoursesList()\n    }\n  },\n  data() {\n    return {\n      date: '',\n      // 星期一到星期日文字\n      weekList: moment()\n        .localeData()\n        .weekdays(),\n      // 日列表\n      dayList: []\n    }\n  },\n  created() {\n    this.init()\n    this.getCoursesList()\n  },\n  methods: {\n    onPopoverMouseEnter(day) {\n      day.popoverShow = true\n    },\n    init() {\n      this.date = this.$searchQuery.start_date\n      this.dayList = this.getCurrentMonthDayList()\n    },\n    getCurrentMonthDayList() {\n      // 当前日期的月份\n      const nowMonth = moment(this.date).month()\n      let dates = []\n      for (let i = 0; i < 42; i++) {\n        const startDate = moment(this.date).date(1)\n        startDate.startOf('week')\n        dates[i] = startDate.weekday(i - 1)\n      }\n      // 判断当前是否含有上个月7天的数据，如果有则删除\n      const startOfMonth = moment(this.date)\n        .startOf('month')\n        .format('YYYY-MM-DD')\n      const firstDay = dates.findIndex(item => {\n        return item.format('YYYY-MM-DD') === startOfMonth\n      })\n      if (firstDay > 6) {\n        dates = dates.slice(7, dates.length)\n      }\n      // 判断是否包含下个月7天的数据，如果有则删除\n      const startOfNextMonth = moment(this.date)\n        .month(moment(this.date).month() + 1)\n        .startOf('month')\n        .format('YYYY-MM-DD')\n      const nextMonthFirstDay = dates.findIndex(item => {\n        return item.format('YYYY-MM-DD') === startOfNextMonth\n      })\n      if (nextMonthFirstDay !== -1 && dates.length - nextMonthFirstDay > 6) {\n        dates = dates.slice(0, dates.length - 7)\n      }\n      return dates.map(item => {\n        return {\n          date: item.date(),\n          fullDate: item.format('YYYY-MM-DD'),\n          current: item.format('YYYY-MM-DD') === moment().format('YYYY-MM-DD'),\n          isThisMonth: item.month() === nowMonth,\n          addBtnShow: false,\n          popoverShow: false,\n          courses: []\n        }\n      })\n    },\n    onMouseMove(day, er) {\n      if (day.courses.length !== 0) {\n        day.popoverShow = true\n        return\n      }\n      this.dayList.forEach(item => {\n        item.addBtnShow = item.fullDate === day.fullDate ? true : false\n      })\n    },\n    onMouseLeave(day) {\n      day.addBtnShow = false\n    },\n    onClickAddBtn(e) {\n      this.$emit('onClickAddBtn', {\n        date: e.date,\n        fullDate: e.fullDate\n      })\n    },\n    hidePopover(e) {\n      e.popoverShow = false\n    },\n    onClickCourse(e) {\n      this.$emit('onClickCourse', {\n        ...e\n      })\n    },\n    getCoursesList() {\n      this.dayList.forEach(day => {\n        this.courses.forEach(course => {\n          if (day.fullDate === course.start_date) {\n            day.courses.push(course)\n          }\n        })\n      })\n    }\n  }\n}\n</script>\n"],"sourceRoot":"src/views/biz-components/schedule/date#"}]}