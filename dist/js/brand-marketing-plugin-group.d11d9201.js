(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["brand-marketing-plugin-group"],{"0c7b":function(t,e,i){"use strict";i.d(e,"b",(function(){return a})),i.d(e,"a",(function(){return n}));var r=i("4ba8"),a=function(t){t.pattern;var e=Object(r["a"])(t);return Object.assign(e,{cardId:{rules:[{required:!0,message:"请选择".concat(t.$c("member_card"))}]}})},n=[{title:"期限/次数",dataIndex:"spec",width:"22%",align:"center"},{title:"原价",dataIndex:"price",align:"center",width:"22%"},{title:"拼团价",dataIndex:"group_price",width:"38%",align:"center",slots:{title:"group_price"},scopedSlots:{customRender:"group_price"}}]},"0f06":function(t,e,i){t.exports=i.p+"img/mod_course.a69f7776.png"},"11f9":function(t,e,i){t.exports=i.p+"img/mod_member.30f6bd5f.png"},"1b9b":function(t,e,i){"use strict";i.r(e),i.d(e,"EditDepositService",(function(){return p}));var r,a=i("d225"),n=i("b0b4"),o=i("9ab4"),s=i("0cd5"),c=i("df29"),u=i("d042"),d=i("c4cc"),l=i("c170"),p=function(){function t(e){Object(a["a"])(this,t),this.groupBuyApi=e,this.loading$=new c["d"]({}),this.info$=new c["d"]({}),this.list$=new c["d"]({})}return Object(n["a"])(t,[{key:"getStoredData",value:function(t){var e=this;return this.groupBuyApi.getStoredData(t).pipe(Object(d["a"])((function(t){e.info$.commit((function(){return t.info}))})))}},{key:"getDepositList",value:function(){var t=this;return this.groupBuyApi.getDepositList().pipe(Object(d["a"])((function(e){t.list$.commit((function(){return e}))})))}},{key:"editGroup",value:function(t){return this.groupBuyApi.editGroup(t)}},{key:"init",value:function(t){return Object(l["a"])(this.getStoredData(t),this.getDepositList())}},{key:"beforeRouteEnter",value:function(t,e){return this.init(t.meta.query.id)}}]),t}();Object(o["b"])([Object(c["c"])(),Object(o["d"])("design:type",Function),Object(o["d"])("design:paramtypes",[Object]),Object(o["d"])("design:returntype",void 0)],p.prototype,"init",null),p=Object(o["b"])([Object(s["b"])(),Object(o["d"])("design:paramtypes",["function"===typeof(r="undefined"!==typeof u["c"]&&u["c"])?r:Object])],p)},"1f01":function(t,e,i){"use strict";i.d(e,"b",(function(){return a})),i.d(e,"a",(function(){return n}));var r=i("4ba8"),a=function(t){t.pattern;var e=Object(r["a"])(t);return Object.assign(e,{shop_id:{rules:[{required:!0,message:"请选择拼团门店"}]},course_id:{rules:[{required:!0,message:"请选择课程包"}]}})},n=[{title:"原价",dataIndex:"price",width:"60%",align:"center"},{title:"拼团价",dataIndex:"group_price",width:"40%",slots:{title:"group_price"},scopedSlots:{customRender:"group_price"}}]},2659:function(t,e,i){"use strict";i.r(e),i.d(e,"EditMemberService",(function(){return h}));var r,a,n=i("d225"),o=i("b0b4"),s=i("9ab4"),c=i("0cd5"),u=i("df29"),d=i("d042"),l=i("c4cc"),p=i("c170"),h=function(){function t(e){Object(n["a"])(this,t),this.groupBuyApi=e,this.loading$=new u["d"]({}),this.info$=new u["d"]({}),this.memberList$=new u["d"]([])}return Object(o["a"])(t,[{key:"getStoredData",value:function(t){var e=this;return this.groupBuyApi.getStoredData(t).pipe(Object(l["a"])((function(t){e.info$.commit((function(){return t.info}))})))}},{key:"editGroup",value:function(t){return this.groupBuyApi.editGroup(t)}},{key:"getMemberList",value:function(){var t=this;return this.groupBuyApi.getMemberList().pipe(Object(l["a"])((function(e){t.memberList$.commit((function(){return e.list}))})))}},{key:"init",value:function(t){return Object(p["a"])(this.getStoredData(t),this.getMemberList())}},{key:"beforeRouteEnter",value:function(t,e){return this.init(t.meta.query.id)}}]),t}();Object(s["b"])([Object(u["c"])(),Object(s["d"])("design:type",Function),Object(s["d"])("design:paramtypes",["function"===typeof(r="undefined"!==typeof d["EditParams"]&&d["EditParams"])?r:Object]),Object(s["d"])("design:returntype",void 0)],h.prototype,"editGroup",null),Object(s["b"])([Object(u["c"])(),Object(s["d"])("design:type",Function),Object(s["d"])("design:paramtypes",[]),Object(s["d"])("design:returntype",void 0)],h.prototype,"getMemberList",null),Object(s["b"])([Object(u["c"])(),Object(s["d"])("design:type",Function),Object(s["d"])("design:paramtypes",[Object]),Object(s["d"])("design:returntype",void 0)],h.prototype,"init",null),h=Object(s["b"])([Object(c["b"])(),Object(s["d"])("design:paramtypes",["function"===typeof(a="undefined"!==typeof d["c"]&&d["c"])?a:Object])],h)},"2a44":function(t,e,i){"use strict";i.r(e),i.d(e,"AddPackageCourseService",(function(){return p}));var r,a,n=i("d225"),o=i("b0b4"),s=i("9ab4"),c=i("0cd5"),u=i("df29"),d=i("d042"),l=i("c4cc"),p=function(){function t(e){Object(n["a"])(this,t),this.groupBuyApi=e,this.loading$=new u["d"]({}),this.courseList$=new u["d"]({})}return Object(o["a"])(t,[{key:"getCourseList",value:function(t){var e=this;return this.groupBuyApi.getCourseList(t).pipe(Object(l["a"])((function(t){e.courseList$.commit((function(){return t.list}))})))}},{key:"createGroupbuy",value:function(t){return this.groupBuyApi.addGroup(t)}}]),t}();Object(s["b"])([Object(u["c"])(),Object(s["d"])("design:type",Function),Object(s["d"])("design:paramtypes",[Object]),Object(s["d"])("design:returntype",void 0)],p.prototype,"getCourseList",null),Object(s["b"])([Object(u["c"])(),Object(s["d"])("design:type",Function),Object(s["d"])("design:paramtypes",["function"===typeof(r="undefined"!==typeof d["AddParams"]&&d["AddParams"])?r:Object]),Object(s["d"])("design:returntype",void 0)],p.prototype,"createGroupbuy",null),p=Object(s["b"])([Object(c["b"])(),Object(s["d"])("design:paramtypes",["function"===typeof(a="undefined"!==typeof d["c"]&&d["c"])?a:Object])],p)},"2d8e":function(t,e,i){"use strict";i.r(e);var r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("group-form",{attrs:{form:t.form,decorators:t.decorators,loading:t.loading.addGroup,isEdit:!0,info:t.info,confirmLoading:t.loading.editGroupbuy,showSelectShop:!1},on:{onsubmit:t.onSubmit}},[i("template",{slot:"choose-product"},[i("a-row",{attrs:{gutter:8}},[i("a-col",{attrs:{span:10}},[i("st-form-item",{attrs:{required:""}},[i("span",{attrs:{slot:"label"},slot:"label"},[t._v("\n            拼团门店\n            "),i("st-help-tooltip",{attrs:{id:"TBPTXJ005"}})],1),i("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.shop_id,expression:"decorators.shop_id"}],attrs:{showSearch:"",disabled:t.disabledEdit},on:{change:t.changeShop}},t._l(t.shopList,(function(e){return i("a-select-option",{key:e.shop_id,attrs:{value:e.shop_id}},[t._v("\n              "+t._s(e.shop_name)+"\n            ")])})),1)],1)],1)],1),i("a-row",{attrs:{gutter:8}},[i("a-col",{attrs:{span:10}},[i("st-form-item",{attrs:{label:"选择课程包",required:""}},[i("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.course_id,expression:"decorators.course_id"}],attrs:{showSearch:"",disabled:t.disabledEdit},on:{change:t.changeCourse}},t._l(t.courseList,(function(e){return i("a-select-option",{key:e.id,attrs:{value:e.id}},[t._v("\n              "+t._s(e.product_name)+"\n            ")])})),1)],1)],1)],1),i("a-row",{attrs:{gutter:8}},[i("a-col",{attrs:{span:16}},[i("st-form-item",{attrs:{label:"优惠设置",required:"",help:t.tableText,validateStatus:t.tableErr?"error":""}},[i("st-container",[i("st-table",{attrs:{rowKey:"activity_name",columns:t.cardColumns,dataSource:t.tableData,pagination:!1,scroll:{y:230},align:"center"},scopedSlots:t._u([{key:"group_price",fn:function(e,r){return[i("st-input-number",{staticStyle:{width:"110px"},attrs:{float:!0,disabled:t.disabledEdit},on:{input:t.setPriceChange},model:{value:r.group_price,callback:function(e){t.$set(r,"group_price",e)},expression:"record.group_price"}},[i("template",{slot:"addonAfter"},[t._v("\n                    元\n                  ")])],2)]}}])})],1)],1)],1)],1)],1)],2)},a=[],n=(i("c5f6"),i("dcb1")),o=i("1f01"),s=i("a9b8"),c=i("2138"),u=i("6f91"),d=(i("c32d"),i("2527")),l={serviceInject:function(){return{editPackageCourseService:s["EditPackageCourseService"],userService:c["a"],pattern:d["a"]}},rxState:function(){return{loading:this.editPackageCourseService.loading$,shopList:this.userService.shopList$,courseList:this.editPackageCourseService.courseList$,info:this.editPackageCourseService.info$}},mounted:function(){var t=this;this.editPackageCourseService.getCourseList({shop_id:this.info.support_shop[0]}).subscribe((function(e){t.setFieldsValue(),t.tableData=t.info.sku}))},data:function(){var t=this.$stForm.create(),e=t.decorators(o["b"]);return{form:t,decorators:e,cardColumns:o["a"],courseList:[],tableData:[],ACTIVITY_STATUS:u["a"],PRODUCT_TYPE:u["b"],tableText:"",tableErr:!1,disabledEdit:!1,oldStock:Number}},methods:{changeShop:function(t){this.editPackageCourseService.getCourseList({shop_id:t}).subscribe((function(t){}))},changeCourse:function(t){this.tableData=this.courseList.filter((function(e){return e.id===t}))[0].product_spec},setPriceChange:function(){this.tableData[0].group_price?(this.tableText="",this.tableErr=!1):(this.tableText="请输入拼团价格",this.tableErr=!0)},onSubmit:function(t){var e=this;t.id=+this.$route.query.id,t.shop_ids=[+this.form.getFieldValue("shop_id")],t.product_type=u["b"].PACKAGE_COURSE,t.product_id=this.form.getFieldValue("course_id"),t.sku=this.tableData.map((function(t){return{sku_id:e.form.getFieldValue("course_id"),group_price:t.group_price}})),this.editPackageCourseService.editGroupbuy(t).subscribe((function(t){e.$router.push({path:"./list"})}))},setFieldsValue:function(){this.oldStock=this.info.stock_total,this.oldTime=new Date(this.info.end_time),this.form.setFieldsValue({shop_id:this.info.support_shop[0],course_id:this.info.product.id}),this.disabledEdit=this.info.activity_state.id>=u["a"].NO_START}},components:{GroupForm:n["a"]}},p=l,h=i("2877"),f=Object(h["a"])(p,r,a,!1,null,null,null);e["default"]=f.exports},"31e5":function(t,e,i){"use strict";i.r(e),i.d(e,"ListService",(function(){return g}));i("c5f6");var r,a,n,o,s,c=i("d225"),u=i("b0b4"),d=i("9ab4"),l=i("0cd5"),p=i("df29"),h=i("d042"),f=i("c4cc"),b=i("2cbb"),m=i("2138"),g=function(){function t(e,i,r){Object(c["a"])(this,t),this.groupBuyApi=e,this.authService=i,this.userService=r,this.list$=new p["d"]([]),this.page$=new p["d"]({}),this.loading$=new p["d"]({}),this.info$=new p["d"]({}),this.shopList$=new p["d"]([]),this.shopPage$=new p["d"]({}),this.isAuth$=new p["d"]({}),this.groupBuyEnums$=this.userService.getOptions$("group_buy.activity_status",{addAll:!0}),this.auth$=this.authService.authMap$({add:"brand:activity:group_buy|add"})}return Object(u["a"])(t,[{key:"getList",value:function(t){var e=this;return this.groupBuyApi.getList(t).pipe(Object(f["a"])((function(t){e.list$.commit((function(){return t.list})),e.page$.commit((function(){return t.page}))})))}},{key:"stopGroup",value:function(t){return this.groupBuyApi.stopGroupList(t).pipe(Object(f["a"])((function(t){})))}},{key:"releaseGroup",value:function(t){return this.groupBuyApi.releaseGroupList(t).pipe(Object(f["a"])((function(t){})))}},{key:"getSharePosterInfo",value:function(t,e){var i=this;return this.groupBuyApi.getPosterInfo(t,e).pipe(Object(f["a"])((function(t){i.info$.commit((function(){return t.info})),i.isAuth$.commit((function(){return t.is_auth}))})))}},{key:"getShopList",value:function(t,e){var i=this;return this.groupBuyApi.getShopList(e,t).pipe(Object(f["a"])((function(t){i.shopList$.commit((function(){return t.list})),i.shopPage$.commit((function(){return t.page}))})))}},{key:"beforeEach",value:function(t,e){return this.getList(t.meta.query)}}]),t}();Object(d["b"])([Object(p["c"])(),Object(d["d"])("design:type",Function),Object(d["d"])("design:paramtypes",["function"===typeof(r="undefined"!==typeof h["GroupListParams"]&&h["GroupListParams"])?r:Object]),Object(d["d"])("design:returntype",void 0)],g.prototype,"getList",null),Object(d["b"])([Object(p["c"])(),Object(d["d"])("design:type",Function),Object(d["d"])("design:paramtypes",[Number,"function"===typeof(a="undefined"!==typeof h["ShopList"]&&h["ShopList"])?a:Object]),Object(d["d"])("design:returntype",void 0)],g.prototype,"getShopList",null),g=Object(d["b"])([Object(l["b"])(),Object(d["d"])("design:paramtypes",["function"===typeof(n="undefined"!==typeof h["c"]&&h["c"])?n:Object,"function"===typeof(o="undefined"!==typeof b["a"]&&b["a"])?o:Object,"function"===typeof(s="undefined"!==typeof m["a"]&&m["a"])?s:Object])],g)},3253:function(t,e,i){"use strict";i.r(e);var r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("group-form",{attrs:{form:t.form,decorators:t.decorators,isEdit:!0,info:t.info,loading:t.loading.getPersonalDetail,confirmLoading:t.loading.editGroupbuy,shopIds:t.shopIds,groupParams:t.groupParams},on:{onsubmit:t.onSubmit}},[i("template",{slot:"choose-product"},[i("a-row",{attrs:{gutter:8}},[i("a-col",{attrs:{span:10}},[i("st-form-item",{attrs:{label:"选择私教课",required:""}},[i("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.course_id,expression:"decorators.course_id"}],attrs:{showSearch:"",disabled:t.disabledEdit,placeholder:"请选择私教课"},on:{change:t.selectCourseChange}},t._l(t.personalList,(function(e){return i("a-select-option",{key:e.id,attrs:{value:e.id}},[t._v("\n              "+t._s(e.product_name)+"\n            ")])})),1)],1)],1)],1),i("a-row",{attrs:{gutter:8}},[i("a-col",{attrs:{span:10}},[i("st-form-item",{attrs:{label:"拼团课时",required:""}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.group_hour,expression:"decorators.group_hour"}],attrs:{placeholder:"请输入拼团课时",disabled:t.disabledEdit},on:{change:t.changeHour}})],1)],1)],1),i("a-row",{attrs:{gutter:8}},[i("a-col",{attrs:{span:16}},[i("st-form-item",{attrs:{label:"优惠设置",required:"",help:t.tableText,validateStatus:t.tableErr?"error":""}},[i("div",{class:t.basic("table")},[i("st-table",{attrs:{columns:t.cardColumns,dataSource:t.newCoach,pagination:!1,scroll:{y:230},rowSelection:t.newCoach.length>1?{onChange:t.onChange,selectedRowKeys:t.selectedRowKeys,getCheckboxProps:t.getCheckboxProps}:null,rowKey:"id"},scopedSlots:t._u([{key:"group_price",fn:function(e,r){return[i("st-input-number",{staticStyle:{width:"110px"},attrs:{disabled:t.disabledEdit,float:!0},on:{input:t.setPriceChange},model:{value:r.group_price,callback:function(e){t.$set(r,"group_price",e)},expression:"record.group_price"}},[i("template",{slot:"addonAfter"},[t._v("\n                    元\n                  ")])],2)]}}])})],1)])],1)],1)],1)],2)},a=[],n=(i("ac6a"),i("dcb1")),o=i("3def"),s=i("3c6e"),c=i("2527"),u=i("6f91"),d={serviceInject:function(){return{editPersonalService:s["EditPersonalService"],pattern:c["a"]}},rxState:function(){return{loading:this.editPersonalService.loading$,coach:this.editPersonalService.coach$,info:this.editPersonalService.info$,personalList:this.editPersonalService.personalList$}},bem:{basic:"brand-marketing-group-personal"},computed:{cardColumns:o["a"]},mounted:function(){var t=this;this.editPersonalService.getPersonalList().subscribe((function(){t.selectCourseChange(t.info.product.id)}))},data:function(){var t=this.$stForm.create(),e=t.decorators(o["b"]);return{form:t,decorators:e,courseId:"",ACTIVITY_STATUS:u["a"],selectedRowKeys:[],tableText:"",tableErr:!1,shopIds:[],newCoach:[],getCheckboxProps:function(){return{props:{disabled:!0}}},disabledEdit:!1,groupParams:{type:3,id:null}}},methods:{changeHour:function(t){this.groupHour=t.target.value,this.newCoach.forEach((function(e,i){e.hour=t.target.value}))},selectCourseChange:function(t){var e=this;this.form.setFieldsValue({course_id:t,group_hour:this.info.init_course_num}),this.groupParams.id=t,this.editPersonalService.getCoachList(t).subscribe((function(t){e.newCoach=e.coach.map((function(t){return{is_select:!1,level:t.spec,id:t.id,hour:e.info.init_course_num,group_price:""}})),1===e.newCoach.length&&(e.selectedRowKeys=e.newCoach,e.newCoach[0].is_select=!0),e.setFieldsValue(),e.setCoachPrice()}))},setCoachPrice:function(){var t=this;this.newCoach.forEach((function(e){var i=t.info.sku.filter((function(t){return t.sku_id===e.id}));e.is_select=i.length>0,e.group_price=i.length>0?i[0].group_price:""})),this.selectedRowKeys=this.info.sku.map((function(t){return t.sku_id}))},onChange:function(t){var e=this;this.selectedRowKeys=t,this.newCoach.forEach((function(t){t.is_select=-1!==e.selectedRowKeys.indexOf(t.id)}))},setPriceChange:function(){var t=this.newCoach.filter((function(t){return t.is_select})),e=t.filter((function(t){return!t.group_price}));e.length>0?(this.tableText="请输入拼团价格",this.tableErr=!0):(this.tableText="",this.tableErr=!1)},onSubmit:function(t){var e=this;if(!this.tableErr){var i=this.newCoach.filter((function(t){return t.is_select}));if(0===i.length)return this.tableText="请选择至少一个".concat(this.$c("coach")),void(this.tableErr=!0);t.sku=i.map((function(t){return{sku_id:t.id,group_price:t.group_price}})),t.init_course_num=+this.form.getFieldValue("group_hour"),t.product_type=3,t.product_id=+this.form.getFieldValue("course_id"),t.id=+this.$route.query.id,this.editPersonalService.editGroupbuy(t).subscribe((function(t){e.$router.push({path:"/brand/marketing/plugin/group/list"})}))}},setFieldsValue:function(){var t=this;this.newCoach.forEach((function(e){e.is_select=t.info.sku.filter((function(t){return t.sku_id===e.id})).length>0})),this.disabledEdit=this.info.activity_state.id>=u["a"].NO_START,this.getCheckboxProps=function(){return{props:{disabled:t.disabledEdit}}},this.selectedRowKeys=this.newCoach.map((function(t){if(t.is_select)return t.id})),this.form.setFieldsValue({group_hour:this.info.init_course_num})}},components:{GroupForm:n["a"]}},l=d,p=i("2877"),h=Object(p["a"])(l,r,a,!1,null,null,null);e["default"]=h.exports},"3c6e":function(t,e,i){"use strict";i.r(e),i.d(e,"EditPersonalService",(function(){return h}));i("c5f6");var r,a,n=i("d225"),o=i("b0b4"),s=i("9ab4"),c=i("0cd5"),u=i("df29"),d=i("d042"),l=i("c4cc"),p=i("c170"),h=function(){function t(e){Object(n["a"])(this,t),this.groupBuyApi=e,this.info$=new u["d"]({}),this.loading$=new u["d"]({}),this.coach$=new u["d"]({}),this.personalList$=new u["d"]([])}return Object(o["a"])(t,[{key:"getPersonalDetail",value:function(t){var e=this;return this.groupBuyApi.getStoredData(t).pipe(Object(l["a"])((function(t){e.info$.commit((function(){return t.info}))})))}},{key:"getPersonalList",value:function(){var t=this;return this.groupBuyApi.getPersonalList().pipe(Object(l["a"])((function(e){t.personalList$.commit((function(){return e.list}))})))}},{key:"getCoachList",value:function(t){var e=this;return this.groupBuyApi.getCoachList(t).pipe(Object(l["a"])((function(t){e.coach$.commit((function(){return t.list}))})))}},{key:"editGroupbuy",value:function(t){return this.groupBuyApi.editGroup(t)}},{key:"init",value:function(t){return Object(p["a"])(this.getPersonalDetail(t))}},{key:"beforeRouteEnter",value:function(t,e){return this.init(t.meta.query.id)}}]),t}();Object(s["b"])([Object(u["c"])(),Object(s["d"])("design:type",Function),Object(s["d"])("design:paramtypes",[Number]),Object(s["d"])("design:returntype",void 0)],h.prototype,"getPersonalDetail",null),Object(s["b"])([Object(u["c"])(),Object(s["d"])("design:type",Function),Object(s["d"])("design:paramtypes",[]),Object(s["d"])("design:returntype",void 0)],h.prototype,"getPersonalList",null),Object(s["b"])([Object(u["c"])(),Object(s["d"])("design:type",Function),Object(s["d"])("design:paramtypes",[Number]),Object(s["d"])("design:returntype",void 0)],h.prototype,"getCoachList",null),Object(s["b"])([Object(u["c"])(),Object(s["d"])("design:type",Function),Object(s["d"])("design:paramtypes",["function"===typeof(r="undefined"!==typeof d["EditParams"]&&d["EditParams"])?r:Object]),Object(s["d"])("design:returntype",void 0)],h.prototype,"editGroupbuy",null),h=Object(s["b"])([Object(c["b"])(),Object(s["d"])("design:paramtypes",["function"===typeof(a="undefined"!==typeof d["c"]&&d["c"])?a:Object])],h)},"3def":function(t,e,i){"use strict";i.d(e,"b",(function(){return a})),i.d(e,"a",(function(){return n}));i("c5f6");var r=i("4ba8"),a=function(t){var e=Object(r["a"])(t);return Object.assign(e,{course_id:{rules:[{validator:function(t,e,i){if(!e)return"请选择私教课"}}]},group_hour:{rules:[{validator:function(t,e,i){return e&&Number(e)?e>9999999?"拼团课时不能超过9999999，请重新输入":void 0:"请填写拼团课时"}}]}})},n=function(t){return[{title:"".concat(t.$c("coach"),"等级"),dataIndex:"level",width:"22%",align:"center"},{title:"课时",dataIndex:"hour",align:"center",width:"22%"},{title:"拼团价",dataIndex:"group_price",width:"38%",align:"center",slots:{title:"group_price"},scopedSlots:{customRender:"group_price"}}]}},"4ba8":function(t,e,i){"use strict";i("4917");var r=i("c32d"),a=i.n(r);e["a"]=function(t){var e=t.pattern;return{activity_name:{rules:[{validator:function(t,i,r){return i?i.match(e.CN_EN_NUM_SPACE("1-30"))?void 0:"请输入活动名称，支持格式长度1~30中英文":"请填写活动名称"}}]},group_sum:{rules:[{validator:function(t,e,i){return e?e>100?"参团人数不能超过100，请重新输入":e<2?"参团人数不能少于2，请重新输入":void 0:"请填写参团人数"}}]},valid_time:{rules:[{validator:function(t,e,i){return e?e>720?"拼团有效期不能超过720，请重新输入":e<2?"拼团有效期不能少于2，请重新输入":void 0:"请填写拼团有效期"}}]},stock_total:{rules:[{validator:function(e,i,r){return i?i>999999?"活动库存不能超过999999，请重新输入":t.ACTIVITY_STATUS&&t.activityState>t.ACTIVITY_STATUS.PUBLISHER&&i<t.info.stock_total?"活动库存只能增加不可减少":void 0:"请填写活动库存"}}]},activity_time:{rules:[{validator:function(e,i,r){return i?t.ACTIVITY_STATUS&&t.activityState>t.ACTIVITY_STATUS.PUBLISHER&&a()(i[1]).valueOf()<a()(t.info.end_time).valueOf()?"活动时间只能延长不可缩短":void 0:"请填写活动时间"}}]},published_time:{rules:[{validator:function(e,i,r){if(t.$children[0].ACTIVITY_STATUS.TIMING===t.$children[0].activityState&&!i)return"请选择发布时间"}}]}}}},"516c":function(t,e,i){t.exports=i.p+"img/mod_stored.d3c08985.png"},5299:function(t,e,i){"use strict";i.r(e);var r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("group-form",{attrs:{form:t.form,decorators:t.decorators,loading:t.loading.getPersonalList,confirmLoading:t.loading.createGroupbuy,groupParams:t.groupParams},on:{onsubmit:t.onSubmit}},[i("template",{slot:"choose-product"},[i("a-row",{attrs:{gutter:8}},[i("a-col",{attrs:{span:10}},[i("st-form-item",{attrs:{label:"选择私教课",required:""}},[i("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.course_id,expression:"decorators.course_id"}],attrs:{placeholder:"请选择私教课"},on:{change:t.selectCourseChange}},t._l(t.personalList,(function(e){return i("a-select-option",{key:e.id,attrs:{value:e.id}},[t._v("\n              "+t._s(e.product_name)+"\n            ")])})),1)],1)],1)],1),i("a-row",{attrs:{gutter:8}},[i("a-col",{attrs:{span:10}},[i("st-form-item",{attrs:{label:"拼团课时",required:""}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.group_hour,expression:"decorators.group_hour"}],attrs:{placeholder:"请输入拼团课时"},on:{change:t.changeHour}})],1)],1)],1),i("a-row",{attrs:{gutter:8}},[i("a-col",{attrs:{span:16}},[i("st-form-item",{attrs:{label:"优惠设置",required:"",help:t.tableText,validateStatus:t.tableErr?"error":""}},[i("div",{class:t.basic("table")},[i("st-table",{attrs:{columns:t.cardColumns,dataSource:t.newCoach,pagination:!1,scroll:{y:230},rowSelection:t.newCoach.length>1?{onChange:t.onChange,selectedRowKeys:t.selectedRowKeys}:null,rowKey:"id"},scopedSlots:t._u([{key:"group_price",fn:function(e,r){return[i("st-input-number",{staticStyle:{width:"110px"},attrs:{float:!0},on:{input:t.setPriceChange},model:{value:r.group_price,callback:function(e){t.$set(r,"group_price",e)},expression:"record.group_price"}},[i("template",{slot:"addonAfter"},[t._v("\n                    元\n                  ")])],2)]}}])})],1)])],1)],1)],1)],2)},a=[],n=(i("ac6a"),i("dcb1")),o=i("3def"),s=i("7ce7"),c=i("2527"),u={serviceInject:function(){return{addPersonalService:s["AddPersonalService"],pattern:c["a"]}},rxState:function(){return{loading:this.addPersonalService.loading$,personalList:this.addPersonalService.personalList$,coach:this.addPersonalService.coachList$}},computed:{cardColumns:o["a"]},mounted:function(){},bem:{basic:"brand-marketing-group-personal"},data:function(){var t=this.$stForm.create(),e=t.decorators(o["b"]);return{form:t,decorators:e,selectedRowKeys:[],tableText:"",tableErr:!1,newCoach:[],groupParams:{type:3,id:null}}},methods:{changeHour:function(t){this.newCoach.forEach((function(e,i){e.hour=t.target.value}))},selectCourseChange:function(t){var e=this;this.groupParams.id=t,this.addPersonalService.getCoachList(t).subscribe((function(t){e.newCoach=e.coach.map((function(t){return{is_select:!1,level:t.spec,id:t.id,hour:"--",group_price:""}})),1===e.newCoach.length&&(e.selectedRowKeys=e.newCoach,e.newCoach[0].is_select=!0)}))},onChange:function(t){var e=this;this.selectedRowKeys=t,this.newCoach.forEach((function(t){t.is_select=-1!==e.selectedRowKeys.indexOf(t.id)}))},setPriceChange:function(){var t=this.newCoach.filter((function(t){return t.is_select})),e=t.filter((function(t){return!t.group_price}));e.length>0?(this.tableText="请输入拼团价格",this.tableErr=!0):(this.tableText="",this.tableErr=!1)},onSubmit:function(t){var e=this;if(!this.tableErr){var i=this.newCoach.filter((function(t){return t.is_select}));if(0===i.length)return this.tableText="请选择至少一个".concat(this.$c("coach")),void(this.tableErr=!0);t.init_course_num=+this.form.getFieldValue("group_hour"),t.product_type=3,t.product_id=+this.form.getFieldValue("course_id"),t.sku=i.map((function(t){return{sku_id:t.id,group_price:t.group_price}})),this.addPersonalService.createGroupbuy(t).subscribe((function(t){e.$router.push({path:"/brand/marketing/plugin/group/list"})}))}}},components:{GroupForm:n["a"]}},d=u,l=i("2877"),p=Object(l["a"])(d,r,a,!1,null,null,null);e["default"]=p.exports},"6f91":function(t,e,i){"use strict";var r,a;i.d(e,"a",(function(){return r})),i.d(e,"b",(function(){return a})),function(t){t[t["PUBLISHER"]=1]="PUBLISHER",t[t["NO_START"]=2]="NO_START",t[t["UNDER_WAY"]=3]="UNDER_WAY",t[t["END"]=4]="END"}(r||(r={})),function(t){t[t["MEMBER"]=1]="MEMBER",t[t["DEPOSIT"]=2]="DEPOSIT",t[t["PERSONAL"]=3]="PERSONAL",t[t["PACKAGE_COURSE"]=4]="PACKAGE_COURSE"}(a||(a={}))},"7adf":function(t,e,i){"use strict";i.r(e);var r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("group-form",{ref:"group",attrs:{form:t.form,decorators:t.decorators,loading:t.loading.addGroup,confirmLoading:t.loading.addGroup,isEdit:!1,groupParams:t.groupParams},on:{onsubmit:t.onSubmit}},[i("template",{slot:"choose-product"},[i("a-row",{attrs:{gutter:8}},[i("a-col",{attrs:{span:10}},[i("st-form-item",{attrs:{label:"选择储值卡",required:""}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.depositId,expression:"decorators.depositId"}],attrs:{type:"hidden"}}),i("a-select",{attrs:{showSearch:"",placeholder:"请选择储值卡"},on:{change:t.changeSelect},model:{value:t.depositId,callback:function(e){t.depositId=e},expression:"depositId"}},t._l(t.list,(function(e,r){return i("a-select-option",{key:r,attrs:{value:e.id}},[t._v("\n              "+t._s(e.product_name)+"\n            ")])})),1)],1)],1)],1),i("a-row",{attrs:{gutter:8}},[i("a-col",{attrs:{span:16}},[i("st-form-item",{attrs:{label:"优惠设置",help:t.tableText,validateStatus:t.tableErr?"error":"",required:""}},[i("st-container",[i("st-table",{attrs:{rowKey:"id",dataSource:t.currentStored,columns:t.columnsGroupStored,pagination:!1},scopedSlots:t._u([{key:"discount",fn:function(e,r){return[i("st-input-number",{staticStyle:{width:"110px"},attrs:{float:!0},on:{input:t.setPriceChange},model:{value:r.group_price,callback:function(e){t.$set(r,"group_price",e)},expression:"record.group_price"}},[i("template",{slot:"addonAfter"},[t._v("\n                    元\n                  ")])],2)]}}])})],1)],1)],1)],1)],1)],2)},a=[],n=(i("c5f6"),i("8c00")),o=i("2527"),s=i("b0d9"),c=(i("c32d"),i("dcb1")),u=i("6f91"),d={name:"PageBrandMarketingGroupAddDeposit",serviceInject:function(){return{add:n["AddDepositService"],pattern:o["a"]}},rxState:function(){return{loading:this.add.loading$,list:this.add.list$}},components:{GroupForm:c["a"]},data:function(){var t=this.$stForm.create(),e=t.decorators(s["b"]);return{form:t,decorators:e,columnsGroupStored:s["a"],groupParams:{type:2,id:null},activityState:Number,depositId:"",currentStored:[],shopIds:[],ACTIVITY_STATUS:u["a"],shopList:null,tableText:"",tableErr:!1}},methods:{setPriceChange:function(){this.currentStored[0].group_price?(this.tableText="",this.tableErr=!1):(this.tableText="请输入拼团价格",this.tableErr=!0)},changeSelect:function(t){var e=this;this.form.setFieldsValue({depositId:t}),this.list.filter((function(i){i.id==t&&(e.currentStored=i.product_spec)})),this.groupParams.id=this.depositId,this.$refs.group.updateShop()},onSubmit:function(t){var e=this,i=[{sku_id:this.currentStored[0].id,group_price:this.currentStored[0].group_price}];t.product_type=2,t.product_id=this.depositId,t.sku=i,this.add.addGroup(t).subscribe((function(t){e.$router.push({path:"/brand/marketing/plugin/group/list"})}))}}},l=d,p=i("2877"),h=Object(p["a"])(l,r,a,!1,null,null,null);e["default"]=h.exports},"7ce7":function(t,e,i){"use strict";i.r(e),i.d(e,"AddPersonalService",(function(){return h}));i("c5f6");var r,a,n=i("d225"),o=i("b0b4"),s=i("9ab4"),c=i("0cd5"),u=i("df29"),d=i("d042"),l=i("c170"),p=i("c4cc"),h=function(){function t(e){Object(n["a"])(this,t),this.GroupBuyApi=e,this.loading$=new u["d"]({}),this.personalList$=new u["d"]([]),this.coachList$=new u["d"]([])}return Object(o["a"])(t,[{key:"createGroupbuy",value:function(t){return this.GroupBuyApi.addGroup(t)}},{key:"getPersonalList",value:function(){var t=this;return this.GroupBuyApi.getPersonalList().pipe(Object(p["a"])((function(e){t.personalList$.commit((function(){return e.list})),t.loading$.commit((function(){return e.loading}))})))}},{key:"getCoachList",value:function(t){var e=this;return this.GroupBuyApi.getCoachList(t).pipe(Object(p["a"])((function(t){e.coachList$.commit((function(){return t.list}))})))}},{key:"init",value:function(){return Object(l["a"])(this.getPersonalList())}},{key:"beforeRouteEnter",value:function(t,e){return this.init()}}]),t}();Object(s["b"])([Object(u["c"])(),Object(s["d"])("design:type",Function),Object(s["d"])("design:paramtypes",["function"===typeof(r="undefined"!==typeof d["AddParams"]&&d["AddParams"])?r:Object]),Object(s["d"])("design:returntype",void 0)],h.prototype,"createGroupbuy",null),Object(s["b"])([Object(u["c"])(),Object(s["d"])("design:type",Function),Object(s["d"])("design:paramtypes",[]),Object(s["d"])("design:returntype",void 0)],h.prototype,"getPersonalList",null),Object(s["b"])([Object(u["c"])(),Object(s["d"])("design:type",Function),Object(s["d"])("design:paramtypes",[Number]),Object(s["d"])("design:returntype",void 0)],h.prototype,"getCoachList",null),h=Object(s["b"])([Object(c["b"])(),Object(s["d"])("design:paramtypes",["function"===typeof(a="undefined"!==typeof d["c"]&&d["c"])?a:Object])],h)},"8c00":function(t,e,i){"use strict";i.r(e),i.d(e,"AddDepositService",(function(){return h}));var r,a,n=i("d225"),o=i("b0b4"),s=i("9ab4"),c=i("0cd5"),u=i("df29"),d=i("d042"),l=i("c4cc"),p=i("c170"),h=function(){function t(e){Object(n["a"])(this,t),this.groupBuyApi=e,this.loading$=new u["d"]({}),this.list$=new u["d"]({})}return Object(o["a"])(t,[{key:"getDepositList",value:function(){var t=this;return this.groupBuyApi.getDepositList().pipe(Object(l["a"])((function(e){t.list$.commit((function(){return e.list}))})))}},{key:"addGroup",value:function(t){return this.groupBuyApi.addGroup(t)}},{key:"init",value:function(){return Object(p["a"])(this.getDepositList())}},{key:"beforeRouteEnter",value:function(t,e){return this.init()}}]),t}();Object(s["b"])([Object(u["c"])(),Object(s["d"])("design:type",Function),Object(s["d"])("design:paramtypes",[]),Object(s["d"])("design:returntype",void 0)],h.prototype,"getDepositList",null),Object(s["b"])([Object(u["c"])(),Object(s["d"])("design:type",Function),Object(s["d"])("design:paramtypes",["function"===typeof(r="undefined"!==typeof d["AddParams"]&&d["AddParams"])?r:Object]),Object(s["d"])("design:returntype",void 0)],h.prototype,"addGroup",null),Object(s["b"])([Object(u["c"])(),Object(s["d"])("design:type",Function),Object(s["d"])("design:paramtypes",[]),Object(s["d"])("design:returntype",void 0)],h.prototype,"init",null),h=Object(s["b"])([Object(c["b"])(),Object(s["d"])("design:paramtypes",["function"===typeof(a="undefined"!==typeof d["c"]&&d["c"])?a:Object])],h)},"91fa":function(t,e,i){"use strict";i.r(e);var r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("group-form",{attrs:{form:t.form,decorators:t.decorators,loading:t.loading.getCourseList,confirmLoading:t.loading.createGroupbuy,showSelectShop:!1},on:{onsubmit:t.onSubmit}},[i("template",{slot:"choose-product"},[i("a-row",{attrs:{gutter:8}},[i("a-col",{attrs:{span:10}},[i("st-form-item",{attrs:{required:""}},[i("span",{attrs:{slot:"label"},slot:"label"},[t._v("\n            拼团门店\n            "),i("st-help-tooltip",{attrs:{id:"TBPTXJ005"}})],1),i("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.shop_id,expression:"decorators.shop_id"}],attrs:{showSearch:"",placeholder:"请输入"},on:{change:t.changeShop}},t._l(t.shopList,(function(e,r){return i("a-select-option",{key:r,attrs:{value:e.shop_id}},[t._v("\n              "+t._s(e.shop_name)+"\n            ")])})),1)],1)],1)],1),i("a-row",{attrs:{gutter:8}},[i("a-col",{attrs:{span:10}},[i("st-form-item",{attrs:{label:"选择课程包",required:""}},[i("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.course_id,expression:"decorators.course_id"}],attrs:{placeholder:"请输入"},on:{change:t.changeCourse}},t._l(t.courseList,(function(e,r){return i("a-select-option",{key:r,attrs:{value:e.id}},[t._v("\n              "+t._s(e.product_name)+"\n            ")])})),1)],1)],1)],1),i("a-row",{attrs:{gutter:8}},[i("a-col",{attrs:{span:16}},[i("st-form-item",{attrs:{label:"优惠设置",required:"",help:t.tableText,validateStatus:t.tableErr?"error":""}},[i("st-container",[i("st-table",{attrs:{rowKey:"id",columns:t.cardColumns,dataSource:t.tableData,pagination:!1,scroll:{y:230},align:"center"},scopedSlots:t._u([{key:"group_price",fn:function(e,r){return[i("st-input-number",{staticStyle:{width:"110px"},attrs:{float:!0},on:{input:t.setPriceChange},model:{value:r.group_price,callback:function(e){t.$set(r,"group_price",e)},expression:"record.group_price"}},[i("template",{slot:"addonAfter"},[t._v("\n                    元\n                  ")])],2)]}}])})],1)],1)],1)],1)],1)],2)},a=[],n=i("dcb1"),o=i("1f01"),s=i("2a44"),c=i("2138"),u=i("6f91"),d=(i("c32d"),i("2527")),l={serviceInject:function(){return{addPackageCourseService:s["AddPackageCourseService"],userService:c["a"],pattern:d["a"]}},components:{GroupForm:n["a"]},rxState:function(){return{loading:this.addPackageCourseService.loading$,shopList:this.userService.shopList$,courseList:this.addPackageCourseService.courseList$}},data:function(){var t=this.$stForm.create(),e=t.decorators(o["b"]);return{form:t,decorators:e,cardColumns:o["a"],tableData:[],tableText:"",tableErr:!1,PRODUCT_TYPE:u["b"]}},methods:{changeShop:function(t){this.addPackageCourseService.getCourseList({shop_id:t}).subscribe((function(t){}))},changeCourse:function(t){this.tableData=this.courseList.filter((function(e){return e.id===t}))[0].product_spec,this.tableData[0].is_select=!0},setPriceChange:function(){this.tableData[0].group_price?(this.tableText="",this.tableErr=!1):(this.tableText="请输入拼团价格",this.tableErr=!0)},onSubmit:function(t){var e=this;t.shop_ids=[+this.form.getFieldValue("shop_id")],t.product_type=u["b"].PACKAGE_COURSE,t.product_id=this.form.getFieldValue("course_id"),t.sku=this.tableData.map((function(t){return{sku_id:e.form.getFieldValue("course_id"),group_price:t.group_price,price:t.price}})),this.addPackageCourseService.createGroupbuy(t).subscribe((function(t){e.$router.push({path:"./list"})}))}}},p=l,h=i("2877"),f=Object(h["a"])(p,r,a,!1,null,null,null);e["default"]=f.exports},"925e":function(t,e,i){t.exports=i.p+"img/mod_personal.816063d7.png"},9365:function(t,e,i){"use strict";i.r(e);var r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("st-panel",{attrs:{app:""}},[i("div",{class:t.basic()},t._l(t.typeList,(function(e,r){return i("router-link",{key:r,attrs:{to:e.url}},[i("div",{class:t.bCard()},[i("img",{attrs:{src:e.bg,alt:e.name}}),i("div",{class:t.bCard("name")},[t._v(t._s(e.name))])])])})),1)])},a=[],n={bem:{basic:"brand-marketing-plugin-choose",bCard:"card"},data:function(){return{typeList:[{name:"".concat(this.$c("member_card")),bg:i("11f9"),url:"./add-member"},{name:"储值卡",bg:i("516c"),url:"./add-deposit"},{name:"私教课",bg:i("925e"),url:"./add-personal"},{name:"课程包",bg:i("0f06"),url:"./add-package-course"}]}}},o=n,s=i("2877"),c=Object(s["a"])(o,r,a,!1,null,null,null);e["default"]=c.exports},a9b8:function(t,e,i){"use strict";i.r(e),i.d(e,"EditPackageCourseService",(function(){return h}));i("c5f6");var r,a,n=i("d225"),o=i("b0b4"),s=i("9ab4"),c=i("0cd5"),u=i("df29"),d=i("d042"),l=i("c4cc"),p=i("c170"),h=function(){function t(e){Object(n["a"])(this,t),this.groupBuyApi=e,this.info$=new u["d"]({}),this.loading$=new u["d"]({}),this.courseList$=new u["d"]({})}return Object(o["a"])(t,[{key:"editGroupbuy",value:function(t){return this.groupBuyApi.editGroup(t)}},{key:"getDetailData",value:function(t){var e=this;return this.groupBuyApi.getStoredData(t).pipe(Object(l["a"])((function(t){e.info$.commit((function(){return t.info}))})))}},{key:"getCourseList",value:function(t){var e=this;return this.groupBuyApi.getCourseList(t).pipe(Object(l["a"])((function(t){e.courseList$.commit((function(){return t.list}))})))}},{key:"init",value:function(t){return Object(p["a"])(this.getDetailData(t))}},{key:"beforeRouteEnter",value:function(t,e){return this.init(t.meta.query.id)}}]),t}();Object(s["b"])([Object(u["c"])(),Object(s["d"])("design:type",Function),Object(s["d"])("design:paramtypes",["function"===typeof(r="undefined"!==typeof d["EditParams"]&&d["EditParams"])?r:Object]),Object(s["d"])("design:returntype",void 0)],h.prototype,"editGroupbuy",null),Object(s["b"])([Object(u["c"])(),Object(s["d"])("design:type",Function),Object(s["d"])("design:paramtypes",[Number]),Object(s["d"])("design:returntype",void 0)],h.prototype,"getDetailData",null),Object(s["b"])([Object(u["c"])(),Object(s["d"])("design:type",Function),Object(s["d"])("design:paramtypes",[Object]),Object(s["d"])("design:returntype",void 0)],h.prototype,"getCourseList",null),Object(s["b"])([Object(u["c"])(),Object(s["d"])("design:type",Function),Object(s["d"])("design:paramtypes",[Object]),Object(s["d"])("design:returntype",void 0)],h.prototype,"init",null),h=Object(s["b"])([Object(c["b"])(),Object(s["d"])("design:paramtypes",["function"===typeof(a="undefined"!==typeof d["c"]&&d["c"])?a:Object])],h)},b03a:function(t,e,i){"use strict";i.r(e);var r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("group-form",{attrs:{form:t.form,decorators:t.decorators,confirmLoading:t.loading.addGroup,groupParams:t.groupParams},on:{onsubmit:t.onSubmit}},[i("template",{slot:"choose-product"},[i("a-row",{attrs:{gutter:8}},[i("a-col",{attrs:{span:10}},[i("st-form-item",{attrs:{label:"选择"+t.$c("member_card"),required:""}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.cardId,expression:"decorators.cardId"}],attrs:{type:"hidden"}}),i("a-select",{attrs:{showSearch:"",placeholder:"请输入"},on:{change:t.chooseMember},model:{value:t.cardId,callback:function(e){t.cardId=e},expression:"cardId"}},t._l(t.memberList,(function(e,r){return i("a-select-option",{key:r,attrs:{value:e.id}},[t._v("\n              "+t._s(e.product_name)+"\n            ")])})),1)],1)],1)],1),i("a-row",{attrs:{gutter:8}},[i("a-col",{attrs:{span:16}},[i("st-form-item",{attrs:{label:"优惠设置",required:"",help:t.tableText,validateStatus:t.tableErr?"error":""}},[i("st-container",[i("st-table",{attrs:{columns:t.cardColumns,dataSource:t.tableData,pagination:!1,scroll:{y:230},rowSelection:t.tableData.length>1?{onChange:t.onChange,selectedRowKeys:t.selectedRowKeys}:null,rowKey:"id"},scopedSlots:t._u([{key:"group_price",fn:function(e,r){return[i("st-input-number",{staticStyle:{width:"110px"},attrs:{float:!0},on:{input:t.setPriceChange},model:{value:r.group_price,callback:function(e){t.$set(r,"group_price",e)},expression:"record.group_price"}},[i("template",{slot:"addonAfter"},[t._v("\n                    元\n                  ")])],2)]}}])})],1)],1)],1)],1)],1)],2)},a=[],n=(i("ac6a"),i("dcb1")),o=i("0c7b"),s=i("dcb0"),c=i("2527"),u={serviceInject:function(){return{addMemberService:s["AddMemberService"],pattern:c["a"]}},rxState:function(){return{loading:this.addMemberService.loading$,memberList:this.addMemberService.memberList$}},bem:{basic:"brand-marketing-group-member"},data:function(){var t=this.$stForm.create(),e=t.decorators(o["b"]);return{form:t,decorators:e,cardId:"",selectedRowKeys:[],cardColumns:o["a"],tableText:"",tableErr:!1,tableData:[],groupParams:{type:1,id:null}}},methods:{chooseMember:function(t){var e=this;this.form.setFieldsValue({cardId:t}),this.groupParams.id=t,this.memberList.filter((function(i){i.id===t&&(e.tableData=i.product_spec,e.tableData.forEach((function(t){t.is_select=!1})))})),1===this.tableData.length&&(this.tableData[0].is_select=!0)},onChange:function(t){var e=this;this.selectedRowKeys=t,this.tableData.forEach((function(t){t.is_select=-1!==e.selectedRowKeys.indexOf(t.id)}))},setPriceChange:function(){var t=this.tableData.filter((function(t){return t.is_select})),e=t.filter((function(t){return!t.group_price}));e.length>0?(this.tableText="请输入拼团价格",this.tableErr=!0):(this.tableText="",this.tableErr=!1)},onSubmit:function(t){var e=this,i=!1;if(!this.tableErr){this.tableData.length>1&&!this.selectedRowKeys.length&&(this.tableText="请选择至少一个".concat(this.$c("member_card"),"规格"),this.tableErr=!0,i=!0);var r=this.tableData.filter((function(t){return t.is_select})).map((function(t){return{sku_id:t.id,group_price:t.group_price}}));i||(t.product_type=1,t.sku=r,t.product_id=this.cardId,this.addMemberService.addGroup(t).subscribe((function(t){e.$router.push({path:"./list"})})))}}},components:{GroupForm:n["a"]}},d=u,l=i("2877"),p=Object(l["a"])(d,r,a,!1,null,null,null);e["default"]=p.exports},b0d9:function(t,e,i){"use strict";i.d(e,"a",(function(){return a})),i.d(e,"b",(function(){return n}));var r=i("4ba8"),a=[{title:"原价",dataIndex:"price",width:"60%",align:"center"},{title:"拼团价",dataIndex:"group_price",width:"40%",slots:{title:"discount"},scopedSlots:{customRender:"discount"}}],n=function(t){t.pattern;var e=Object(r["a"])(t);return Object.assign(e,{depositId:{rules:[{required:!0,message:"请选择储值卡"}]}})}},b8b3:function(t,e,i){"use strict";i.r(e);var r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("st-panel-layout",[i("MarkteingPluginTitle",{attrs:{type:t.TYPE.GROUP_BUY}}),i("st-panel",{class:t.basic(),attrs:{app:"",initial:""}},[i("div",{class:t.basic("search"),attrs:{slot:"title"},slot:"title"},[t.auth.add?i("div",{class:t.basic("add")},[i("st-button",{attrs:{icon:"add",type:"primary"},on:{click:t.onAddGroup}},[t._v("\n          新增活动\n        ")]),i("st-button",{staticClass:"mg-l16",on:{click:t.onConfigHandle}},[t._v("\n          配置到小程序\n        ")])],1):t._e(),i("a-select",{class:t.basic("select"),staticStyle:{width:"160px"},attrs:{placeholder:"活动状态"},on:{change:function(e){return t.onSingleSearch("activity_status",e)}},model:{value:t.activityStatus,callback:function(e){t.activityStatus=e},expression:"activityStatus"}},t._l(t.groupBuyEnums,(function(e){return i("a-select-option",{key:e.value},[t._v("\n          "+t._s(e.label)+"\n        ")])})),1),i("st-input-search",{attrs:{placeholder:"请输入活动名称",maxlength:"50"},on:{search:function(e){return t.onSingleSearch("activity_name",e)}},model:{value:t.activityName,callback:function(e){t.activityName=e},expression:"activityName"}})],1),i("div",{class:t.basic("content")},[i("st-table",{attrs:{page:t.page,rowKey:"id",columns:t.columns,dataSource:t.list},on:{change:t.onTableChange},scopedSlots:t._u([{key:"product_type",fn:function(e,r){return[i("span",[t._v(t._s(r.product_type.name))])]}},{key:"support_sales",fn:function(e,r){return[r.id?i("a",{directives:[{name:"modal-link",rawName:"v-modal-link",value:{name:"card-brand-member-shop-table",props:{id:r.id,type:"Group",title:"支持门店"}},expression:"{\n              name: 'card-brand-member-shop-table',\n              props: { id: record.id, type: 'Group', title: '支持门店' }\n            }"}]},[t._v("\n            "+t._s(e)+"\n          ")]):t._e()]}},{key:"activity_state",fn:function(e,r){return[r.activity_state&&r.activity_state.published_time?i("span",[i("st-text",{attrs:{status:{warning:1===r.activity_state.id}}},[t._v("\n              "+t._s(r.activity_state.name)+"\n            ")]),r.activity_state.published_time?i("st-help-popover",[i("span",{attrs:{slot:"content"},slot:"content"},[t._v("\n                发布时间："+t._s(r.activity_state.published_time)+"\n              ")])]):t._e()],1):i("span",[i("st-text",{attrs:{status:{warning:1===r.activity_state.id,default:2===r.activity_state.id,success:3===r.activity_state.id,error:4===r.activity_state.id}}},[t._v("\n              "+t._s(r.activity_state.name)+"\n            ")])],1)]}},{key:"action",fn:function(e,r){return[i("st-table-actions",{attrs:{sytle:"width: 120px"}},[r.auth["brand:activity:group_buy|data"]?i("a",{on:{click:function(e){return t.onData(r)}}},[t._v("\n              数据\n            ")]):t._e(),r.auth["brand:activity:group_buy|spread"]?i("a",{on:{click:function(e){return t.onGeneralize(r)}}},[t._v("\n              推广\n            ")]):t._e(),r.auth["brand:activity:group_buy|edit"]?i("a",{on:{click:function(e){return t.onEdit(r)}}},[t._v("\n              编辑\n            ")]):t._e(),r.auth["brand:activity:group_buy|stop"]?i("a",{on:{click:function(e){return t.onStop(r)}}},[t._v("\n              结束\n            ")]):t._e(),r.auth["brand:activity:group_buy|release"]?i("a",{on:{click:function(e){return t.onRelease(r)}}},[t._v("\n              发布\n            ")]):t._e()])]}}])})],1),i("st-modal",{attrs:{footer:null,title:t.title,wrapClassName:"scroll-modal"},model:{value:t.modalShow,callback:function(e){t.modalShow=e},expression:"modalShow"}},[i("st-table",{attrs:{page:t.shopPage,rowKey:"id",loading:t.loading["getShopList"],columns:t.shopListColumns,scroll:{y:230,x:600},dataSource:t.shopList,pagination:{current:t.shopPage.current_page,total:t.shopPage.total_counts,pageSize:t.shopPage.size}},on:{change:t.onShopTableChange},scopedSlots:t._u([{key:"action",fn:function(e,r){return[i("st-table-actions",{attrs:{sytle:"width: 80px"}},[i("a",{on:{click:function(e){return t.onSelect(r)}}},[t._v("\n              选择\n            ")])])]}}])})],1)],1)],1)},a=[],n=i("2138"),o=i("31e5"),s=i("aa7d"),c=i("ea3e"),u=[{title:"活动名称",width:175,dataIndex:"activity_name"},{title:"商品类型",dataIndex:"product_type",scopedSlots:{customRender:"product_type"}},{title:"支持门店",width:175,dataIndex:"support_sales",scopedSlots:{customRender:"support_sales"}},{title:"有效时间",width:180,dataIndex:"activity_time"},{title:"活动状态",width:90,dataIndex:"activity_state",scopedSlots:{customRender:"activity_state"}},{title:"开团人次",dataIndex:"group_total"},{title:"成团订单",dataIndex:"group_success_total"},{title:"剩余活动库存",dataIndex:"stock_remaining"},{title:"操作",dataIndex:"action",width:140,scopedSlots:{customRender:"action"}}],d=[{title:"省",dataIndex:"province_name",width:"22%",scopedSlots:{customRender:"province_name"}},{title:"市",width:"22%",dataIndex:"city_name"},{title:"区",width:"22%",dataIndex:"district_name"},{title:"门店名称",width:"34%",dataIndex:"shop_name"},{title:"操作",dataIndex:"action",width:60,fixed:"right",scopedSlots:{customRender:"action"}}],l=i("6c94"),p=i("0484"),h=i("5ffc"),f=i("12f0"),b={name:"PageBrandMarketingPluginGroupList",mixins:[c["a"]],bem:{basic:"page-brand-plugin-group-list"},modals:{BrandMarketingBind:p["a"],CardBrandMemberShopTable:f["a"]},serviceInject:function(){return{listService:o["ListService"],userService:n["a"]}},rxState:function(){return{list:this.listService.list$,page:this.listService.page$,loading:this.listService.loading$,auth:this.listService.auth$,info:this.listService.info$,groupBuyEnums:this.listService.groupBuyEnums$,shopList:this.listService.shopList$,shopPage:this.listService.shopPage$,isAuth:this.listService.isAuth$}},hooks:function(){return{share:Object(h["a"])()}},data:function(t){return{TYPE:l["a"],activityName:"",activityStatus:-1,columns:u,shopListColumns:d,modalShow:!1,title:"选择门店",groupId:""}},computed:{},mounted:function(){this.setSearchData()},watch:{query:function(t){this.setSearchData()}},methods:{onConfigHandle:function(){this.$router.push({path:"/brand/setting/mina/index"})},onSelect:function(t){var e=this;this.listService.getSharePosterInfo(this.groupId,{shop_id:t.id}).subscribe((function(t){e.modalShow=!1;var i=e.isAuth,r={person_num:e.info.group_sum,name:e.info.product_name,qrcode_url:e.info.qrcode_base,logo:e.info.brand_logo,brand_name:e.info.brand_name,price:e.info.price,image:e.info.product_logo};e.share.poster({isAuth:i,shsInfo:r,hasQrCodeBtn:!0,shsPath:"/saas-mina/groupbuy"})}))},setSearchData:function(){var t=this.$searchQuery,e=t.activity_name,i=t.activity_status;this.activityName=e,this.activityStatus=i||-1},onRelease:function(t){var e=this;this.$confirm({title:"提示",content:"确定发布该活动?发布成功后，用户即可在小程序端看到该活动。",onOk:function(){e.listService.releaseGroup(t.id).subscribe((function(t){e.$router.reload()}))},onCancel:function(){}})},onData:function(t){this.$router.push({path:"./data",query:{id:t.id}})},onGeneralize:function(t){var e=this;this.groupId=t.id,this.listService.getShopList(t.id,{size:t.size||20,current_page:t.current_page||1}).subscribe((function(t){e.modalShow=!0}))},onShopTableChange:function(t){this.onGeneralize({id:this.groupId,size:t.pageSize,current_page:t.current})},onEdit:function(t){var e=t.product_type.id,i=t.id;switch(e){case 3:this.$router.push({path:"./edit-personal",query:{id:i}});break;case 2:this.$router.push({path:"./edit-deposit",query:{id:i}});break;case 1:this.$router.push({path:"./edit-member",query:{id:i}});break;case 4:this.$router.push({path:"./edit-package-course",query:{id:i}});break;default:}},onStop:function(t){var e=this;this.$confirm({title:"提示",content:"确定停止该活动吗？活动停止后，未成团订单将自动关闭并退款。",onOk:function(){e.listService.stopGroup(t.id).subscribe((function(t){e.$router.reload()}))},onCancel:function(){}})},onAddGroup:function(){this.$router.push({path:"./choose"})}},components:{MarkteingPluginTitle:s["a"]}},m=b,g=i("2877"),v=Object(g["a"])(m,r,a,!1,null,null,null);e["default"]=v.exports},bbea:function(t,e,i){"use strict";i.r(e),i.d(e,"DataService",(function(){return b}));var r,a,n,o=i("d225"),s=i("b0b4"),c=i("9ab4"),u=i("0cd5"),d=i("d042"),l=i("df29"),p=i("c4cc"),h=i("54da"),f=i("2138"),b=function(){function t(e,i){Object(o["a"])(this,t),this.groupBuyApi=e,this.userService=i,this.list$=new l["d"]([]),this.page$=new l["d"]({}),this.loading$=new l["d"]({}),this.collect$=new l["d"]([]),this.info$=new l["d"]({}),this.groupStatusEnums$=this.userService.getOptions$("group_buy.group_status",{addAll:!0})}return Object(s["a"])(t,[{key:"getData",value:function(t){var e=this;return this.groupBuyApi.getData(t).pipe(Object(p["a"])((function(t){e.list$.commit((function(){return t.list})),e.page$.commit((function(){return t.page})),e.collect$.commit((function(){return t.collect})),e.loading$.commit((function(){return t.loading}))})))}},{key:"getDatatop",value:function(t){var e=this;return this.groupBuyApi.getGroupBuyDataTop(t).pipe(Object(p["a"])((function(t){e.info$.commit((function(){return t}))})))}},{key:"init",value:function(t){return Object(h["a"])(this.getData(t),this.getDatatop(t.id))}},{key:"beforeEach",value:function(t,e){return this.init(t.meta.query)}}]),t}();Object(c["b"])([Object(l["c"])(),Object(c["d"])("design:type",Function),Object(c["d"])("design:paramtypes",["function"===typeof(r="undefined"!==typeof d["GroupData"]&&d["GroupData"])?r:Object]),Object(c["d"])("design:returntype",void 0)],b.prototype,"getData",null),b=Object(c["b"])([Object(u["b"])(),Object(c["d"])("design:paramtypes",["function"===typeof(a="undefined"!==typeof d["c"]&&d["c"])?a:Object,"function"===typeof(n="undefined"!==typeof f["a"]&&f["a"])?n:Object])],b)},c95e:function(t,e,i){"use strict";i.r(e);var r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("st-panel-layout",{class:t.activities()},[i("st-panel",{staticClass:"mg-b12"},[i("st-t2",[t._v(t._s(t.info.activity_name))]),i("div",{class:t.activities("desc")},[i("p",{class:t.activities("activity")},[t._v("活动商品："+t._s(t.info.product_name))]),i("p",{class:t.activities("activity")},[t._v("\n        活动时间："+t._s(t.info.start_time)+"~"+t._s(t.info.end_time)+"\n      ")])])],1),i("st-panel",{attrs:{app:""}},[i("div",{class:t.activities("block")},[i("a-row",{class:t.activities("acount")},[i("a-col",{attrs:{span:4}},[i("p",{class:t.activities("acount-title")},[t._v("\n            开团数\n            "),i("st-help-tooltip",{attrs:{id:"TBPTSJ001"}})],1),i("p",{staticClass:"number-up font-number"},[t._v("\n            "+t._s(t.collect.group_total)+"\n          ")])]),i("a-col",{attrs:{span:4}},[i("p",{class:t.activities("acount-title")},[t._v("\n            成团数\n            "),i("st-help-tooltip",{attrs:{id:"TBPTSJ002"}})],1),i("p",{staticClass:"number-up font-number"},[t._v("\n            "+t._s(t.collect.group_success_total)+"\n          ")])]),i("a-col",{attrs:{span:4}},[i("p",{class:t.activities("acount-title")},[t._v("\n            参与人数\n            "),i("st-help-tooltip",{attrs:{id:"TBPTSJ003"}})],1),i("p",{staticClass:"number-up font-number"},[t._v("\n            "+t._s(t.collect.join_total)+"\n          ")])]),i("a-col",{attrs:{span:4}},[i("p",{class:t.activities("acount-title")},[t._v("\n            新用户数\n            "),i("st-help-tooltip",{attrs:{id:"TBPTSJ004"}})],1),i("p",{staticClass:"number-up font-number"},[t._v("\n            "+t._s(t.collect.new_total)+"\n          ")])]),i("a-col",{attrs:{span:4}},[i("p",{class:t.activities("acount-title")},[t._v("\n            成单数\n            "),i("st-help-tooltip",{attrs:{id:"TBPTSJ005"}})],1),i("p",{staticClass:"number-up font-number"},[t._v("\n            "+t._s(t.collect.success_order_total)+"\n          ")])]),i("a-col",{attrs:{span:4}},[i("p",{class:t.activities("acount-title")},[t._v("\n            成交金额\n            "),i("st-help-tooltip",{attrs:{id:"TBPTSJ006"}})],1),i("p",{staticClass:"number-up font-number"},[t._v("\n            "+t._s(t.collect.success_amount_total)+"\n          ")])])],1)],1),i("div",{class:t.activities("search")},[i("a-select",{class:t.activities("select"),staticStyle:{width:"130px"},attrs:{placeholder:"活动状态"},on:{change:function(e){return t.onSingleSearch("group_status",e)}},model:{value:t.groupStatus,callback:function(e){t.groupStatus=e},expression:"groupStatus"}},t._l(t.groupStatusEnums,(function(e){return i("a-select-option",{key:e.value},[t._v("\n          "+t._s(e.label)+"\n        ")])})),1),i("st-input-search",{attrs:{placeholder:"请输入会员名或手机号",maxlength:"50"},on:{search:function(e){return t.onSingleSearch("search_where",e)}},model:{value:t.searchWhere,callback:function(e){t.searchWhere=e},expression:"searchWhere"}})],1),i("st-table",{attrs:{rowKey:"id",page:t.page,columns:t.columns,scroll:{x:1240},dataSource:t.list},on:{change:t.onTableChange}})],1)],1)},a=[],n=(i("a481"),i("6762"),i("2fdb"),i("2138")),o=i("bbea"),s=[{title:"拼团编号",dataIndex:"id"},{title:"开团时间",dataIndex:"start_time"},{title:"拼团门店",dataIndex:"shop_name"},{title:"拼团状态",dataIndex:"group_status"},{title:"会员",dataIndex:"member_name"},{title:"身份",dataIndex:"member_type"},{title:"手机号",dataIndex:"member_mobile"},{title:"参与时间",dataIndex:"join_start_time"},{title:"新老用户",dataIndex:"is_new_member"},{title:"订单编号",dataIndex:"order_id"}],c=(i("df29"),i("ea3e")),u=(i("bef4"),""),d={name:"PageBrandMarketingPluginGroupListData",bem:{activities:"brand-marketing-plugin-group-data"},mixins:[c["a"]],serviceInject:function(){return{dataService:o["DataService"],userService:n["a"]}},rxState:function(){return{list:this.dataService.list$,page:this.dataService.page$,collect:this.dataService.collect$,loading:this.dataService.loading$,info:this.dataService.info$,groupStatusEnums:this.dataService.groupStatusEnums$}},data:function(){return{showList:[],flag:!0,searchWhere:"",groupStatus:-1,columns:s}},watch:{$searchQuery:function(t){this.setSearchData()}},mounted:function(){this.setSearchData()},methods:{setSearchData:function(){var t=this.$searchQuery,e=t.search_where,i=t.group_status;this.searchWhere=e,this.groupStatus=i||-1},rowClassName:function(t,e){var i=t&&t.id,r=this.showList.includes(i),a="";if(a=e%2!==0?r?"evengb shadow":"evengb":r?"shadow":"",t&&t.children)return u=a,a;var n=u;return-1===n.indexOf("shadow")?n:n.replace("shadow","")},onShow:function(t){this.showList=t,this.rowClassName()}}},l=d,p=i("2877"),h=Object(p["a"])(l,r,a,!1,null,null,null);e["default"]=h.exports},d042:function(t,e,i){"use strict";i.d(e,"c",(function(){return l}));i("6b54"),i("2397");var r=i("d225"),a=i("b0b4"),n=i("308d"),o=i("6bb5"),s=i("4e2b"),c=i("de46");function u(t){return function(){var e,i=Object(o["a"])(t);if(d()){var r=Object(o["a"])(this).constructor;e=Reflect.construct(i,arguments,r)}else e=i.apply(this,arguments);return Object(n["a"])(this,e)}}function d(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var l=function(t){Object(s["a"])(i,t);var e=u(i);function i(){return Object(r["a"])(this,i),e.apply(this,arguments)}return Object(a["a"])(i,[{key:"addGroup",value:function(t){return this.http.post("/v1/plugin/group_buy",{params:t})}},{key:"editGroup",value:function(t){return this.http.put("/v1/plugin/group_buy/".concat(t.id),{params:t})}},{key:"getStoredData",value:function(t){return this.http.get("/v1/plugin/group_buy/"+t)}},{key:"getList",value:function(t){return this.http.get("/v1/plugin/group_buy",{query:t})}},{key:"getData",value:function(t){return this.http.get("/v1/plugin/group_buy/data/".concat(t.id),{query:t})}},{key:"getMemberList",value:function(){return this.http.get("/v1/cards/member/brand_list")}},{key:"getDepositList",value:function(){return this.http.get("/v1/cards/deposit/brand_list")}},{key:"getCourseList",value:function(t){return this.http.get("/v1/course/package/group/list",{query:t})}},{key:"getPersonalList",value:function(){return this.http.get("/v1/course/personal/brand_list")}},{key:"getCoachList",value:function(t){return this.http.get("/v1/course/personal/coach_level/".concat(t))}},{key:"stopGroupList",value:function(t){return this.http.get("/v1/plugin/group_buy/stop/".concat(t))}},{key:"releaseGroupList",value:function(t){return this.http.get("/v1/plugin/group_buy/release/".concat(t))}},{key:"getPosterInfo",value:function(t,e){return this.http.get("/v1/plugin/group_buy/spread/".concat(t),{query:e})}},{key:"getGroupBuyDataTop",value:function(t){return this.http.get("/v1/plugin/group_buy/data_top/".concat(t))}},{key:"getShopList",value:function(t,e){return this.http.get("/v1/plugin/group_buy/shop/".concat(e),{query:t})}}]),i}(c["a"])},d256:function(t,e,i){"use strict";i.r(e);var r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("group-form",{attrs:{form:t.form,decorators:t.decorators,loading:t.loading.init,confirmLoading:t.loading.editGroup,isEdit:!0,info:t.info,shopIds:t.shopIds,groupParams:t.groupParams},on:{onsubmit:t.onSubmit}},[i("template",{slot:"choose-product"},[i("a-row",{attrs:{gutter:8}},[i("a-col",{attrs:{span:10}},[i("st-form-item",{attrs:{label:"选择"+t.$c("member_card"),required:""}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.cardId,expression:"decorators.cardId"}],attrs:{type:"hidden"}}),i("a-select",{attrs:{showSearch:"",placeholder:"请输入",disabled:t.activityState>=t.ACTIVITY_STATUS.NO_START},on:{change:t.chooseMember},model:{value:t.cardId,callback:function(e){t.cardId=e},expression:"cardId"}},t._l(t.memberList,(function(e,r){return i("a-select-option",{key:r,attrs:{value:e.id}},[t._v("\n              "+t._s(e.product_name)+"\n            ")])})),1)],1)],1)],1),i("a-row",{attrs:{gutter:8}},[i("a-col",{attrs:{span:16}},[i("st-form-item",{attrs:{label:"优惠设置",required:"",help:t.tableText,validateStatus:t.tableErr?"error":""}},[i("st-container",[i("st-table",{attrs:{columns:t.cardColumns,dataSource:t.tableData,pagination:!1,scroll:{y:230},rowSelection:t.tableData.length>1?{onChange:t.onChange,selectedRowKeys:t.selectedRowKeys,getCheckboxProps:t.getCheckboxProps}:null,rowKey:"id"},scopedSlots:t._u([{key:"group_price",fn:function(e,r){return[i("st-input-number",{staticStyle:{width:"110px"},attrs:{float:!0,disabled:t.activityState>=t.ACTIVITY_STATUS.NO_START},on:{input:t.setPriceChange},model:{value:r.group_price,callback:function(e){t.$set(r,"group_price",e)},expression:"record.group_price"}},[i("template",{slot:"addonAfter"},[t._v("\n                    元\n                  ")])],2)]}}])})],1)],1)],1)],1)],1)],2)},a=[],n=(i("ac6a"),i("c5f6"),i("dcb1")),o=i("0c7b"),s=i("2659"),c=i("2527"),u=i("6f91"),d={serviceInject:function(){return{editMemberService:s["EditMemberService"],pattern:c["a"]}},rxState:function(){return{loading:this.editMemberService.loading$,memberList:this.editMemberService.memberList$,info:this.editMemberService.info$}},data:function(){var t=this.$stForm.create(),e=t.decorators(o["b"]);return{form:t,decorators:e,cardId:"",selectedRowKeys:[],cardColumns:o["a"],tableText:"",tableErr:!1,tableData:[],shopIds:[],groupParams:{type:1,id:null},ACTIVITY_STATUS:u["a"],activityState:Number,oldStock:Number,oldTime:"",getCheckboxProps:function(){return{props:{disabled:!0}}}}},mounted:function(){this.setFieldsValue(),this.chooseMember(this.cardId)},methods:{chooseMember:function(t){var e=this;this.form.setFieldsValue({cardId:t}),this.groupParams.id=t;var i=this.memberList.filter((function(e){return e.id===t}))[0];this.tableData=i.product_spec.map((function(t){return Object.assign(t,{is_select:!1})})),this.selectedRowKeys&&this.info.sku.forEach((function(t){e.tableData.forEach((function(e){t.sku_id===e.id&&(e.group_price=t.group_price,e.is_select=!0)}))})),1===this.tableData.length&&(this.tableData[0].is_select=!0)},onChange:function(t){var e=this;this.selectedRowKeys=t,this.tableData.forEach((function(t){t.is_select=-1!==e.selectedRowKeys.indexOf(t.id)}))},setPriceChange:function(){var t=this.tableData.filter((function(t){return t.is_select})),e=t.filter((function(t){return!t.group_price}));e.length>0?(this.tableText="请输入拼团价格",this.tableErr=!0):(this.tableText="",this.tableErr=!1)},onSubmit:function(t){var e=this,i=!1;this.selectedRowKeys.length||(this.tableText="请选择".concat(this.$c("member_card"),"规格"),this.tableErr=!0,i=!0);var r=this.tableData.filter((function(t){return t.is_select})).map((function(t){return{sku_id:t.id,group_price:t.group_price}}));i||(t.product_type=1,t.product_id=this.cardId,t.sku=r,t.id=this.$route.query.id,this.editMemberService.editGroup(t).subscribe((function(t){e.$router.push({path:"./list"})})))},setFieldsValue:function(){var t=this;this.activityState=this.info.activity_state.id,this.cardId=this.info.product.id,this.oldStock=this.info.stock_total,this.oldTime=new Date(this.info.end_time),this.info.sku.forEach((function(e){t.selectedRowKeys.push(e.sku_id)})),this.getCheckboxProps=function(){return{props:{disabled:t.info.activity_state.id>=u["a"].NO_START}}}}},components:{GroupForm:n["a"]}},l=d,p=i("2877"),h=Object(p["a"])(l,r,a,!1,null,null,null);e["default"]=h.exports},dcb0:function(t,e,i){"use strict";i.r(e),i.d(e,"AddMemberService",(function(){return f}));var r,a,n,o=i("d225"),s=i("b0b4"),c=i("9ab4"),u=i("0cd5"),d=i("df29"),l=i("d042"),p=i("c170"),h=i("c4cc"),f=function(){function t(e){Object(o["a"])(this,t),this.groupBuyApi=e,this.loading$=new d["d"]({}),this.memberList$=new d["d"]([])}return Object(s["a"])(t,[{key:"addGroup",value:function(t){return this.groupBuyApi.addGroup(t)}},{key:"editGroup",value:function(t){return this.groupBuyApi.editGroup(t)}},{key:"getMemberList",value:function(){var t=this;return this.groupBuyApi.getMemberList().pipe(Object(h["a"])((function(e){t.memberList$.commit((function(){return e.list}))})))}},{key:"init",value:function(){return Object(p["a"])(this.getMemberList())}},{key:"beforeRouteEnter",value:function(t,e){return this.init()}}]),t}();Object(c["b"])([Object(d["c"])(),Object(c["d"])("design:type",Function),Object(c["d"])("design:paramtypes",["function"===typeof(r="undefined"!==typeof l["AddParams"]&&l["AddParams"])?r:Object]),Object(c["d"])("design:returntype",void 0)],f.prototype,"addGroup",null),Object(c["b"])([Object(d["c"])(),Object(c["d"])("design:type",Function),Object(c["d"])("design:paramtypes",["function"===typeof(a="undefined"!==typeof l["EditParams"]&&l["EditParams"])?a:Object]),Object(c["d"])("design:returntype",void 0)],f.prototype,"editGroup",null),Object(c["b"])([Object(d["c"])(),Object(c["d"])("design:type",Function),Object(c["d"])("design:paramtypes",[]),Object(c["d"])("design:returntype",void 0)],f.prototype,"getMemberList",null),f=Object(c["b"])([Object(u["b"])(),Object(c["d"])("design:paramtypes",["function"===typeof(n="undefined"!==typeof l["c"]&&l["c"])?n:Object])],f)},dcb1:function(t,e,i){"use strict";var r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("st-mina-panel",{attrs:{app:""}},[i("div",{attrs:{slot:"actions"},slot:"actions"},[i("st-button",{attrs:{loading:t.confirmLoading,type:"primary"},on:{click:t.onSubmit}},[t._v("\n      保 存\n    ")])],1),i("div",[i("st-form",{attrs:{form:t.form,labelWidth:"118px"}},[i("a-row",{attrs:{gutter:8}},[i("a-col",{attrs:{span:10}},[i("st-form-item",{attrs:{label:"活动名称",required:""}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.activity_name,expression:"decorators.activity_name"}],attrs:{placeholder:"请输入活动名称",maxlength:"30"},on:{change:t.changeName}},[i("span",{class:t.basic("name--gray"),attrs:{slot:"suffix"},slot:"suffix"},[t._v("\n                "+t._s(t.groupName.length)+"\n                /30\n              ")])])],1)],1)],1),t._t("choose-product"),i("a-row",{attrs:{gutter:8}},[i("a-col",{attrs:{span:16}},[i("st-form-item",{attrs:{label:"活动时间",required:""}},[i("st-range-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.activity_time,expression:"decorators.activity_time"}],attrs:{disabledDays:180,options:t.activityOptions}})],1)],1)],1),i("a-row",{attrs:{gutter:8}},[i("a-col",{attrs:{span:10}},[i("st-form-item",{attrs:{required:""}},[i("span",{attrs:{slot:"label"},slot:"label"},[t._v("\n              参团人数\n              "),i("st-help-tooltip",{attrs:{id:"TBPTXJ001"}})],1),i("st-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.group_sum,expression:"decorators.group_sum"}],attrs:{disabled:t.isEdit&&t.activityState>t.ACTIVITY_STATUS.PUBLISHER}},[i("template",{slot:"addonAfter"},[t._v("\n                人\n              ")])],2)],1),i("st-form-item",{attrs:{required:""}},[i("span",{attrs:{slot:"label"},slot:"label"},[t._v("\n              拼团有效期\n              "),i("st-help-tooltip",{attrs:{id:"TBPTXJ002"}})],1),i("st-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.valid_time,expression:"decorators.valid_time"}],attrs:{disabled:t.isEdit&&t.activityState>t.ACTIVITY_STATUS.PUBLISHER}},[i("template",{slot:"addonAfter"},[t._v("\n                小时\n              ")])],2)],1),i("st-form-item",{attrs:{required:""}},[i("span",{attrs:{slot:"label"},slot:"label"},[t._v("\n              活动库存\n              "),i("st-help-tooltip",{attrs:{id:"TBPTXJ003"}})],1),i("a-checkbox",{attrs:{checked:t.isLimit,disabled:t.isEdit&&t.activityState>t.ACTIVITY_STATUS.PUBLISHER},on:{change:t.limitStock}},[t._v("\n              限制库存  \n            ")]),t.isLimit?i("st-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.stock_total,expression:"decorators.stock_total"}],class:t.basic("stock"),attrs:{disabled:t.isEdit&&t.activityState>=t.ACTIVITY_STATUS.END}}):t._e()],1)],1)],1),t.showSelectShop?i("a-row",{attrs:{gutter:8}},[i("a-col",{attrs:{span:16}},[i("st-form-item",{class:t.basic("shop"),attrs:{required:"",help:t.errTips,validateStatus:t.showErr?"error":""}},[i("span",{attrs:{slot:"label"},slot:"label"},[t._v("\n              选择门店\n              "),i("st-help-tooltip",{attrs:{id:"TBPTXJ004"}})],1),i("st-container",[i("st-t4",{class:t.basic("shop--set")},[t._v("\n                设置支持活动的场馆范围\n              ")]),i("select-shop",{ref:"selectShop",attrs:{shopIds:t.info?t.info.support_shop:[],type:"group",groupParams:t.groupParams,disabled:t.isEdit&&t.activityState>t.ACTIVITY_STATUS.PUBLISHER},on:{change:t.onSelectShop}})],1)],1)],1)],1):t._e(),i("a-row",{attrs:{gutter:8}},[i("a-col",{attrs:{span:10}},[i("st-form-item",{attrs:{required:""}},[i("span",{attrs:{slot:"label"},slot:"label"},[t._v("\n              发布状态\n              "),i("st-help-tooltip",{attrs:{id:"TBPTXJ006"}})],1),i("a-radio-group",{attrs:{defaultValue:t.releaseStatus||t.publishedType[0].value,disabled:t.isEdit&&t.activityState>t.ACTIVITY_STATUS.PUBLISHER},model:{value:t.releaseStatus,callback:function(e){t.releaseStatus=e},expression:"releaseStatus"}},t._l(t.publishedType,(function(e){return i("a-radio",{key:e.value,attrs:{value:e.value}},[t._v("\n                "+t._s(e.label)+"\n              ")])})),1)],1),i("st-form-item",{directives:[{name:"show",rawName:"v-show",value:t.releaseStatus===t.publishedType[2].value,expression:"releaseStatus === publishedType[2].value"}],attrs:{label:"发布时间",required:""}},[i("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.published_time,expression:"decorators.published_time"}],attrs:{disabledDate:t.disabledDate,showTime:{format:"HH:mm"},format:"YYYY-MM-DD HH:mm"}})],1)],1)],1)],2)],1)])},a=[],n=(i("c5f6"),i("d2d7")),o=i("c32d"),s=i.n(o),c=i("6f91"),u=i("2138"),d={serviceInject:function(){return{userService:u["a"]}},rxState:function(){return{publishedType:this.userService.getOptions$("group_buy.published_type")}},bem:{basic:"brand-marketing-group-form"},props:{isEdit:{type:Boolean,default:!1},info:{type:Object,default:function(){}},form:{type:Object,default:function(){return{}}},decorators:{type:Object,default:function(){return{}}},groupParams:{type:Object,default:function(){return{type:null,id:null}}},loading:{type:Boolean},confirmLoading:{type:Boolean},showSelectShop:{type:Boolean,default:function(){return!0}}},mounted:function(){this.isEdit&&this.setFieldsValue()},data:function(){return{ACTIVITY_STATUS:c["a"],groupName:"",errTips:"",showErr:!1,activityState:Number,isLimit:!0,releaseStatus:1,publishTime:null,activityOptions:{start:{showTime:!0,disabledBegin:s()().format("YYYY-MM-DD"),placeholder:"开始日期",disabled:!1,format:"YYYY-MM-DD HH:mm:ss"},end:{showTime:!0,placeholder:"结束日期",disabled:!1,format:"YYYY-MM-DD HH:mm:ss"}},shopIds:[]}},methods:{updateShop:function(){this.$refs.selectShop.clearShopList()},limitStock:function(t){this.isLimit=t.target.checked},onSelectShop:function(t){this.shopIds=t,this.shopIds.length&&(this.errTips="",this.showErr=!1)},changeName:function(t){this.groupName=t.target.value},disabledDate:function(t){return t&&t.format("YYYY-MM-DD HH:mm")<s()().format("YYYY-MM-DD HH:mm")},onSubmit:function(){var t=this,e=!1;this.showSelectShop&&!this.shopIds.length&&(this.errTips="请选择门店",this.showErr=!0,e=!0),this.form.validate().then((function(i){e||t.$emit("onsubmit",{activity_name:i.activity_name,start_time:s()(i.activity_time[0]).format("YYYY-MM-DD HH:mm:ss"),end_time:s()(i.activity_time[1]).format("YYYY-MM-DD HH:mm:ss"),group_sum:+i.group_sum,valid_time:+i.valid_time,is_limit_stock:t.isLimit?1:0,stock_total:t.isLimit?+i.stock_total:0,shop_ids:t.shopIds,published_type:t.releaseStatus,published_time:s()(i.published_time).format("YYYY-MM-DD HH:mm:ss")})}))},setFieldsValue:function(){this.releaseStatus=this.info.published_type,this.activityState=Number(this.info.activity_state.id),this.isLimit=1===this.info.is_limit_stock,this.shopIds=this.info.support_shop,this.groupName=this.info.activity_name,this.form.setFieldsValue({activity_name:this.info.activity_name,group_sum:this.info.group_sum,valid_time:this.info.valid_time,stock_total:this.info.stock_total,activity_time:[this.info.start_time,this.info.end_time]}),this.releaseStatus===this.publishedType[2].value&&this.form.setFieldsValue({published_time:s()(this.info.published_time)}),this.activityOptions.start.disabled=this.isEdit&&this.activityState>this.ACTIVITY_STATUS.PUBLISHER,this.activityOptions.end.disabled=this.isEdit&&this.activityState>=this.ACTIVITY_STATUS.END}},components:{SelectShop:n["a"]}},l=d,p=i("2877"),h=Object(p["a"])(l,r,a,!1,null,null,null);e["a"]=h.exports},e42c:function(t,e,i){"use strict";i.r(e);var r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("group-form",{attrs:{form:t.form,decorators:t.decorators,loading:t.loading.addGroup,confirmLoading:t.loading.addGroup,isEdit:!0,info:t.info,shopIds:t.shopList,groupParams:t.groupParams},on:{onsubmit:t.onSubmit}},[i("template",{slot:"choose-product"},[i("a-row",{attrs:{gutter:8}},[i("a-col",{attrs:{span:10}},[i("st-form-item",{attrs:{label:"选择储值卡",required:""}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.depositId,expression:"decorators.depositId"}],attrs:{type:"hidden"}}),i("a-select",{attrs:{showSearch:"",placeholder:"请选择储值卡",disabled:t.activityState>=t.ACTIVITY_STATUS.NO_START},on:{change:t.changeSelect},model:{value:t.depositId,callback:function(e){t.depositId=e},expression:"depositId"}},t._l(t.list.list,(function(e,r){return i("a-select-option",{key:r,attrs:{value:e.id}},[t._v("\n              "+t._s(e.product_name)+"\n            ")])})),1)],1)],1)],1),i("a-row",{attrs:{gutter:8}},[i("a-col",{attrs:{span:16}},[i("st-form-item",{attrs:{label:"优惠设置",help:t.tableText,validateStatus:t.tableErr?"error":"",required:""}},[i("div",{class:t.basic("table")},[i("st-table",{attrs:{rowKey:"id",dataSource:t.currentStored,columns:t.columnsGroupStored,pagination:!1},scopedSlots:t._u([{key:"discount",fn:function(e,r){return[i("st-input-number",{staticStyle:{width:"110px"},attrs:{float:!0,disabled:t.activityState>=t.ACTIVITY_STATUS.NO_START},on:{input:t.setPriceChange},model:{value:r.group_price,callback:function(e){t.$set(r,"group_price",e)},expression:"record.group_price"}},[i("template",{slot:"addonAfter"},[t._v("\n                    元\n                  ")])],2)]}}])})],1)])],1)],1)],1)],2)},a=[],n=(i("c5f6"),i("dcb1")),o=i("1b9b"),s=i("b0d9"),c=(i("d2d7"),i("2527")),u=(i("c32d"),i("6f91")),d={name:"PageBrandMarketingGroupEditDeposit",bem:{basic:"brand-marketing-group-deposit"},serviceInject:function(){return{edit:o["EditDepositService"],pattern:c["a"]}},rxState:function(){return{loading:this.edit.loading$,info:this.edit.info$,list:this.edit.list$}},components:{GroupForm:n["a"]},data:function(){var t=this.$stForm.create(),e=t.decorators(s["b"]);return{form:t,decorators:e,columnsGroupStored:s["a"],groupParams:{type:2,id:null},activityState:Number,depositId:"",currentStored:[],shopIds:[],ACTIVITY_STATUS:u["a"],shopList:null,tableText:"",tableErr:""}},mounted:function(){this.setFieldsValue()},methods:{setPriceChange:function(){this.currentStored[0].group_price?(this.tableText="",this.tableErr=!1):(this.tableText="请输入拼团价格",this.tableErr=!0)},changeSelect:function(t){var e=this;this.form.setFieldsValue({depositId:t}),this.list.list.filter((function(i){i.id==t&&(e.currentStored=i.product_spec)})),this.groupParams.id=this.depositId},onSubmit:function(t){var e=this,i=[{sku_id:this.currentStored[0].sku_id,group_price:this.currentStored[0].group_price}];t.id=this.$searchQuery.id,t.product_type=2,t.product_id=this.depositId,t.sku=i,this.edit.editGroup(t).subscribe((function(t){e.$router.push({path:"/brand/marketing/plugin/group/list"})}))},setFieldsValue:function(){this.activityState=this.info.activity_state.id,this.depositId=this.info.product.id,this.currentStored=this.info.sku,this.shopList=this.info.support_shop||[],this.form.setFieldsValue({depositId:this.info.product.id})}}},l=d,p=i("2877"),h=Object(p["a"])(l,r,a,!1,null,null,null);e["default"]=h.exports}}]);