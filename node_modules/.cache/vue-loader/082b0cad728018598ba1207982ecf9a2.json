{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhigang/Desktop/styd/web/src/views/biz-components/schedule/date#/month-board.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/biz-components/schedule/date#/month-board.vue","mtime":1591147717112},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js","mtime":1591062572376}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport moment from 'moment'\n\nexport default {\n  name: 'MonthBoard',\n  bem: {\n    basic: 'months-group-board',\n    bHeader: 'board-header',\n    boardContent: 'board-content',\n    dayContent: 'day-content',\n    popoverBox: 'popover-box',\n    addBtnContent: 'add-btn-content'\n  },\n  props: {\n    addTitle: {\n      type: String,\n      default: '新增团体课'\n    },\n    courses: {\n      type: Array,\n      default: () => {\n        return []\n      }\n    }\n  },\n  watch: {\n    $route(val) {\n      this.init()\n    },\n    courses() {\n      this.getCoursesList()\n    }\n  },\n  data() {\n    return {\n      date: '',\n      // 星期一到星期日文字\n      weekList: moment()\n        .localeData()\n        .weekdays(),\n      // 日列表\n      dayList: []\n    }\n  },\n  created() {\n    this.init()\n    this.getCoursesList()\n  },\n  methods: {\n    onPopoverMouseEnter(day) {\n      day.popoverShow = true\n    },\n    init() {\n      this.date = this.$searchQuery.start_date\n      this.dayList = this.getCurrentMonthDayList()\n    },\n    getCurrentMonthDayList() {\n      // 当前日期的月份\n      const nowMonth = moment(this.date).month()\n      let dates = []\n      for (let i = 0; i < 42; i++) {\n        const startDate = moment(this.date).date(1)\n        startDate.startOf('week')\n        dates[i] = startDate.weekday(i - 1)\n      }\n      // 判断当前是否含有上个月7天的数据，如果有则删除\n      const startOfMonth = moment(this.date)\n        .startOf('month')\n        .format('YYYY-MM-DD')\n      const firstDay = dates.findIndex(item => {\n        return item.format('YYYY-MM-DD') === startOfMonth\n      })\n      if (firstDay > 6) {\n        dates = dates.slice(7, dates.length)\n      }\n      // 判断是否包含下个月7天的数据，如果有则删除\n      const startOfNextMonth = moment(this.date)\n        .month(moment(this.date).month() + 1)\n        .startOf('month')\n        .format('YYYY-MM-DD')\n      const nextMonthFirstDay = dates.findIndex(item => {\n        return item.format('YYYY-MM-DD') === startOfNextMonth\n      })\n      if (nextMonthFirstDay !== -1 && dates.length - nextMonthFirstDay > 6) {\n        dates = dates.slice(0, dates.length - 7)\n      }\n      return dates.map(item => {\n        return {\n          date: item.date(),\n          fullDate: item.format('YYYY-MM-DD'),\n          current: item.format('YYYY-MM-DD') === moment().format('YYYY-MM-DD'),\n          isThisMonth: item.month() === nowMonth,\n          addBtnShow: false,\n          popoverShow: false,\n          courses: []\n        }\n      })\n    },\n    onMouseMove(day, er) {\n      if (day.courses.length !== 0) {\n        day.popoverShow = true\n        return\n      }\n      this.dayList.forEach(item => {\n        item.addBtnShow = item.fullDate === day.fullDate ? true : false\n      })\n    },\n    onMouseLeave(day) {\n      day.addBtnShow = false\n    },\n    onClickAddBtn(e) {\n      this.$emit('onClickAddBtn', {\n        date: e.date,\n        fullDate: e.fullDate\n      })\n    },\n    hidePopover(e) {\n      e.popoverShow = false\n    },\n    onClickCourse(e) {\n      this.$emit('onClickCourse', {\n        ...e\n      })\n    },\n    getCoursesList() {\n      this.dayList.forEach(day => {\n        this.courses.forEach(course => {\n          if (day.fullDate === course.start_date) {\n            day.courses.push(course)\n          }\n        })\n      })\n    }\n  }\n}\n",null]}