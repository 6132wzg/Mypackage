{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js!/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhigang/Desktop/styd/web/src/views/pages/shop/member/info/sold.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/pages/shop/member/info/sold.vue","mtime":1600926556366},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js","mtime":1591062572376}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport formDate from \"./sold#/form-date.vue\";\nimport { SoldService } from \"./sold.service\";\nimport { classrecord } from \"./sold.config.ts\";\nimport tableMixin from '@/mixins/table.mixin';\nimport ScheduleSmallCourseReservedCourse from '@/views/biz-modals/schedule/small-course/reserved-course';\nimport ScheduleSmallCourseRemedialCourse from '@/views/biz-modals/schedule/small-course/remedial-course';\nimport ScheduleSmallCourseRemedialInfo from '@/views/biz-modals/schedule/small-course/remedial-info';\nexport default {\n  mixins: [tableMixin],\n  serviceInject: function serviceInject() {\n    return {\n      soldService: SoldService\n    };\n  },\n  rxState: function rxState() {\n    return {\n      soldListInfo: this.soldService.soldListInfo$,\n      soldPage: this.soldService.soldPage$,\n      auth: this.soldService.auth$\n    };\n  },\n  modals: {\n    ScheduleSmallCourseReservedCourse: ScheduleSmallCourseReservedCourse,\n    ScheduleSmallCourseRemedialCourse: ScheduleSmallCourseRemedialCourse,\n    ScheduleSmallCourseRemedialInfo: ScheduleSmallCourseRemedialInfo\n  },\n  computed: {\n    classrecord: classrecord\n  },\n  components: {\n    formDate: formDate\n  },\n  data: function data() {\n    return {\n      form: {\n        start_date: '',\n        // 上课日期\n        reserve_type: -1,\n        reserve_status: -1,\n        checkin_status: -1,\n        course_name: undefined,\n        size: 20,\n        page: 1\n      }\n    };\n  },\n  created: function created() {// let self = this\n    // this.soldService.init(self.$searchQuery.id, self.form).subscribe()\n  },\n  methods: {\n    /* 取消预约 */\n    reserveStatus: function reserveStatus(record) {\n      var self = this;\n      this.$confirm({\n        title: '提示',\n        content: '确认取消预约并退还相应费用？',\n        okText: '确认取消',\n        cancelText: '再看看',\n        onOk: function onOk() {\n          var getdata = {\n            id: self.$searchQuery.id,\n            reserve_type: record.reserve_type.id,\n            reserve_id: record.id\n          };\n          self.soldService.getMemberCancel(getdata).subscribe(function (res) {\n            self.soldService.init(self.$searchQuery.id, self.form).subscribe();\n          });\n        },\n        onCancel: function onCancel() {}\n      });\n    },\n\n    /* 课程签到 */\n    isCheckin: function isCheckin(record) {\n      var self = this;\n      this.$confirm({\n        title: '提示',\n        content: '确认签到?',\n        onOk: function onOk() {\n          var getdata = {\n            id: self.$searchQuery.id,\n            reserve_type: record.reserve_type.id,\n            reserve_id: record.id\n          };\n          console.log(record, getdata);\n          self.soldService.getMemberSign(getdata).subscribe(function (res) {\n            self.soldService.init(self.$searchQuery.id, self.form).subscribe();\n          });\n        },\n        onCancel: function onCancel() {}\n      });\n    },\n    handleChange: function handleChange(value) {\n      console.log(\"selected \".concat(value));\n    },\n    // 上课记录分页\n    reservePageChange: function reservePageChange(e) {\n      this.form.size = e.pageSize;\n      this.form.page = e.current;\n    },\n    // 入场记录分页\n    entrancePageChange: function entrancePageChange(e) {\n      this.soldService.getMemberEntrance(this.$searchQuery.id, {\n        size: e.pageSize,\n        page: e.current\n      }).subscribe();\n    },\n    // 查看补课\n    getMessage: function getMessage(id) {\n      this.$modalRouter.push({\n        name: 'schedule-small-course-remedial-info',\n        props: {\n          id: id\n        }\n      });\n      this.show = false;\n    },\n    // 补签到\n    checkSign: function checkSign(id) {\n      this.soldService.checkSign(id).subscribe(this.getReserveInfo);\n    },\n    // 取消预约\n    del: function del(id) {\n      this.soldService.del(id).subscribe(this.getReserveInfo);\n    },\n    // 请假\n    leave: function leave(id) {\n      this.soldService.leave(id).subscribe(this.getReserveInfo);\n    },\n    // 补课回显\n    remedialCourse: function remedialCourse(reserve_id) {\n      var _this = this;\n\n      this.$modalRouter.push({\n        name: 'schedule-small-course-remedial-course',\n        props: {\n          reserve_id: reserve_id\n        },\n        on: {\n          ok: function ok() {\n            _this.$router.reload();\n          }\n        }\n      });\n      this.show = false;\n    },\n    getReserveInfo: function getReserveInfo() {\n      this.$router.reload();\n    }\n  },\n  watch: {\n    form: {\n      handler: function handler() {\n        this.soldService.getMemberReserve(this.$searchQuery.id, this.form).subscribe();\n      },\n      deep: true\n    }\n  }\n};",{"version":3,"sources":["sold.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"member-info-sold\">\n    <formDate v-model=\"form\"></formDate>\n    <a-row :gutter=\"24\" class=\"mg-t16\">\n      <a-col :lg=\"24\">\n        <st-table\n          rowKey=\"id\"\n          :columns=\"classrecord\"\n          :dataSource=\"soldListInfo\"\n          @change=\"reservePageChange\"\n          :page=\"soldPage\"\n        >\n          <div slot=\"reserve_type\" slot-scope=\"text, record\">\n            {{ record.reserve_type.name }}\n          </div>\n          <div slot=\"reserve_status\" slot-scope=\"text, record\">\n            {{\n              record.mina_reserve_status | enumFilter('reserve.reserve_status')\n            }}\n          </div>\n          <div slot=\"is_checkin\" slot-scope=\"text, record\">\n            <div>\n              <span v-if=\"record.mina_checkin_status === 0\"></span>\n              {{ text }}\n            </div>\n          </div>\n          <div slot=\"action\" slot-scope=\"text, record\">\n            <st-table-actions>\n              <a\n                v-if=\"\n                  record.auth['shop:reserve:personal_course_reserve|del'] &&\n                    record.reserve_type.id === 1\n                \"\n                @click=\"reserveStatus(record)\"\n              >\n                取消预约\n              </a>\n              <a\n                v-if=\"\n                  record.auth['shop:reserve:personal_course_reserve|checkin'] &&\n                    record.reserve_type.id === 1\n                \"\n                @click=\"isCheckin(record)\"\n              >\n                签到\n              </a>\n              <a\n                v-if=\"\n                  record.auth[\n                    'shop:reserve:personal_team_course_reserve|del'\n                  ] && record.reserve_type.id === 2\n                \"\n                @click=\"reserveStatus(record)\"\n              >\n                取消预约\n              </a>\n              <a\n                v-if=\"\n                  record.auth[\n                    'shop:reserve:personal_team_course_reserve|checkin'\n                  ] && record.reserve_type.id === 2\n                \"\n                @click=\"isCheckin(record)\"\n              >\n                签到\n              </a>\n              <a\n                v-if=\"\n                  record.auth['shop:reserve:team_course_reserve|del'] &&\n                    record.reserve_type.id === 3\n                \"\n                @click=\"reserveStatus(record)\"\n              >\n                取消预约\n              </a>\n              <a\n                v-if=\"\n                  record.auth['shop:reserve:team_course_reserve|checkin'] &&\n                    record.reserve_type.id === 3\n                \"\n                @click=\"isCheckin(record)\"\n              >\n                签到\n              </a>\n              <a\n                v-if=\"\n                  record.auth['shop:reserve:small_class_course_reserve|del'] &&\n                    record.reserve_type.id === 5\n                \"\n                @click=\"reserveStatus(record)\"\n              >\n                取消预约\n              </a>\n              <a\n                v-if=\"\n                  record.auth['shop:reserve:small_class_course_reserve|checkin']\n                \"\n                @click=\"isCheckin(record)\"\n              >\n                签到\n              </a>\n              <a\n                @click=\"getMessage(record.id)\"\n                v-if=\"\n                  record.auth[\n                    'shop:reserve:small_class_course_reserve|get_supplement'\n                  ]\n                \"\n              >\n                查看补课\n              </a>\n              <a\n                @click=\"leave(record.id)\"\n                v-if=\"\n                  record.auth['shop:reserve:small_class_course_reserve|leave']\n                \"\n              >\n                请假\n              </a>\n              <a\n                @click=\"checkSign(record.id)\"\n                v-if=\"\n                  record.auth[\n                    'shop:reserve:small_class_course_reserve|supplement_checkin'\n                  ]\n                \"\n              >\n                补签到\n              </a>\n              <a\n                @click=\"remedialCourse(record.id)\"\n                v-if=\"\n                  record.auth[\n                    'shop:reserve:small_class_course_reserve|supplement'\n                  ]\n                \"\n              >\n                补课\n              </a>\n            </st-table-actions>\n          </div>\n        </st-table>\n      </a-col>\n    </a-row>\n  </div>\n</template>\n<script>\nimport formDate from './sold#/form-date.vue'\nimport { SoldService } from './sold.service'\nimport { classrecord } from './sold.config.ts'\nimport tableMixin from '@/mixins/table.mixin'\nimport ScheduleSmallCourseReservedCourse from '@/views/biz-modals/schedule/small-course/reserved-course'\nimport ScheduleSmallCourseRemedialCourse from '@/views/biz-modals/schedule/small-course/remedial-course'\nimport ScheduleSmallCourseRemedialInfo from '@/views/biz-modals/schedule/small-course/remedial-info'\nexport default {\n  mixins: [tableMixin],\n  serviceInject() {\n    return {\n      soldService: SoldService\n    }\n  },\n  rxState() {\n    return {\n      soldListInfo: this.soldService.soldListInfo$,\n      soldPage: this.soldService.soldPage$,\n      auth: this.soldService.auth$\n    }\n  },\n  modals: {\n    ScheduleSmallCourseReservedCourse,\n    ScheduleSmallCourseRemedialCourse,\n    ScheduleSmallCourseRemedialInfo\n  },\n  computed: {\n    classrecord\n  },\n  components: {\n    formDate\n  },\n  data() {\n    return {\n      form: {\n        start_date: '', // 上课日期\n        reserve_type: -1,\n        reserve_status: -1,\n        checkin_status: -1,\n        course_name: undefined,\n        size: 20,\n        page: 1\n      }\n    }\n  },\n  created() {\n    // let self = this\n    // this.soldService.init(self.$searchQuery.id, self.form).subscribe()\n  },\n  methods: {\n    /* 取消预约 */\n    reserveStatus(record) {\n      let self = this\n      this.$confirm({\n        title: '提示',\n        content: '确认取消预约并退还相应费用？',\n        okText: '确认取消',\n        cancelText: '再看看',\n        onOk() {\n          let getdata = {\n            id: self.$searchQuery.id,\n            reserve_type: record.reserve_type.id,\n            reserve_id: record.id\n          }\n          self.soldService.getMemberCancel(getdata).subscribe(res => {\n            self.soldService.init(self.$searchQuery.id, self.form).subscribe()\n          })\n        },\n        onCancel() {}\n      })\n    },\n    /* 课程签到 */\n    isCheckin(record) {\n      let self = this\n      this.$confirm({\n        title: '提示',\n        content: '确认签到?',\n        onOk() {\n          let getdata = {\n            id: self.$searchQuery.id,\n            reserve_type: record.reserve_type.id,\n            reserve_id: record.id\n          }\n          console.log(record, getdata)\n          self.soldService.getMemberSign(getdata).subscribe(res => {\n            self.soldService.init(self.$searchQuery.id, self.form).subscribe()\n          })\n        },\n        onCancel() {}\n      })\n    },\n    handleChange(value) {\n      console.log(`selected ${value}`)\n    },\n    // 上课记录分页\n    reservePageChange(e) {\n      this.form.size = e.pageSize\n      this.form.page = e.current\n    },\n    // 入场记录分页\n    entrancePageChange(e) {\n      this.soldService\n        .getMemberEntrance(this.$searchQuery.id, {\n          size: e.pageSize,\n          page: e.current\n        })\n        .subscribe()\n    },\n    // 查看补课\n    getMessage(id) {\n      this.$modalRouter.push({\n        name: 'schedule-small-course-remedial-info',\n        props: {\n          id: id\n        }\n      })\n      this.show = false\n    },\n    // 补签到\n    checkSign(id) {\n      this.soldService.checkSign(id).subscribe(this.getReserveInfo)\n    },\n    // 取消预约\n    del(id) {\n      this.soldService.del(id).subscribe(this.getReserveInfo)\n    },\n    // 请假\n    leave(id) {\n      this.soldService.leave(id).subscribe(this.getReserveInfo)\n    },\n    // 补课回显\n    remedialCourse(reserve_id) {\n      this.$modalRouter.push({\n        name: 'schedule-small-course-remedial-course',\n        props: {\n          reserve_id: reserve_id\n        },\n        on: {\n          ok: () => {\n            this.$router.reload()\n          }\n        }\n      })\n      this.show = false\n    },\n    getReserveInfo() {\n      this.$router.reload()\n    }\n  },\n  watch: {\n    form: {\n      handler() {\n        this.soldService\n          .getMemberReserve(this.$searchQuery.id, this.form)\n          .subscribe()\n      },\n      deep: true\n    }\n  }\n}\n</script>\n"],"sourceRoot":"src/views/pages/shop/member/info"}]}