{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhigang/Desktop/styd/web/src/views/pages/brand/marketing/plugin/lottery/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/pages/brand/marketing/plugin/lottery/index.vue","mtime":1600926556141},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js","mtime":1591062572376}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { IndexService } from './index.service'\nimport MarkteingPluginTitle from '../../components#/marketing-title'\nimport { columns } from './index.config.ts'\nimport tableMixin from '@/mixins/table.mixin'\nimport { ACTIVITY_STATUS } from '@/constants/marketing/lottery'\nimport useShare from '@/hooks/marketing/share.hook'\nimport BrandMarketingPluginLotteryTable from '@/views/biz-modals/brand/marketing/lottery-table'\nexport default {\n  name: 'PluginLotteryIndex',\n  mixins: [tableMixin],\n  modals: {\n    BrandMarketingPluginLotteryTable\n  },\n  data() {\n    return {\n      ACTIVITY_STATUS\n    }\n  },\n  bem: {\n    bPage: 'page-brand-marketing-plugin-lottery-index'\n  },\n  serviceInject() {\n    return {\n      indexService: IndexService\n    }\n  },\n  hooks() {\n    return {\n      share: useShare()\n    }\n  },\n  rxState() {\n    return {\n      list: this.indexService.list$,\n      page: this.indexService.page$,\n      loading: this.indexService.loading$,\n      info: this.indexService.info$,\n      status: this.indexService.status$,\n      auth: this.indexService.auth$\n    }\n  },\n  components: {\n    MarkteingPluginTitle\n  },\n  computed: {\n    columns\n  },\n  methods: {\n    onConfigHandle() {\n      this.$router.push({\n        path: '/brand/setting/mina/index'\n      })\n    },\n    onGeneralize(record) {\n      // let is_auth = record.is_auth\n      // 绑定小程序\n      this.indexService.getPosterInfo(record.id).subscribe(res => {\n        const info = this.info\n        const shsInfo = {\n          qrcode_url: info.qrcode_url,\n          sub_name: info.sub_name\n        }\n        const isAuth = res.is_auth\n        this.share.poster({ isAuth, shsInfo, shsPath: '/saas/lottery_poster' })\n      })\n    },\n    // 停止优惠券模板\n    onStop(record) {\n      if (record.activity_status === this.ACTIVITY_STATUS.ISSTOPED) {\n        // this.$router.push({\n        //   path: '/brand/marketing/plugin/lottery/info/prize',\n        //   query: {\n        //     id: record.id\n        //   }\n        // })\n        this.$modalRouter.push({\n          name: 'brand-marketing-plugin-lottery-table',\n          props: { id: record.id, title: '奖品数据' }\n        })\n        return\n      }\n      let that = this\n      this.$confirm({\n        title: '提示',\n        okText:\n          record.activity_status === this.ACTIVITY_STATUS.ISHOLDING\n            ? '取消'\n            : '结束',\n        cancelText: '我再想想',\n        content:\n          record.activity_status === this.ACTIVITY_STATUS.ISHOLDING\n            ? '确认取消该活动'\n            : '确认要结束',\n        onOk() {\n          that.indexService.stopActivity(record.id).subscribe(res => {\n            that.$router.reload()\n          })\n        }\n      })\n    }\n  }\n}\n",{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2IA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/pages/brand/marketing/plugin/lottery","sourcesContent":["<template>\n  <st-panel-layout :class=\"bPage()\">\n    <MarkteingPluginTitle pathName=\"brand-marketing-plugin-lottery-index\" />\n    <st-panel app>\n      <div :class=\"bPage('action')\" class=\"mg-b16\">\n        <div>\n          <router-link to=\"./add\" v-if=\"auth.add\">\n            <st-button type=\"primary\" icon=\"add\" class=\"mg-r16\">\n              新增活动\n            </st-button>\n          </router-link>\n          <router-link to=\"./checkin\" v-if=\"auth.destory\">\n            <st-button type=\"default\">核销兑换码</st-button>\n          </router-link>\n          <st-button @click=\"onConfigHandle\" class=\"mg-l16\">\n            配置到小程序\n          </st-button>\n        </div>\n        <div style=\"text-align:right\">\n          <a-select\n            placeholder=\"活动状态\"\n            v-model=\"$searchQuery.activity_status\"\n            class=\"mg-r16\"\n            @change=\"onSingleSearch('activity_status', $event)\"\n            style=\"width:100px;display:inline-block;\"\n          >\n            <a-select-option\n              v-for=\"(item, index) of status\"\n              :key=\"index\"\n              :value=\"item.value\"\n            >\n              {{ item.label }}\n            </a-select-option>\n          </a-select>\n          <st-input-search\n            style=\"display:inline-block;\"\n            v-model=\"$searchQuery.keyword\"\n            @search=\"onKeywordsSearch('keyword', $event)\"\n            placeholder=\"搜索活动名称\"\n          ></st-input-search>\n        </div>\n      </div>\n\n      <st-table\n        :page=\"page\"\n        @change=\"onTableChange\"\n        :loading=\"loading.getActivityList\"\n        :columns=\"columns\"\n        :dataSource=\"list\"\n        rowKey=\"id\"\n      >\n        <span slot=\"join_num\" slot-scope=\"record\">\n          <router-link\n            :to=\"{\n              name: 'brand-marketing-plugin-lottery-info-users',\n              query: { id: record.id }\n            }\"\n          >\n            {{ record.activity_join_num }}\n          </router-link>\n        </span>\n        <template slot=\"activity_status_name\" slot-scope=\"text, record\">\n          <st-text\n            :status=\"{\n              error: record.activity_status === 2,\n              success: record.activity_status === 1,\n              default: record.activity_status === 3\n            }\"\n          >\n            {{ text }}\n          </st-text>\n        </template>\n        <span slot=\"time\" slot-scope=\"record\">\n          {{ record.activity_start_time }}~{{ record.activity_end_time }}\n        </span>\n        <span slot=\"prize_num\" slot-scope=\"record\">\n          <router-link\n            :to=\"{\n              name: 'brand-marketing-plugin-lottery-info-users',\n              query: { id: record.id, prize_status: 1 }\n            }\"\n          >\n            {{ record.activity_prize_num }}\n          </router-link>\n        </span>\n        <div slot=\"action\" slot-scope=\"text, record\">\n          <st-table-actions>\n            <!-- <router-link\n              v-if=\"record.activity_status !== ACTIVITY_STATUS.ISSTOPED\"\n              :to=\"{\n                name: 'brand-marketing-plugin-lottery-info-prize',\n                query: { id: record.id }\n              }\"\n            >\n              奖品数据\n            </router-link> -->\n            <a\n              v-if=\"record.activity_status !== ACTIVITY_STATUS.ISSTOPED\"\n              v-modal-link=\"{\n                name: 'brand-marketing-plugin-lottery-table',\n                props: { id: record.id, type: 'Sale', title: '奖品数据' }\n              }\"\n            >\n              奖品数据\n            </a>\n            <a\n              v-if=\"record.activity_status !== ACTIVITY_STATUS.ISSTOPED\"\n              @click=\"onGeneralize(record)\"\n            >\n              推广\n            </a>\n            <router-link\n              v-if=\"record.activity_status !== ACTIVITY_STATUS.ISSTOPED\"\n              :to=\"{\n                name: 'brand-marketing-plugin-lottery-add',\n                query: {\n                  activity_id: record.id,\n                  status: record.activity_status\n                }\n              }\"\n            >\n              编辑\n            </router-link>\n            <a @click=\"onStop(record)\">\n              {{\n                record.activity_status === ACTIVITY_STATUS.ISSTOPED\n                  ? '奖品数据'\n                  : record.activity_status === ACTIVITY_STATUS.DISABLED\n                  ? '结束'\n                  : '取消'\n              }}\n            </a>\n          </st-table-actions>\n        </div>\n      </st-table>\n    </st-panel>\n  </st-panel-layout>\n</template>\n<script>\nimport { IndexService } from './index.service'\nimport MarkteingPluginTitle from '../../components#/marketing-title'\nimport { columns } from './index.config.ts'\nimport tableMixin from '@/mixins/table.mixin'\nimport { ACTIVITY_STATUS } from '@/constants/marketing/lottery'\nimport useShare from '@/hooks/marketing/share.hook'\nimport BrandMarketingPluginLotteryTable from '@/views/biz-modals/brand/marketing/lottery-table'\nexport default {\n  name: 'PluginLotteryIndex',\n  mixins: [tableMixin],\n  modals: {\n    BrandMarketingPluginLotteryTable\n  },\n  data() {\n    return {\n      ACTIVITY_STATUS\n    }\n  },\n  bem: {\n    bPage: 'page-brand-marketing-plugin-lottery-index'\n  },\n  serviceInject() {\n    return {\n      indexService: IndexService\n    }\n  },\n  hooks() {\n    return {\n      share: useShare()\n    }\n  },\n  rxState() {\n    return {\n      list: this.indexService.list$,\n      page: this.indexService.page$,\n      loading: this.indexService.loading$,\n      info: this.indexService.info$,\n      status: this.indexService.status$,\n      auth: this.indexService.auth$\n    }\n  },\n  components: {\n    MarkteingPluginTitle\n  },\n  computed: {\n    columns\n  },\n  methods: {\n    onConfigHandle() {\n      this.$router.push({\n        path: '/brand/setting/mina/index'\n      })\n    },\n    onGeneralize(record) {\n      // let is_auth = record.is_auth\n      // 绑定小程序\n      this.indexService.getPosterInfo(record.id).subscribe(res => {\n        const info = this.info\n        const shsInfo = {\n          qrcode_url: info.qrcode_url,\n          sub_name: info.sub_name\n        }\n        const isAuth = res.is_auth\n        this.share.poster({ isAuth, shsInfo, shsPath: '/saas/lottery_poster' })\n      })\n    },\n    // 停止优惠券模板\n    onStop(record) {\n      if (record.activity_status === this.ACTIVITY_STATUS.ISSTOPED) {\n        // this.$router.push({\n        //   path: '/brand/marketing/plugin/lottery/info/prize',\n        //   query: {\n        //     id: record.id\n        //   }\n        // })\n        this.$modalRouter.push({\n          name: 'brand-marketing-plugin-lottery-table',\n          props: { id: record.id, title: '奖品数据' }\n        })\n        return\n      }\n      let that = this\n      this.$confirm({\n        title: '提示',\n        okText:\n          record.activity_status === this.ACTIVITY_STATUS.ISHOLDING\n            ? '取消'\n            : '结束',\n        cancelText: '我再想想',\n        content:\n          record.activity_status === this.ACTIVITY_STATUS.ISHOLDING\n            ? '确认取消该活动'\n            : '确认要结束',\n        onOk() {\n          that.indexService.stopActivity(record.id).subscribe(res => {\n            that.$router.reload()\n          })\n        }\n      })\n    }\n  }\n}\n</script>\n"]}]}