(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["shop-sold-card-info-member"],{"11d3":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("st-panel-layout",{class:t.basic()},[n("st-panel",{attrs:{title:t.$c("member_card")+"详情"}},[n("div",{attrs:{slot:"actions"},slot:"actions"},[n("st-btn-actions",{attrs:{options:t.btnOptions}})],1),n("a-row",{attrs:{gutter:24}},[n("a-col",{attrs:{span:9}},[n("st-info",[n("st-info-item",{attrs:{label:"卡名"}},[t._v(t._s(t.info.card_name))]),n("st-info-item",{attrs:{label:"类型"}},[t._v("\n            "+t._s(t._f("enumFilter")(t.info.card_type,"sold_common.card_type"))+"\n          ")]),n("st-info-item",{attrs:{label:"初始额度"}},[t._v(t._s(t.info.init_amount))]),n("st-info-item",{attrs:{label:"剩余额度"}},[t._v("\n            "+t._s(t.info.remain_amount)+"\n          ")]),n("st-info-item",{staticClass:"mg-b16",attrs:{label:"有效期"}},[t._v("\n            "+t._s(t.info.start_time)+" 至 "+t._s(t.info.end_time)+"\n          ")]),n("st-info-item",{staticClass:"mg-b0",attrs:{label:"合同编号"}},[t._v("\n            "+t._s(t.info.contract_number)+"\n          ")])],1)],1),n("a-col",{attrs:{span:9}},[n("st-info",[n("st-info-item",{attrs:{label:"所属会员"}},[t._v(t._s(t.info.member_name))]),n("st-info-item",{attrs:{label:"手机号"}},[t._v(t._s(t.info.mobile))]),n("st-info-item",{attrs:{label:"订单号"}},[t._v(t._s(t.info.order_id))]),n("st-info-item",{attrs:{label:"订单状态"}},[t._v("\n            "+t._s(t._f("enumFilter")(t.info.order_status,"sold_common.order_status"))+"\n          ")]),n("st-info-item",{attrs:{label:"当前状态"}},[t._v("\n            "+t._s(t._f("enumFilter")(t.info.card_status,"sold_common.card_status"))+"\n          ")]),n("st-info-item",{attrs:{label:"入场时段"}},[t.info&&t.info.admission_time.type<2?[t._v("\n              "+t._s(t.info.admission_time.name)+"\n            ")]:n("a-popover",{attrs:{title:t.info.admission_time.name}},[n("template",{slot:"content"},[n("st-table",{key:"id",class:t.basic("popover-content"),attrs:{columns:t.enterTimeColumns,dataSource:t.info.admission_time.list,pagination:!1}})],1),n("a",{attrs:{type:"primary"}},[t._v("\n                "+t._s(t.info.admission_time.name)+"\n              ")])],2)],2)],1)],1),n("a-col",{attrs:{span:6}},[n("st-info",[n("st-info-item",{attrs:{label:"允许转让"}},[t._v("\n            "+t._s(t._f("enumFilter")(t.info.is_transferable,"sold_common.is_transferable"))+"\n          ")]),0!==t.info.is_transferable?n("st-info-item",{attrs:{label:"转让手续费"}},[t._v("\n            "+t._s(t.info.transfer_num)+t._s(t._f("enumFilter")(t.info.transfer_unit,"package_course.transfer_unit"))+"\n          ")]):t._e(),n("st-info-item",{attrs:{label:"入场场馆"}},[t.info.admission_range.id<2?[t._v("\n              "+t._s(t.info.admission_range.shop_name)+"\n            ")]:n("a-popover",{attrs:{title:t.info.admission_range.shop_name}},[n("template",{slot:"content"},[n("st-table",{key:"id",class:t.basic("popover-content"),attrs:{columns:t.admissionColumns,dataSource:t.info.admission_range.shops,pagination:!1}})],1),n("a",{attrs:{type:"primary"}},[t._v("\n                "+t._s(t._f("enumFilter")(t.info.admission_range.id,"sold_common.admission_range"))+"\n              ")])],2)],2),n("st-info-item",{attrs:{label:"约课范围"}},[t.info.course_interests.id<2?[t._v("\n              "+t._s(t.info.course_interests.name)+"\n            ")]:n("a-popover",{attrs:{title:t.info.course_interests.name}},[n("template",{slot:"content"},[n("st-table",{key:"id",class:t.basic("popover-content"),attrs:{columns:t.courseColumns,dataSource:t.info.course_interests.courses,pagination:!1}})],1),n("a",{attrs:{type:"primary"}},[t._v("\n                "+t._s(t._f("enumFilter")(t.info.course_interests.id,"sold_common.course_interests"))+"\n              ")])],2)],2),t.info&&2===t.info.card_number_type?n("st-info-item",{attrs:{label:"卡成员"}},[0===t.info.card_member.length?[t._v("\n              无\n            ")]:t._l(t.info.card_member,(function(e,i){return n("router-link",{key:i,attrs:{to:{path:"/shop/member/info/basic",query:{id:e.id}}}},[t._v("\n                "+t._s(e.name)+"\n              ")])}))],2):t._e(),n("st-info-item",{staticClass:"mg-b0",attrs:{label:"备注"}},[t._v("\n            "+t._s(t.info.description)+"\n          ")])],1)],1)],1)],1),n("st-panel",{staticClass:"mg-t16",attrs:{app:"",tabs:t.authTabs}},[n("router-view")],1)],1)},o=[],r=n("a3b2"),s=function(t){return[{text:"查看合同",click:t.toContract,if:t.auth["shop:sold:sold_member_card|export_contract"]},{text:"冻结",click:t.onFreeze,if:t.auth["shop:sold:sold_member_card|frozen"]},{text:"续卡",click:t.onRenewal,if:t.auth["shop:sold:sold_member_card|renew"]},{text:"升级",click:t.onUpgrade,if:t.auth["shop:sold:sold_member_card|upgrade"]},{text:"转让",click:t.onTransfer,if:t.auth["shop:sold:sold_member_card|transfer"]},{text:"退款",click:t.onRefund,if:t.auth["brand_shop:order:order|refund"]},{text:"取消冻结",click:t.onUnfreeze,if:t.auth["shop:sold:sold_member_card|unfrozen"]},{text:"修改有效时间",click:t.onSetTime,if:t.auth["shop:sold:sold_member_card|vaild_time"]},{text:"修改入场vip区域",click:t.onArea,if:t.auth["shop:sold:sold_member_card|vip_region"]},{text:"变更成员",click:t.onChangeMember,if:t.auth["shop:sold:sold_member_card|edit"]},{text:"修改合同备注",click:t.onEditContractDescription,if:t.auth["shop:sold:sold_member_card|edit_contract_remark"]},{text:"重新激活",click:t.onReactive,if:t.auth["shop:sold:sold_member_card|reactivate"]},{text:"对内备注",click:t.onInternalNote,if:t.auth["shop:sold:sold_member_card|internal_description"]},{text:"修改权益",click:function(){return t.soldMemberCardActions.onUpdateRights(t.infoService.id)},if:t.auth["shop:sold:sold_member_card|rights_edit"]}]},a=n("c32d"),c=n.n(a),d=n("fb15"),l=n("49c5"),u=n("a51e"),f=n("1bbb"),m=n("3296"),_=n("3251"),p=n("f076"),b=n("70a6"),h=n("c262"),v=n("1687"),y=n("b6fb"),g={name:"PageShopSoldCardMemberInfo",bem:{basic:"page-shop-sold-info"},modals:{SoldCardArea:d["a"],SoldCardFreeze:l["a"],SoldCardRefund:u["a"],SoldCardSetTime:f["a"],SoldCardTransfer:m["a"],SoldCardMemberReactive:_["a"]},serviceInject:function(){return{infoService:r["InfoService"]}},rxState:function(){return{info:this.infoService.info$,loading:this.infoService.loading$,authTabs:this.infoService.authTabs$,auth:this.infoService.auth$}},beforeCreate:function(){var t=this;this.cardActions.$on("refresh",(function(e){t.$router.reload()}))},hooks:function(){return{cardActions:Object(b["a"])(),internalNoteActions:Object(h["a"])(),contractActions:Object(v["a"])(this),soldMemberCardActions:Object(y["a"])(this)}},computed:{admissionColumns:p["a"],courseColumns:p["b"],enterTimeColumns:p["c"],btnOptions:s},methods:{moment:c.a,toContract:function(){var t=this.info,e="".concat(window.location.origin,"/common/contract-preview?id=").concat(t.order_id);window.open(e)},onFreeze:function(){var t=this;this.$modalRouter.push({name:"sold-card-freeze",props:{id:this.infoService.id},on:{success:function(){t.$router.reload()}}})},onInternalNote:function(){this.internalNoteActions.onOpenModal({id:this.infoService.id})},onReactive:function(){var t=this;this.$modalRouter.push({name:"sold-card-member-reactive",props:{id:this.infoService.id},on:{success:function(){t.$router.reload()}}})},onUnfreeze:function(t){var e=this;this.$confirm({title:"提示",content:"是否取消冻结？",maskClosable:!0,onOk:function(){return e.infoService.unFreeze(e.infoService.id).toPromise().then((function(){e.$router.reload()}))}})},onRenewal:function(){this.cardActions.onRenewal({id:this.infoService.id})},onUpgrade:function(){this.cardActions.upgradeCard({id:this.infoService.id})},onChangeMember:function(){this.cardActions.onChangeMember({id:this.infoService.id})},onTransfer:function(){var t=this;this.$modalRouter.push({name:"sold-card-transfer",props:{id:this.infoService.id,type:"member"},on:{success:function(){t.$router.reload()}}})},onRefund:function(){var t=this;this.$modalRouter.push({name:"sold-card-refund",props:{type:"member",id:this.infoService.id},on:{success:function(){t.$router.reload()}}})},onSetTime:function(){var t=this;this.$modalRouter.push({name:"sold-card-set-time",props:{id:this.infoService.id},on:{success:function(){t.$router.reload()}}})},onArea:function(){var t=this;this.$modalRouter.push({name:"sold-card-area",props:{id:[this.infoService.id]},on:{success:function(){t.$router.reload()}}})},onEditContractDescription:function(){var t=this.info,e=t.order_id,n=t.description;this.contractActions.editDescription({order_id:e,description:n})}}},k=g,S=n("2877"),C=Object(S["a"])(k,i,o,!1,null,null,null);e["default"]=C.exports},a3b2:function(t,e,n){"use strict";n.r(e),n.d(e,"InfoService",(function(){return m}));var i,o,r=n("d225"),s=n("b0b4"),a=n("9ab4"),c=n("0cd5"),d=n("df29"),l=n("4e17"),u=n("c4cc"),f=n("2cbb"),m=function(){function t(e,n){Object(r["a"])(this,t),this.cardApi=e,this.authService=n,this.info$=new d["d"]({}),this.loading$=new d["d"]({}),this.auth$=new d["d"]({}),this.id="",this.authTabs$=this.authService.getAuthTabs$("shop-sold-card-info-member-info",{withQuery:["id","card_type"]})}return Object(s["a"])(t,[{key:"getInfo",value:function(t){var e=this;return this.cardApi.getCardInfo(t,"member").pipe(Object(u["a"])((function(t){e.info$.commit((function(){return t.info})),e.auth$.commit((function(){return t.auth}))})))}},{key:"unFreeze",value:function(t){return this.cardApi.unFreezeCard(t,"member")}},{key:"beforeEach",value:function(t){return this.id=t.meta.query.id,this.getInfo(t.meta.query.id)}}]),t}();Object(a["b"])([Object(d["c"])(),Object(a["d"])("design:type",Function),Object(a["d"])("design:paramtypes",[String]),Object(a["d"])("design:returntype",void 0)],m.prototype,"getInfo",null),Object(a["b"])([Object(d["c"])(),Object(a["d"])("design:type",Function),Object(a["d"])("design:paramtypes",[String]),Object(a["d"])("design:returntype",void 0)],m.prototype,"unFreeze",null),m=Object(a["b"])([Object(c["b"])(),Object(a["d"])("design:paramtypes",["function"===typeof(i="undefined"!==typeof l["a"]&&l["a"])?i:Object,"function"===typeof(o="undefined"!==typeof f["a"]&&f["a"])?o:Object])],m)},f076:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return r}));var i=function(t){return[{title:"省",dataIndex:"province_name",key:"province_name"},{title:"市",dataIndex:"city_name",key:"city_name"},{title:"区",dataIndex:"district_name",key:"district_name"},{title:"门店名称",dataIndex:"shop_name",key:"shop_name"}]},o=function(t){return[{title:"课程类型",dataIndex:"course_type",key:"course_type"},{title:"课程名称",dataIndex:"name",key:"name"}]},r=function(t){return[{title:"星期",dataIndex:"week",key:"week"},{title:"时间段",dataIndex:"time",key:"time"}]}}}]);