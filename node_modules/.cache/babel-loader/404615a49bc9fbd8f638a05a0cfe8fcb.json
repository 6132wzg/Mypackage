{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js!/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhigang/Desktop/styd/web/src/views/pages/brand/marketing/plugin/activity-registration/add.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/pages/brand/marketing/plugin/activity-registration/add.vue","mtime":1591147717298},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js","mtime":1591062572376}],"contextDependencies":[],"result":["import _toConsumableArray from \"/Users/wangzhigang/Desktop/styd/web/node_modules/@babel/runtime-corejs2/helpers/esm/toConsumableArray\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport Step1Form from \"./components#/step1-form\";\nimport Step2Form from \"./components#/step2-form\";\nimport Step3Form from \"./components#/step3-form\";\nimport ActivityH5View from \"./components#/activity-h5-view\";\nimport TicketH5View from \"./components#/ticket-h5-view\";\nimport SignupH5View from \"./components#/signup-h5-view\";\nimport { AddService } from \"./add.service\";\nexport default {\n  name: 'AddActivity',\n  bem: {\n    bPage: 'page-plugin-form-activity'\n  },\n  serviceInject: function serviceInject() {\n    return {\n      service: AddService\n    };\n  },\n  components: {\n    ActivityH5View: ActivityH5View,\n    TicketH5View: TicketH5View,\n    SignupH5View: SignupH5View,\n    Step1Form: Step1Form,\n    Step3Form: Step3Form,\n    Step2Form: Step2Form\n  },\n  data: function data() {\n    return {\n      step1Info: {},\n      step2Info: [],\n      step3Info: [],\n      stepForm: {},\n      steps: [{\n        title: '活动信息'\n      }, {\n        title: '票种信息'\n      }, {\n        title: '报名信息'\n      }],\n      currentStep: 0\n    };\n  },\n  props: {\n    isCopy: {\n      type: Boolean,\n      default: false\n    },\n    isEdit: {\n      type: Boolean,\n      default: false\n    }\n  },\n  methods: {\n    onBack: function onBack(step) {\n      this.currentStep = step;\n    },\n    onChangeStep1Form: function onChangeStep1Form(formObj) {\n      this.step1Info = formObj;\n    },\n    onChangeStep2Form: function onChangeStep2Form(ticketList) {\n      this.step2Info = _toConsumableArray(ticketList);\n    },\n    onChangeStep3Form: function onChangeStep3Form(signUpList) {\n      this.step3Info = _toConsumableArray(signUpList);\n    },\n    onSubmitGetStep1Form: function onSubmitGetStep1Form(form) {\n      this.currentStep = 1;\n      this.stepForm = form;\n    },\n    onSubmitGetStep2Form: function onSubmitGetStep2Form(form) {\n      this.currentStep = 2;\n      this.$set(this.stepForm, 'tickets', form);\n    },\n    // 发布活动\n    onReleaseActivity: function onReleaseActivity(form) {\n      var _this = this;\n\n      this.stepForm.is_draft = 0;\n      this.$set(this.stepForm, 'rule_settings', JSON.stringify(form)); // 发布\n\n      if (this.isEdit) {\n        this.service.updateActivity(this.stepForm).subscribe(function (res) {\n          _this.$router.push({\n            path: '/brand/marketing/plugin/activity-registration/success',\n            query: {\n              activity_id: _this.stepForm.activity_id\n            }\n          });\n        });\n      } else if (this.isCopy) {\n        this.service.copyActivity(this.stepForm).subscribe(function (res) {\n          _this.$router.push({\n            path: '/brand/marketing/plugin/activity-registration/success',\n            query: {\n              activity_id: res.activity_id\n            }\n          });\n        });\n      } else {\n        this.service.addActivity(this.stepForm).subscribe(function (res) {\n          _this.$router.push({\n            path: '/brand/marketing/plugin/activity-registration/success',\n            query: {\n              activity_id: res.activity_id\n            }\n          });\n        });\n      }\n    },\n    // 存草稿\n    onSaveDraftActivity: function onSaveDraftActivity(form) {\n      var _this2 = this;\n\n      this.stepForm.is_draft = 1;\n      this.$set(this.stepForm, 'rule_settings', JSON.stringify(form));\n      this.service.saveDraftActivity(this.stepForm).subscribe(function (res) {\n        _this2.$router.push({\n          path: '/brand/marketing/plugin/activity-registration/list'\n        });\n      });\n    },\n    onClickStep: function onClickStep(idx) {\n      this.currentStep = idx;\n    }\n  }\n};",{"version":3,"sources":["add.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <st-mina-panel>\n    <div slot=\"preview\">\n      <activity-h5-view\n        v-if=\"currentStep === 0\"\n        :stepInfo=\"step1Info\"\n      ></activity-h5-view>\n      <ticket-h5-view\n        v-if=\"currentStep === 1\"\n        :stepInfo=\"step2Info\"\n      ></ticket-h5-view>\n      <signup-h5-view\n        v-if=\"currentStep === 2\"\n        :stepInfo=\"step3Info\"\n      ></signup-h5-view>\n    </div>\n    <div :class=\"bPage()\">\n      <a-steps :class=\"bPage('step')\" :current=\"currentStep\">\n        <a-step v-for=\"(info, idx) in steps\" :key=\"idx\" :title=\"info.title\" />\n      </a-steps>\n      <div :class=\"bPage('form')\">\n        <step1-form\n          v-show=\"currentStep === 0\"\n          :show=\"currentStep === 0\"\n          :isCopy=\"isCopy\"\n          :isEdit=\"isEdit\"\n          @step-submit=\"onSubmitGetStep1Form\"\n          @change=\"onChangeStep1Form\"\n        ></step1-form>\n        <step2-form\n          v-show=\"currentStep === 1\"\n          :show=\"currentStep === 1\"\n          :isCopy=\"isCopy\"\n          :stepForm=\"stepForm\"\n          @back=\"onBack\"\n          :isEdit=\"isEdit\"\n          @step-submit=\"onSubmitGetStep2Form\"\n          @change=\"onChangeStep2Form\"\n        ></step2-form>\n        <step3-form\n          v-show=\"currentStep === 2\"\n          :show=\"currentStep === 2\"\n          :isCopy=\"isCopy\"\n          :isEdit=\"isEdit\"\n          @back=\"onBack\"\n          @release=\"onReleaseActivity\"\n          @save-draft=\"onSaveDraftActivity\"\n          @change=\"onChangeStep3Form\"\n        ></step3-form>\n      </div>\n    </div>\n    <portal-target\n      slot=\"actions\"\n      name=\"BRAND_MARKETING_ACTIVITY_FORM_ACTIONS\"\n    ></portal-target>\n  </st-mina-panel>\n</template>\n<script>\nimport Step1Form from './components#/step1-form'\nimport Step2Form from './components#/step2-form'\nimport Step3Form from './components#/step3-form'\nimport ActivityH5View from './components#/activity-h5-view'\nimport TicketH5View from './components#/ticket-h5-view'\nimport SignupH5View from './components#/signup-h5-view'\nimport { AddService } from './add.service'\nexport default {\n  name: 'AddActivity',\n  bem: {\n    bPage: 'page-plugin-form-activity'\n  },\n  serviceInject() {\n    return {\n      service: AddService\n    }\n  },\n  components: {\n    ActivityH5View,\n    TicketH5View,\n    SignupH5View,\n    Step1Form,\n    Step3Form,\n    Step2Form\n  },\n  data() {\n    return {\n      step1Info: {},\n      step2Info: [],\n      step3Info: [],\n      stepForm: {},\n      steps: [\n        { title: '活动信息' },\n        { title: '票种信息' },\n        { title: '报名信息' }\n      ],\n      currentStep: 0\n    }\n  },\n  props: {\n    isCopy: {\n      type: Boolean,\n      default: false\n    },\n    isEdit: {\n      type: Boolean,\n      default: false\n    }\n  },\n  methods: {\n    onBack(step) {\n      this.currentStep = step\n    },\n    onChangeStep1Form(formObj) {\n      this.step1Info = formObj\n    },\n    onChangeStep2Form(ticketList) {\n      this.step2Info = [...ticketList]\n    },\n    onChangeStep3Form(signUpList) {\n      this.step3Info = [...signUpList]\n    },\n    onSubmitGetStep1Form(form) {\n      this.currentStep = 1\n      this.stepForm = form\n    },\n    onSubmitGetStep2Form(form) {\n      this.currentStep = 2\n      this.$set(this.stepForm, 'tickets', form)\n    },\n    // 发布活动\n    onReleaseActivity(form) {\n      this.stepForm.is_draft = 0\n      this.$set(this.stepForm, 'rule_settings', JSON.stringify(form))\n      // 发布\n      if (this.isEdit) {\n        this.service.updateActivity(this.stepForm).subscribe(res => {\n          this.$router.push({\n            path: '/brand/marketing/plugin/activity-registration/success',\n            query: {\n              activity_id: this.stepForm.activity_id\n            }\n          })\n        })\n      } else if (this.isCopy) {\n        this.service.copyActivity(this.stepForm).subscribe(res => {\n          this.$router.push({\n            path: '/brand/marketing/plugin/activity-registration/success',\n            query: {\n              activity_id: res.activity_id\n            }\n          })\n        })\n      } else {\n        this.service.addActivity(this.stepForm).subscribe(res => {\n          this.$router.push({\n            path: '/brand/marketing/plugin/activity-registration/success',\n            query: {\n              activity_id: res.activity_id\n            }\n          })\n        })\n      }\n    },\n    // 存草稿\n    onSaveDraftActivity(form) {\n      this.stepForm.is_draft = 1\n      this.$set(this.stepForm, 'rule_settings', JSON.stringify(form))\n      this.service.saveDraftActivity(this.stepForm).subscribe(res => {\n        this.$router.push({\n          path: '/brand/marketing/plugin/activity-registration/list'\n        })\n      })\n    },\n    onClickStep(idx) {\n      this.currentStep = idx\n    }\n  }\n}\n</script>\n"],"sourceRoot":"src/views/pages/brand/marketing/plugin/activity-registration"}]}