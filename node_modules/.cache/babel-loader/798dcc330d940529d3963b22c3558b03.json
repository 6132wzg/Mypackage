{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/thread-loader/dist/cjs.js!/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js!/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhigang/Desktop/styd/web/src/views/pages/brand/staff/info.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/pages/brand/staff/info.vue","mtime":1597396799977},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/thread-loader/dist/cjs.js","mtime":1591062572352},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js","mtime":1591062572376}],"contextDependencies":[],"result":["import \"core-js/modules/es6.array.from\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.string.iterator\";\nimport \"core-js/modules/es6.set\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { InfoService } from \"./info.service\";\nimport { forEach } from 'lodash-es';\nimport StaffBindEntityCard from '@/views/biz-modals/staff/bind-entity-card';\nimport StaffRePassword from '@/views/biz-modals/staff/re-password';\nimport StaffReinstatement from '@/views/biz-modals/staff/reinstatement';\nimport StaffSalaryAccountSetting from '@/views/biz-modals/staff/salary-account-setting';\nimport StaffTurnover from '@/views/biz-modals/staff/turnover';\nimport StaffUpdateStaffPosition from '@/views/biz-modals/staff/update-staff-position';\nimport { DepartmentService } from \"./department.service\";\nexport default {\n  modals: {\n    StaffBindEntityCard: StaffBindEntityCard,\n    StaffRePassword: StaffRePassword,\n    StaffReinstatement: StaffReinstatement,\n    StaffSalaryAccountSetting: StaffSalaryAccountSetting,\n    StaffTurnover: StaffTurnover,\n    StaffUpdateStaffPosition: StaffUpdateStaffPosition\n  },\n  serviceInject: function serviceInject() {\n    return {\n      infoService: InfoService,\n      departmentService: DepartmentService\n    };\n  },\n  rxState: function rxState() {\n    return {\n      info: this.infoService.info$,\n      auth: this.infoService.auth$\n    };\n  },\n  data: function data() {\n    return {\n      identity: [],\n      basic: {\n        label: '员工资料',\n        route: {\n          name: 'brand-staff-info-basic',\n          query: {\n            id: this.$searchQuery.id\n          }\n        }\n      },\n      course: {\n        label: '上课记录',\n        route: {\n          name: 'brand-staff-info-course',\n          query: {\n            id: this.$searchQuery.id\n          }\n        }\n      },\n      follow: {\n        label: '跟进记录',\n        route: {\n          name: 'brand-staff-info-follow',\n          query: {\n            id: this.$searchQuery.id\n          }\n        }\n      },\n      sold: {\n        label: '售卖订单',\n        route: {\n          name: 'brand-staff-info-sold',\n          query: {\n            id: this.$searchQuery.id\n          }\n        }\n      },\n      member: {\n        label: '服务课程',\n        route: {\n          name: 'brand-staff-info-member',\n          query: {\n            id: this.$searchQuery.id\n          }\n        }\n      }\n    };\n  },\n  computed: {\n    image_avatar_url: function image_avatar_url() {\n      return this.info && this.info.image_avatar && this.info.image_avatar.image_url || '';\n    },\n    btnOptions: function btnOptions() {\n      return [{\n        text: '编辑资料',\n        click: this.editStaffInfo,\n        if: this.auth['brand:staff:staff|edit']\n      }, {\n        text: '绑定实体卡',\n        click: this.openModalBindCard,\n        if: this.auth['brand:staff:staff|bind_card']\n      }, {\n        text: '重绑实体卡',\n        click: this.openModalRebindCard,\n        if: this.auth['brand:staff:staff|rebind_card']\n      }, {\n        text: '职位和薪资变更',\n        click: this.openModalPosition,\n        if: this.auth['brand:staff:staff|position']\n      }, {\n        text: '离职',\n        click: this.openModalLeave,\n        if: this.auth['brand:staff:staff|leave']\n      }, {\n        text: '复职',\n        click: this.openModalReinstate,\n        if: this.auth['brand:staff:staff|reinstate']\n      }, {\n        text: '管理登录账户',\n        click: this.openModalSave,\n        if: this.auth['brand:staff:staff:account|save']\n      }, {\n        text: '设置提现账户',\n        click: this.openModalSalary,\n        if: this.auth['brand:staff:staff|salary']\n      }, {\n        text: '清空指纹信息',\n        click: this.onClearFingerprintInfo,\n        if: this.auth['brand:staff:staff|finger_del']\n      }, {\n        text: '清空硬件密码',\n        click: this.onClearHardwarePassword,\n        if: this.auth['brand:staff:staff|cabinet_pwd_del']\n      }];\n    }\n  },\n  created: function created() {\n    var _this = this;\n\n    // 会籍销售：跟进记录、服务课程 、销售订单\n    // 团课教练：上课记录\n    // 私教教练：上课记录、跟进记录、服务课程 、销售订单\n    // 1,普通员工 2-会籍销售；3-团课教练；4-私人教练\n    var identity = this.info.identity;\n    identity = identity.map(function (item) {\n      return item.id;\n    });\n    var indetitySet = new Set();\n    this.setIndentyList(['basic'], indetitySet);\n\n    if (Array.isArray(identity) && identity.length) {\n      identity.forEach(function (ele) {\n        if (ele === 2) {\n          _this.setIndentyList(['member', 'sold'], indetitySet);\n        } else if (ele === 3) {\n          _this.setIndentyList(['course'], indetitySet);\n        } else if (ele === 4) {\n          _this.setIndentyList(['course', 'follow', 'member', 'sold'], indetitySet);\n        }\n      });\n    }\n\n    this.identity = Array.from(indetitySet).map(function (key) {\n      return _this[key];\n    });\n  },\n  methods: {\n    setIndentyList: function setIndentyList(arr, targetArr) {\n      var _this2 = this;\n\n      arr.forEach(function (key) {\n        return targetArr.add(key, _this2[key]);\n      });\n    },\n    openModal: function openModal(modalType) {\n      var modalPathList = {\n        bind_card: 'staff-bind-entity-card',\n        rebind_card: 'staff-bind-entity-card',\n        leave: 'staff-turnover',\n        reinstate: 'staff-reinstatement',\n        save: 'staff-re-password',\n        position: 'staff-update-staff-position',\n        salary: 'staff-salary-account-setting'\n      };\n      var name = modalPathList[modalType];\n      this.$modalRouter.push({\n        name: name,\n        props: {\n          staff: this.info\n        }\n      });\n    },\n    openModalBindCard: function openModalBindCard() {\n      this.openModal('bind_card');\n    },\n    openModalRebindCard: function openModalRebindCard() {\n      this.openModal('rebind_card');\n    },\n    openModalLeave: function openModalLeave() {\n      this.openModal('leave');\n    },\n    openModalReinstate: function openModalReinstate() {\n      this.openModal('reinstate');\n    },\n    openModalSave: function openModalSave() {\n      this.openModal('save');\n    },\n    openModalPosition: function openModalPosition() {\n      this.openModal('position');\n    },\n    openModalSalary: function openModalSalary() {\n      this.openModal('salary');\n    },\n    editStaffInfo: function editStaffInfo() {\n      this.$router.push({\n        name: 'brand-staff-edit',\n        query: {\n          id: this.info.id\n        }\n      });\n    },\n    // 清空指纹信息\n    onClearFingerprintInfo: function onClearFingerprintInfo() {\n      var _this3 = this;\n\n      this.$confirm({\n        title: '提示信息',\n        content: '确认清空指纹信息？',\n        onOk: function onOk() {\n          _this3.departmentService.deleteStaffFinger(_this3.info.id).subscribe();\n        }\n      });\n    },\n    // 清空硬件密码\n    onClearHardwarePassword: function onClearHardwarePassword() {\n      var _this4 = this;\n\n      this.$confirm({\n        title: '提示信息',\n        content: '确认清空硬件密码吗？',\n        onOk: function onOk() {\n          _this4.departmentService.deleteStaffCabinetPassword(_this4.info.id).subscribe();\n        }\n      });\n    }\n  }\n};",null]}