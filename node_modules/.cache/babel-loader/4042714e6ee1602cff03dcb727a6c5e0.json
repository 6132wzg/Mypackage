{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js!/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhigang/Desktop/styd/web/src/views/pages/brand/product/card/member/number/edit.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/pages/brand/product/card/member/number/edit.vue","mtime":1600926556161},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js","mtime":1591062572376}],"contextDependencies":[],"result":["import _toConsumableArray from \"/Users/wangzhigang/Desktop/styd/web/node_modules/@babel/runtime-corejs2/helpers/esm/toConsumableArray\";\nimport \"core-js/modules/es6.object.keys\";\nimport \"core-js/modules/es6.regexp.split\";\nimport \"core-js/modules/es6.regexp.to-string\";\nimport \"core-js/modules/web.dom.iterable\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { UserService } from '@/services/user.service';\nimport moment from 'moment';\nimport { PatternService } from '@/services/pattern.service';\nimport SelectShop from '@/views/fragments/shop/select-shop';\nimport { cloneDeep, remove } from 'lodash-es';\nimport { EditService } from \"./edit.service\";\nimport MemberCard from '@/views/biz-components/h5/pages/member-card';\nimport H5Container from '@/views/biz-components/h5/h5-container';\nimport h5mixin from \"../period/h5mixin\";\nimport { MEMBER_CARD } from '@/views/biz-components/h5/pages/member-card.config';\nimport CardBgRadio from '@/views/biz-components/card-bg-radio/card-bg-radio';\nimport FormBanner from '@/views/biz-components/card/form-banner.vue';\nimport { ADMISSION_RANGE, SELL_TYPE, PRICE_SETTING, SUPPORT_SALES, UNIT, CARD_TYPE } from '@/constants/card/member';\nimport { ruleOptions } from \"./number.config\";\nimport StEditor from '@/views/components/editor#/editor.vue';\nexport default {\n  name: 'BrandNumberCardEdit',\n  mixins: [h5mixin],\n  serviceInject: function serviceInject() {\n    return {\n      pattern: PatternService,\n      editService: EditService,\n      userService: UserService\n    };\n  },\n  rxState: function rxState() {\n    return {\n      addLoading: this.editService.loading$,\n      cardInfo: this.editService.cardInfo$,\n      cardBgList: this.editService.cardBgList$,\n      admissionRange: this.editService.admissionRange$,\n      priceSetting: this.editService.priceSetting$,\n      supportSales: this.editService.supportSales$,\n      unit: this.editService.unit$,\n      sellType: this.editService.sellType$,\n      isShelfCard: this.editService.isShelfCard$,\n      supportMemberNums: this.editService.supportMemberNums$\n    };\n  },\n  bem: {\n    b: 'st-help-popover'\n  },\n  components: {\n    StEditor: StEditor,\n    SelectShop: SelectShop,\n    MemberCard: MemberCard,\n    H5Container: H5Container,\n    CardBgRadio: CardBgRadio,\n    FormBanner: FormBanner\n  },\n  data: function data() {\n    var form = this.$stForm.create();\n    var decorators = form.decorators(ruleOptions);\n    return {\n      // cardData\n      form: form,\n      decorators: decorators,\n      ADMISSION_RANGE: ADMISSION_RANGE,\n      SELL_TYPE: SELL_TYPE,\n      PRICE_SETTING: PRICE_SETTING,\n      SUPPORT_SALES: SUPPORT_SALES,\n      UNIT: UNIT,\n      cardType: MEMBER_CARD.NUMBER_CARD,\n      MEMBER_CARD: MEMBER_CARD,\n      cardData: {\n        // 卡id\n        id: null,\n        // 会员卡类型1-次卡 2-期限卡\n        card_type: this.isFamilyCard ? CARD_TYPE.MORE_NUMBER : CARD_TYPE.NUMBER,\n        // 会员卡名称\n        card_name: '',\n        // 特殊说明\n        special_note: '',\n        // 支持入场范围 1-单店 2-多店 3-全店\n        admission_range: ADMISSION_RANGE.ONLY_STORE,\n        // 支持入场门店\n        admission_shop_list: [],\n        // 价格设置类型 1-统一定价 2-门店定价\n        price_setting: PRICE_SETTING.UNIFORM_PRICE,\n        // 价格梯度\n        price_gradient: [],\n        // 支持售卖场馆类型 1-全部门店 2-指定门店\n        support_sales: SUPPORT_SALES.ALL_STORE,\n        // 支持售卖门店\n        sell_shop_list: [],\n        // 上架门店数量\n        shelf_shop_num: 0,\n        // 支持售卖时间\n        start_time: '',\n        end_time: '',\n        // 结束时间面板是否显示\n        endOpen: false,\n        // 是否支持转让\n        _is_transfer: false,\n        is_transfer: 0,\n        // 转让单位\n        unit: UNIT.RMB,\n        // 转让手续费\n        num: undefined,\n        // 售卖方式\n        sell_type: [SELL_TYPE.OFFLINE],\n        // 卡背景\n        card_bg: {\n          image_id: 0,\n          image_key: this.cardBgList[0].image_key,\n          image_url: '',\n          index: 1\n        },\n        // 是否配置了用户端\n        appConfig: true,\n        // 卡介绍\n        card_introduction: '',\n        // 备注\n        card_contents: ''\n      },\n      transfer_unit_is_first: true,\n      // 品牌统一定价-价格梯度\n      rallyPriceList: [],\n      // 门店自主定价-价格梯度\n      shopPriceList: [],\n      // 售卖时间\n      start_time: null,\n      end_time: null,\n      unit_list: [{\n        value: 2,\n        label: '天'\n      }, {\n        value: 3,\n        label: '月'\n      }, {\n        value: 4,\n        label: '年'\n      }],\n      // 校验价格的help文本\n      priceValidatorText: '',\n      // 卡背景的help文本\n      cardBgValidatorText: '',\n      // 是否禁止选择开始时间,如果卡状态是可售卖，则需要禁止修改开始时间\n      startTimeIsDisabled: false\n    };\n  },\n  mounted: function mounted() {\n    this.init();\n  },\n  methods: {\n    // init\n    init: function init() {\n      var _this = this;\n\n      this.form.setFieldsValue({\n        'cardData.special_note': this.cardInfo.special_note,\n        'cardData.admission_range': this.cardInfo.admission_range,\n        'cardData.price_setting': this.cardInfo.price_setting,\n        'cardData.support_sales': this.cardInfo.support_sales,\n        start_time: moment(this.cardInfo.start_time * 1000),\n        end_time: moment(this.cardInfo.end_time * 1000),\n        'cardData.num': this.cardInfo.transfer_num\n      });\n\n      if (this.isFamilyCard) {\n        this.form.setFieldsValue({\n          'cardData.support_member_num': this.cardInfo.support_member_num\n        });\n      } // 入场门店\n\n\n      this.cardData.admission_range = this.cardInfo.admission_range;\n      this.cardData.admission_shop_list = this.cardInfo.admission_shop_list; // 价格设置\n\n      this.cardData.price_setting = this.cardInfo.price_setting;\n\n      if (this.cardInfo.price_setting === PRICE_SETTING.UNIFORM_PRICE) {\n        // 品牌定价\n        this.cardInfo.price_gradient.forEach(function (i) {\n          var key = parseInt(Math.random() * 999999).toString();\n\n          _this.rallyPriceList.push({\n            key: key,\n            id: i.id,\n            time: {\n              unit: +i.unit,\n              num: +i.num\n            },\n            validity_times: +i.validity_times,\n            rally_price: +i.rally_price,\n            frozen_day: +i.frozen_day,\n            gift_unit: +i.gift_unit\n          });\n        });\n      } else {\n        // 门店定价\n        this.cardInfo.price_gradient.forEach(function (i) {\n          var key = parseInt(Math.random() * 999999).toString();\n\n          _this.shopPriceList.push({\n            key: key,\n            id: i.id,\n            time: {\n              unit: +i.unit,\n              num: +i.num\n            },\n            validity_times: +i.validity_times,\n            frozen_day: +i.frozen_day,\n            gift_unit: +i.gift_unit,\n            rally_price: {\n              min_price: +i.min_price,\n              max_price: +i.max_price\n            }\n          });\n        });\n      } // 支持售卖门店\n\n\n      this.cardData.support_sales = this.cardInfo.support_sales;\n      this.cardData.sell_shop_list = this.cardData.support_sales === SUPPORT_SALES.SPECIFIED_STORE ? cloneDeep(this.cardInfo.sell_shop_list) : []; // 支持售卖时间\n\n      this.start_time = moment(this.cardInfo.start_time * 1000);\n      this.end_time = moment(this.cardInfo.end_time * 1000);\n      this.startTimeIsDisabled = this.cardInfo.start_time * 1000 < moment().startOf('day').valueOf() && this.cardInfo.end_time * 1000 > moment().valueOf(); // 转让设置\n\n      this.cardData._is_transfer = !!this.cardInfo.is_transfer;\n      this.cardData.unit = this.cardInfo.transfer_unit;\n      this.cardData.num = this.cardInfo.transfer_num; // 售卖方式\n\n      this.cardData.sell_type = this.cardInfo.sell_type; // 卡背景\n\n      this.cardData.card_bg = cloneDeep(this.cardInfo.card_bg); // 卡介绍\n\n      this.cardData.card_introduction = this.cardInfo.card_introduction; // 卡备注\n\n      this.cardData.card_contents = this.cardInfo.card_contents;\n      this.initH5CardInfo();\n    },\n    // 保存\n    onHandleSubmit: function onHandleSubmit(e) {\n      var _this2 = this;\n\n      e.preventDefault(); // 校验价格\n\n      this.priceValidator(this.cardData.price_setting); // 校验卡背景\n\n      this.cardBgValidator();\n      this.form.validateFieldsAndScroll(function (err, values) {\n        if (!err && _this2.priceIsOk && _this2.cardBgIsOk) {\n          // 入场门店\n          if (_this2.cardData.admission_range !== ADMISSION_RANGE.GENERAL_STORE) {\n            // 不是多门店\n            _this2.cardData.admission_shop_list = [];\n          } // 售卖门店\n\n\n          if (_this2.cardData.support_sales !== SUPPORT_SALES.SPECIFIED_STORE) {\n            // 不是多门店\n            _this2.cardData.sell_shop_list = [];\n          } // 售卖门店\n\n\n          if (_this2.cardData.admission_range === ADMISSION_RANGE.GENERAL_STORE && _this2.cardData.support_sales === SUPPORT_SALES.ENTRY_STORE) {\n            // 多门店 && 支持入场门店\n            _this2.cardData.sell_shop_list = cloneDeep(_this2.cardData.admission_shop_list);\n          } // 价格梯度\n\n\n          var p = [];\n\n          switch (_this2.cardData.price_setting) {\n            case PRICE_SETTING.UNIFORM_PRICE:\n              // 品牌统一定价\n              _this2.rallyPriceList.forEach(function (i) {\n                p.push({\n                  id: i.id || 0,\n                  unit: +i.time.unit,\n                  num: +i.time.num,\n                  validity_times: +i.validity_times,\n                  rally_price: +i.rally_price,\n                  frozen_day: +i.frozen_day,\n                  gift_unit: +i.gift_unit\n                });\n              });\n\n              break;\n\n            case PRICE_SETTING.SHOP_PRICE:\n              // 门店自主定价\n              _this2.shopPriceList.forEach(function (i) {\n                p.push({\n                  id: i.id || 0,\n                  unit: +i.time.unit,\n                  num: +i.time.num,\n                  validity_times: +i.validity_times,\n                  min_price: +i.rally_price.min_price,\n                  max_price: +i.rally_price.max_price,\n                  frozen_day: +i.frozen_day,\n                  gift_unit: +i.gift_unit\n                });\n              });\n\n              break;\n          }\n\n          _this2.cardData.special_note = values.cardData.special_note;\n          _this2.cardData.price_gradient = cloneDeep(p); // 时间\n\n          _this2.cardData.start_time = \"\".concat(_this2.start_time.format('YYYY-MM-DD'));\n          _this2.cardData.end_time = \"\".concat(_this2.end_time.format('YYYY-MM-DD')); // 卡id\n\n          _this2.cardData.id = +_this2.$searchQuery.id; // 转让\n\n          _this2.cardData.num = _this2.cardData._is_transfer ? +values.cardData.num : undefined;\n\n          if (!_this2.isFamilyCard) {\n            _this2.cardData.support_member_num = 1;\n            _this2.cardData.card_type = CARD_TYPE.NUMBER;\n          } else {\n            _this2.cardData.support_member_num = values.cardData.support_member_num;\n            _this2.cardData.card_type = CARD_TYPE.MORE_NUMBER;\n          }\n\n          _this2.editService.editCard(_this2.cardData).subscribe(function (res) {\n            _this2.$router.push({\n              name: 'brand-product-card-member-list-all'\n            });\n          });\n        }\n      });\n    },\n    // 增加入场门店\n    admission_range_change: function admission_range_change(data) {\n      this.cardData.admission_shop_list = cloneDeep(data);\n      this.syncAdmissionShop();\n    },\n    // 入场门店支持方式change\n    admission_range: function admission_range(data) {\n      this.cardData.admission_range = data.target.value; // 入场门店变化时，售卖门店和价格同时变化\n\n      this.form.setFieldsValue({\n        'cardData.support_sales': SUPPORT_SALES.ALL_STORE,\n        'cardData.price_setting': PRICE_SETTING.UNIFORM_PRICE\n      });\n      this.cardData.support_sales = SUPPORT_SALES.ALL_STORE;\n      this.cardData.price_setting = PRICE_SETTING.UNIFORM_PRICE;\n      this.priceValidatorText = '';\n      this.syncAdmission();\n    },\n    // 价格设置方式change\n    price_range: function price_range(data) {\n      this.cardData.price_setting = data.target.value;\n    },\n    // 增加品牌价格\n    brand_price_add: function brand_price_add() {\n      var key = parseInt(Math.random() * 999999).toString();\n      this.rallyPriceList.push({\n        key: key,\n        time: {\n          unit: 2,\n          num: null\n        },\n        validity_times: null,\n        rally_price: null,\n        frozen_day: null,\n        gift_unit: null\n      });\n    },\n    // 删除品牌价格\n    brand_price_delete: function brand_price_delete(index) {\n      this.rallyPriceList.splice(index, 1);\n    },\n    // 品牌价格梯度-期限\n    brandPriceSettingHandleChange: function brandPriceSettingHandleChange(_ref) {\n      var value = _ref.value,\n          key = _ref.key,\n          col = _ref.col,\n          prop = _ref.prop;\n\n      if (prop !== undefined) {\n        this.rallyPriceList[key][col][prop] = value;\n      } else {\n        this.rallyPriceList[key][col] = value;\n      }\n    },\n    // 增加门店价格\n    shop_price_add: function shop_price_add() {\n      var key = parseInt(Math.random() * 999999).toString();\n      this.shopPriceList.push({\n        key: key,\n        time: {\n          unit: 2,\n          num: null\n        },\n        rally_price: {\n          min_price: null,\n          max_price: null\n        },\n        validity_times: null,\n        frozen_day: null,\n        gift_unit: null\n      });\n    },\n    // 删除门店价格\n    shop_price_delete: function shop_price_delete(index) {\n      this.shopPriceList.splice(index, 1);\n    },\n    // 门店价格梯度-期限\n    shopPriceSettingHandleChange: function shopPriceSettingHandleChange(_ref2) {\n      var value = _ref2.value,\n          key = _ref2.key,\n          col = _ref2.col,\n          prop = _ref2.prop;\n\n      if (prop !== undefined) {\n        this.shopPriceList[key][col][prop] = value;\n      } else {\n        this.shopPriceList[key][col] = value;\n      }\n    },\n    // 支持售卖门店change\n    support_range: function support_range(data) {\n      this.cardData.support_sales = data.target.value;\n    },\n    // 增加售卖门店\n    sales_shop_change: function sales_shop_change(data) {\n      this.cardData.sell_shop_list = cloneDeep(data);\n    },\n    // 售卖时间-start\n    disabledStartDate: function disabledStartDate(startValue) {\n      var endValue = this.end_time;\n\n      if (!endValue) {\n        // 结束时间未选择\n        return startValue.valueOf() < moment().startOf('day').valueOf();\n      }\n\n      var start = endValue.valueOf() > moment().add(30, 'y').valueOf() ? moment(endValue).subtract(30, 'y').valueOf() : moment().startOf('day').valueOf();\n      return startValue.valueOf() < start || startValue.valueOf() > moment(endValue).valueOf();\n    },\n    start_time_change: function start_time_change(data) {\n      this.start_time = cloneDeep(data);\n    },\n    handleStartOpenChange: function handleStartOpenChange(open) {\n      if (!open) {\n        this.cardData.endOpen = true;\n      }\n    },\n    // 售卖时间-end\n    end_time_change: function end_time_change(data) {\n      this.end_time = cloneDeep(data);\n    },\n    handleEndOpenChange: function handleEndOpenChange(open) {\n      this.cardData.endOpen = open;\n    },\n    disabledEndDate: function disabledEndDate(endValue) {\n      var startValue = this.start_time;\n\n      if (!startValue) {\n        // 开始时间未选择\n        return endValue.valueOf() < moment().startOf('day').valueOf();\n      }\n\n      return endValue.valueOf() >= moment(startValue).add(30, 'y').valueOf() || endValue.valueOf() < moment(startValue).valueOf() || endValue.valueOf() < moment().startOf('day').valueOf();\n    },\n    // moment\n    moment: moment,\n    range: function range(start, end) {\n      var result = [];\n\n      for (var i = start; i < end; i++) {\n        result.push(i);\n      }\n\n      return result;\n    },\n    // 转让\n    transfer: function transfer(e) {\n      this.cardData._is_transfer = e.target.checked; // 重置转让费用的校验\n\n      this.form.resetFields(['cardData.num']);\n    },\n    // 价格梯度校验\n    priceValidator: function priceValidator(type) {\n      var _this3 = this;\n\n      var fnName = type === PRICE_SETTING.UNIFORM_PRICE ? 'brandPriceValidataArray' : 'shopPriceValidataArray';\n      var validata = this[fnName].length ? this[fnName].every(function (i) {\n        return _this3.pattern.NUM_FLOAT(1).test(i.split('-')[1]);\n      }) : false;\n      this.priceValidatorText = validata ? '' : '请输入正确的价格';\n    },\n    onCardBgChange: function onCardBgChange(e) {\n      this.cardBgValidatorText = '';\n    },\n    // 卡背景校验\n    cardBgValidator: function cardBgValidator() {\n      var validata = this.cardData.card_bg.image_key !== '';\n      this.cardBgValidatorText = validata ? '' : '请上传卡背景';\n    }\n  },\n  watch: {\n    'cardData._is_transfer': {\n      deep: true,\n      handler: function handler(newVal, oldVal) {\n        this.cardData.is_transfer = +newVal;\n      }\n    },\n    'cardData.unit': {\n      deep: true,\n      handler: function handler() {\n        if (!this.transfer_unit_is_first) {\n          this.form.resetFields(['cardData.num']);\n        }\n\n        this.transfer_unit_is_first = false;\n      }\n    },\n    'cardData.admission_shop_list': {\n      deep: true,\n      handler: function handler() {\n        var v = this.cardData.admission_range;\n        this.cardData.admission_range = v;\n        this.form.setFieldsValue({\n          'cardData.admission_range': v\n        });\n      }\n    },\n    'cardData.sell_shop_list': {\n      deep: true,\n      handler: function handler() {\n        var v = this.cardData.support_sales;\n        this.cardData.support_sales = v;\n        this.form.setFieldsValue({\n          'cardData.support_sales': v\n        });\n      }\n    }\n  },\n  computed: {\n    // 支持售卖门店\n    support_sales_list: function support_sales_list() {\n      var arr = cloneDeep(this.supportSales);\n      var index = this.cardData.admission_range === ADMISSION_RANGE.GENERAL_STORE ? 999 : 2;\n      arr.splice(index, 1);\n      return arr;\n    },\n    // 售卖方式\n    sell_type_list: function sell_type_list() {\n      var sell_type = cloneDeep(this.sellType);\n      var arr = [];\n      sell_type.forEach(function (i) {\n        arr.push({\n          value: i.value,\n          label: i.label\n        });\n      });\n\n      if (!this.cardData.appConfig) {\n        remove(arr, function (i) {\n          return i.value === SELL_TYPE.CLIENT;\n        });\n      }\n\n      return arr;\n    },\n    // 品牌统一定价-价格梯度校验数组\n    brandPriceValidataArray: function brandPriceValidataArray() {\n      var array = [];\n      this.rallyPriceList.forEach(function (i) {\n        Object.keys(i).forEach(function (o) {\n          array.push(o === 'time' ? \"time-\".concat(i.time.num) : \"\".concat(o, \"-\").concat(i[o]));\n        });\n      });\n      return array;\n    },\n    // 门店自主定价-价格梯度校验数组\n    shopPriceValidataArray: function shopPriceValidataArray() {\n      var array = [];\n      this.shopPriceList.forEach(function (i) {\n        Object.keys(i).forEach(function (o) {\n          var value = [];\n\n          if (o === 'time') {\n            value = [\"time-\".concat(i.time.num)];\n          } else if (o === 'rally_price') {\n            value = [\"min_price-\".concat(i.rally_price.min_price), \"max_price-\".concat(i.rally_price.max_price)];\n          } else {\n            value = [\"\".concat(o, \"-\").concat(i[o])];\n          }\n\n          array.push.apply(array, _toConsumableArray(value));\n        });\n      });\n      return array;\n    },\n    // 价格是否校验通过\n    priceIsOk: function priceIsOk() {\n      return this.priceValidatorText === '';\n    },\n    // 卡背景是否校验通过\n    cardBgIsOk: function cardBgIsOk() {\n      return this.cardBgValidatorText === '';\n    },\n    // 转让设置的min\n    transferMin: function transferMin() {\n      // return this.cardData.transfer_unit === 1 ? 1 : 0.1\n      return 0;\n    },\n    // 转让设置的max\n    transferMax: function transferMax() {\n      return this.cardData.unit === UNIT.PERCENT ? 100 : 999999.9;\n    },\n    // 是否是多人卡\n    isFamilyCard: function isFamilyCard() {\n      return this.$searchQuery.type === 'family-card';\n    }\n  }\n};",{"version":3,"sources":["edit.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <st-mina-panel\n    responsivePreview\n    class=\"page-brand-basic-card page-brand-edit-number-card\"\n  >\n    <h5-container slot=\"preview\" fixed>\n      <template v-slot:title>\n        购卡\n      </template>\n      <template v-slot:default>\n        <member-card\n          :data=\"h5CardInfo\"\n          :cardType=\"MEMBER_CARD.NUMBER_CARD\"\n        ></member-card>\n      </template>\n    </h5-container>\n\n    <form-banner\n      slot=\"prepend\"\n      :shelf-number=\"cardInfo.shelf_shop_num\"\n    ></form-banner>\n\n    <div slot=\"actions\">\n      <st-button\n        :loading=\"addLoading.editCard\"\n        type=\"primary\"\n        @click=\"onHandleSubmit\"\n      >\n        保 存\n      </st-button>\n    </div>\n\n    <div class=\"page-content\">\n      <st-form :form=\"form\" labelWidth=\"118px\">\n        <p class=\"page-content-card__card__name\">\n          <st-tag type=\"number-card\" />\n          <span>{{ cardInfo.card_name }}</span>\n        </p>\n        <st-form-item class=\"page-content-card-line\" label=\"特别说明\">\n          <a-input\n            class=\"page-content-card-input\"\n            v-decorator=\"decorators.cardData.special_note\"\n            maxlength=\"20\"\n            placeholder=\"最多显示20个字符\"\n            @change=\"syncSpecialNote\"\n          ></a-input>\n        </st-form-item>\n        <st-hr class=\"mg-y32\" />\n        <a-row :gutter=\"8\" v-if=\"isFamilyCard\">\n          <a-col :lg=\"23\">\n            <st-form-item\n              class=\"page-content-card-admission-range mg-t4\"\n              required\n            >\n              <template slot=\"label\">\n                支持入场人数\n                <st-help-tooltip id=\"TBMCDC003\" />\n              </template>\n              <a-select\n                v-decorator=\"decorators.cardData.support_member_num\"\n                :disabled=\"isShelfCard\"\n                placeholder=\"请选择入场人数\"\n                class=\"page-content-card-input\"\n              >\n                <a-select-option\n                  v-for=\"(item, index) in supportMemberNums\"\n                  :key=\"index\"\n                  :value=\"item.value\"\n                >\n                  {{ item.label }}\n                </a-select-option>\n              </a-select>\n            </st-form-item>\n          </a-col>\n        </a-row>\n\n        <a-row :gutter=\"8\">\n          <a-col :lg=\"23\">\n            <st-form-item\n              class=\"page-content-card-admission-range mg-t4\"\n              label=\"支持入场门店\"\n              required\n            >\n              <a-radio-group\n                :disabled=\"isShelfCard\"\n                @change=\"admission_range\"\n                v-decorator=\"decorators.cardData.admission_range\"\n              >\n                <a-radio\n                  v-for=\"item in admissionRange\"\n                  :key=\"item.value\"\n                  :value=\"item.value\"\n                >\n                  {{ item.label }}\n                </a-radio>\n              </a-radio-group>\n              <div\n                class=\"page-admission-range-shop\"\n                v-if=\"\n                  cardData.admission_range === ADMISSION_RANGE.GENERAL_STORE\n                \"\n              >\n                <p class=\"page-admission-range-shop__describe\">\n                  设置支持此{{ $c('member_card') }}出入场馆范围\n                </p>\n                <select-shop\n                  :shopIds=\"cardData.admission_shop_list\"\n                  @change=\"admission_range_change\"\n                ></select-shop>\n              </div>\n            </st-form-item>\n          </a-col>\n        </a-row>\n        <a-row :gutter=\"8\">\n          <a-col :lg=\"23\">\n            <st-form-item\n              class=\"page-content-card-price-setting mg-t4\"\n              label=\"价格设置\"\n              required\n              :help=\"priceValidatorText\"\n            >\n              <a-radio-group\n                :disabled=\"isShelfCard\"\n                @change=\"price_range\"\n                v-show=\"cardData.admission_range === ADMISSION_RANGE.ONLY_STORE\"\n                v-decorator=\"decorators.cardData.price_setting\"\n              >\n                <a-radio\n                  v-for=\"item in priceSetting\"\n                  :key=\"item.value\"\n                  :value=\"item.value\"\n                >\n                  {{ item.label }}\n                </a-radio>\n              </a-radio-group>\n              <div\n                class=\"page-price-setting-set\"\n                :class=\"{\n                  error: !priceIsOk,\n                  'brand-set':\n                    cardData.price_setting === PRICE_SETTING.UNIFORM_PRICE &&\n                    cardData.admission_range === ADMISSION_RANGE.ONLY_STORE\n                }\"\n                v-if=\"cardData.price_setting === PRICE_SETTING.UNIFORM_PRICE\"\n              >\n                <st-form-table>\n                  <colgroup>\n                    <col />\n                    <col />\n                    <col style=\"width:28%;\" />\n                    <col />\n                    <col />\n                    <col style=\"width:60px;\" />\n                  </colgroup>\n                  <thead>\n                    <tr>\n                      <th>入场次数/次</th>\n                      <th>售价/元</th>\n                      <th>有效期</th>\n                      <th class=\"white-nowrap\">允许冻结/天</th>\n                      <th>赠送上限/次</th>\n                      <th>操作</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    <tr>\n                      <td colspan=\"6\" class=\"pd-y0 pd-x0\">\n                        <st-button\n                          v-if=\"!isShelfCard\"\n                          :disabled=\"rallyPriceList.length >= 12\"\n                          type=\"dashed\"\n                          icon=\"add\"\n                          class=\"page-price-setting-set__add\"\n                          block\n                          @click=\"brand_price_add\"\n                        >\n                          新增定价规格（{{ rallyPriceList.length }}/12）\n                        </st-button>\n                      </td>\n                    </tr>\n                    <tr\n                      v-for=\"(item, index) in rallyPriceList\"\n                      :key=\"`${index}brand`\"\n                    >\n                      <td>\n                        <st-input-number\n                          :disabled=\"isShelfCard\"\n                          :min=\"1\"\n                          :max=\"99999\"\n                          :value=\"item.validity_times\"\n                          @change=\"\n                            e =>\n                              brandPriceSettingHandleChange({\n                                value: e,\n                                key: index,\n                                col: 'validity_times'\n                              })\n                          \"\n                        ></st-input-number>\n                      </td>\n                      <td>\n                        <st-input-number\n                          :disabled=\"isShelfCard\"\n                          :float=\"true\"\n                          :min=\"0\"\n                          :max=\"999999.9\"\n                          :value=\"item.rally_price\"\n                          @change=\"\n                            e =>\n                              brandPriceSettingHandleChange({\n                                value: e,\n                                key: index,\n                                col: 'rally_price'\n                              })\n                          \"\n                        ></st-input-number>\n                      </td>\n                      <td>\n                        <st-input-number\n                          :min=\"1\"\n                          :max=\"99999\"\n                          :value=\"item.time.num\"\n                          :disabled=\"isShelfCard\"\n                          @change=\"\n                            e =>\n                              brandPriceSettingHandleChange({\n                                value: e,\n                                key: index,\n                                col: 'time',\n                                prop: 'num'\n                              })\n                          \"\n                        >\n                          <a-select\n                            slot=\"addonAfter\"\n                            :value=\"item.time.unit\"\n                            :disabled=\"isShelfCard\"\n                            @change=\"\n                              e =>\n                                brandPriceSettingHandleChange({\n                                  value: e,\n                                  key: index,\n                                  col: 'time',\n                                  prop: 'unit'\n                                })\n                            \"\n                          >\n                            <a-select-option\n                              v-for=\"(item, index) in unit_list\"\n                              :value=\"item.value\"\n                              :key=\"index\"\n                            >\n                              {{ item.label }}\n                            </a-select-option>\n                          </a-select>\n                        </st-input-number>\n                      </td>\n                      <td>\n                        <st-input-number\n                          :min=\"0\"\n                          :max=\"99999\"\n                          :value=\"item.frozen_day\"\n                          :disabled=\"isShelfCard\"\n                          @change=\"\n                            e =>\n                              brandPriceSettingHandleChange({\n                                value: e,\n                                key: index,\n                                col: 'frozen_day'\n                              })\n                          \"\n                        ></st-input-number>\n                      </td>\n                      <td>\n                        <st-input-number\n                          :min=\"0\"\n                          :max=\"99999\"\n                          :value=\"item.gift_unit\"\n                          :disabled=\"isShelfCard\"\n                          @change=\"\n                            e =>\n                              brandPriceSettingHandleChange({\n                                value: e,\n                                key: index,\n                                col: 'gift_unit'\n                              })\n                          \"\n                        ></st-input-number>\n                      </td>\n                      <td>\n                        <a\n                          v-if=\"!isShelfCard\"\n                          @click=\"brand_price_delete(index)\"\n                        >\n                          删除\n                        </a>\n                      </td>\n                    </tr>\n                  </tbody>\n                </st-form-table>\n              </div>\n              <div\n                class=\"page-price-setting-set\"\n                :class=\"{\n                  error: !priceIsOk,\n                  'shop-set':\n                    cardData.price_setting === PRICE_SETTING.SHOP_PRICE &&\n                    cardData.admission_range === ADMISSION_RANGE.ONLY_STORE\n                }\"\n                v-if=\"cardData.price_setting === PRICE_SETTING.SHOP_PRICE\"\n              >\n                <st-form-table>\n                  <colgroup>\n                    <col />\n                    <col />\n                    <col />\n                    <col />\n                    <col />\n                    <col style=\"width:60px;\" />\n                  </colgroup>\n                  <thead>\n                    <tr>\n                      <th>入场次数/次</th>\n                      <th>售价范围/元</th>\n                      <th>有效期</th>\n                      <th class=\"white-nowrap\">允许冻结/天</th>\n                      <th>赠送上限/次</th>\n                      <th>操作</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    <tr>\n                      <td colspan=\"6\" class=\"pd-y0 pd-x0\">\n                        <st-button\n                          :disabled=\"shopPriceList.length >= 12 || isShelfCard\"\n                          type=\"dashed\"\n                          icon=\"add\"\n                          class=\"page-price-setting-set__add\"\n                          block\n                          @click=\"shop_price_add\"\n                        >\n                          新增定价规格（{{ shopPriceList.length }}/12）\n                        </st-button>\n                      </td>\n                    </tr>\n                    <tr\n                      v-for=\"(item, index) in shopPriceList\"\n                      :key=\"`${index}shop`\"\n                    >\n                      <td>\n                        <st-input-number\n                          :disabled=\"isShelfCard\"\n                          :min=\"1\"\n                          :max=\"99999\"\n                          :value=\"item.validity_times\"\n                          @change=\"\n                            e =>\n                              shopPriceSettingHandleChange({\n                                value: e,\n                                key: index,\n                                col: 'validity_times'\n                              })\n                          \"\n                        ></st-input-number>\n                      </td>\n                      <td>\n                        <st-input-number\n                          style=\"width:40%\"\n                          :float=\"true\"\n                          :min=\"0\"\n                          :max=\"999999.9\"\n                          :disabled=\"isShelfCard\"\n                          :value=\"item.rally_price.min_price\"\n                          @change=\"\n                            e =>\n                              shopPriceSettingHandleChange({\n                                value: e,\n                                key: index,\n                                col: 'rally_price',\n                                prop: 'min_price'\n                              })\n                          \"\n                        ></st-input-number>\n                        ~\n                        <st-input-number\n                          style=\"width:40%\"\n                          :float=\"true\"\n                          :disabled=\"isShelfCard\"\n                          :min=\"0\"\n                          :max=\"999999.9\"\n                          :value=\"item.rally_price.max_price\"\n                          @change=\"\n                            e =>\n                              shopPriceSettingHandleChange({\n                                value: e,\n                                key: index,\n                                col: 'rally_price',\n                                prop: 'max_price'\n                              })\n                          \"\n                        ></st-input-number>\n                      </td>\n                      <td>\n                        <st-input-number\n                          class=\"page-content-table-input\"\n                          :min=\"1\"\n                          :max=\"99999\"\n                          :value=\"item.time.num\"\n                          :disabled=\"isShelfCard\"\n                          @change=\"\n                            e =>\n                              shopPriceSettingHandleChange({\n                                value: e,\n                                key: index,\n                                col: 'time',\n                                prop: 'num'\n                              })\n                          \"\n                        >\n                          <a-select\n                            slot=\"addonAfter\"\n                            :value=\"item.time.unit\"\n                            @change=\"\n                              e =>\n                                shopPriceSettingHandleChange({\n                                  value: e,\n                                  key: index,\n                                  col: 'time',\n                                  prop: 'unit'\n                                })\n                            \"\n                          >\n                            <a-select-option\n                              v-for=\"(item, index) in unit_list\"\n                              :value=\"item.value\"\n                              :key=\"index\"\n                            >\n                              {{ item.label }}\n                            </a-select-option>\n                          </a-select>\n                        </st-input-number>\n                      </td>\n                      <td>\n                        <st-input-number\n                          :min=\"1\"\n                          :max=\"99999\"\n                          :disabled=\"isShelfCard\"\n                          :value=\"item.frozen_day\"\n                          @change=\"\n                            e =>\n                              shopPriceSettingHandleChange({\n                                value: e,\n                                key: index,\n                                col: 'frozen_day'\n                              })\n                          \"\n                        ></st-input-number>\n                      </td>\n                      <td>\n                        <st-input-number\n                          :min=\"1\"\n                          :max=\"99999\"\n                          :value=\"item.gift_unit\"\n                          :disabled=\"isShelfCard\"\n                          @change=\"\n                            e =>\n                              shopPriceSettingHandleChange({\n                                value: e,\n                                key: index,\n                                col: 'gift_unit'\n                              })\n                          \"\n                        ></st-input-number>\n                      </td>\n                      <td>\n                        <a\n                          v-if=\"!isShelfCard\"\n                          @click=\"shop_price_delete(index)\"\n                        >\n                          删除\n                        </a>\n                      </td>\n                    </tr>\n                  </tbody>\n                </st-form-table>\n              </div>\n            </st-form-item>\n          </a-col>\n        </a-row>\n        <a-row :gutter=\"8\">\n          <a-col :lg=\"23\">\n            <st-form-item\n              class=\"page-content-card-support-sales mg-t4\"\n              label=\"支持售卖门店\"\n              required\n            >\n              <a-radio-group\n                :disabled=\"isShelfCard\"\n                @change=\"support_range\"\n                v-decorator=\"decorators.cardData.support_sales\"\n              >\n                <a-radio\n                  v-for=\"item in support_sales_list\"\n                  :key=\"item.value\"\n                  :value=\"item.value\"\n                >\n                  {{ item.label }}\n                </a-radio>\n              </a-radio-group>\n              <div\n                class=\"page-support-sales-shop\"\n                :class=\"{\n                  'page-lot-shop':\n                    cardData.admission_range === ADMISSION_RANGE.GENERAL_STORE\n                }\"\n                v-if=\"cardData.support_sales === SUPPORT_SALES.SPECIFIED_STORE\"\n              >\n                <p class=\"page-support-sales-shop__describe\">\n                  设置支持此{{ $c('member_card') }}售卖场馆范围\n                </p>\n                <select-shop\n                  :disabled=\"isShelfCard\"\n                  :shopIds=\"cardData.sell_shop_list\"\n                  @change=\"sales_shop_change\"\n                ></select-shop>\n              </div>\n            </st-form-item>\n          </a-col>\n        </a-row>\n        <a-row :gutter=\"8\">\n          <a-col :lg=\"20\">\n            <st-form-item class=\"page-content-card-time\" required>\n              <span slot=\"label\">\n                支持售卖时间\n                <a-popover\n                  trigger=\"hover\"\n                  placement=\"bottomRight\"\n                  arrowPointAtCenter\n                >\n                  <div slot=\"content\">\n                    设置此{{ $c('member_card') }}可售卖的时间范围\n                  </div>\n                  <a-icon\n                    class=\"page-content-card-time__icon\"\n                    type=\"info-circle\"\n                  ></a-icon>\n                </a-popover>\n              </span>\n              <a-form-item class=\"page-a-form\">\n                <a-date-picker\n                  :disabled=\"isShelfCard\"\n                  :disabledDate=\"disabledStartDate\"\n                  v-decorator=\"decorators.start_time\"\n                  format=\"YYYY-MM-DD\"\n                  placeholder=\"开始时间\"\n                  :showToday=\"false\"\n                  @openChange=\"handleStartOpenChange\"\n                  @change=\"start_time_change\"\n                />\n              </a-form-item>\n              ~\n              <a-form-item class=\"page-a-form\">\n                <a-date-picker\n                  :disabledDate=\"disabledEndDate\"\n                  v-decorator=\"decorators.end_time\"\n                  format=\"YYYY-MM-DD\"\n                  placeholder=\"结束时间\"\n                  :showToday=\"false\"\n                  :open=\"cardData.endOpen\"\n                  @openChange=\"handleEndOpenChange\"\n                  @change=\"end_time_change\"\n                />\n              </a-form-item>\n            </st-form-item>\n          </a-col>\n        </a-row>\n        <a-row :gutter=\"8\">\n          <a-col :lg=\"20\">\n            <st-form-item class=\"page-content-card-transfer\" label=\"转让设置\">\n              <div class=\"page-content-card-transfer-body\">\n                <a-checkbox\n                  class=\"page-checkbox\"\n                  :checked=\"cardData._is_transfer\"\n                  @change=\"transfer\"\n                >\n                  支持转让\n                </a-checkbox>\n                <st-input-number\n                  v-decorator=\"decorators.cardData.num\"\n                  class=\"page-input-group page-content-card-num-input\"\n                  :float=\"cardData.unit === UNIT.RMB\"\n                  :disabled=\"!cardData._is_transfer\"\n                  :min=\"transferMin\"\n                  :max=\"transferMax\"\n                >\n                  <a-select\n                    slot=\"addonAfter\"\n                    v-model=\"cardData.unit\"\n                    :disabled=\"!cardData._is_transfer\"\n                  >\n                    <a-select-option\n                      v-for=\"item in unit\"\n                      :key=\"item.value\"\n                      :value=\"item.value\"\n                    >\n                      {{ item.label }}\n                    </a-select-option>\n                  </a-select>\n                </st-input-number>\n              </div>\n            </st-form-item>\n          </a-col>\n        </a-row>\n        <a-row :gutter=\"8\">\n          <a-col :lg=\"20\">\n            <st-form-item\n              class=\"page-content-card-sell-type\"\n              label=\"售卖方式\"\n              required\n            >\n              <a-checkbox-group v-model=\"cardData.sell_type\">\n                <a-checkbox\n                  v-for=\"item in sell_type_list\"\n                  :key=\"item.value\"\n                  :value=\"item.value\"\n                >\n                  {{ item.label }}\n                </a-checkbox>\n              </a-checkbox-group>\n            </st-form-item>\n          </a-col>\n        </a-row>\n        <a-row :gutter=\"8\">\n          <a-col :lg=\"20\">\n            <st-form-item\n              class=\"page-content-card-bg\"\n              label=\"卡背景\"\n              required\n              :help=\"cardBgValidatorText\"\n            >\n              <card-bg-radio\n                @change=\"onCardBgChange\"\n                v-model=\"cardData.card_bg\"\n                :isFamilyCard=\"isFamilyCard\"\n              />\n            </st-form-item>\n          </a-col>\n        </a-row>\n        <a-row :gutter=\"8\">\n          <a-col :lg=\"22\">\n            <st-form-item\n              class=\"page-content-card-introduction mg-t4\"\n              :label=\"`${$c('member_card')}介绍`\"\n            >\n              <st-editor v-model=\"cardData.card_introduction\"></st-editor>\n            </st-form-item>\n          </a-col>\n        </a-row>\n        <a-row :gutter=\"8\">\n          <a-col :lg=\"22\">\n            <st-form-item\n              class=\"page-content-card-contents mg-t4\"\n              label=\"内部备注\"\n            >\n              <st-textarea\n                v-model=\"cardData.card_contents\"\n                maxlength=\"500\"\n                class=\"page-content-card-textarea\"\n                placeholder=\"请输入\"\n              />\n            </st-form-item>\n          </a-col>\n        </a-row>\n      </st-form>\n    </div>\n  </st-mina-panel>\n</template>\n<script>\nimport { UserService } from '@/services/user.service'\nimport moment from 'moment'\nimport { PatternService } from '@/services/pattern.service'\nimport SelectShop from '@/views/fragments/shop/select-shop'\nimport { cloneDeep, remove } from 'lodash-es'\nimport { EditService } from './edit.service'\nimport MemberCard from '@/views/biz-components/h5/pages/member-card'\nimport H5Container from '@/views/biz-components/h5/h5-container'\nimport h5mixin from '../period/h5mixin'\nimport { MEMBER_CARD } from '@/views/biz-components/h5/pages/member-card.config'\nimport CardBgRadio from '@/views/biz-components/card-bg-radio/card-bg-radio'\nimport FormBanner from '@/views/biz-components/card/form-banner.vue'\nimport {\n  ADMISSION_RANGE,\n  SELL_TYPE,\n  PRICE_SETTING,\n  SUPPORT_SALES,\n  UNIT,\n  CARD_TYPE\n} from '@/constants/card/member'\nimport { ruleOptions } from './number.config'\nimport StEditor from '@/views/components/editor#/editor.vue'\nexport default {\n  name: 'BrandNumberCardEdit',\n  mixins: [h5mixin],\n  serviceInject() {\n    return {\n      pattern: PatternService,\n      editService: EditService,\n      userService: UserService\n    }\n  },\n  rxState() {\n    return {\n      addLoading: this.editService.loading$,\n      cardInfo: this.editService.cardInfo$,\n      cardBgList: this.editService.cardBgList$,\n      admissionRange: this.editService.admissionRange$,\n      priceSetting: this.editService.priceSetting$,\n      supportSales: this.editService.supportSales$,\n      unit: this.editService.unit$,\n      sellType: this.editService.sellType$,\n      isShelfCard: this.editService.isShelfCard$,\n      supportMemberNums: this.editService.supportMemberNums$\n    }\n  },\n  bem: {\n    b: 'st-help-popover'\n  },\n  components: {\n    StEditor,\n    SelectShop,\n    MemberCard,\n    H5Container,\n    CardBgRadio,\n    FormBanner\n  },\n  data() {\n    const form = this.$stForm.create()\n    const decorators = form.decorators(ruleOptions)\n    return {\n      // cardData\n      form,\n      decorators,\n      ADMISSION_RANGE,\n      SELL_TYPE,\n      PRICE_SETTING,\n      SUPPORT_SALES,\n      UNIT,\n      cardType: MEMBER_CARD.NUMBER_CARD,\n      MEMBER_CARD,\n      cardData: {\n        // 卡id\n        id: null,\n        // 会员卡类型1-次卡 2-期限卡\n        card_type: this.isFamilyCard ? CARD_TYPE.MORE_NUMBER : CARD_TYPE.NUMBER,\n        // 会员卡名称\n        card_name: '',\n        // 特殊说明\n        special_note: '',\n        // 支持入场范围 1-单店 2-多店 3-全店\n        admission_range: ADMISSION_RANGE.ONLY_STORE,\n        // 支持入场门店\n        admission_shop_list: [],\n        // 价格设置类型 1-统一定价 2-门店定价\n        price_setting: PRICE_SETTING.UNIFORM_PRICE,\n        // 价格梯度\n        price_gradient: [],\n        // 支持售卖场馆类型 1-全部门店 2-指定门店\n        support_sales: SUPPORT_SALES.ALL_STORE,\n        // 支持售卖门店\n        sell_shop_list: [],\n        // 上架门店数量\n        shelf_shop_num: 0,\n\n        // 支持售卖时间\n        start_time: '',\n        end_time: '',\n        // 结束时间面板是否显示\n        endOpen: false,\n        // 是否支持转让\n        _is_transfer: false,\n        is_transfer: 0,\n        // 转让单位\n        unit: UNIT.RMB,\n        // 转让手续费\n        num: undefined,\n        // 售卖方式\n        sell_type: [SELL_TYPE.OFFLINE],\n        // 卡背景\n        card_bg: {\n          image_id: 0,\n          image_key: this.cardBgList[0].image_key,\n          image_url: '',\n          index: 1\n        },\n        // 是否配置了用户端\n        appConfig: true,\n        // 卡介绍\n        card_introduction: '',\n        // 备注\n        card_contents: ''\n      },\n      transfer_unit_is_first: true,\n      // 品牌统一定价-价格梯度\n      rallyPriceList: [],\n      // 门店自主定价-价格梯度\n      shopPriceList: [],\n      // 售卖时间\n      start_time: null,\n      end_time: null,\n      unit_list: [\n        {\n          value: 2,\n          label: '天'\n        },\n        {\n          value: 3,\n          label: '月'\n        },\n        {\n          value: 4,\n          label: '年'\n        }\n      ],\n      // 校验价格的help文本\n      priceValidatorText: '',\n      // 卡背景的help文本\n      cardBgValidatorText: '',\n      // 是否禁止选择开始时间,如果卡状态是可售卖，则需要禁止修改开始时间\n      startTimeIsDisabled: false\n    }\n  },\n  mounted() {\n    this.init()\n  },\n  methods: {\n    // init\n    init() {\n      this.form.setFieldsValue({\n        'cardData.special_note': this.cardInfo.special_note,\n        'cardData.admission_range': this.cardInfo.admission_range,\n        'cardData.price_setting': this.cardInfo.price_setting,\n        'cardData.support_sales': this.cardInfo.support_sales,\n        start_time: moment(this.cardInfo.start_time * 1000),\n        end_time: moment(this.cardInfo.end_time * 1000),\n        'cardData.num': this.cardInfo.transfer_num\n      })\n      if (this.isFamilyCard) {\n        this.form.setFieldsValue({\n          'cardData.support_member_num': this.cardInfo.support_member_num\n        })\n      }\n      // 入场门店\n      this.cardData.admission_range = this.cardInfo.admission_range\n      this.cardData.admission_shop_list = this.cardInfo.admission_shop_list\n      // 价格设置\n      this.cardData.price_setting = this.cardInfo.price_setting\n      if (this.cardInfo.price_setting === PRICE_SETTING.UNIFORM_PRICE) {\n        // 品牌定价\n        this.cardInfo.price_gradient.forEach(i => {\n          let key = parseInt(Math.random() * 999999).toString()\n          this.rallyPriceList.push({\n            key,\n            id: i.id,\n            time: {\n              unit: +i.unit,\n              num: +i.num\n            },\n            validity_times: +i.validity_times,\n            rally_price: +i.rally_price,\n            frozen_day: +i.frozen_day,\n            gift_unit: +i.gift_unit\n          })\n        })\n      } else {\n        // 门店定价\n        this.cardInfo.price_gradient.forEach(i => {\n          let key = parseInt(Math.random() * 999999).toString()\n          this.shopPriceList.push({\n            key,\n            id: i.id,\n            time: {\n              unit: +i.unit,\n              num: +i.num\n            },\n            validity_times: +i.validity_times,\n            frozen_day: +i.frozen_day,\n            gift_unit: +i.gift_unit,\n            rally_price: {\n              min_price: +i.min_price,\n              max_price: +i.max_price\n            }\n          })\n        })\n      }\n      // 支持售卖门店\n      this.cardData.support_sales = this.cardInfo.support_sales\n      this.cardData.sell_shop_list =\n        this.cardData.support_sales === SUPPORT_SALES.SPECIFIED_STORE\n          ? cloneDeep(this.cardInfo.sell_shop_list)\n          : []\n      // 支持售卖时间\n      this.start_time = moment(this.cardInfo.start_time * 1000)\n      this.end_time = moment(this.cardInfo.end_time * 1000)\n      this.startTimeIsDisabled =\n        this.cardInfo.start_time * 1000 <\n          moment()\n            .startOf('day')\n            .valueOf() && this.cardInfo.end_time * 1000 > moment().valueOf()\n      // 转让设置\n      this.cardData._is_transfer = !!this.cardInfo.is_transfer\n      this.cardData.unit = this.cardInfo.transfer_unit\n      this.cardData.num = this.cardInfo.transfer_num\n      // 售卖方式\n      this.cardData.sell_type = this.cardInfo.sell_type\n      // 卡背景\n      this.cardData.card_bg = cloneDeep(this.cardInfo.card_bg)\n      // 卡介绍\n      this.cardData.card_introduction = this.cardInfo.card_introduction\n      // 卡备注\n      this.cardData.card_contents = this.cardInfo.card_contents\n      this.initH5CardInfo()\n    },\n    // 保存\n    onHandleSubmit(e) {\n      e.preventDefault()\n      // 校验价格\n      this.priceValidator(this.cardData.price_setting)\n      // 校验卡背景\n      this.cardBgValidator()\n      this.form.validateFieldsAndScroll((err, values) => {\n        if (!err && this.priceIsOk && this.cardBgIsOk) {\n          // 入场门店\n          if (this.cardData.admission_range !== ADMISSION_RANGE.GENERAL_STORE) {\n            // 不是多门店\n            this.cardData.admission_shop_list = []\n          }\n          // 售卖门店\n          if (this.cardData.support_sales !== SUPPORT_SALES.SPECIFIED_STORE) {\n            // 不是多门店\n            this.cardData.sell_shop_list = []\n          }\n          // 售卖门店\n          if (\n            this.cardData.admission_range === ADMISSION_RANGE.GENERAL_STORE &&\n            this.cardData.support_sales === SUPPORT_SALES.ENTRY_STORE\n          ) {\n            // 多门店 && 支持入场门店\n            this.cardData.sell_shop_list = cloneDeep(\n              this.cardData.admission_shop_list\n            )\n          }\n          // 价格梯度\n          let p = []\n          switch (this.cardData.price_setting) {\n            case PRICE_SETTING.UNIFORM_PRICE:\n              // 品牌统一定价\n              this.rallyPriceList.forEach(i => {\n                p.push({\n                  id: i.id || 0,\n                  unit: +i.time.unit,\n                  num: +i.time.num,\n                  validity_times: +i.validity_times,\n                  rally_price: +i.rally_price,\n                  frozen_day: +i.frozen_day,\n                  gift_unit: +i.gift_unit\n                })\n              })\n              break\n            case PRICE_SETTING.SHOP_PRICE:\n              // 门店自主定价\n              this.shopPriceList.forEach(i => {\n                p.push({\n                  id: i.id || 0,\n                  unit: +i.time.unit,\n                  num: +i.time.num,\n                  validity_times: +i.validity_times,\n                  min_price: +i.rally_price.min_price,\n                  max_price: +i.rally_price.max_price,\n                  frozen_day: +i.frozen_day,\n                  gift_unit: +i.gift_unit\n                })\n              })\n              break\n          }\n          this.cardData.special_note = values.cardData.special_note\n          this.cardData.price_gradient = cloneDeep(p)\n          // 时间\n          this.cardData.start_time = `${this.start_time.format('YYYY-MM-DD')}`\n          this.cardData.end_time = `${this.end_time.format('YYYY-MM-DD')}`\n          // 卡id\n          this.cardData.id = +this.$searchQuery.id\n          // 转让\n          this.cardData.num = this.cardData._is_transfer\n            ? +values.cardData.num\n            : undefined\n          if (!this.isFamilyCard) {\n            this.cardData.support_member_num = 1\n            this.cardData.card_type = CARD_TYPE.NUMBER\n          } else {\n            this.cardData.support_member_num =\n              values.cardData.support_member_num\n            this.cardData.card_type = CARD_TYPE.MORE_NUMBER\n          }\n          this.editService.editCard(this.cardData).subscribe(res => {\n            this.$router.push({\n              name: 'brand-product-card-member-list-all'\n            })\n          })\n        }\n      })\n    },\n    // 增加入场门店\n    admission_range_change(data) {\n      this.cardData.admission_shop_list = cloneDeep(data)\n      this.syncAdmissionShop()\n    },\n    // 入场门店支持方式change\n    admission_range(data) {\n      this.cardData.admission_range = data.target.value\n      // 入场门店变化时，售卖门店和价格同时变化\n      this.form.setFieldsValue({\n        'cardData.support_sales': SUPPORT_SALES.ALL_STORE,\n        'cardData.price_setting': PRICE_SETTING.UNIFORM_PRICE\n      })\n      this.cardData.support_sales = SUPPORT_SALES.ALL_STORE\n      this.cardData.price_setting = PRICE_SETTING.UNIFORM_PRICE\n      this.priceValidatorText = ''\n      this.syncAdmission()\n    },\n    // 价格设置方式change\n    price_range(data) {\n      this.cardData.price_setting = data.target.value\n    },\n    // 增加品牌价格\n    brand_price_add() {\n      let key = parseInt(Math.random() * 999999).toString()\n      this.rallyPriceList.push({\n        key,\n        time: {\n          unit: 2,\n          num: null\n        },\n        validity_times: null,\n        rally_price: null,\n        frozen_day: null,\n        gift_unit: null\n      })\n    },\n    // 删除品牌价格\n    brand_price_delete(index) {\n      this.rallyPriceList.splice(index, 1)\n    },\n    // 品牌价格梯度-期限\n    brandPriceSettingHandleChange({ value, key, col, prop }) {\n      if (prop !== undefined) {\n        this.rallyPriceList[key][col][prop] = value\n      } else {\n        this.rallyPriceList[key][col] = value\n      }\n    },\n    // 增加门店价格\n    shop_price_add() {\n      let key = parseInt(Math.random() * 999999).toString()\n      this.shopPriceList.push({\n        key,\n        time: {\n          unit: 2,\n          num: null\n        },\n        rally_price: {\n          min_price: null,\n          max_price: null\n        },\n        validity_times: null,\n        frozen_day: null,\n        gift_unit: null\n      })\n    },\n    // 删除门店价格\n    shop_price_delete(index) {\n      this.shopPriceList.splice(index, 1)\n    },\n    // 门店价格梯度-期限\n    shopPriceSettingHandleChange({ value, key, col, prop }) {\n      if (prop !== undefined) {\n        this.shopPriceList[key][col][prop] = value\n      } else {\n        this.shopPriceList[key][col] = value\n      }\n    },\n    // 支持售卖门店change\n    support_range(data) {\n      this.cardData.support_sales = data.target.value\n    },\n    // 增加售卖门店\n    sales_shop_change(data) {\n      this.cardData.sell_shop_list = cloneDeep(data)\n    },\n    // 售卖时间-start\n    disabledStartDate(startValue) {\n      const endValue = this.end_time\n      if (!endValue) {\n        // 结束时间未选择\n        return (\n          startValue.valueOf() <\n          moment()\n            .startOf('day')\n            .valueOf()\n        )\n      }\n      let start =\n        endValue.valueOf() >\n        moment()\n          .add(30, 'y')\n          .valueOf()\n          ? moment(endValue)\n              .subtract(30, 'y')\n              .valueOf()\n          : moment()\n              .startOf('day')\n              .valueOf()\n      return (\n        startValue.valueOf() < start ||\n        startValue.valueOf() > moment(endValue).valueOf()\n      )\n    },\n    start_time_change(data) {\n      this.start_time = cloneDeep(data)\n    },\n    handleStartOpenChange(open) {\n      if (!open) {\n        this.cardData.endOpen = true\n      }\n    },\n    // 售卖时间-end\n    end_time_change(data) {\n      this.end_time = cloneDeep(data)\n    },\n    handleEndOpenChange(open) {\n      this.cardData.endOpen = open\n    },\n    disabledEndDate(endValue) {\n      const startValue = this.start_time\n      if (!startValue) {\n        // 开始时间未选择\n        return (\n          endValue.valueOf() <\n          moment()\n            .startOf('day')\n            .valueOf()\n        )\n      }\n      return (\n        endValue.valueOf() >=\n          moment(startValue)\n            .add(30, 'y')\n            .valueOf() ||\n        endValue.valueOf() < moment(startValue).valueOf() ||\n        endValue.valueOf() <\n          moment()\n            .startOf('day')\n            .valueOf()\n      )\n    },\n    // moment\n    moment,\n    range(start, end) {\n      const result = []\n      for (let i = start; i < end; i++) {\n        result.push(i)\n      }\n      return result\n    },\n    // 转让\n    transfer(e) {\n      this.cardData._is_transfer = e.target.checked\n      // 重置转让费用的校验\n      this.form.resetFields(['cardData.num'])\n    },\n    // 价格梯度校验\n    priceValidator(type) {\n      let fnName =\n        type === PRICE_SETTING.UNIFORM_PRICE\n          ? 'brandPriceValidataArray'\n          : 'shopPriceValidataArray'\n      let validata = this[fnName].length\n        ? this[fnName].every(i =>\n            this.pattern.NUM_FLOAT(1).test(i.split('-')[1])\n          )\n        : false\n      this.priceValidatorText = validata ? '' : '请输入正确的价格'\n    },\n    onCardBgChange(e) {\n      this.cardBgValidatorText = ''\n    },\n    // 卡背景校验\n    cardBgValidator() {\n      let validata = this.cardData.card_bg.image_key !== ''\n      this.cardBgValidatorText = validata ? '' : '请上传卡背景'\n    }\n  },\n  watch: {\n    'cardData._is_transfer': {\n      deep: true,\n      handler(newVal, oldVal) {\n        this.cardData.is_transfer = +newVal\n      }\n    },\n    'cardData.unit': {\n      deep: true,\n      handler() {\n        if (!this.transfer_unit_is_first) {\n          this.form.resetFields(['cardData.num'])\n        }\n        this.transfer_unit_is_first = false\n      }\n    },\n    'cardData.admission_shop_list': {\n      deep: true,\n      handler() {\n        let v = this.cardData.admission_range\n        this.cardData.admission_range = v\n        this.form.setFieldsValue({\n          'cardData.admission_range': v\n        })\n      }\n    },\n    'cardData.sell_shop_list': {\n      deep: true,\n      handler() {\n        let v = this.cardData.support_sales\n        this.cardData.support_sales = v\n        this.form.setFieldsValue({\n          'cardData.support_sales': v\n        })\n      }\n    }\n  },\n  computed: {\n    // 支持售卖门店\n    support_sales_list() {\n      let arr = cloneDeep(this.supportSales)\n      let index =\n        this.cardData.admission_range === ADMISSION_RANGE.GENERAL_STORE\n          ? 999\n          : 2\n      arr.splice(index, 1)\n      return arr\n    },\n    // 售卖方式\n    sell_type_list() {\n      let sell_type = cloneDeep(this.sellType)\n      let arr = []\n      sell_type.forEach(i => {\n        arr.push({\n          value: i.value,\n          label: i.label\n        })\n      })\n      if (!this.cardData.appConfig) {\n        remove(arr, i => i.value === SELL_TYPE.CLIENT)\n      }\n      return arr\n    },\n    // 品牌统一定价-价格梯度校验数组\n    brandPriceValidataArray() {\n      let array = []\n      this.rallyPriceList.forEach(i => {\n        Object.keys(i).forEach(o => {\n          array.push(o === 'time' ? `time-${i.time.num}` : `${o}-${i[o]}`)\n        })\n      })\n      return array\n    },\n    // 门店自主定价-价格梯度校验数组\n    shopPriceValidataArray() {\n      let array = []\n      this.shopPriceList.forEach(i => {\n        Object.keys(i).forEach(o => {\n          let value = []\n          if (o === 'time') {\n            value = [`time-${i.time.num}`]\n          } else if (o === 'rally_price') {\n            value = [\n              `min_price-${i.rally_price.min_price}`,\n              `max_price-${i.rally_price.max_price}`\n            ]\n          } else {\n            value = [`${o}-${i[o]}`]\n          }\n          array.push(...value)\n        })\n      })\n      return array\n    },\n    // 价格是否校验通过\n    priceIsOk() {\n      return this.priceValidatorText === ''\n    },\n    // 卡背景是否校验通过\n    cardBgIsOk() {\n      return this.cardBgValidatorText === ''\n    },\n    // 转让设置的min\n    transferMin() {\n      // return this.cardData.transfer_unit === 1 ? 1 : 0.1\n      return 0\n    },\n    // 转让设置的max\n    transferMax() {\n      return this.cardData.unit === UNIT.PERCENT ? 100 : 999999.9\n    },\n    // 是否是多人卡\n    isFamilyCard() {\n      return this.$searchQuery.type === 'family-card'\n    }\n  }\n}\n</script>\n"],"sourceRoot":"src/views/pages/brand/product/card/member/number"}]}