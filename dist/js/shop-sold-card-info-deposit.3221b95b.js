(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["shop-sold-card-info-deposit"],{2967:function(t,n,e){"use strict";e.r(n);var i=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("st-panel-layout",{class:t.basic()},[e("st-panel",{attrs:{title:"储值卡详情"}},[e("div",{attrs:{slot:"actions"},slot:"actions"},[e("st-btn-actions",{attrs:{options:t.btnOptions}})],1),e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{span:9}},[e("st-info",[e("st-info-item",{attrs:{label:"卡名"}},[t._v(t._s(t.info.card_name))]),e("st-info-item",{attrs:{label:"类型"}},[t._v(t._s(t.info.type))]),e("st-info-item",{attrs:{label:"初始额度"}},[t._v(t._s(t.info.init_amount))]),e("st-info-item",{attrs:{label:"剩余额度"}},[t._v(t._s(t.info.now_amount))]),e("st-info-item",{staticClass:"mg-b16",attrs:{label:"有效期"}},[t._v("\n            "+t._s(t.moment(1e3*t.info.buy_time).format("YYYY-MM-DD HH:mm"))+" 至\n            "+t._s(t.moment(1e3*t.info.end_time).format("YYYY-MM-DD HH:mm"))+"\n          ")]),e("st-info-item",{staticClass:"mg-b0",attrs:{label:"合同编号"}},[t._v("\n            "+t._s(t.info.contract_number)+"\n          ")])],1)],1),e("a-col",{attrs:{span:9}},[e("st-info",[e("st-info-item",{attrs:{label:"所属会员"}},[t._v(t._s(t.info.member_name))]),e("st-info-item",{attrs:{label:"手机号"}},[t._v(t._s(t.info.mobile))]),e("st-info-item",{attrs:{label:"订单号"}},[t._v(t._s(t.info.order_id))]),e("st-info-item",{attrs:{label:"订单状态"}},[t._v("\n            "+t._s(t._f("enumFilter")(t.info.order_status,"sold_common.order_status"))+"\n          ")]),e("st-info-item",{staticClass:"mg-b0",attrs:{label:"当前状态"}},[t._v("\n            "+t._s(t._f("enumFilter")(t.info.is_valid,"sold_common.card_status"))+"\n          ")])],1)],1),e("a-col",{attrs:{span:6}},[e("st-info",[e("st-info-item",{attrs:{label:"允许转让"}},[t._v("\n            "+t._s(t._f("enumFilter")(t.info.is_transferable,"sold_common.is_transferable"))+"\n          ")]),t.info.is_transferable&&t.info.transfer_unit?e("st-info-item",{attrs:{label:"转让手续费"}},[t._v("\n            "+t._s(t.info.transfer_num)+t._s(t._f("enumFilter")(t.info.transfer_unit,"package_course.transfer_unit"))+"\n          ")]):t._e(),e("st-info-item",{attrs:{label:"消费场馆"}},[t.info.shop_range.id<2?[t._v("\n              "+t._s(t.info.shop_range.shop_name)+"\n            ")]:e("a-popover",{attrs:{title:t.info.shop_range.shop_name}},[e("template",{slot:"content"},[e("st-table",{key:"id",class:t.basic("popover-content"),attrs:{columns:t.admissionColumns,dataSource:t.info.shop_range.shops,pagination:!1}})],1),e("a",{attrs:{type:"primary"}},[t._v("\n                "+t._s(t._f("enumFilter")(t.info.shop_range.id,"sold_common.admission_range"))+"\n              ")])],2)],2),e("st-info-item",{attrs:{label:"消费类目"}},t._l(t.info.consumer_type,(function(n,i){return e("span",{key:i},[t._v("\n              "+t._s(t._f("enumFilter")(n,"deposit_card.consumer_type"))+"\n              "),i!==t.info.consumer_type.length-1?e("i",[t._v("、")]):t._e()])})),0),e("st-info-item",{staticClass:"mg-b0",attrs:{label:"备注"}},[t._v("\n            "+t._s(t.info.description)+"\n          ")])],1)],1)],1)],1),e("st-panel",{staticClass:"mg-t16",attrs:{app:"",tabs:t.authTabs}},[e("router-view")],1)],1)},o=[],s=e("e2bd"),a=function(t){return[{text:"查看合同",click:t.toContract,if:t.auth["shop:sold:sold_deposit_card|export_contract"]},{text:"退款",click:t.onRefund,if:t.auth["brand_shop:order:order|refund"]},{text:"转让",click:t.onTransfer,if:t.auth["shop:sold:sold_deposit_card|transfer"]},{text:"修改合同备注",click:t.onEditContractDescription,if:t.auth["shop:sold:sold_deposit_card|edit_contract_remark"]},{text:"对内备注",click:t.onInternalNote,if:t.auth["shop:sold:sold_deposit_card|internal_description"]},{text:"修改权益",click:function(){return t.soldDepositCardActions.onUpdateRights(t.infoService.id)},if:t.auth["shop:sold:sold_deposit_card|rights_edit"]}]},r=e("c32d"),c=e.n(r),d=e("a51e"),f=e("3296"),l=e("f076"),u=e("c262"),_=e("1687"),m=e("2b1e"),p={name:"PageShopSoldCardDepositInfo",bem:{basic:"page-shop-sold-info"},modals:{SoldCardRefund:d["a"],SoldCardTransfer:f["a"]},serviceInject:function(){return{infoService:s["InfoService"]}},rxState:function(){return{info:this.infoService.info$,loading:this.infoService.loading$,authTabs:this.infoService.authTabs$,auth:this.infoService.auth$}},hooks:function(){return{internalNoteActions:Object(u["a"])(),contractActions:Object(_["a"])(this),soldDepositCardActions:Object(m["a"])(this)}},computed:{admissionColumns:l["a"],btnOptions:a},methods:{moment:c.a,toContract:function(){var t=this.info,n="".concat(window.location.origin,"/common/contract-preview?id=").concat(t.order_id);window.open(n)},onRefund:function(){var t=this;this.$modalRouter.push({name:"sold-card-refund",props:{type:"deposit",id:this.infoService.id},on:{success:function(){t.$router.reload()}}})},onTransfer:function(){var t=this;this.$modalRouter.push({name:"sold-card-transfer",props:{id:this.infoService.id,type:"deposit"},on:{success:function(){t.$router.reload()}}})},onInternalNote:function(){this.internalNoteActions.onOpenModal({id:this.infoService.id})},onEditContractDescription:function(){var t=this.info,n=t.order_id,e=t.description;this.contractActions.editDescription({order_id:n,description:e})}}},h=p,b=e("2877"),v=Object(b["a"])(h,i,o,!1,null,null,null);n["default"]=v.exports},e2bd:function(t,n,e){"use strict";e.r(n),e.d(n,"InfoService",(function(){return _}));var i,o,s=e("d225"),a=e("b0b4"),r=e("9ab4"),c=e("0cd5"),d=e("df29"),f=e("4e17"),l=e("c4cc"),u=e("2cbb"),_=function(){function t(n,e){Object(s["a"])(this,t),this.cardApi=n,this.authService=e,this.info$=new d["d"]({}),this.loading$=new d["d"]({}),this.auth$=new d["d"]({}),this.id="",this.authTabs$=this.authService.getAuthTabs$("shop-sold-card-info-deposit-info",{withQuery:["id","card_type"]})}return Object(a["a"])(t,[{key:"getInfo",value:function(t,n){var e=this;return this.cardApi.getCardInfo(t,n).pipe(Object(l["a"])((function(t){e.info$.commit((function(){return t.info})),e.auth$.commit((function(){return t.auth}))})))}},{key:"beforeEach",value:function(t){return this.id=t.meta.query.id,this.getInfo(t.meta.query.id,"deposit")}}]),t}();_=Object(r["b"])([Object(c["b"])(),Object(r["d"])("design:paramtypes",["function"===typeof(i="undefined"!==typeof f["a"]&&f["a"])?i:Object,"function"===typeof(o="undefined"!==typeof u["a"]&&u["a"])?o:Object])],_)},f076:function(t,n,e){"use strict";e.d(n,"a",(function(){return i})),e.d(n,"b",(function(){return o})),e.d(n,"c",(function(){return s}));var i=function(t){return[{title:"省",dataIndex:"province_name",key:"province_name"},{title:"市",dataIndex:"city_name",key:"city_name"},{title:"区",dataIndex:"district_name",key:"district_name"},{title:"门店名称",dataIndex:"shop_name",key:"shop_name"}]},o=function(t){return[{title:"课程类型",dataIndex:"course_type",key:"course_type"},{title:"课程名称",dataIndex:"name",key:"name"}]},s=function(t){return[{title:"星期",dataIndex:"week",key:"week"},{title:"时间段",dataIndex:"time",key:"time"}]}}}]);