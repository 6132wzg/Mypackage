{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/thread-loader/dist/cjs.js!/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js!/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhigang/Desktop/styd/web/src/views/biz-modals/finance/add-performance-template.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/biz-modals/finance/add-performance-template.vue","mtime":1597396799934},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/thread-loader/dist/cjs.js","mtime":1591062572352},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js","mtime":1591062572376}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { MessageService } from '@/services/message.service';\nimport { AddTemplateService } from \"./add-performance-template.service\";\nimport { UserService } from '@/services/user.service';\nimport { ruleOptions } from \"./performance-template.config\";\nimport { PERFORMANCE } from '@/constants/finance/performance';\nexport default {\n  serviceInject: function serviceInject() {\n    return {\n      service: AddTemplateService,\n      message: MessageService\n    };\n  },\n  rxState: function rxState() {\n    return {\n      performanceModes: this.service.performanceModes$,\n      performanceTypes: this.service.performanceTypes$\n    };\n  },\n  data: function data() {\n    var form = this.$stForm.create();\n    var decorators = form.decorators(ruleOptions);\n    return {\n      PERFORMANCE: PERFORMANCE,\n      form: form,\n      decorators: decorators,\n      data: [],\n      gradients: {\n        range_min: '',\n        royalty_num: ''\n      },\n      show: false,\n      choose: 1,\n      // 1 百分比 0 金额\n      isChooseks: true,\n      // 是否选中课时\n      performance_type: 1,\n      performance_mode: 1\n    };\n  },\n  computed: {\n    placeholderGradient: function placeholderGradient() {\n      if (this.performance_type == this.PERFORMANCE.PERFORMANCE_TYPE_1) {\n        return '请输入月销售额';\n      }\n\n      if (this.performance_type == this.PERFORMANCE.PERFORMANCE_TYPE_2) {\n        return '请输入月课时价值';\n      }\n\n      if (this.performance_type == this.PERFORMANCE.PERFORMANCE_TYPE_3) {\n        return '请输入月课时数';\n      }\n\n      return '请输入';\n    },\n    errorMessageTip: function errorMessageTip() {\n      if (this.performance_type == this.PERFORMANCE.PERFORMANCE_TYPE_1) {\n        return '月销售额不能重复';\n      }\n\n      if (this.performance_type == this.PERFORMANCE.PERFORMANCE_TYPE_2) {\n        return '月课时价值不能重复';\n      }\n\n      if (this.performance_type == this.PERFORMANCE.PERFORMANCE_TYPE_3) {\n        return '月课时数不能重复';\n      }\n\n      return '请输入';\n    },\n    placeholderGradientFee: function placeholderGradientFee() {\n      if (this.performance_type == this.PERFORMANCE.PERFORMANCE_TYPE_3) {\n        return '请输入课时费';\n      }\n\n      return '请输入月销售额';\n    }\n  },\n  methods: {\n    selectType: function selectType(e) {\n      this.performance_type = e;\n\n      if (e === this.PERFORMANCE.PERFORMANCE_TYPE_1 || e === this.PERFORMANCE.PERFORMANCE_TYPE_2) {\n        this.isChooseks = true;\n      } else if (e === this.PERFORMANCE.PERFORMANCE_TYPE_3) {\n        this.isChooseks = false;\n      }\n    },\n    submitEdit: function submitEdit(e) {\n      var range_min = this.data[e].range_min;\n      var royalty_num = this.data[e].royalty_num;\n\n      if (!this.data[e].range_min || !this.data[e].royalty_num) {\n        this.message.warn({\n          content: '请填写完整'\n        });\n        return;\n      }\n\n      if (this.performance_type == this.PERFORMANCE.PERFORMANCE_TYPE_3) {\n        range_min = parseInt(range_min);\n      } else {\n        range_min = parseFloat(range_min).toFixed(1);\n      }\n\n      royalty_num = parseFloat(royalty_num).toFixed(1);\n      var arr = this.data.filter(function (item, index) {\n        return item.range_min === range_min && index !== e;\n      });\n\n      if (arr.length > 0) {\n        this.message.warn({\n          content: this.errorMessageTip\n        });\n        return;\n      }\n\n      this.data[e].range_min = range_min;\n      this.data[e].royalty_num = royalty_num;\n      delete this.data[e].range_min_bak;\n      delete this.data[e].royalty_num_bak;\n      this.data[e].isEdit = false;\n    },\n    cancelEdit: function cancelEdit(e) {\n      this.data[e].isEdit = false;\n      this.data[e].range_min = this.data[e].range_min_bak;\n      this.data[e].royalty_num = this.data[e].royalty_num_bak;\n      delete this.data[e].range_min_bak;\n      delete this.data[e].royalty_num_bak;\n    },\n    editPerformanceNum: function editPerformanceNum(e) {\n      this.data[e].isEdit = true;\n      this.data[e].range_min_bak = this.data[e].range_min;\n      this.data[e].royalty_num_bak = this.data[e].royalty_num;\n    },\n    deletePerformanceNum: function deletePerformanceNum(e) {\n      this.data.splice(e, 1);\n    },\n    addGradients: function addGradients(e) {\n      // 加校验\n      var _this$gradients = this.gradients,\n          range_min = _this$gradients.range_min,\n          royalty_num = _this$gradients.royalty_num;\n\n      if (!range_min || !royalty_num) {\n        this.message.warn({\n          content: '请填写完整'\n        });\n        return;\n      }\n\n      if (this.performance_type == this.PERFORMANCE.PERFORMANCE_TYPE_3) {\n        range_min = parseInt(range_min);\n      } else {\n        range_min = parseFloat(range_min).toFixed(1);\n      }\n\n      royalty_num = parseFloat(royalty_num).toFixed(1);\n      var arr = this.data.filter(function (item) {\n        return item.range_min === range_min;\n      });\n\n      if (arr.length > 0) {\n        this.message.warn({\n          content: this.errorMessageTip\n        });\n        return;\n      }\n\n      this.data.push({\n        id: 0,\n        range_min: range_min,\n        royalty_num: royalty_num,\n        isEdit: false\n      });\n      this.gradients.range_min = '';\n      this.gradients.royalty_num = '';\n    },\n    handleSubmit: function handleSubmit(e) {\n      var _this = this;\n\n      e.preventDefault();\n      this.form.validate().then(function (values) {\n        values.gradients = _this.data;\n\n        if (values.performance_type === _this.PERFORMANCE.PERFORMANCE_TYPE_3) {\n          values.performance_mode = 0;\n        }\n\n        _this.service.addTemplate(values).subscribe(function () {\n          _this.$emit('change');\n\n          _this.message.success({\n            content: '新增成功'\n          });\n\n          _this.show = false;\n        });\n      });\n    },\n    onChooseRadio: function onChooseRadio(e) {\n      this.performance_mode = e.target.value;\n      this.data = [];\n    }\n  }\n};",null]}