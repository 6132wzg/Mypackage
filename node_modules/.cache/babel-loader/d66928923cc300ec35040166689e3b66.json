{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js!/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhigang/Desktop/styd/web/src/views/biz-modals/sold/course/package/update-rights.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/biz-modals/sold/course/package/update-rights.vue","mtime":1601345845238},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js","mtime":1591062572376}],"contextDependencies":[],"result":["import \"core-js/modules/es6.number.constructor\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { UpdateRightsService } from \"./update-rights.service.ts\";\nimport { ruleOptions } from \"./update-rights.config\";\nimport { MessageService } from '@/services/message.service';\nimport CommonTaskSuccessTip from '@/views/biz-modals/common/task/success-tip';\nexport default {\n  modals: {\n    CommonTaskSuccessTip: CommonTaskSuccessTip\n  },\n  serviceInject: function serviceInject() {\n    return {\n      messageService: MessageService,\n      updateRightsService: UpdateRightsService\n    };\n  },\n  rxState: function rxState() {\n    var _this$updateRightsSer = this.updateRightsService,\n        info$ = _this$updateRightsSer.info$,\n        loading$ = _this$updateRightsSer.loading$,\n        transferUnitOptions$ = _this$updateRightsSer.transferUnitOptions$,\n        supportMemberNumOptions$ = _this$updateRightsSer.supportMemberNumOptions$,\n        reserveLimitDayOptions$ = _this$updateRightsSer.reserveLimitDayOptions$,\n        reserveIsLimitNewOptions$ = _this$updateRightsSer.reserveIsLimitNewOptions$;\n    return {\n      info: info$,\n      loading: loading$,\n      transferUnitOptions: transferUnitOptions$,\n      supportMemberNumOptions: supportMemberNumOptions$,\n      reserveLimitDayOptions: reserveLimitDayOptions$,\n      reserveIsLimitNewOptions: reserveIsLimitNewOptions$\n    };\n  },\n  props: {\n    id: {\n      type: Number,\n      default: 0\n    },\n\n    /**\n     * 是否是课程包列表的同步售出权益操作\n     */\n    isSync: {\n      type: Boolean,\n      default: false\n    },\n    isShowLink: {\n      type: Boolean,\n      default: true\n    },\n    isBrandTaskLink: {\n      type: Boolean,\n      default: false\n    }\n  },\n  data: function data() {\n    var form = this.$stForm.create();\n    var decorators = form.decorators(ruleOptions);\n    return {\n      form: form,\n      decorators: decorators,\n      show: false,\n      timeList: [],\n      INOUT_TYPE_CUSTOM: 2,\n      switches: {\n        supportNum: 0,\n        frozenTime: 0,\n        transferSetting: 0,\n        reserveSetting: 0\n      }\n    };\n  },\n  computed: {\n    title: function title() {\n      return '修改售出权益' + (this.isSync ? '-选中权益点信息会同步到已售合同' : '');\n    }\n  },\n  created: function created() {\n    var _this = this;\n\n    this.updateRightsService.getInfo(this.id, this.isSync).subscribe(function (res) {\n      _this.$nextTick(function () {\n        _this.setFieldsValue(res.info);\n      });\n    });\n  },\n  methods: {\n    setFieldsValue: function setFieldsValue(info) {\n      var frozen_time_remain = info.frozen_time_remain,\n          support_num = info.support_num;\n      var _info$transfer = info.transfer,\n          transfer_num = _info$transfer.transfer_num,\n          transfer_unit = _info$transfer.transfer_unit;\n      var _info$reserve = info.reserve,\n          reserve_limit_day = _info$reserve.reserve_limit_day,\n          reserve_limit_times = _info$reserve.reserve_limit_times,\n          reserve_is_limit = _info$reserve.reserve_is_limit;\n      this.form.setFieldsValue({\n        support_num: support_num,\n        frozen_time_remain: frozen_time_remain,\n        transfer_num: transfer_num,\n        transfer_unit: transfer_unit || 1,\n        reserve_limit_day: reserve_limit_day || 1,\n        reserve_limit_times: reserve_limit_times,\n        reserve_is_limit: reserve_is_limit\n      });\n    },\n    onSwitchChange: function onSwitchChange() {\n      this.form.validateFields(['transfer_num', 'transfer_unit', 'frozen_time_remain', 'reserve_limit_times'], {\n        force: true\n      });\n    },\n    checkIsChanged: function checkIsChanged() {\n      var isChanged = false;\n      var switches = this.switches;\n\n      for (var i in switches) {\n        if (switches[i]) {\n          isChanged = true;\n          return true;\n        }\n      }\n\n      return isChanged;\n    },\n    onSubmit: function onSubmit() {\n      var _this2 = this;\n\n      if (!this.checkIsChanged()) {\n        return this.messageService.error({\n          content: '未进行任何操作，请勿提交'\n        });\n      }\n\n      this.form.validate().then(function (values) {\n        _this2.doSubmit(values);\n      });\n    },\n    doSubmit: function doSubmit(values) {\n      var _this3 = this;\n\n      var _this$info = this.info,\n          transfer = _this$info.transfer,\n          support_member_num = _this$info.support_member_num,\n          reserve = _this$info.reserve;\n      var frozen_time_remain = values.frozen_time_remain,\n          support_num = values.support_num;\n      var switches = this.switches;\n      var params = {\n        id: this.id,\n        support_num: support_num,\n        is_change_support_num: switches.supportNum,\n        frozen_time_remain: frozen_time_remain,\n        is_change_frozen_time_remain: switches.frozenTime,\n        transfer: {\n          is_transferable: transfer.is_transferable,\n          transfer_num: values.transfer_num,\n          transfer_unit: values.transfer_unit\n        },\n        is_change_transfer: switches.transferSetting,\n        reserve: {\n          reserve_is_limit: reserve.reserve_is_limit,\n          reserve_limit_day: values.reserve_limit_day,\n          reserve_limit_times: values.reserve_limit_times\n        },\n        is_change_reserve: switches.reserveSetting\n      };\n      this.updateRightsService.updateRights(params, this.isSync).subscribe(function () {\n        if (_this3.isSync) {\n          _this3.onSyncSubmitSuccess();\n        } else {\n          _this3.onSubmitSuccess();\n        }\n      });\n    },\n    onSubmitSuccess: function onSubmitSuccess() {\n      this.messageService.success({\n        content: '提交成功'\n      });\n      this.show = false;\n      this.$emit('success');\n    },\n\n    /**\n     * 课程包售出权益同步成功回调\n     */\n    onSyncSubmitSuccess: function onSyncSubmitSuccess() {\n      this.show = false;\n      this.successTip();\n    },\n    successTip: function successTip() {\n      var _this4 = this;\n\n      this.$modalRouter.push({\n        name: 'common-task-success-tip',\n        props: {\n          isShowLink: this.isShowLink,\n          isBrandTaskLink: this.isBrandTaskLink\n        },\n        on: {\n          success: function success() {\n            _this4.$emit('success');\n          }\n        }\n      });\n    }\n  }\n};",{"version":3,"sources":["update-rights.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <st-modal :title=\"title\" v-model=\"show\">\n    <st-form :form=\"form\">\n      <st-form-item labelWidth=\"120px\">\n        <template slot=\"label\">\n          <st-checkbox v-model=\"switches.supportNum\">\n            支持入场人数\n          </st-checkbox>\n        </template>\n        <st-input-number\n          v-decorator=\"decorators.support_num\"\n          :disabled=\"!switches.supportNum\"\n          :min=\"1\"\n          :max=\"20\"\n          style=\"width: 120px\"\n        >\n          <template slot=\"addonAfter\">人</template>\n        </st-input-number>\n      </st-form-item>\n      <st-form-item labelWidth=\"120px\">\n        <template slot=\"label\">\n          <st-checkbox v-model=\"switches.frozenTime\" @change=\"onSwitchChange\">\n            剩余冻结时长\n          </st-checkbox>\n        </template>\n        <st-input-number\n          v-decorator=\"decorators.frozen_time_remain\"\n          :disabled=\"!switches.frozenTime\"\n          :max=\"9999\"\n          style=\"width: 120px\"\n        >\n          <template slot=\"addonAfter\">天</template>\n        </st-input-number>\n      </st-form-item>\n      <st-form-item v-if=\"info.transfer\" labelWidth=\"88px\">\n        <template slot=\"label\">\n          <st-checkbox\n            v-model=\"switches.transferSetting\"\n            @change=\"onSwitchChange\"\n          >\n            转让设置\n          </st-checkbox>\n        </template>\n        <st-checkbox\n          :disabled=\"!switches.transferSetting\"\n          v-model=\"info.transfer.is_transferable\"\n        >\n          支持转让\n        </st-checkbox>\n        <st-input-number\n          v-show=\"info.transfer.is_transferable\"\n          v-decorator=\"decorators.transfer_num\"\n          style=\"width: 140px\"\n          :min=\"0\"\n          :max=\"form.getFieldValue('transfer_unit') === 1 ? 100 : 9999999.9\"\n          :disabled=\"!switches.transferSetting\"\n        >\n          <span slot=\"addonAfter\">\n            <a-select\n              v-decorator=\"decorators.transfer_unit\"\n              :options=\"transferUnitOptions\"\n              :disabled=\"!switches.transferSetting\"\n            ></a-select>\n          </span>\n        </st-input-number>\n      </st-form-item>\n      <st-form-item v-if=\"info.reserve\" labelWidth=\"88px\">\n        <template slot=\"label\">\n          <st-checkbox\n            v-model=\"switches.reserveSetting\"\n            @change=\"onSwitchChange\"\n          >\n            约课限制\n          </st-checkbox>\n        </template>\n        <a-select\n          style=\"width: 160px; margin-right: 10px;\"\n          v-model=\"info.reserve.reserve_is_limit\"\n          :options=\"reserveIsLimitNewOptions\"\n          :disabled=\"!switches.reserveSetting\"\n        ></a-select>\n        <st-input-number\n          v-decorator=\"decorators.reserve_limit_times\"\n          v-show=\"info.reserve.reserve_is_limit === 1\"\n          :min=\"1\"\n          :max=\"999\"\n          :disabled=\"!switches.reserveSetting\"\n          style=\"width: 200px\"\n        >\n          <a-select\n            v-decorator=\"decorators.reserve_limit_day\"\n            slot=\"addonBefore\"\n            :disabled=\"!switches.reserveSetting\"\n            :options=\"reserveLimitDayOptions\"\n          ></a-select>\n          <template slot=\"addonAfter\">节</template>\n        </st-input-number>\n        <span class=\"st-des mg-l8\">该限制仅生效于小程序</span>\n      </st-form-item>\n    </st-form>\n    <template slot=\"footer\">\n      <a-popconfirm v-if=\"isSync\" @confirm=\"onSubmit\" placement=\"topRight\">\n        <template slot=\"title\">\n          <p>\n            请再次确认是否同步，同步后会覆盖\n            <br />\n            售出售出会员卡，将会有2-5s无法正常使用\n          </p>\n        </template>\n        <st-button type=\"primary\" :loading=\"loading.updateRights\">\n          确认提交\n        </st-button>\n      </a-popconfirm>\n      <st-button\n        v-else\n        type=\"primary\"\n        @click=\"onSubmit\"\n        :loading=\"loading.updateRights\"\n      >\n        确认提交\n      </st-button>\n    </template>\n  </st-modal>\n</template>\n\n<script>\nimport { UpdateRightsService } from './update-rights.service.ts'\nimport { ruleOptions } from './update-rights.config'\nimport { MessageService } from '@/services/message.service'\nimport CommonTaskSuccessTip from '@/views/biz-modals/common/task/success-tip'\nexport default {\n  modals: {\n    CommonTaskSuccessTip\n  },\n  serviceInject() {\n    return {\n      messageService: MessageService,\n      updateRightsService: UpdateRightsService\n    }\n  },\n  rxState() {\n    const {\n      info$,\n      loading$,\n      transferUnitOptions$,\n      supportMemberNumOptions$,\n      reserveLimitDayOptions$,\n      reserveIsLimitNewOptions$\n    } = this.updateRightsService\n    return {\n      info: info$,\n      loading: loading$,\n      transferUnitOptions: transferUnitOptions$,\n      supportMemberNumOptions: supportMemberNumOptions$,\n      reserveLimitDayOptions: reserveLimitDayOptions$,\n      reserveIsLimitNewOptions: reserveIsLimitNewOptions$\n    }\n  },\n  props: {\n    id: {\n      type: Number,\n      default: 0\n    },\n    /**\n     * 是否是课程包列表的同步售出权益操作\n     */\n    isSync: {\n      type: Boolean,\n      default: false\n    },\n    isShowLink: {\n      type: Boolean,\n      default: true\n    },\n    isBrandTaskLink: {\n      type: Boolean,\n      default: false\n    }\n  },\n  data() {\n    const form = this.$stForm.create()\n    const decorators = form.decorators(ruleOptions)\n    return {\n      form,\n      decorators,\n      show: false,\n      timeList: [],\n      INOUT_TYPE_CUSTOM: 2,\n      switches: {\n        supportNum: 0,\n        frozenTime: 0,\n        transferSetting: 0,\n        reserveSetting: 0\n      }\n    }\n  },\n  computed: {\n    title() {\n      return (\n        '修改售出权益' + (this.isSync ? '-选中权益点信息会同步到已售合同' : '')\n      )\n    }\n  },\n  created() {\n    this.updateRightsService.getInfo(this.id, this.isSync).subscribe(res => {\n      this.$nextTick(() => {\n        this.setFieldsValue(res.info)\n      })\n    })\n  },\n  methods: {\n    setFieldsValue(info) {\n      const { frozen_time_remain, support_num } = info\n      const { transfer_num, transfer_unit } = info.transfer\n      const {\n        reserve_limit_day,\n        reserve_limit_times,\n        reserve_is_limit\n      } = info.reserve\n      this.form.setFieldsValue({\n        support_num,\n        frozen_time_remain,\n        transfer_num,\n        transfer_unit: transfer_unit || 1,\n        reserve_limit_day: reserve_limit_day || 1,\n        reserve_limit_times,\n        reserve_is_limit\n      })\n    },\n    onSwitchChange() {\n      this.form.validateFields(\n        [\n          'transfer_num',\n          'transfer_unit',\n          'frozen_time_remain',\n          'reserve_limit_times'\n        ],\n        { force: true }\n      )\n    },\n    checkIsChanged() {\n      let isChanged = false\n      const { switches } = this\n      for (let i in switches) {\n        if (switches[i]) {\n          isChanged = true\n          return true\n        }\n      }\n      return isChanged\n    },\n    onSubmit() {\n      if (!this.checkIsChanged()) {\n        return this.messageService.error({\n          content: '未进行任何操作，请勿提交'\n        })\n      }\n      this.form.validate().then(values => {\n        this.doSubmit(values)\n      })\n    },\n    doSubmit(values) {\n      const { transfer, support_member_num, reserve } = this.info\n      const { frozen_time_remain, support_num } = values\n      const { switches } = this\n      const params = {\n        id: this.id,\n        support_num,\n        is_change_support_num: switches.supportNum,\n        frozen_time_remain,\n        is_change_frozen_time_remain: switches.frozenTime,\n        transfer: {\n          is_transferable: transfer.is_transferable,\n          transfer_num: values.transfer_num,\n          transfer_unit: values.transfer_unit\n        },\n        is_change_transfer: switches.transferSetting,\n        reserve: {\n          reserve_is_limit: reserve.reserve_is_limit,\n          reserve_limit_day: values.reserve_limit_day,\n          reserve_limit_times: values.reserve_limit_times\n        },\n        is_change_reserve: switches.reserveSetting\n      }\n      this.updateRightsService\n        .updateRights(params, this.isSync)\n        .subscribe(() => {\n          if (this.isSync) {\n            this.onSyncSubmitSuccess()\n          } else {\n            this.onSubmitSuccess()\n          }\n        })\n    },\n    onSubmitSuccess() {\n      this.messageService.success({\n        content: '提交成功'\n      })\n      this.show = false\n      this.$emit('success')\n    },\n    /**\n     * 课程包售出权益同步成功回调\n     */\n    onSyncSubmitSuccess() {\n      this.show = false\n      this.successTip()\n    },\n    successTip() {\n      this.$modalRouter.push({\n        name: 'common-task-success-tip',\n        props: {\n          isShowLink: this.isShowLink,\n          isBrandTaskLink: this.isBrandTaskLink\n        },\n        on: {\n          success: () => {\n            this.$emit('success')\n          }\n        }\n      })\n    }\n  }\n}\n</script>\n"],"sourceRoot":"src/views/biz-modals/sold/course/package"}]}