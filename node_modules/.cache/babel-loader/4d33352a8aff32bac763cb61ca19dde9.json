{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js!/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhigang/Desktop/styd/web/src/views/pages/brand/setting/sms/group.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/pages/brand/setting/sms/group.vue","mtime":1600926556240},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js","mtime":1591062572376}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { GroupService } from \"./group.service\";\nimport { recordColumns, templateColumns } from \"./group.config.ts\";\nimport { UserService } from '@/services/user.service';\nimport BrandSettingSmsGroup from '@/views/biz-modals/brand/setting/sms/group';\nimport BrandSettingSmsTemplate from '@/views/biz-modals/brand/setting/sms/template';\nimport BrandSettingSmsReceive from '@/views/biz-modals/brand/setting/sms/receive';\nimport tableMixin from '@/mixins/table.mixin';\nvar pageName = 'page-setting-sms-group';\nexport default {\n  mixins: [tableMixin],\n  bem: {\n    bPage: pageName\n  },\n  serviceInject: function serviceInject() {\n    return {\n      groupService: GroupService\n    };\n  },\n  rxState: function rxState() {\n    return {\n      loading: this.groupService.loading$,\n      templatePage: this.groupService.templatePage$,\n      templateList: this.groupService.templateList$,\n      groupPage: this.groupService.groupPage$,\n      groupList: this.groupService.groupList$\n    };\n  },\n  modals: {\n    BrandSettingSmsGroup: BrandSettingSmsGroup,\n    BrandSettingSmsTemplate: BrandSettingSmsTemplate,\n    BrandSettingSmsReceive: BrandSettingSmsReceive\n  },\n  computed: {\n    recordColumns: recordColumns,\n    templateColumns: templateColumns\n  },\n  created: function created() {},\n  mounted: function mounted() {},\n  data: function data() {\n    return {\n      isShowList: 1\n    };\n  },\n  methods: {\n    // 撤销\n    onReset: function onReset(id) {\n      var _this = this;\n\n      return this.groupService.onReset(id).subscribe(function (res) {\n        _this.getGroupList();\n      });\n    },\n    // 删除\n    onDelete: function onDelete(id) {\n      var _this2 = this;\n\n      return this.groupService.onDelete(id).subscribe(function (res) {\n        _this2.getTemplateList();\n      });\n    },\n    handleTableChange: function handleTableChange(e) {\n      this.isShowList = e.target.value;\n\n      if (this.isShowList) {\n        this.getGroupList();\n      } else {\n        this.getTemplateList();\n      }\n    },\n    onTemTableChange: function onTemTableChange(pagination) {\n      var para = {\n        current_page: pagination.current,\n        size: pagination.pageSize\n      };\n      this.getTemplateList(para);\n    },\n    getTemplateList: function getTemplateList(para) {\n      return this.groupService.getTemplateList(para).subscribe();\n    },\n    getGroupList: function getGroupList() {\n      return this.groupService.getGroupList().subscribe();\n    },\n    refresh: function refresh() {\n      return this.groupService.getGroupList();\n    }\n  }\n};",{"version":3,"sources":["group.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div :class=\"bPage()\">\n    <div class=\"mg-b24\">\n      <st-button\n        type=\"primary\"\n        class=\"mg-r12\"\n        v-modal-link=\"{\n          name: 'brand-setting-sms-group',\n          on: { success: getGroupList }\n        }\"\n      >\n        群发消息\n      </st-button>\n      <st-button\n        v-modal-link=\"{\n          name: 'brand-setting-sms-template',\n          on: { success: getTemplateList }\n        }\"\n      >\n        新增短信模版\n      </st-button>\n      <a-radio-group\n        :value=\"isShowList\"\n        @change=\"handleTableChange\"\n        class=\"fl-r\"\n      >\n        <a-radio-button :value=\"1\">发送记录</a-radio-button>\n        <a-radio-button :value=\"0\">短信模版</a-radio-button>\n      </a-radio-group>\n      <st-refresh-btn\n        class=\"fl-r mg-r8\"\n        :class=\"bPage('actions')\"\n        v-if=\"isShowList\"\n        :action=\"refresh\"\n      ></st-refresh-btn>\n    </div>\n    <st-table\n      v-if=\"isShowList\"\n      :page=\"groupPage\"\n      :loading=\"loading.getGroupList\"\n      @change=\"onTableChange\"\n      :columns=\"recordColumns\"\n      :dataSource=\"groupList\"\n      rowKey=\"group_id\"\n      :class=\"bPage('table')\"\n    >\n      <span slot=\"action\" slot-scope=\"text, record\">\n        <st-table-actions>\n          <st-popconfirm\n            v-if=\"record.send_status === 0\"\n            title=\"确定撤销吗\"\n            @confirm=\"onReset(record.group_id)\"\n          >\n            <a>撤销</a>\n          </st-popconfirm>\n          <a\n            v-if=\"record.send_status === 0\"\n            v-modal-link=\"{\n              name: 'brand-setting-sms-group',\n              props: { id: record.group_id },\n              on: { success: getGroupList }\n            }\"\n          >\n            编辑\n          </a>\n        </st-table-actions>\n      </span>\n      <div slot=\"send_status_text\" slot-scope=\"text, record\">\n        <st-text\n          :status=\"{\n            success: record.send_status === 2,\n            default: record.send_status === 1,\n            info: record.send_status === 0,\n            error: record.send_status === 4,\n            warning: record.send_status === 3\n          }\"\n        >\n          {{ record.send_status_text }}\n        </st-text>\n      </div>\n      <div slot=\"received_count\" slot-scope=\"text, record\">\n        <a\n          v-modal-link=\"{\n            name: 'brand-setting-sms-receive',\n            props: { id: record.group_id }\n          }\"\n        >\n          {{ record.received_count }}\n        </a>\n      </div>\n      <div\n        slot=\"content\"\n        style=\" text-overflow: -o-ellipsis-lastline;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  display: -webkit-box;\n  -webkit-line-clamp: 2;\n  line-clamp: 2;\n  -webkit-box-orient: vertical;\n\"\n        slot-scope=\"text, record\"\n      >\n        <a-tooltip\n          placement=\"topLeft\"\n          overlayClassName=\"page-setting-sms-group-tooltip\"\n        >\n          <template slot=\"title\">\n            <span>{{ record.content }}</span>\n          </template>\n          {{ record.content }}\n        </a-tooltip>\n      </div>\n    </st-table>\n    <st-table\n      v-else\n      :page=\"templatePage\"\n      :loading=\"loading.getTemplateList\"\n      @change=\"onTemTableChange\"\n      :columns=\"templateColumns\"\n      :dataSource=\"templateList\"\n      rowKey=\"tmpl_id\"\n      :class=\"bPage('table')\"\n    >\n      <div slot=\"action\" slot-scope=\"text, record\">\n        <st-table-actions>\n          <a\n            v-modal-link=\"{\n              name: 'brand-setting-sms-template',\n              on: { success: getTemplateList },\n              props: { info: record }\n            }\"\n          >\n            编辑\n          </a>\n          <st-popconfirm\n            title=\"\n                  确定删除吗\n                \"\n            @confirm=\"onDelete(record.tmpl_id)\"\n          >\n            <a>删除</a>\n          </st-popconfirm>\n          <a\n            v-modal-link=\"{\n              name: 'brand-setting-sms-group',\n              props: {\n                tmpl: {\n                  tmpl_type: 2,\n                  tmpl_id: record.tmpl_id,\n                  content: record.content\n                }\n              },\n              on: { success: getTemplateList }\n            }\"\n          >\n            发送\n          </a>\n        </st-table-actions>\n      </div>\n    </st-table>\n  </div>\n</template>\n<script>\nimport { GroupService } from './group.service'\nimport { recordColumns, templateColumns } from './group.config.ts'\nimport { UserService } from '@/services/user.service'\nimport BrandSettingSmsGroup from '@/views/biz-modals/brand/setting/sms/group'\nimport BrandSettingSmsTemplate from '@/views/biz-modals/brand/setting/sms/template'\nimport BrandSettingSmsReceive from '@/views/biz-modals/brand/setting/sms/receive'\n\nimport tableMixin from '@/mixins/table.mixin'\nconst pageName = 'page-setting-sms-group'\n\nexport default {\n  mixins: [tableMixin],\n  bem: {\n    bPage: pageName\n  },\n  serviceInject() {\n    return {\n      groupService: GroupService\n    }\n  },\n  rxState() {\n    return {\n      loading: this.groupService.loading$,\n      templatePage: this.groupService.templatePage$,\n      templateList: this.groupService.templateList$,\n      groupPage: this.groupService.groupPage$,\n      groupList: this.groupService.groupList$\n    }\n  },\n  modals: {\n    BrandSettingSmsGroup,\n    BrandSettingSmsTemplate,\n    BrandSettingSmsReceive\n  },\n  computed: {\n    recordColumns,\n    templateColumns\n  },\n  created() {},\n  mounted() {},\n  data() {\n    return {\n      isShowList: 1\n    }\n  },\n  methods: {\n    // 撤销\n    onReset(id) {\n      return this.groupService.onReset(id).subscribe(res => {\n        this.getGroupList()\n      })\n    },\n    // 删除\n    onDelete(id) {\n      return this.groupService.onDelete(id).subscribe(res => {\n        this.getTemplateList()\n      })\n    },\n    handleTableChange(e) {\n      this.isShowList = e.target.value\n      if (this.isShowList) {\n        this.getGroupList()\n      } else {\n        this.getTemplateList()\n      }\n    },\n    onTemTableChange(pagination) {\n      let para = {\n        current_page: pagination.current,\n        size: pagination.pageSize\n      }\n      this.getTemplateList(para)\n    },\n    getTemplateList(para) {\n      return this.groupService.getTemplateList(para).subscribe()\n    },\n    getGroupList() {\n      return this.groupService.getGroupList().subscribe()\n    },\n    refresh() {\n      return this.groupService.getGroupList()\n    }\n  }\n}\n</script>\n"],"sourceRoot":"src/views/pages/brand/setting/sms"}]}