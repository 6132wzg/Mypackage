{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js!/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhigang/Desktop/styd/web/src/views/biz-modals/store/class-manage.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/biz-modals/store/class-manage.vue","mtime":1600926555996},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js","mtime":1591062572376}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { ClassManageService } from \"./class-manage.service\";\nimport { cloneDeep } from 'lodash-es';\nexport default {\n  serviceInject: function serviceInject() {\n    return {\n      classManageService: ClassManageService\n    };\n  },\n  rxState: function rxState() {\n    return {\n      loading: this.classManageService.loading$\n    };\n  },\n  data: function data() {\n    return {\n      show: false,\n      tableData: [],\n      oldTableData: [],\n      loadingStatus: 1 // 1: 获取列表，2：新增分类，3删除分类，4编辑分类\n\n    };\n  },\n  mounted: function mounted() {\n    this.getList();\n  },\n  methods: {\n    getList: function getList() {\n      var _this = this;\n\n      this.loadingStatus = 1;\n      this.classManageService.getList().subscribe(function (res) {\n        res.list.map(function (item) {\n          return item.isEdit = false;\n        });\n        _this.tableData = res.list;\n        _this.oldTableData = cloneDeep(res.list);\n      });\n    },\n    onSubmit: function onSubmit() {\n      this.show = false;\n      this.$emit('success', this.tableData);\n    },\n    addClass: function addClass() {\n      this.tableData.unshift({\n        category_name: '',\n        isEdit: true,\n        isNew: true\n      });\n      this.oldTableData.unshift({\n        category_name: '',\n        isEdit: true,\n        isNew: true\n      });\n    },\n    saveHandle: function saveHandle(item, index) {\n      var _this2 = this;\n\n      // 新建分类\n      if (item.isNew) {\n        this.loadingStatus = 2;\n        this.classManageService.addClass({\n          category_name: item.category_name\n        }).subscribe(function (res) {\n          item.category_id = res.category_id;\n          item.isEdit = false;\n          _this2.oldTableData[index] = item;\n        });\n      } else {\n        this.loadingStatus = 4; //  编辑分类\n\n        this.classManageService.editClass(item.category_id, {\n          category_name: item.category_name\n        }).subscribe(function (res) {\n          item.isEdit = false;\n          _this2.oldTableData[index] = item;\n        });\n      }\n    },\n    editHandle: function editHandle(item) {\n      item.isEdit = true;\n    },\n    cancelHandle: function cancelHandle(item, index) {\n      if (!item.category_name || !item.category_id) {\n        this.tableData.splice(index, 1);\n        this.oldTableData.splice(index, 1);\n      } else {\n        item.category_name = this.oldTableData[index].category_name;\n        item.isEdit = false;\n      }\n    },\n    delHandle: function delHandle(item, index) {\n      var _this3 = this;\n\n      this.loadingStatus = 3;\n      this.classManageService.delClass(item.category_id).subscribe(function (res) {\n        _this3.getList();\n      });\n    }\n  }\n};",{"version":3,"sources":["class-manage.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <st-modal\n    :loading=\"\n      loadingStatus === 1\n        ? loading.getList\n        : loadingStatus === 2\n        ? loading.addClass\n        : loadingStatus === 3\n        ? loading.delClass\n        : loading.editClass\n    \"\n    title=\"分类管理\"\n    @ok=\"onSubmit\"\n    v-model=\"show\"\n  >\n    <st-container>\n      <st-form-table>\n        <thead>\n          <tr>\n            <th style=\"padding-left: 42px\">分类名称</th>\n            <th style=\"width: 20%\">操作</th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr v-if=\"tableData.length < 10\">\n            <td colspan=\"3\" class=\"st-form-table__add\">\n              <st-button type=\"dashed\" icon=\"add\" block @click=\"addClass\">\n                新增（{{ tableData.length }}/10）\n              </st-button>\n            </td>\n          </tr>\n          <tr v-for=\"(item, index) in tableData\" :key=\"index\">\n            <td style=\"padding-left: 42px\" v-if=\"item.isEdit\">\n              <a-input\n                style=\"width: 150px\"\n                maxlength=\"6\"\n                v-model=\"item.category_name\"\n              ></a-input>\n            </td>\n            <td style=\"padding-left: 42px\" v-else>{{ item.category_name }}</td>\n            <td>\n              <st-table-actions>\n                <a @click=\"saveHandle(item, index)\" v-if=\"item.isEdit\">\n                  保存\n                </a>\n                <a @click=\"editHandle(item, index)\" v-else>\n                  编辑\n                </a>\n                |\n                <a @click=\"cancelHandle(item, index)\" v-if=\"item.isEdit\">\n                  取消\n                </a>\n                <a @click=\"delHandle(item, index)\" v-else>\n                  删除\n                </a>\n              </st-table-actions>\n            </td>\n          </tr>\n        </tbody>\n      </st-form-table>\n    </st-container>\n  </st-modal>\n</template>\n<script>\nimport { ClassManageService } from './class-manage.service'\nimport { cloneDeep } from 'lodash-es'\nexport default {\n  serviceInject() {\n    return { classManageService: ClassManageService }\n  },\n  rxState() {\n    return {\n      loading: this.classManageService.loading$\n    }\n  },\n  data() {\n    return {\n      show: false,\n      tableData: [],\n      oldTableData: [],\n      loadingStatus: 1 // 1: 获取列表，2：新增分类，3删除分类，4编辑分类\n    }\n  },\n  mounted() {\n    this.getList()\n  },\n  methods: {\n    getList() {\n      this.loadingStatus = 1\n      this.classManageService.getList().subscribe(res => {\n        res.list.map(item => (item.isEdit = false))\n        this.tableData = res.list\n        this.oldTableData = cloneDeep(res.list)\n      })\n    },\n    onSubmit() {\n      this.show = false\n      this.$emit('success', this.tableData)\n    },\n    addClass() {\n      this.tableData.unshift({ category_name: '', isEdit: true, isNew: true })\n      this.oldTableData.unshift({\n        category_name: '',\n        isEdit: true,\n        isNew: true\n      })\n    },\n    saveHandle(item, index) {\n      // 新建分类\n      if (item.isNew) {\n        this.loadingStatus = 2\n        this.classManageService\n          .addClass({ category_name: item.category_name })\n          .subscribe(res => {\n            item.category_id = res.category_id\n            item.isEdit = false\n            this.oldTableData[index] = item\n          })\n      } else {\n        this.loadingStatus = 4\n        //  编辑分类\n        this.classManageService\n          .editClass(item.category_id, { category_name: item.category_name })\n          .subscribe(res => {\n            item.isEdit = false\n            this.oldTableData[index] = item\n          })\n      }\n    },\n    editHandle(item) {\n      item.isEdit = true\n    },\n    cancelHandle(item, index) {\n      if (!item.category_name || !item.category_id) {\n        this.tableData.splice(index, 1)\n        this.oldTableData.splice(index, 1)\n      } else {\n        item.category_name = this.oldTableData[index].category_name\n        item.isEdit = false\n      }\n    },\n    delHandle(item, index) {\n      this.loadingStatus = 3\n      this.classManageService.delClass(item.category_id).subscribe(res => {\n        this.getList()\n      })\n    }\n  }\n}\n</script>\n"],"sourceRoot":"src/views/biz-modals/store"}]}