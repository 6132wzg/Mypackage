(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["tier-2~shop-finance-order~shop-sold-cabinet"],{c201:function(e,t,n){"use strict";var r,a,i,s,o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("st-modal",{attrs:{title:"转让",size:"small",wrapClassName:"modal-sold-lease-transfer"},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[n("div",{class:e.transfer("content")},[n("a-row",{class:e.transfer("info")},[n("a-col",{attrs:{span:13}},[n("st-info",[n("st-info-item",{attrs:{label:"商品名称"}},[e._v("\n            "+e._s(e.info.product_name)+"\n          ")]),n("st-info-item",{attrs:{label:"剩余天数"}},[e._v(e._s(e.info.remain_days))]),n("st-info-item",{attrs:{label:"租赁天数"}},[e._v(e._s(e.info.lease_days))]),n("st-info-item",{attrs:{label:"实付金额"}},[e._v(e._s(e.info.pay_price))]),n("st-info-item",{attrs:{label:"销售人员"}},[e._v(e._s(e.info.staff_name))]),n("st-info-item",{attrs:{label:"订单号"}},[e._v(e._s(e.info.order_id))])],1)],1),n("a-col",{attrs:{span:11}},[n("st-info",[n("st-info-item",{attrs:{label:"会员姓名"}},[e._v(e._s(e.info.member_name))]),e.info.is_minors===e.PERSON_TYPE.CHILD?[n("st-info-item",{attrs:{label:"家长手机号"}},[e._v("\n              "+e._s(e.info.parent_mobile)+"\n            ")]),n("st-info-item",{attrs:{label:"家长姓名"}},[e._v("\n              "+e._s(e.info.parent_name)+"\n            ")])]:n("st-info-item",{attrs:{label:"手机号"}},[e._v(e._s(e.info.mobile))]),n("st-info-item",{attrs:{label:"起租日期"}},[e._v(e._s(e.info.start_time))]),n("st-info-item",{attrs:{label:"到期日期"}},[e._v(e._s(e.info.end_time))]),e.info.order_status?n("st-info-item",{attrs:{label:"订单状态"}},[e._v("\n            "+e._s(e._f("enumFilter")(e.info.order_status,"sold_common.order_status"))+"\n          ")]):e._e()],2)],1)],1),n("st-hr",{staticClass:"mg-0"}),n("st-form",{attrs:{form:e.form,labelWidth:"88px"}},[n("div",{class:e.transfer("transfer")},[e.info.sale_range?n("member-search",{attrs:{form:e.form,saleRangeType:e.info.sale_range.type,label:"转让会员"}}):e._e(),n("st-form-item",{attrs:{label:"剩余价值",required:""}},[n("template",{slot:"label"},[e._v("\n            剩余价值\n            "),n("st-help-tooltip",{attrs:{id:"TSMC004"}})],1),n("st-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:e.decorators.remainPrice,expression:"decorators.remainPrice"}],attrs:{max:+e.info.pay_price,float:!0,placeholder:"请输入剩余价值"}},[n("template",{slot:"addonAfter"},[e._v("元")])],2)],2),n("editable-contract-number",{attrs:{form:e.form},model:{value:e.info.contract_number,callback:function(t){e.$set(e.info,"contract_number",t)},expression:"info.contract_number"}}),n("st-form-item",{attrs:{label:"手续费",type:"text"}},[e._v("\n          "+e._s(e.info.transfer_num)+"元\n        ")]),n("st-form-item",{attrs:{label:"减免金额"}},[n("st-input-number",{directives:[{name:"decorator",rawName:"v-decorator",value:e.decorators.handling_fee_reduce,expression:"decorators.handling_fee_reduce"}],attrs:{float:!0,placeholder:"请输入减免金额",max:e.info.transfer_num}},[n("span",{attrs:{slot:"addonAfter"},slot:"addonAfter"},[e._v("元")])])],1),n("st-form-item",{attrs:{label:"支付方式",required:""}},[n("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:e.decorators.payType,expression:"decorators.payType"}],attrs:{placeholder:"选择支付方式"}},e._l(e.payList,(function(t,r){return n("a-select-option",{key:r,attrs:{value:+t.payment_type}},[e._v("\n              "+e._s(t.payment_type_name)+"\n            ")])})),1)],1)],1)])],1),n("template",{slot:"footer"},[n("st-button",{attrs:{loading:e.loading.setTransaction,type:"primary"},on:{click:e.onSubmit}},[e._v("\n      确认提交\n    ")])],1)],2)},c=[],l=(n("c5f6"),n("d225")),m=n("b0b4"),f=n("9ab4"),d=n("0cd5"),p=n("df29"),u=n("c4cc"),b=n("d792"),_=n("af6c"),v=n("dd5c"),y=n("b51b"),h=n("75ca"),g=function(){function e(t,n,r){Object(l["a"])(this,e),this.contractApi=t,this.transactionApi=n,this.cabinetApi=r,this.loading$=new p["d"]({}),this.memberList$=new p["d"]([]),this.info$=new p["d"]({}),this.timeScope$=new p["d"]({}),this.payList$=new p["d"]([])}return Object(m["a"])(e,[{key:"getMember",value:function(e){var t=this;return this.transactionApi.getTransactionMemeberList(e).pipe(Object(u["a"])((function(e){t.memberList$.commit((function(){return e.list}))})))}},{key:"getDetail",value:function(e){var t=this;return this.cabinetApi.getDetail(e,"transfer").pipe(Object(u["a"])((function(e){t.info$.commit((function(){return e.info}))})),Object(b["a"])((function(e){return t.getPayList({member_id:e.info.member_id,product_type:e.info.product_type,operation_type:y["a"].TRANSFORM})})))}},{key:"setTransaction",value:function(e,t){return this.cabinetApi.setTransaction(e,"transfer",t)}},{key:"getPayList",value:function(e){var t=this;return this.transactionApi.getMemberPaymentList(e).pipe(Object(u["a"])((function(e){t.payList$.commit((function(){return e.list}))})))}}]),e}();Object(f["b"])([Object(p["c"])(),Object(f["d"])("design:type",Function),Object(f["d"])("design:paramtypes",["function"===typeof(r="undefined"!==typeof h["MemberListInput"]&&h["MemberListInput"])?r:Object]),Object(f["d"])("design:returntype",void 0)],g.prototype,"getMember",null),Object(f["b"])([Object(p["c"])(),Object(f["d"])("design:type",Function),Object(f["d"])("design:paramtypes",[Object,Number]),Object(f["d"])("design:returntype",void 0)],g.prototype,"setTransaction",null),Object(f["b"])([Object(p["c"])(),Object(f["d"])("design:type",Function),Object(f["d"])("design:paramtypes",[Object]),Object(f["d"])("design:returntype",void 0)],g.prototype,"getPayList",null),g=Object(f["b"])([Object(d["b"])(),Object(f["d"])("design:paramtypes",["function"===typeof(a="undefined"!==typeof _["a"]&&_["a"])?a:Object,"function"===typeof(i="undefined"!==typeof h["c"]&&h["c"])?i:Object,"function"===typeof(s="undefined"!==typeof v["a"]&&v["a"])?s:Object])],g);var O=n("2138"),j=n("2527"),w=function(e){e.pattern;return{remainPrice:{rules:[{required:!0,message:"请输入剩余价值"}]},payType:{rules:[{required:!0,message:"请选择支付方式"}]},handling_fee_reduce:{}}},S=n("464d"),L=n("2d9d"),T=n("b283"),$={name:"ModalSoldLeaseTransfer",bem:{transfer:"modal-sold-lease-transfer"},components:{EditableContractNumber:S["a"],MemberSearch:L["a"]},serviceProviders:function(){return[g]},serviceInject:function(){return{userService:O["a"],transferService:g,pattern:j["a"]}},rxState:function(){return{loading:this.transferService.loading$,info:this.transferService.info$,payList:this.transferService.payList$}},props:["id","type"],data:function(){var e=this.$stForm.create(),t=e.decorators(w);return{PERSON_TYPE:T["e"],form:e,decorators:t,show:!1}},created:function(){this.transferService.getDetail(this.id,this.type).subscribe()},computed:{member_id:function(){return this.info.member_id}},methods:{onSubmit:function(){var e=this;this.form.validate().then((function(t){e.transferService.setTransaction({id:e.id,transferee_member_id:+t.member_id,member_name:t.member_name,mobile:t.mobile?t.mobile.phone:void 0,sale_range:e.info.sale_range.type,remain_amount:t.remainPrice,contract_number:e.info.contract_number,pay_channel:+t.payType,handling_fee_reduce:t.handling_fee_reduce,is_minors:t.is_minors,parent_name:t.parent_name,parent_mobile:t.parent_mobile?t.parent_mobile.phone:void 0,parent_country_prefix:t.parent_mobile?t.parent_mobile.code_id:void 0,parent_user_role:t.parent_user_role},e.id,e.type).subscribe((function(t){e.$emit("success"),e.show=!1}))}))},disabledStartDate:function(e){return e.valueOf()<moment().subtract(1,"d").valueOf()||e.valueOf()>moment().add(31,"d").valueOf()}}},P=$,x=n("2877"),A=Object(x["a"])(P,o,c,!1,null,null,null);t["a"]=A.exports}}]);