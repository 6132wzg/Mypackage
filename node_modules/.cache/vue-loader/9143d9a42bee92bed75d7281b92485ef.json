{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhigang/Desktop/styd/web/src/views/biz-modals/course/select-course.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/biz-modals/course/select-course.vue","mtime":1600926382213},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js","mtime":1591062572376}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { SelectCourseService } from './select-course.service'\nimport { cloneDeep, filter, remove } from 'lodash-es'\nexport default {\n  name: 'SelectCourse',\n  serviceInject() {\n    return {\n      selectCourseService: SelectCourseService\n    }\n  },\n  rxState() {\n    return {\n      addLoading: this.selectCourseService.loading$\n    }\n  },\n  bem: {\n    course: 'st-select-course'\n  },\n  props: {\n    type: {\n      type: String,\n      default() {\n        return 'team'\n      }\n    },\n    courses: {\n      type: Array,\n      default() {\n        return []\n      }\n    }\n  },\n  data() {\n    return {\n      show: false,\n      courseTypeList: [],\n      titleList: {\n        team: '选择团课',\n        personal: '选择私教课'\n      },\n      searchData: {\n        course_type: null,\n        search: ''\n      },\n      courseList: [],\n      selectCourseList: []\n    }\n  },\n  methods: {\n    onCourseTypeChange(data) {\n      this.searchData.search = ''\n      this.searchData.course_type = data\n      this.getCourseList()\n    },\n    onAdd(id) {\n      let arr = filter(this.courseList, o => o.course_id === id)\n      this.selectCourseList.push(...arr)\n      this.filterCourse()\n    },\n    onAllAdd() {\n      this.selectCourseList.push(...cloneDeep(this.courseList))\n      this.courseList = []\n    },\n    onRemove(id) {\n      let arr = cloneDeep(this.selectCourseList)\n      remove(arr, o => o.course_id === id)\n      this.selectCourseList = arr\n      this.getCourseList()\n    },\n    onOk() {\n      this.$emit('ok', { list: cloneDeep(this.selectCourseList) })\n      this.show = false\n    },\n    // 根据已选课程，过滤可选课程\n    filterCourse() {\n      let arr = cloneDeep(this.courseList)\n      this.selectCourseList.forEach(i => {\n        remove(arr, o => o.course_id === i.course_id)\n      })\n      this.courseList = arr\n    },\n    getCourseType() {\n      this.selectCourseService.getCourseTypeList().subscribe(res => {\n        this.courseTypeList = cloneDeep(res.list)\n        this.searchData.course_type = res.list[0].id\n        this.getCourseList()\n      })\n    },\n    getCourseList() {\n      this.selectCourseService\n        .getCourseList({\n          type: this.type,\n          search: this.searchData.search,\n          course_type: this.searchData.course_type\n        })\n        .subscribe(res => {\n          this.courseList = cloneDeep(res.list)\n          this.filterCourse()\n        })\n    }\n  },\n  created() {\n    this.getCourseType()\n    this.selectCourseList.push(...this.courses)\n  }\n}\n",{"version":3,"sources":["select-course.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"select-course.vue","sourceRoot":"src/views/biz-modals/course","sourcesContent":["<template>\n  <st-modal :title=\"titleList[type]\" @ok=\"onOk\" v-model=\"show\">\n    <div :class=\"course()\">\n      <div :class=\"course('search')\">\n        <a-select\n          :class=\"course('search-select')\"\n          :getPopupContainer=\"trigger => trigger.parentNode\"\n          v-model=\"searchData.course_type\"\n          @change=\"onCourseTypeChange\"\n        >\n          <a-select-option\n            v-for=\"(item, index) in courseTypeList\"\n            :key=\"index\"\n            :value=\"item.id\"\n          >\n            {{ item.setting_name }}\n          </a-select-option>\n        </a-select>\n        <st-input-search\n          @search=\"getCourseList\"\n          v-model=\"searchData.search\"\n          :class=\"course('search-input')\"\n          placeholder=\"请输入课程名称进行查询\"\n        />\n      </div>\n      <div :class=\"course('all-table')\">\n        <st-form-table>\n          <colgroup>\n            <col style=\"width:25%;\" />\n            <col style=\"width:23%;\" />\n            <col style=\"width:33%;\" />\n            <col style=\"width:16%;\" />\n          </colgroup>\n          <tr class=\"bg-thead\">\n            <th class=\"pl-9\">课程类别</th>\n            <th>课程类型</th>\n            <th>课程名称</th>\n            <th>操作</th>\n          </tr>\n          <tbody>\n            <tr>\n              <td colspan=\"4\">\n                <ul\n                  :class=\"course('scroll-content')\"\n                  v-scrollBar=\"{ stopPropagation: true }\"\n                >\n                  <li\n                    class=\"table-item\"\n                    v-for=\"(item, index) in courseList\"\n                    :class=\"{\n                      'bg-row-odd': index % 2 === 0,\n                      'bg-row-even': index % 2 !== 0\n                    }\"\n                    :key=\"item.course_id\"\n                  >\n                    <div class=\"pl-9\">{{ item.course_category }}</div>\n                    <div>{{ item.course_type }}</div>\n                    <div>\n                      <st-overflow-text\n                        slot=\"\"\n                        max-width=\"180px\"\n                        :value=\"item.course_name\"\n                      ></st-overflow-text>\n                    </div>\n                    <div>\n                      <a\n                        href=\"javascript:void(0)\"\n                        @click=\"onAdd(item.course_id)\"\n                      >\n                        添加\n                      </a>\n                    </div>\n                  </li>\n                </ul>\n              </td>\n            </tr>\n          </tbody>\n        </st-form-table>\n      </div>\n      <p :class=\"course('count')\">\n        <span>共查到{{ courseList.length }}条记录</span>\n        <a\n          href=\"javascript:void(0)\"\n          :disabled=\"courseList.length < 1\"\n          @click=\"onAllAdd\"\n        >\n          全部添加\n        </a>\n      </p>\n      <p :class=\"course('selet-course-title')\">\n        已选定{{ selectCourseList.length }}种课程\n      </p>\n      <div :class=\"course('select-table')\">\n        <st-form-table>\n          <colgroup>\n            <col style=\"width:25%;\" />\n            <col style=\"width:23%;\" />\n            <col style=\"width:33%;\" />\n            <col style=\"width:16%;\" />\n          </colgroup>\n          <tr class=\"bg-thead\">\n            <th class=\"pl-9\">课程类别</th>\n            <th>课程类型</th>\n            <th>课程名称</th>\n            <th>操作</th>\n          </tr>\n          <tbody>\n            <tr>\n              <td colspan=\"4\">\n                <ul\n                  :class=\"course('scroll-content')\"\n                  v-scrollBar=\"{ stopPropagation: true }\"\n                >\n                  <li\n                    class=\"table-item\"\n                    v-for=\"(item, index) in selectCourseList\"\n                    :class=\"{\n                      'bg-row-odd': index % 2 === 0,\n                      'bg-row-even': index % 2 !== 0\n                    }\"\n                    :key=\"item.course_id\"\n                  >\n                    <div class=\"pl-9\">{{ item.course_category }}</div>\n                    <div>{{ item.course_type }}</div>\n                    <div>\n                      <st-overflow-text\n                        slot=\"\"\n                        max-width=\"180px\"\n                        :value=\"item.course_name\"\n                      ></st-overflow-text>\n                    </div>\n                    <div>\n                      <a href=\"javascript:void(0)\">\n                        <st-popconfirm\n                          :title=\"'一旦删除则无法恢复，确认删除'\"\n                          @confirm=\"onRemove(item.course_id)\"\n                        >\n                          删除\n                        </st-popconfirm>\n                      </a>\n                    </div>\n                  </li>\n                </ul>\n              </td>\n            </tr>\n          </tbody>\n        </st-form-table>\n      </div>\n    </div>\n  </st-modal>\n</template>\n<script>\nimport { SelectCourseService } from './select-course.service'\nimport { cloneDeep, filter, remove } from 'lodash-es'\nexport default {\n  name: 'SelectCourse',\n  serviceInject() {\n    return {\n      selectCourseService: SelectCourseService\n    }\n  },\n  rxState() {\n    return {\n      addLoading: this.selectCourseService.loading$\n    }\n  },\n  bem: {\n    course: 'st-select-course'\n  },\n  props: {\n    type: {\n      type: String,\n      default() {\n        return 'team'\n      }\n    },\n    courses: {\n      type: Array,\n      default() {\n        return []\n      }\n    }\n  },\n  data() {\n    return {\n      show: false,\n      courseTypeList: [],\n      titleList: {\n        team: '选择团课',\n        personal: '选择私教课'\n      },\n      searchData: {\n        course_type: null,\n        search: ''\n      },\n      courseList: [],\n      selectCourseList: []\n    }\n  },\n  methods: {\n    onCourseTypeChange(data) {\n      this.searchData.search = ''\n      this.searchData.course_type = data\n      this.getCourseList()\n    },\n    onAdd(id) {\n      let arr = filter(this.courseList, o => o.course_id === id)\n      this.selectCourseList.push(...arr)\n      this.filterCourse()\n    },\n    onAllAdd() {\n      this.selectCourseList.push(...cloneDeep(this.courseList))\n      this.courseList = []\n    },\n    onRemove(id) {\n      let arr = cloneDeep(this.selectCourseList)\n      remove(arr, o => o.course_id === id)\n      this.selectCourseList = arr\n      this.getCourseList()\n    },\n    onOk() {\n      this.$emit('ok', { list: cloneDeep(this.selectCourseList) })\n      this.show = false\n    },\n    // 根据已选课程，过滤可选课程\n    filterCourse() {\n      let arr = cloneDeep(this.courseList)\n      this.selectCourseList.forEach(i => {\n        remove(arr, o => o.course_id === i.course_id)\n      })\n      this.courseList = arr\n    },\n    getCourseType() {\n      this.selectCourseService.getCourseTypeList().subscribe(res => {\n        this.courseTypeList = cloneDeep(res.list)\n        this.searchData.course_type = res.list[0].id\n        this.getCourseList()\n      })\n    },\n    getCourseList() {\n      this.selectCourseService\n        .getCourseList({\n          type: this.type,\n          search: this.searchData.search,\n          course_type: this.searchData.course_type\n        })\n        .subscribe(res => {\n          this.courseList = cloneDeep(res.list)\n          this.filterCourse()\n        })\n    }\n  },\n  created() {\n    this.getCourseType()\n    this.selectCourseList.push(...this.courses)\n  }\n}\n</script>\n"]}]}