{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"tier-11~brand-marketing-plugin-coupon~brand-marketing-plugin-group~brand-marketing-plugin-lottery~br~e04738a9\"],{\"89fa\":function(t,e,n){\"use strict\";function i(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s={keyRegExp:/^\\d+$/,keyName:\"\"};return e=Object.assign(s,e),t.map((function(t){var s=n,c=!0,o=e,r=o.keyRegExp,a=o.keyName;for(var h in t)a?t.key=t[a]:r.test(t[h])?t.key=t[h]:t.key=t.id,\"string\"===typeof t[h]&&(t.title=t[h]),t[h]instanceof Array&&(c=!1,t.children=t[h],t.children=i(t.children,e,++s));return t.key=JSON.stringify({isLeaf:c,key:t.key}),t}))}n.d(e,\"a\",(function(){return i}))},d2d7:function(t,e,n){\"use strict\";var i,s,c=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n(\"div\",[n(\"st-form-table\",[n(\"thead\",[n(\"tr\",[n(\"th\",[t._v(\"省\")]),n(\"th\",[t._v(\"市\")]),n(\"th\",[t._v(\"区\")]),n(\"th\",[t._v(\"门店名称\")]),t.disabled?t._e():n(\"th\",[t._v(\"操作\")])])]),n(\"tbody\",[t.disabled?t._e():n(\"tr\",[n(\"td\",{staticClass:\"st-form-table__add\",attrs:{colspan:t.colspanNum}},[n(\"st-button\",{directives:[{name:\"modal-link\",rawName:\"v-modal-link\",value:{name:\"shop-select\",props:{checked:t.checkedShopIds,groupParams:t.groupParams,type:t.type},on:{change:t.onSelectShopComplete}},expression:\"{\\n              name: 'shop-select',\\n              props: {\\n                checked: checkedShopIds,\\n                groupParams,\\n                type\\n              },\\n              on: {\\n                change: onSelectShopComplete\\n              }\\n            }\"}],attrs:{type:\"dashed\",icon:\"add\",block:\"\"}},[t._v(\"\\n            新增门店\\n          \")])],1)]),t.list.length?t._l(t.list,(function(e,i){return n(\"tr\",{key:i},[n(\"td\",[t._v(t._s(e.province))]),n(\"td\",[t._v(t._s(e.city))]),n(\"td\",[t._v(t._s(e.district))]),n(\"td\",[t._v(t._s(e.shop_name))]),t.disabled?t._e():n(\"td\",[n(\"a\",{on:{click:function(n){return t.delShopTableRecord(e.shop_id)}}},[t._v(\"\\n              删除\\n            \")])])])})):[n(\"tr\",[n(\"td\",{attrs:{colspan:t.colspanNum}},[n(\"st-no-data\")],1)])]],2)])],1)},o=[],r=(n(\"ac6a\"),n(\"d225\")),a=n(\"b0b4\"),h=n(\"9ab4\"),p=n(\"0cd5\"),d=n(\"df29\"),u=n(\"5afb\"),l=function(){function t(e){Object(r[\"a\"])(this,t),this.shopApi=e,this.loading$=new d[\"d\"]({})}return Object(a[\"a\"])(t,[{key:\"getShopBasic\",value:function(t){return this.shopApi.getShopBasic(t)}}]),t}();Object(h[\"b\"])([Object(d[\"c\"])(),Object(h[\"d\"])(\"design:type\",Function),Object(h[\"d\"])(\"design:paramtypes\",[\"function\"===typeof(i=\"undefined\"!==typeof u[\"GetShopBasicInput\"]&&u[\"GetShopBasicInput\"])?i:Object]),Object(h[\"d\"])(\"design:returntype\",void 0)],l.prototype,\"getShopBasic\",null),l=Object(h[\"b\"])([Object(p[\"b\"])(),Object(h[\"d\"])(\"design:paramtypes\",[\"function\"===typeof(s=\"undefined\"!==typeof u[\"c\"]&&u[\"c\"])?s:Object])],l);var f,g,y=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n(\"st-modal\",{staticClass:\"modal-brand-switch\",attrs:{title:\"选择场馆\",footer:null,loading:t.loading.getShopListTree},model:{value:t.show,callback:function(e){t.show=e},expression:\"show\"}},[n(\"st-container\",[n(\"a-tree\",{attrs:{checkable:\"\",treeData:t.treeData},on:{check:t.onCheck},model:{value:t.checkedKeys,callback:function(e){t.checkedKeys=e},expression:\"checkedKeys\"}})],1),n(\"p\",{staticClass:\"color-text-light mg-t8\"},[t._v(\"已选择\"+t._s(t.checedNum)+\"家场馆\")]),n(\"p\",{staticClass:\"ta-r\"},[n(\"st-button\",{attrs:{type:\"primary\"},on:{click:t.confirm}},[t._v(\"确定\")])],1)],1)},b=[],m=n(\"c4cc\"),S=function(){function t(e){Object(r[\"a\"])(this,t),this.shopApi=e,this.loading$=new d[\"d\"]({}),this.list$=new d[\"d\"]([])}return Object(a[\"a\"])(t,[{key:\"getShopListTree\",value:function(t,e){return\"group\"===e?this.getGroupShopList(t):this.getShopList()}},{key:\"getGroupShopList\",value:function(t){var e=this;return this.shopApi.getGroupShopList(t).pipe(Object(m[\"a\"])((function(t){e.list$.commit((function(){return t.list}))})))}},{key:\"getShopList\",value:function(){var t=this;return this.shopApi.getShopListTree().pipe(Object(m[\"a\"])((function(e){t.list$.commit((function(){return e.list}))})))}}]),t}();Object(h[\"b\"])([Object(d[\"c\"])(),Object(h[\"d\"])(\"design:type\",Function),Object(h[\"d\"])(\"design:paramtypes\",[\"function\"===typeof(f=\"undefined\"!==typeof u[\"GroupBuy\"]&&u[\"GroupBuy\"])?f:Object,String]),Object(h[\"d\"])(\"design:returntype\",void 0)],S.prototype,\"getShopListTree\",null),S=Object(h[\"b\"])([Object(p[\"b\"])(),Object(h[\"d\"])(\"design:paramtypes\",[\"function\"===typeof(g=\"undefined\"!==typeof u[\"c\"]&&u[\"c\"])?g:Object])],S);var k=n(\"89fa\"),v={serviceInject:function(){return{selectService:S}},rxState:function(){return{loading:this.selectService.loading$}},data:function(){return{show:!1,treeData:[],checkedKeys:[],shopIds:[]}},props:{checked:{type:Array,default:function(){return[]}},groupParams:{type:Object,default:function(){return{}}},type:{type:String,default:\"\"}},computed:{checedNum:function(){return this.shopIds.length}},mounted:function(){var t=this;this.selectService.getShopListTree(this.groupParams,this.type).subscribe((function(e){t.treeData=Object(k[\"a\"])(e.list),t.initCheckedKeys()}))},methods:{initCheckedKeys:function(){var t=this.checked;this.shopIds=t,this.checkedKeys=t.map((function(t){return JSON.stringify({isLeaf:!0,key:t})}))},onCheck:function(t){this.checkedKeys=t;this.filterShopIds(t)},filterShopIds:function(t){var e=[];return t.forEach((function(t){t=JSON.parse(t),t.isLeaf&&e.push(t.key)})),this.shopIds=e,e},confirm:function(){this.show=!1,this.$emit(\"change\",this.shopIds)}}},O=v,j=n(\"2877\"),_=Object(j[\"a\"])(O,y,b,!1,null,null,null),I=_.exports,w={name:\"SelectShop\",modals:{ShopSelect:I},serviceInject:function(){return{selectService:l}},rxState:function(){return{loading:this.selectService.loading$}},props:{shopIds:{type:Array,default:function(){return[]}},disabled:{type:Boolean,default:!1},groupParams:{type:Object,default:function(){return{}}},type:{type:String,default:\"\"}},data:function(){return{checkedShopIds:[],list:[],group:this.groupParams}},mounted:function(){this.checkedShopIds=this.shopIds,this.getShops(this.shopIds)},computed:{colspanNum:function(){return this.disabled?4:5}},methods:{onSelectShopComplete:function(t){this.getShops(t),this.checkedShopIds=t,this.$emit(\"change\",t)},getShops:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e.length&&this.selectService.getShopBasic({shop_ids:e}).subscribe((function(e){t.list=e.shops}))},delShopTableRecord:function(t){var e=this.list,n=this.checkedShopIds;e.forEach((function(n,i){n.shop_id===t&&e.splice(i,1)})),n.forEach((function(e,i){e===+t&&n.splice(i,1)})),this.list=e,this.checkedShopIds=n,this.$emit(\"change\",n)},clearShopList:function(){this.list=[],this.checkedShopIds=[],this.$emit(\"change\",this.checkedShopIds)}}},L=w,$=Object(j[\"a\"])(L,c,o,!1,null,null,null);e[\"a\"]=$.exports}}]);","extractedComments":[]}