{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js!/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhigang/Desktop/styd/web/src/views/pages/brand/product/package/list.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/pages/brand/product/package/list.vue","mtime":1601345845257},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js","mtime":1591062572376}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { ListService } from \"./list.service\";\nimport tableMixin from '@/mixins/table.mixin';\nimport { columns } from \"./list.config\";\nimport { ruleOptions } from \"./list.config\";\nimport ShopList from '@/views/biz-modals/package/shop-list';\nimport Synchronize from '@/views/biz-modals/package/synchronize';\nimport SuccessTip from '@/views/biz-modals/package/success-tip';\nimport SoldCoursePackageUpdateRights from '@/views/biz-modals/sold/course/package/update-rights';\nimport userPackageActions from '@/hooks/package/package-actions.hook';\nexport default {\n  name: 'BrandPackageList',\n  mixins: [tableMixin],\n  serviceInject: function serviceInject() {\n    return {\n      listService: ListService\n    };\n  },\n  modals: {\n    ShopList: ShopList,\n    Synchronize: Synchronize,\n    SuccessTip: SuccessTip,\n    SoldCoursePackageUpdateRights: SoldCoursePackageUpdateRights\n  },\n  hooks: function hooks() {\n    return {\n      userPackageActions: userPackageActions(this)\n    };\n  },\n  rxState: function rxState() {\n    var _this$listService = this.listService,\n        list$ = _this$listService.list$,\n        page$ = _this$listService.page$,\n        loading$ = _this$listService.loading$,\n        auth$ = _this$listService.auth$,\n        packageType$ = _this$listService.packageType$,\n        publicChannel$ = _this$listService.publicChannel$,\n        supportNum$ = _this$listService.supportNum$;\n    return {\n      list$: list$,\n      page$: page$,\n      loading$: loading$,\n      auth$: auth$,\n      packageType$: packageType$,\n      publicChannel$: publicChannel$,\n      supportNum$: supportNum$\n    };\n  },\n  bem: {\n    b: 'page-brand-package-list'\n  },\n  data: function data() {\n    return {\n      FIXATION: 3,\n      UNLIMIT: 1,\n      RANGE: 2,\n      pageType: 'brand'\n    };\n  },\n  computed: {\n    columns: columns\n  },\n  methods: {\n    addPackage: function addPackage() {\n      this.$router.push({\n        name: 'brand-product-package-add'\n      });\n    },\n    getShopList: function getShopList(id) {\n      this.$modalRouter.push({\n        name: 'shop-list',\n        props: {\n          id: id\n        }\n      });\n    },\n    onUpShelf: function onUpShelf(id, channel) {\n      this.userPackageActions.onUpShelf({\n        id: id,\n        channel: channel,\n        pageType: this.pageType\n      });\n    },\n    onDownShelf: function onDownShelf(id) {\n      this.userPackageActions.onDownShelf({\n        id: id,\n        pageType: this.pageType\n      });\n    },\n    batchOperate: function batchOperate(id) {\n      var _this = this;\n\n      this.$modalRouter.push({\n        name: 'Synchronize',\n        on: {\n          success: function success() {\n            _this.$confirm({\n              title: '提示',\n              content: \"\\u8BF7\\u518D\\u6B21\\u786E\\u8BA4\\u662F\\u5426\\u540C\\u6B65\\uFF0C\\u540C\\u6B65\\u540E\\u4F1A\\u8986\\u76D6\\u552E\\u51FA\\u8BFE\\u7A0B\\u5305\\uFF0C\\u5C06\\u4F1A\\u67092\\uFF5E5s\\u65E0\\u6CD5\\u6B63\\u5E38\\u4F7F\\u7528\",\n              onOk: function onOk() {\n                _this.listService.setSyncSold(id).subscribe(function (res) {\n                  _this.$modalRouter.push({\n                    name: 'success-tip'\n                  });\n\n                  _this.$router.reload();\n                });\n              },\n              onCancel: function onCancel() {}\n            });\n          }\n        }\n      });\n    },\n    deletePackage: function deletePackage(id, name) {\n      var _this2 = this;\n\n      this.userPackageActions.deletePackage(id, name, this.listService.deletePackage.bind(this.listService)).then(function (res) {\n        _this2.$router.reload();\n      });\n    },\n    onEdit: function onEdit(id) {\n      this.userPackageActions.onEdit({\n        pageType: this.pageType,\n        id: id\n      });\n    },\n    onDetail: function onDetail(id, packageType) {\n      this.$router.push({\n        name: 'brand-product-package-info',\n        query: {\n          id: id,\n          packageType: packageType\n        }\n      });\n    }\n  }\n};",{"version":3,"sources":["list.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <st-panel app :class=\"b()\">\n    <div slot=\"title\">\n      <st-input-search\n        @search=\"onSingleSearch('course_name', $event, true)\"\n        v-model=\"$searchQuery.course_name\"\n        placeholder=\"课程包名称\"\n      />\n    </div>\n    <div :class=\"b('operation')\">\n      <st-button\n        type=\"primary\"\n        @click=\"addPackage\"\n        :disabled=\"!auth$.add\"\n        icon=\"add\"\n      >\n        新增课程包\n      </st-button>\n      <div :class=\"b('select-group')\">\n        <a-select\n          v-model=\"$searchQuery.support_num\"\n          @change=\"onSingleSearch('support_num', $event)\"\n          :class=\"b('select')\"\n          class=\"mg-r16\"\n          style=\"width: 160px\"\n          :options=\"supportNum$\"\n        />\n        <a-select\n          v-model=\"$searchQuery.package_type\"\n          @change=\"onSingleSearch('package_type', $event)\"\n          :class=\"b('select')\"\n          style=\"width: 160px\"\n          :options=\"packageType$\"\n        />\n        <a-select\n          v-model=\"$searchQuery.publish_channel\"\n          @change=\"onSingleSearch('publish_channel', $event)\"\n          :class=\"b('select')\"\n          class=\"mg-l16\"\n          style=\"width: 160px\"\n          :options=\"publicChannel$\"\n        />\n      </div>\n    </div>\n    <st-table\n      class=\"mg-t16\"\n      :page=\"page$\"\n      :columns=\"columns\"\n      @change=\"onTableChange\"\n      rowKey=\"package_course_id\"\n      :dataSource=\"list$\"\n      :loading=\"loading$.getList\"\n    >\n      <template slot=\"package_type\" slot-scope=\"text\">\n        {{ text | enumFilter('package_course.package_type') }}\n      </template>\n      <template slot=\"valid_time\" slot-scope=\"text, record\">\n        <span class=\"white-nowrap\">\n          {{ text }}\n          {{\n            record.valid_time_unit\n              | enumFilter('package_course.valid_time_unit')\n          }}\n        </span>\n      </template>\n      <template slot=\"is_limit\" slot-scope=\"text\">\n        <span>{{ text | enumFilter('package_course.is_limit') }}</span>\n      </template>\n      <template slot=\"sale_shop_num\" slot-scope=\"text, record\">\n        <a @click=\"getShopList(record.package_course_id)\">\n          {{ `${record.up_shop_num} / ${text}` }}\n        </a>\n      </template>\n\n      <div slot=\"action\" slot-scope=\"text, record\">\n        <st-table-actions>\n          <a\n            v-if=\"record.auth['brand:product:package_course|edit']\"\n            @click=\"onEdit(record.package_course_id)\"\n          >\n            编辑\n          </a>\n          <a\n            v-if=\"record.auth['brand:product:package_course|get']\"\n            @click=\"onDetail(record.package_course_id, record.package_type)\"\n          >\n            详情\n          </a>\n          <a\n            v-if=\"record.auth['brand:product:package_course|up']\"\n            @click=\"\n              onUpShelf(\n                record.package_course_id,\n                record.publish_channel,\n                record.is_permanent_sale\n              )\n            \"\n          >\n            上架\n          </a>\n          <a\n            v-if=\"record.auth['brand:product:package_course|down']\"\n            @click=\"onDownShelf(record.package_course_id, record.course_name)\"\n          >\n            下架\n          </a>\n          <a\n            v-if=\"record.auth['brand:product:package_course|batch_operate']\"\n            @click=\"batchOperate(record.package_course_id, record.course_name)\"\n          >\n            应用至售出\n          </a>\n          <a\n            v-if=\"record.auth['brand:product:package_course|del']\"\n            @click=\"deletePackage(record.package_course_id, record.course_name)\"\n          >\n            删除\n          </a>\n          <a\n            v-if=\"record.auth['brand:product:package_course|sync_rights']\"\n            v-modal-link=\"{\n              name: 'sold-course-package-update-rights',\n              props: {\n                id: record.package_course_id,\n                isSync: true,\n                isShowLink: true,\n                isBrandTaskLink: true\n              }\n            }\"\n          >\n            修改售出权益\n          </a>\n        </st-table-actions>\n      </div>\n    </st-table>\n  </st-panel>\n</template>\n<script>\nimport { ListService } from './list.service'\nimport tableMixin from '@/mixins/table.mixin'\nimport { columns } from './list.config'\nimport { ruleOptions } from './list.config'\nimport ShopList from '@/views/biz-modals/package/shop-list'\nimport Synchronize from '@/views/biz-modals/package/synchronize'\nimport SuccessTip from '@/views/biz-modals/package/success-tip'\nimport SoldCoursePackageUpdateRights from '@/views/biz-modals/sold/course/package/update-rights'\nimport userPackageActions from '@/hooks/package/package-actions.hook'\nexport default {\n  name: 'BrandPackageList',\n  mixins: [tableMixin],\n  serviceInject() {\n    return {\n      listService: ListService\n    }\n  },\n  modals: {\n    ShopList,\n    Synchronize,\n    SuccessTip,\n    SoldCoursePackageUpdateRights\n  },\n  hooks() {\n    return {\n      userPackageActions: userPackageActions(this)\n    }\n  },\n  rxState() {\n    const {\n      list$,\n      page$,\n      loading$,\n      auth$,\n      packageType$,\n      publicChannel$,\n      supportNum$\n    } = this.listService\n    return {\n      list$,\n      page$,\n      loading$,\n      auth$,\n      packageType$,\n      publicChannel$,\n      supportNum$\n    }\n  },\n  bem: {\n    b: 'page-brand-package-list'\n  },\n  data() {\n    return {\n      FIXATION: 3,\n      UNLIMIT: 1,\n      RANGE: 2,\n      pageType: 'brand'\n    }\n  },\n  computed: {\n    columns\n  },\n  methods: {\n    addPackage() {\n      this.$router.push({ name: 'brand-product-package-add' })\n    },\n    getShopList(id) {\n      this.$modalRouter.push({\n        name: 'shop-list',\n        props: {\n          id\n        }\n      })\n    },\n    onUpShelf(id, channel) {\n      this.userPackageActions.onUpShelf({\n        id,\n        channel,\n        pageType: this.pageType\n      })\n    },\n    onDownShelf(id) {\n      this.userPackageActions.onDownShelf({ id, pageType: this.pageType })\n    },\n    batchOperate(id) {\n      this.$modalRouter.push({\n        name: 'Synchronize',\n        on: {\n          success: () => {\n            this.$confirm({\n              title: '提示',\n              content: `请再次确认是否同步，同步后会覆盖售出课程包，将会有2～5s无法正常使用`,\n              onOk: () => {\n                this.listService.setSyncSold(id).subscribe(res => {\n                  this.$modalRouter.push({\n                    name: 'success-tip'\n                  })\n                  this.$router.reload()\n                })\n              },\n              onCancel() {}\n            })\n          }\n        }\n      })\n    },\n    deletePackage(id, name) {\n      this.userPackageActions\n        .deletePackage(\n          id,\n          name,\n          this.listService.deletePackage.bind(this.listService)\n        )\n        .then(res => {\n          this.$router.reload()\n        })\n    },\n    onEdit(id) {\n      this.userPackageActions.onEdit({ pageType: this.pageType, id })\n    },\n    onDetail(id, packageType) {\n      this.$router.push({\n        name: 'brand-product-package-info',\n        query: {\n          id,\n          packageType\n        }\n      })\n    }\n  }\n}\n</script>\n"],"sourceRoot":"src/views/pages/brand/product/package"}]}