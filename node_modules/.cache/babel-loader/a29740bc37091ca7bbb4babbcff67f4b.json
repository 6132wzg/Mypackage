{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js!/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhigang/Desktop/styd/web/src/views/biz-modals/shop/app/venue/setting.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/biz-modals/shop/app/venue/setting.vue","mtime":1600926555913},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js","mtime":1591062572376}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es6.number.constructor\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { SettingService } from \"./setting.service\";\nimport { MessageService } from '@/services/message.service';\nimport { CYCLIC_TYPE, WEEK_MAP } from '@/constants/venue';\nexport default {\n  serviceInject: function serviceInject() {\n    return {\n      settingService: SettingService,\n      messageService: MessageService\n    };\n  },\n  rxState: function rxState() {\n    return {\n      list: this.settingService.list$,\n      auth: this.settingService.auth$\n    };\n  },\n  name: 'newLable',\n  props: {\n    siteId: {\n      type: Number,\n      default: function _default() {\n        return '';\n      }\n    },\n    venuesId: {\n      type: Number,\n      default: function _default() {\n        return '';\n      }\n    }\n  },\n  data: function data() {\n    return {\n      show: false,\n      CYCLIC_TYPE: CYCLIC_TYPE\n    };\n  },\n  filters: {\n    cycleFilter: function cycleFilter(val) {\n      return '每' + val.map(function (item) {\n        return WEEK_MAP[item];\n      }).join('、');\n    }\n  },\n  mounted: function mounted() {\n    this.getList();\n  },\n  methods: {\n    getList: function getList() {\n      this.settingService.getList({\n        site_id: this.siteId\n      }).subscribe();\n    },\n    delSetting: function delSetting(item) {\n      var _this = this;\n\n      var data = {\n        settings_id: item.settings_id\n      };\n      this.settingService.deleteSetting(data).subscribe(function () {\n        _this.getList();\n      });\n    },\n    order: function order(item) {\n      var _this2 = this;\n\n      var data = {\n        site_id: this.siteId,\n        settings_id: item.settings_id\n      };\n      this.settingService.orderSetting(data).subscribe(function () {\n        _this2.getList();\n      });\n    },\n    addRow: function addRow() {\n      this.show = false;\n      this.$router.push({\n        name: 'shop-app-venue-setting-add',\n        query: {\n          venues_id: this.venuesId\n        }\n      });\n    },\n    editRow: function editRow(item) {\n      this.show = false;\n      this.$router.push({\n        name: 'shop-app-venue-setting-edit',\n        query: {\n          settings_id: item.settings_id\n        }\n      });\n    },\n    save: function save(e) {\n      var _this3 = this;\n\n      var verify = true;\n      e.preventDefault();\n      var sites = this.sites.map(function (item) {\n        item.name === '' && (verify = false);\n        return item.name;\n      });\n\n      if (!verify) {\n        this.messageService.warn({\n          content: '场地名称不能为空'\n        });\n        return;\n      }\n\n      var data = {\n        venues_id: this.venuesId,\n        sites: this.sites.map(function (item) {\n          return item.name;\n        })\n      };\n      this.settingService.addSites(data).subscribe(function (state) {\n        _this3.messageService.success({\n          content: '新增成功'\n        });\n\n        _this3.show = false;\n\n        _this3.$emit('success', true);\n      });\n    }\n  }\n};",{"version":3,"sources":["setting.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <st-modal\n    title=\"高级设置\"\n    v-model=\"show\"\n    width=\"928px\"\n    :footer=\"null\"\n    wrapClassName=\"st-modal-shop-app-venue-setting\"\n  >\n    <div class=\"border-box\">\n      <st-form-table hoverable :isEmpty=\"false\">\n        <thead>\n          <tr>\n            <th>优先级</th>\n            <th>生效日期</th>\n            <th>循环日期</th>\n            <th>时间段</th>\n            <th>状态</th>\n            <th class=\"ta-r\">价格(元)</th>\n            <th style=\"width: 160px\">操作</th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr v-if=\"list.length < 10 && auth.add\">\n            <td colspan=\"7\" class=\"st-form-table__add\">\n              <st-button type=\"dashed\" icon=\"add\" block @click=\"addRow\">\n                新增\n              </st-button>\n            </td>\n          </tr>\n\n          <template v-for=\"(item, index) in list\">\n            <tr :key=\"index\">\n              <td>\n                {{ item.weight }}\n              </td>\n              <td>\n                {{ item.time_limit }}\n              </td>\n              <td>\n                <span v-if=\"item.cyclic_type === CYCLIC_TYPE.EVERYDAY\">\n                  每天\n                </span>\n                <span v-if=\"item.cyclic_type === CYCLIC_TYPE.CUSTOM\">\n                  {{ item.week_day | cycleFilter }}\n                </span>\n              </td>\n              <td>\n                {{ item.open_time }}\n              </td>\n              <td>\n                {{\n                  item.can_reserve | enumFilter('venues_reserve.can_reserve')\n                }}\n              </td>\n              <td class=\"ta-r\">\n                {{ item.price }}\n              </td>\n              <td>\n                <template>\n                  <a @click=\"editRow(item)\" v-if=\"auth.edit\">编辑</a>\n                  <a-divider type=\"vertical\"></a-divider>\n                  <a v-if=\"auth.del\">\n                    <st-popconfirm\n                      :title=\"'一旦删除则无法恢复，确认删除？'\"\n                      @confirm=\"delSetting(item)\"\n                    >\n                      删除\n                    </st-popconfirm>\n                  </a>\n                  <a-divider type=\"vertical\"></a-divider>\n                  <a v-if=\"item.weight !== 10 && auth.top\" @click=\"order(item)\">\n                    置顶\n                  </a>\n                </template>\n              </td>\n            </tr>\n          </template>\n        </tbody>\n      </st-form-table>\n    </div>\n    <p class=\"tips\">\n      当多条高级设置时间有冲突，执行优先级高的设置内容。数字越大，优先级越高。\n    </p>\n  </st-modal>\n</template>\n<script>\nimport { SettingService } from './setting.service'\nimport { MessageService } from '@/services/message.service'\nimport { CYCLIC_TYPE, WEEK_MAP } from '@/constants/venue'\n\nexport default {\n  serviceInject() {\n    return {\n      settingService: SettingService,\n      messageService: MessageService\n    }\n  },\n  rxState() {\n    return {\n      list: this.settingService.list$,\n      auth: this.settingService.auth$\n    }\n  },\n  name: 'newLable',\n  props: {\n    siteId: {\n      type: Number,\n      default() {\n        return ''\n      }\n    },\n    venuesId: {\n      type: Number,\n      default() {\n        return ''\n      }\n    }\n  },\n  data() {\n    return {\n      show: false,\n      CYCLIC_TYPE\n    }\n  },\n  filters: {\n    cycleFilter(val) {\n      return '每' + val.map(item => WEEK_MAP[item]).join('、')\n    }\n  },\n  mounted() {\n    this.getList()\n  },\n  methods: {\n    getList() {\n      this.settingService.getList({ site_id: this.siteId }).subscribe()\n    },\n    delSetting(item) {\n      const data = {\n        settings_id: item.settings_id\n      }\n      this.settingService.deleteSetting(data).subscribe(() => {\n        this.getList()\n      })\n    },\n    order(item) {\n      const data = {\n        site_id: this.siteId,\n        settings_id: item.settings_id\n      }\n      this.settingService.orderSetting(data).subscribe(() => {\n        this.getList()\n      })\n    },\n    addRow() {\n      this.show = false\n      this.$router.push({\n        name: 'shop-app-venue-setting-add',\n        query: { venues_id: this.venuesId }\n      })\n    },\n    editRow(item) {\n      this.show = false\n      this.$router.push({\n        name: 'shop-app-venue-setting-edit',\n        query: { settings_id: item.settings_id }\n      })\n    },\n    save(e) {\n      let verify = true\n      e.preventDefault()\n      const sites = this.sites.map(item => {\n        item.name === '' && (verify = false)\n        return item.name\n      })\n      if (!verify) {\n        this.messageService.warn({ content: '场地名称不能为空' })\n        return\n      }\n      let data = {\n        venues_id: this.venuesId,\n        sites: this.sites.map(item => item.name)\n      }\n      this.settingService.addSites(data).subscribe(state => {\n        this.messageService.success({ content: '新增成功' })\n        this.show = false\n        this.$emit('success', true)\n      })\n    }\n  }\n}\n</script>\n"],"sourceRoot":"src/views/biz-modals/shop/app/venue"}]}