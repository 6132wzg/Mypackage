{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhigang/Desktop/styd/web/src/views/pages/shop/store/data/data.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/pages/shop/store/data/data.vue","mtime":1591147717472},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js","mtime":1591062572376}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport pieImg from '@/assets/img/shop/dashboard/pie.png'\nimport inoutNumImg from '@/assets/img/shop/dashboard/inoutNum.png'\nimport moment from 'moment'\nimport ShopStoreDataLine from '@/views/biz-components/stat/shop-store-data-line'\nimport WholeTabs from './components#/whole-tabs'\nimport BuyConsumptionTables from './components#/buy-consumption-tables'\nimport DatePicker from './components#/date-picker'\nimport SalesAnalysis from './components#/sales-analysis'\nimport BuyNumber from './components#/buy-number'\nimport WholeOrderMember from './components#/whole-order-member'\nimport ShopStoreDataRevenueRing from '@/views/biz-components/stat/shop-store-data-revenue-ring'\nimport { DataService } from './data.service'\nimport {\n  headerInfo,\n  wholeNav,\n  headerTitleItem,\n  fieldNav,\n  fieldInfo\n} from './data.config.ts'\nexport default {\n  serviceInject() {\n    return {\n      dataService: DataService\n    }\n  },\n  rxState() {\n    return {\n      dataProfile: this.dataService.dataProfile$,\n      storeBoard: this.dataService.storeBoard$,\n      storeSaleList: this.dataService.storeSaleList$,\n      storeCategoryRank: this.dataService.storeCategoryRank$,\n      storeMemberAnalysis: this.dataService.storeMemberAnalysis$\n    }\n  },\n  bem: {\n    basic: 'shop-store-data',\n    salesCategory: 'sales-category',\n    headerContent: 'header-content'\n  },\n  data() {\n    return {\n      wholenavIndex: 0,\n      pieImg,\n      inoutNumImg,\n      wholeNavcom: 'shop-store-data-ring',\n      headerInfo,\n      wholeNav,\n      headerTitleItem,\n      fieldNav,\n      fieldInfo,\n      tabsObjData: {\n        choose_type: 1,\n        date_type: 1,\n        date: null\n      }\n    }\n  },\n  components: {\n    ShopStoreDataLine,\n    DatePicker,\n    WholeTabs,\n    BuyConsumptionTables,\n    SalesAnalysis,\n    BuyNumber,\n    ShopStoreDataRevenueRing,\n    WholeOrderMember\n  },\n  mounted() {\n    this.$nextTick(() => {\n      this.wholenavFilter()\n    })\n  },\n  methods: {\n    // 整体看板时间\n    wholeTimesFn(value) {\n      this.dataService.getStoreBoard(value).subscribe(res => {\n        this.wholenavFilter()\n      })\n    },\n    // 销售分析时间\n    saleTimesFn(value) {\n      this.dataService.getStoreSaleList(value).subscribe()\n    },\n    // 类目分析时间\n    categoryTimesFn(value) {\n      this.dataService.getStoreCategoryRank(value).subscribe()\n    },\n    // 购买次数/消费金额时间\n    userAnalysisTimesFn(value) {\n      this.tabsObjData.date_type = value.date_type\n      this.tabsObjData.date = value.date\n      this.dataService.getStoreMemberAnalysis(this.tabsObjData).subscribe()\n    },\n    // 整体看板订单/会员折线图\n    filterLine(data, type) {\n      if (!data[this.fieldNav[this.wholenavIndex]].trend.length) return []\n      return data[this.fieldNav[this.wholenavIndex]].trend.map(item => {\n        return {\n          date: item.date,\n          amount: Number(item[this.fieldInfo[this.wholenavIndex]])\n        }\n      })\n    },\n    // 整体看板数据处理\n    wholenavFilter() {\n      let data = this.storeBoard\n      this.wholeNav.forEach((item, index) => {\n        let dataInfo = data[this.fieldNav[index]][this.fieldInfo[index]]\n        this.$set(item, 'num', dataInfo)\n        item.unit = data[this.fieldNav[index]].unit\n      })\n    },\n    onChangeTabs(query) {\n      this.tabsObjData = Object.assign(this.tabsObjData, { choose_type: query })\n      this.tabsObjData.date = this.tabsObjData.date\n        ? this.tabsObjData.date\n        : moment()\n            .subtract(1, 'days')\n            .format('YYYY-MM-DD') + ''\n      this.dataService.getStoreMemberAnalysis(this.tabsObjData).subscribe()\n    },\n    refresh() {\n      return this.dataService.getDataProfile(this.chartTodayShop)\n    },\n    wholenavFun(index, item) {\n      this.wholenavIndex = index\n      if (index > 1) {\n        this.wholeNavcom = 'brand-user-avg-bar'\n      } else {\n        this.wholeNavcom = 'shop-store-data-ring'\n      }\n    }\n  }\n}\n",{"version":3,"sources":["data.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"data.vue","sourceRoot":"src/views/pages/shop/store/data","sourcesContent":["<template>\n  <div :class=\"basic()\">\n    <st-panel-layout :class=\"basic('main')\">\n      <!-- 云店概览 -->\n      <st-panel class=\"mg-t16\" title=\"云店概览\">\n        <div slot=\"actions\">\n          <st-refresh-btn :action=\"refresh\"></st-refresh-btn>\n        </div>\n        <ul :class=\"headerContent()\">\n          <li\n            v-for=\"(item, index) in headerInfo\"\n            :key=\"index\"\n            :class=\"headerContent('item')\"\n          >\n            <img :src=\"item.icon\" :class=\"headerContent('item-icon')\" />\n            <div>\n              <div :class=\"headerContent('item-title')\">\n                {{ item.title }}\n              </div>\n              <div :class=\"headerContent('day-money')\">\n                <span class=\"font-number\">\n                  {{ dataProfile.today[headerTitleItem[index]] }}\n                </span>\n              </div>\n              <div :class=\"headerContent('yesterday-money')\">\n                昨日:\n                <span class=\"font-number\">\n                  {{ dataProfile.yesterday[headerTitleItem[index]] }}\n                </span>\n              </div>\n            </div>\n          </li>\n        </ul>\n      </st-panel>\n      <!-- 整体看板 -->\n      <section>\n        <st-panel class=\"mg-t16\" title=\"整体看板\">\n          <div slot=\"actions\">\n            <date-picker @onChange=\"wholeTimesFn\"></date-picker>\n          </div>\n          <div :class=\"basic('whole')\">\n            <div\n              :class=\"[\n                basic('whole-item'),\n                wholenavIndex === index ? basic('whole-item-active') : ''\n              ]\"\n              v-for=\"(item, index) in wholeNav\"\n              :key=\"index\"\n              @click=\"wholenavFun(index, item)\"\n            >\n              <div :class=\"basic('whole-item-title')\">\n                {{ item.title }}\n                <img :class=\"basic('whole-item-icon')\" :src=\"item.icon\" />\n              </div>\n              <div :class=\"basic('whole-item-text')\">\n                <span class=\"font-number\">{{ item.num }}</span>\n              </div>\n            </div>\n          </div>\n          <div :class=\"basic('revenue-trend')\">\n            <a-row>\n              <a-col :span=\"16\">\n                <div>\n                  <st-t3>\n                    {{ wholeNav[wholenavIndex].title }}\n                  </st-t3>\n                  <shop-store-data-line\n                    v-if=\"\n                      filterLine(storeBoard, wholeNav[wholenavIndex].title)\n                        .length\n                    \"\n                    :data=\"\n                      filterLine(storeBoard, wholeNav[wholenavIndex].title)\n                    \"\n                    :tooltipKey=\"wholeNav[wholenavIndex].title\"\n                    :unit=\"wholeNav[wholenavIndex].unit\"\n                  ></shop-store-data-line>\n                  <div v-else :class=\"basic('entry-store-img')\">\n                    <img\n                      :src=\"inoutNumImg\"\n                      :class=\"basic('entry-store-img-line')\"\n                    />\n                  </div>\n                </div>\n              </a-col>\n              <a-col :span=\"8\">\n                <div class=\"ring\">\n                  <whole-tabs>\n                    <template v-slot:user>\n                      <whole-order-member\n                        :storeBoard=\"storeBoard\"\n                        :wholeNav=\"wholeNav\"\n                        :wholeNavcom=\"wholeNavcom\"\n                        orderMemberFlag=\"order\"\n                        :wholenavIndex=\"wholenavIndex\"\n                        :fieldNav=\"fieldNav\"\n                      ></whole-order-member>\n                    </template>\n                    <template v-slot:marketing>\n                      <whole-order-member\n                        :storeBoard=\"storeBoard\"\n                        :wholeNav=\"wholeNav\"\n                        :wholeNavcom=\"wholeNavcom\"\n                        orderMemberFlag=\"member\"\n                        :wholenavIndex=\"wholenavIndex\"\n                        :fieldNav=\"fieldNav\"\n                        :colors=\"['#4679F9', '#894BFF', '#009DFF']\"\n                      ></whole-order-member>\n                    </template>\n                  </whole-tabs>\n                </div>\n              </a-col>\n            </a-row>\n          </div>\n        </st-panel>\n        <!-- 销售分析 类目分析-->\n        <div :class=\"salesCategory()\">\n          <div :class=\"salesCategory('sales-box')\">\n            <a-row>\n              <a-col :span=\"16\" :class=\"salesCategory('sales-box__left')\">\n                <st-container class=\"bg-white\" type=\"2\">\n                  <st-t3>销售分析</st-t3>\n                  <date-picker @onChange=\"saleTimesFn\"></date-picker>\n                </st-container>\n                <div :class=\"salesCategory('sales-top')\">\n                  <a-col :span=\"12\">\n                    <div>\n                      <sales-analysis\n                        title=\"销量TOP5\"\n                        :salesTitle=\"['排名', '商品', '销量(件)']\"\n                        nameLength=\"6\"\n                        :salesList=\"storeSaleList.sales_rank\"\n                      ></sales-analysis>\n                    </div>\n                  </a-col>\n                  <a-col :span=\"12\" class=\"hr\">\n                    <div>\n                      <sales-analysis\n                        title=\"营收TOP5\"\n                        :salesTitle=\"['排名', '商品', '营收(元)']\"\n                        nameLength=\"6\"\n                        :salesList=\"storeSaleList.revenue_rank\"\n                      ></sales-analysis>\n                    </div>\n                  </a-col>\n                </div>\n              </a-col>\n              <a-col :span=\"8\">\n                <div :class=\"salesCategory('category-box')\">\n                  <st-container class=\"bg-white\" type=\"2\">\n                    <st-t3>类目分析</st-t3>\n                    <date-picker\n                      @onChange=\"categoryTimesFn\"\n                      class=\"date-picker\"\n                    ></date-picker>\n                  </st-container>\n                  <div class=\"category\">\n                    <st-t3>类目营收占比</st-t3>\n                    <shop-store-data-revenue-ring\n                      :data=\"storeCategoryRank.category_list\"\n                      :total=\"Number(storeCategoryRank.total_revenue)\"\n                      style=\"width: 100%;\"\n                      v-if=\"storeCategoryRank.category_list.length\"\n                    ></shop-store-data-revenue-ring>\n                    <div :class=\"basic('entry-pie-img')\" v-else>\n                      <img :src=\"pieImg\" />\n                    </div>\n                  </div>\n                </div>\n              </a-col>\n            </a-row>\n          </div>\n        </div>\n        <!-- 购买次数 消费金额 -->\n        <div class=\"buy-consumption\">\n          <buy-consumption-tables\n            @change=\"onChangeTabs\"\n            @onChange=\"userAnalysisTimesFn\"\n          >\n            <template v-slot:user>\n              <buy-number :data=\"storeMemberAnalysis\"></buy-number>\n            </template>\n            <template v-slot:marketing>\n              <buy-number\n                :flag=\"false\"\n                :data=\"storeMemberAnalysis\"\n              ></buy-number>\n            </template>\n          </buy-consumption-tables>\n        </div>\n      </section>\n    </st-panel-layout>\n  </div>\n</template>\n<script>\nimport pieImg from '@/assets/img/shop/dashboard/pie.png'\nimport inoutNumImg from '@/assets/img/shop/dashboard/inoutNum.png'\nimport moment from 'moment'\nimport ShopStoreDataLine from '@/views/biz-components/stat/shop-store-data-line'\nimport WholeTabs from './components#/whole-tabs'\nimport BuyConsumptionTables from './components#/buy-consumption-tables'\nimport DatePicker from './components#/date-picker'\nimport SalesAnalysis from './components#/sales-analysis'\nimport BuyNumber from './components#/buy-number'\nimport WholeOrderMember from './components#/whole-order-member'\nimport ShopStoreDataRevenueRing from '@/views/biz-components/stat/shop-store-data-revenue-ring'\nimport { DataService } from './data.service'\nimport {\n  headerInfo,\n  wholeNav,\n  headerTitleItem,\n  fieldNav,\n  fieldInfo\n} from './data.config.ts'\nexport default {\n  serviceInject() {\n    return {\n      dataService: DataService\n    }\n  },\n  rxState() {\n    return {\n      dataProfile: this.dataService.dataProfile$,\n      storeBoard: this.dataService.storeBoard$,\n      storeSaleList: this.dataService.storeSaleList$,\n      storeCategoryRank: this.dataService.storeCategoryRank$,\n      storeMemberAnalysis: this.dataService.storeMemberAnalysis$\n    }\n  },\n  bem: {\n    basic: 'shop-store-data',\n    salesCategory: 'sales-category',\n    headerContent: 'header-content'\n  },\n  data() {\n    return {\n      wholenavIndex: 0,\n      pieImg,\n      inoutNumImg,\n      wholeNavcom: 'shop-store-data-ring',\n      headerInfo,\n      wholeNav,\n      headerTitleItem,\n      fieldNav,\n      fieldInfo,\n      tabsObjData: {\n        choose_type: 1,\n        date_type: 1,\n        date: null\n      }\n    }\n  },\n  components: {\n    ShopStoreDataLine,\n    DatePicker,\n    WholeTabs,\n    BuyConsumptionTables,\n    SalesAnalysis,\n    BuyNumber,\n    ShopStoreDataRevenueRing,\n    WholeOrderMember\n  },\n  mounted() {\n    this.$nextTick(() => {\n      this.wholenavFilter()\n    })\n  },\n  methods: {\n    // 整体看板时间\n    wholeTimesFn(value) {\n      this.dataService.getStoreBoard(value).subscribe(res => {\n        this.wholenavFilter()\n      })\n    },\n    // 销售分析时间\n    saleTimesFn(value) {\n      this.dataService.getStoreSaleList(value).subscribe()\n    },\n    // 类目分析时间\n    categoryTimesFn(value) {\n      this.dataService.getStoreCategoryRank(value).subscribe()\n    },\n    // 购买次数/消费金额时间\n    userAnalysisTimesFn(value) {\n      this.tabsObjData.date_type = value.date_type\n      this.tabsObjData.date = value.date\n      this.dataService.getStoreMemberAnalysis(this.tabsObjData).subscribe()\n    },\n    // 整体看板订单/会员折线图\n    filterLine(data, type) {\n      if (!data[this.fieldNav[this.wholenavIndex]].trend.length) return []\n      return data[this.fieldNav[this.wholenavIndex]].trend.map(item => {\n        return {\n          date: item.date,\n          amount: Number(item[this.fieldInfo[this.wholenavIndex]])\n        }\n      })\n    },\n    // 整体看板数据处理\n    wholenavFilter() {\n      let data = this.storeBoard\n      this.wholeNav.forEach((item, index) => {\n        let dataInfo = data[this.fieldNav[index]][this.fieldInfo[index]]\n        this.$set(item, 'num', dataInfo)\n        item.unit = data[this.fieldNav[index]].unit\n      })\n    },\n    onChangeTabs(query) {\n      this.tabsObjData = Object.assign(this.tabsObjData, { choose_type: query })\n      this.tabsObjData.date = this.tabsObjData.date\n        ? this.tabsObjData.date\n        : moment()\n            .subtract(1, 'days')\n            .format('YYYY-MM-DD') + ''\n      this.dataService.getStoreMemberAnalysis(this.tabsObjData).subscribe()\n    },\n    refresh() {\n      return this.dataService.getDataProfile(this.chartTodayShop)\n    },\n    wholenavFun(index, item) {\n      this.wholenavIndex = index\n      if (index > 1) {\n        this.wholeNavcom = 'brand-user-avg-bar'\n      } else {\n        this.wholeNavcom = 'shop-store-data-ring'\n      }\n    }\n  }\n}\n</script>\n"]}]}