{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js!/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhigang/Desktop/styd/web/src/views/pages/shop/staff/info.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/pages/shop/staff/info.vue","mtime":1600926556511},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js","mtime":1591062572376}],"contextDependencies":[],"result":["import \"core-js/modules/es6.array.from\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.string.iterator\";\nimport \"core-js/modules/es6.set\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { InfoService } from \"./info.service\";\nimport ShopStaffBindCard from '@/views/biz-modals/shop-staff/bind-card';\nimport ShopStaffLeaveCurrentShop from '@/views/biz-modals/shop-staff/leave-current-shop';\nimport ShopStaffRePassword from '@/views/biz-modals/shop-staff/re-password';\nimport ShopStaffSalaryAccountSetting from '@/views/biz-modals/shop-staff/salary-account-setting';\nimport ShopStaffUpdateStaffPosition from '@/views/biz-modals/shop-staff/update-staff-position';\nimport StaffUpdateStaffPosition from '@/views/biz-modals/staff/update-staff-position';\nimport { forEach } from 'lodash-es';\nexport default {\n  modals: {\n    ShopStaffBindCard: ShopStaffBindCard,\n    ShopStaffLeaveCurrentShop: ShopStaffLeaveCurrentShop,\n    ShopStaffRePassword: ShopStaffRePassword,\n    ShopStaffSalaryAccountSetting: ShopStaffSalaryAccountSetting,\n    ShopStaffUpdateStaffPosition: ShopStaffUpdateStaffPosition,\n    StaffUpdateStaffPosition: StaffUpdateStaffPosition\n  },\n  serviceInject: function serviceInject() {\n    return {\n      infoService: InfoService\n    };\n  },\n  rxState: function rxState() {\n    return {\n      info: this.infoService.info$,\n      auth: this.infoService.auth$\n    };\n  },\n  data: function data() {\n    return {\n      basic: {\n        label: '员工资料',\n        route: {\n          name: 'shop-staff-info-basic',\n          query: {\n            id: this.$searchQuery.id\n          }\n        }\n      },\n      course: {\n        label: '上课记录',\n        route: {\n          name: 'shop-staff-info-course',\n          query: {\n            id: this.$searchQuery.id\n          }\n        }\n      },\n      follow: {\n        label: '跟进记录',\n        route: {\n          name: 'shop-staff-info-follow',\n          query: {\n            id: this.$searchQuery.id\n          }\n        }\n      },\n      sold: {\n        label: '售卖订单',\n        route: {\n          name: 'shop-staff-info-sold',\n          query: {\n            id: this.$searchQuery.id\n          }\n        }\n      },\n      member: {\n        label: '服务课程',\n        route: {\n          name: 'shop-staff-info-member',\n          query: {\n            id: this.$searchQuery.id\n          }\n        }\n      },\n      tabList: []\n    };\n  },\n  computed: {\n    image_avatar_url: function image_avatar_url() {\n      return this.info && this.info.image_avatar && this.info.image_avatar.image_url || '';\n    },\n    btnOptions: function btnOptions() {\n      return [{\n        text: '编辑资料',\n        click: this.editStaffInfo,\n        if: this.auth['shop:staff:staff|edit']\n      }, {\n        text: '绑定实体卡',\n        click: this.openModalBindCard,\n        if: this.auth['shop:staff:staff|bind_card']\n      }, {\n        text: '重绑实体卡',\n        click: this.openModalRebindCard,\n        if: this.auth['shop:staff:staff|rebind_card']\n      }, {\n        text: '职位和薪资变更',\n        click: this.openModalPosition,\n        if: this.auth['shop:staff:staff|position']\n      }, {\n        text: '离职',\n        click: this.openModalLeave,\n        if: this.auth['shop:staff:staff|leave']\n      }, {\n        text: '复职',\n        click: this.openModalReinstate,\n        if: this.auth['shop:staff:staff|reinstate']\n      }, {\n        text: '管理登录账户',\n        click: this.openModalSave,\n        if: this.auth['shop:staff:account|save']\n      }, {\n        text: '设置提现账户',\n        click: this.openModalSalary,\n        if: this.auth['shop:staff:staff|salary']\n      }, {\n        text: '解除门店关系',\n        click: this.openModalShopLeave,\n        if: this.auth['shop:staff:staff|shop_leave']\n      }, {\n        text: '清空指纹信息',\n        click: this.onClearFingerprintInfo,\n        if: this.auth['shop:staff:staff|finger_del']\n      }, {\n        text: '清空硬件密码',\n        click: this.onClearHardwarePassword,\n        if: this.auth['shop:staff:staff|cabinet_pwd_del']\n      }];\n    }\n  },\n  created: function created() {\n    var _this = this;\n\n    // 团课教练：上课记录\n    // 私教教练：上课记录、跟进记录、服务课程 、销售订单\n    // 会籍销售：跟进记录、服务课程 、销售订单\n    // 1,普通员工 2-会籍销售；3-团课教练；4-私人教练\n    var identity = this.info.identity;\n    identity = identity.map(function (item) {\n      return item.id;\n    });\n    var tabSet = new Set();\n    this.setIndentyList(['basic'], tabSet);\n\n    if (Array.isArray(identity) && identity.length) {\n      identity.forEach(function (ele) {\n        if (ele === 2) {\n          _this.setIndentyList(['member', 'sold'], tabSet);\n        } else if (ele === 3) {\n          _this.setIndentyList(['course'], tabSet);\n        } else if (ele === 4) {\n          _this.setIndentyList(['course', 'follow', 'member', 'sold'], tabSet);\n        }\n      });\n    }\n\n    this.tabList = Array.from(tabSet).map(function (key) {\n      return _this[key];\n    });\n  },\n  methods: {\n    setIndentyList: function setIndentyList(arr, targetArr) {\n      var _this2 = this;\n\n      arr.forEach(function (key) {\n        return targetArr.add(key, _this2[key]);\n      });\n    },\n    openModal: function openModal(modalType) {\n      var modalPathList = {\n        bind_card: 'shop-staff-bind-card',\n        rebind_card: 'shop-staff-bind-card',\n        leave: 'shop-staff-turnover',\n        reinstate: 'shop-staff-reinstatement',\n        save: 'shop-staff-re-password',\n        position: 'shop-staff-update-staff-position',\n        salary: 'shop-staff-salary-account-setting',\n        shop_leave: 'shop-staff-leave-current-shop'\n      };\n      var name = modalPathList[modalType];\n      this.$modalRouter.push({\n        name: name,\n        props: {\n          staff: this.info\n        }\n      });\n    },\n    openModalBindCard: function openModalBindCard() {\n      this.openModal('bind_card');\n    },\n    openModalRebindCard: function openModalRebindCard() {\n      this.openModal('rebind_card');\n    },\n    openModalLeave: function openModalLeave() {\n      this.openModal('leave');\n    },\n    openModalReinstate: function openModalReinstate() {\n      this.openModal('reinstate');\n    },\n    openModalSave: function openModalSave() {\n      this.openModal('save');\n    },\n    openModalPosition: function openModalPosition() {\n      this.openModal('position');\n    },\n    openModalSalary: function openModalSalary() {\n      this.openModal('salary');\n    },\n    openModalShopLeave: function openModalShopLeave() {\n      this.openModal('shop_leave');\n    },\n    editStaffInfo: function editStaffInfo() {\n      this.$router.push({\n        name: 'shop-staff-edit',\n        query: {\n          id: this.info.id\n        }\n      });\n    },\n    // 清空指纹信息\n    onClearFingerprintInfo: function onClearFingerprintInfo() {\n      var _this3 = this;\n\n      this.$confirm({\n        title: '提示信息',\n        content: '确认清空指纹信息？',\n        onOk: function onOk() {\n          _this3.infoService.deleteStaffFinger(_this3.info.id).subscribe();\n        }\n      });\n    },\n    // 清空硬件密码\n    onClearHardwarePassword: function onClearHardwarePassword() {\n      var _this4 = this;\n\n      this.$confirm({\n        title: '提示信息',\n        content: '确认清空硬件密码吗？',\n        onOk: function onOk() {\n          _this4.infoService.deleteStaffCabinetPassword(_this4.info.id).subscribe();\n        }\n      });\n    }\n  }\n};",{"version":3,"sources":["info.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <st-panel-layout class=\"pages-staffdata-container\">\n    <st-panel class=\"pages-staffdata-header\">\n      <a-row>\n        <a-col :span=\"15\" class=\"pages-staffdata-header-detail\">\n          <div class=\"staff-avatar-container st-preview-item\">\n            <img :src=\"image_avatar_url\" />\n            <div class=\"staff-avatar-tip\">\n              {{ info.work_status.name }}\n              <span v-if=\"info.nature_work.name\">\n                /{{ info.nature_work.name }}\n              </span>\n            </div>\n          </div>\n          <div class=\"staff-info-container\">\n            <div class=\"staff-info-name\">\n              {{ info.staff_name }}\n              <span v-if=\"info.nickname\">（{{ info.nickname }}）</span>\n              <st-icon\n                :type=\"info.sex === 1 ? 'female' : 'male'\"\n                :style=\"info.sex === 1 ? 'color:#FF5E41' : 'color:#3F66F6'\"\n              />\n            </div>\n            <div class=\"staff-info-cont\">\n              <span class=\"mg-r24\">手机号：{{ info.mobile }}</span>\n              <span class=\"mg-r24\" v-if=\"info.staff_num\">\n                工号：{{ info.staff_num }}\n              </span>\n              <span v-if=\"info.coach_level\">\n                {{ $c('coach') }}等级：{{ info.coach_level }}\n              </span>\n            </div>\n            <div class=\"staff-info-shops\">\n              <span class=\"mg-r24\">所在部门：{{ info.department }}</span>\n              <span>所在门店：{{ info.shop_num }}家门店</span>\n            </div>\n          </div>\n        </a-col>\n        <a-col\n          :span=\"9\"\n          style=\"text-align: right;\"\n          v-if=\"info.work_status.name === '在职'\"\n        >\n          <st-btn-actions :options=\"btnOptions\"></st-btn-actions>\n        </a-col>\n      </a-row>\n    </st-panel>\n    <st-panel app :tabs=\"tabList\">\n      <div slot=\"actions\"></div>\n      <router-view></router-view>\n    </st-panel>\n  </st-panel-layout>\n</template>\n<script>\nimport { InfoService } from './info.service'\nimport ShopStaffBindCard from '@/views/biz-modals/shop-staff/bind-card'\nimport ShopStaffLeaveCurrentShop from '@/views/biz-modals/shop-staff/leave-current-shop'\nimport ShopStaffRePassword from '@/views/biz-modals/shop-staff/re-password'\nimport ShopStaffSalaryAccountSetting from '@/views/biz-modals/shop-staff/salary-account-setting'\nimport ShopStaffUpdateStaffPosition from '@/views/biz-modals/shop-staff/update-staff-position'\nimport StaffUpdateStaffPosition from '@/views/biz-modals/staff/update-staff-position'\nimport { forEach } from 'lodash-es'\nexport default {\n  modals: {\n    ShopStaffBindCard,\n    ShopStaffLeaveCurrentShop,\n    ShopStaffRePassword,\n    ShopStaffSalaryAccountSetting,\n    ShopStaffUpdateStaffPosition,\n    StaffUpdateStaffPosition\n  },\n  serviceInject() {\n    return {\n      infoService: InfoService\n    }\n  },\n  rxState() {\n    return {\n      info: this.infoService.info$,\n      auth: this.infoService.auth$\n    }\n  },\n  data() {\n    return {\n      basic: {\n        label: '员工资料',\n        route: {\n          name: 'shop-staff-info-basic',\n          query: { id: this.$searchQuery.id }\n        }\n      },\n      course: {\n        label: '上课记录',\n        route: {\n          name: 'shop-staff-info-course',\n          query: { id: this.$searchQuery.id }\n        }\n      },\n      follow: {\n        label: '跟进记录',\n        route: {\n          name: 'shop-staff-info-follow',\n          query: { id: this.$searchQuery.id }\n        }\n      },\n      sold: {\n        label: '售卖订单',\n        route: {\n          name: 'shop-staff-info-sold',\n          query: { id: this.$searchQuery.id }\n        }\n      },\n      member: {\n        label: '服务课程',\n        route: {\n          name: 'shop-staff-info-member',\n          query: { id: this.$searchQuery.id }\n        }\n      },\n      tabList: []\n    }\n  },\n  computed: {\n    image_avatar_url() {\n      return (\n        (this.info &&\n          this.info.image_avatar &&\n          this.info.image_avatar.image_url) ||\n        ''\n      )\n    },\n    btnOptions() {\n      return [\n        {\n          text: '编辑资料',\n          click: this.editStaffInfo,\n          if: this.auth['shop:staff:staff|edit']\n        },\n        {\n          text: '绑定实体卡',\n          click: this.openModalBindCard,\n          if: this.auth['shop:staff:staff|bind_card']\n        },\n        {\n          text: '重绑实体卡',\n          click: this.openModalRebindCard,\n          if: this.auth['shop:staff:staff|rebind_card']\n        },\n        {\n          text: '职位和薪资变更',\n          click: this.openModalPosition,\n          if: this.auth['shop:staff:staff|position']\n        },\n        {\n          text: '离职',\n          click: this.openModalLeave,\n          if: this.auth['shop:staff:staff|leave']\n        },\n        {\n          text: '复职',\n          click: this.openModalReinstate,\n          if: this.auth['shop:staff:staff|reinstate']\n        },\n        {\n          text: '管理登录账户',\n          click: this.openModalSave,\n          if: this.auth['shop:staff:account|save']\n        },\n        {\n          text: '设置提现账户',\n          click: this.openModalSalary,\n          if: this.auth['shop:staff:staff|salary']\n        },\n        {\n          text: '解除门店关系',\n          click: this.openModalShopLeave,\n          if: this.auth['shop:staff:staff|shop_leave']\n        },\n        {\n          text: '清空指纹信息',\n          click: this.onClearFingerprintInfo,\n          if: this.auth['shop:staff:staff|finger_del']\n        },\n        {\n          text: '清空硬件密码',\n          click: this.onClearHardwarePassword,\n          if: this.auth['shop:staff:staff|cabinet_pwd_del']\n        }\n      ]\n    }\n  },\n  created() {\n    // 团课教练：上课记录\n    // 私教教练：上课记录、跟进记录、服务课程 、销售订单\n    // 会籍销售：跟进记录、服务课程 、销售订单\n    // 1,普通员工 2-会籍销售；3-团课教练；4-私人教练\n    let { identity } = this.info\n    identity = identity.map(item => item.id)\n    let tabSet = new Set()\n    this.setIndentyList(['basic'], tabSet)\n    if (Array.isArray(identity) && identity.length) {\n      identity.forEach(ele => {\n        if (ele === 2) {\n          this.setIndentyList(['member', 'sold'], tabSet)\n        } else if (ele === 3) {\n          this.setIndentyList(['course'], tabSet)\n        } else if (ele === 4) {\n          this.setIndentyList(['course', 'follow', 'member', 'sold'], tabSet)\n        }\n      })\n    }\n    this.tabList = Array.from(tabSet).map(key => this[key])\n  },\n  methods: {\n    setIndentyList(arr, targetArr) {\n      arr.forEach(key => targetArr.add(key, this[key]))\n    },\n    openModal(modalType) {\n      const modalPathList = {\n        bind_card: 'shop-staff-bind-card',\n        rebind_card: 'shop-staff-bind-card',\n        leave: 'shop-staff-turnover',\n        reinstate: 'shop-staff-reinstatement',\n        save: 'shop-staff-re-password',\n        position: 'shop-staff-update-staff-position',\n        salary: 'shop-staff-salary-account-setting',\n        shop_leave: 'shop-staff-leave-current-shop'\n      }\n      const name = modalPathList[modalType]\n      this.$modalRouter.push({\n        name,\n        props: { staff: this.info }\n      })\n    },\n    openModalBindCard() {\n      this.openModal('bind_card')\n    },\n    openModalRebindCard() {\n      this.openModal('rebind_card')\n    },\n    openModalLeave() {\n      this.openModal('leave')\n    },\n    openModalReinstate() {\n      this.openModal('reinstate')\n    },\n    openModalSave() {\n      this.openModal('save')\n    },\n    openModalPosition() {\n      this.openModal('position')\n    },\n    openModalSalary() {\n      this.openModal('salary')\n    },\n    openModalShopLeave() {\n      this.openModal('shop_leave')\n    },\n    editStaffInfo() {\n      this.$router.push({\n        name: 'shop-staff-edit',\n        query: { id: this.info.id }\n      })\n    },\n    // 清空指纹信息\n    onClearFingerprintInfo() {\n      this.$confirm({\n        title: '提示信息',\n        content: '确认清空指纹信息？',\n        onOk: () => {\n          this.infoService.deleteStaffFinger(this.info.id).subscribe()\n        }\n      })\n    },\n    // 清空硬件密码\n    onClearHardwarePassword() {\n      this.$confirm({\n        title: '提示信息',\n        content: '确认清空硬件密码吗？',\n        onOk: () => {\n          this.infoService.deleteStaffCabinetPassword(this.info.id).subscribe()\n        }\n      })\n    }\n  }\n}\n</script>\n"],"sourceRoot":"src/views/pages/shop/staff"}]}