(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["shop-stat-sell"],{"1ac5":function(t,e,a){"use strict";a.r(e);var n,i,r,s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("st-table-header-section",[t.auth.export?a("st-button",{directives:[{name:"export-excel",rawName:"v-export-excel",value:{type:"sale/summary",query:t.$searchQuery},expression:"{\n        type: 'sale/summary',\n        query: $searchQuery\n      }"}],attrs:{type:"primary"}},[t._v("\n      全部导出\n    ")]):t._e(),a("st-recent-radio-group",{attrs:{slot:"actions"},on:{change:t.recentChange},slot:"actions"})],1),a("st-total",{staticClass:"mg-t12",attrs:{indexs:t.totalColumns,dataSource:t.total$,hasTitle:""},scopedSlots:t._u([{key:"performance_amount",fn:function(e){return[a("st-total-item",{attrs:{unit:e.unit,label:e.label,value:e.value},nativeOn:{click:function(e){return t.onCLickPerformanceAmount(e)}}})]}}])}),a("st-table",{staticClass:"mg-t12",attrs:{page:t.page,scroll:{x:2300},loading:t.loading.getSellList,columns:t.columns,dataSource:t.list,rowKey:"id"},on:{change:t.onTableChange},scopedSlots:t._u([{key:"performance_amount",fn:function(e,n){return 0!==e?a("a",{on:{click:function(e){return t.getSellTotalAmount(n)}}},[t._v("\n      "+t._s(e)+"\n    ")]):a("span",[t._v(t._s(e))])}}],null,!0)},[a("span",{attrs:{slot:"memberTitle"},slot:"memberTitle"},[t._v("\n      "+t._s(t.$c("member_card"))+"成单数\n      "),a("st-help-tooltip",{attrs:{id:"TSSR001"}})],1),a("span",{attrs:{slot:"depositTitle"},slot:"depositTitle"},[t._v("\n      储值卡成单数\n      "),a("st-help-tooltip",{attrs:{id:"TSSR002"}})],1),a("span",{attrs:{slot:"totalTitle"},slot:"totalTitle"},[t._v("\n      总购课节数\n      "),a("st-help-tooltip",{attrs:{id:"TSSR004"}})],1),a("span",{attrs:{slot:"otherTitle"},slot:"otherTitle"},[t._v("\n      其它销售金额(元)\n      "),a("st-help-tooltip",{attrs:{id:"TSSR005"}})],1),a("span",{attrs:{slot:"performanceTitle"},slot:"performanceTitle"},[t._v("\n      总销售业绩(元)\n      "),a("st-help-tooltip",{attrs:{id:"TSSR006"}})],1)])],1)},o=[],c=a("f4df"),u=a("ea3e"),l=a("1044"),d=a("b513"),p=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("st-modal",{attrs:{wrapClassName:"modal-stat-sell-amount",title:"总销售业绩",width:"1150px",loading:t.loading.init},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("div",{staticClass:"search mg-b8"},[a("div",{staticClass:"search__left"},["all"===t.showTable?a("a-select",{staticStyle:{width:"200px"},attrs:{showSearch:"",placeholder:"请选择部门",optionFilterProp:"children",filterOption:t.filterOption},on:{change:function(e){return t.getAmountList(e,"changeDepartment")}},model:{value:t.pageParams.department_id,callback:function(e){t.$set(t.pageParams,"department_id",e)},expression:"pageParams.department_id"}},t._l(t.modalDepartmentList,(function(e){return a("a-select-option",{key:e.id,attrs:{value:e.id}},[t._v("\n          "+t._s(e.name)+"\n        ")])})),1):t._e(),"all"===t.showTable?a("a-select",{staticClass:"mg-l8",staticStyle:{width:"200px"},attrs:{showSearch:"",placeholder:"所有销售",optionFilterProp:"children",filterOption:t.filterOption},on:{change:t.getAmountList},model:{value:t.pageParams.staff_id,callback:function(e){t.$set(t.pageParams,"staff_id",e)},expression:"pageParams.staff_id"}},t._l(t.staffListFilter,(function(e){return a("a-select-option",{key:e.id,attrs:{value:e.id}},[t._v("\n          "+t._s(e.name)+"\n        ")])})),1):t._e()],1),a("div",{staticClass:"search__right"})]),a("st-table",{attrs:{scroll:{y:345},columns:t.columns,loading:t.loading.getSellAmountList,rowKey:"id",dataSource:t.amountList,"page-mode":"client"},scopedSlots:t._u([{key:"sale_price",fn:function(e){return a("span",{},[t._v("\n      "+t._s(e)+"\n    ")])}},{key:"product_name",fn:function(t){return a("span",{},[a("st-overflow-text",{attrs:{value:t,maxWidth:"120px"}})],1)}}])},[a("span",{attrs:{slot:"saleTitle"},slot:"saleTitle"},[t._v("\n      业绩金额\n      "),a("st-help-tooltip",{attrs:{id:"TSSR007"}})],1)]),a("div",{attrs:{slot:"footer"},slot:"footer"},[t.auth$.export?a("st-button",{directives:[{name:"export-excel",rawName:"v-export-excel",value:t.exportParams,expression:"exportParams"}],attrs:{type:"primary"}},[t._v("\n      全部导出\n    ")]):t._e()],1)],1)},f=[],h=(a("8e6e"),a("ac6a"),a("456d"),a("75fc")),m=a("bd86"),_=function(){return[{title:"签单时间",dataIndex:"order_time",width:"16%"},{title:"签单商品",dataIndex:"product_name",scopedSlots:{customRender:"product_name"},width:"18%"},{title:"会员姓名",dataIndex:"member_name",width:"10%"},{title:"订单总价",align:"right",dataIndex:"total_price",width:"10%"},{title:"实收金额",dataIndex:"actual_price",align:"right",width:"10%"},{dataIndex:"sale_price",align:"right",slots:{title:"saleTitle"},width:"10%"},{title:"销售姓名",dataIndex:"staff_name",width:"10%"},{title:"所属部门",dataIndex:"department_name",width:"10%"}]},g=a("d225"),y=a("b0b4"),b=a("9ab4"),v=a("0cd5"),S=a("2138"),O=a("ece1"),x=a("df29"),$=a("c4cc"),j=a("54da"),w=a("2cbb"),L=function(){function t(e,a,n){Object(g["a"])(this,t),this.statApi=e,this.userService=a,this.authService=n,this.amountList$=new x["d"]([]),this.modalDepartmentList$=new x["d"]([]),this.modalStaffList$=new x["d"]([]),this.loading$=new x["d"]({}),this.page$=new x["d"]({}),this.courseTypeList$=this.userService.getOptions$("reserve.reserve_type"),this.auth$=this.authService.authMap$({export:"shop:stat:saler_reports|export_day"})}return Object(y["a"])(t,[{key:"getSellAmountList",value:function(t){var e=this;return this.statApi.getSellAmount(t).pipe(Object($["a"])((function(t){e.amountList$.commit((function(){return t.list})),e.page$.commit((function(){return t.page}))})))}},{key:"getDepartmentStaffList",value:function(){var t=this;return this.statApi.getDepartmentStaffList().pipe(Object($["a"])((function(e){t.modalStaffList$.commit((function(){return[{id:-1,name:"所有销售"}].concat(Object(h["a"])(e.info.staff_list))})),t.modalDepartmentList$.commit((function(){return[{id:-1,name:"全部部门"}].concat(Object(h["a"])(e.info.department_list))}))})))}},{key:"init",value:function(t){return Object(j["a"])(this.getDepartmentStaffList(),this.getSellAmountList(t))}}]),t}();Object(b["b"])([Object(x["c"])(),Object(b["d"])("design:type",Function),Object(b["d"])("design:paramtypes",[Object]),Object(b["d"])("design:returntype",void 0)],L.prototype,"getSellAmountList",null),L=Object(b["b"])([Object(v["b"])(),Object(b["d"])("design:paramtypes",["function"===typeof(n="undefined"!==typeof O["c"]&&O["c"])?n:Object,"function"===typeof(i="undefined"!==typeof S["a"]&&S["a"])?i:Object,"function"===typeof(r="undefined"!==typeof w["a"]&&w["a"])?r:Object])],L);a("5664");var T=a("5c8a");function I(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function D(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?I(Object(a),!0).forEach((function(e){Object(m["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):I(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var P={name:"SellAmount",mixins:[u["a"]],serviceInject:function(){return{sellAmountervice:L}},rxState:function(){var t=this.sellAmountervice,e=t.amountList$,a=t.page$,n=t.auth$,i=t.loading$,r=t.modalDepartmentList$,s=t.modalStaffList$;return{auth$:n,page:a,amountList:e,loading:i,modalDepartmentList:r,modalStaffList:s}},props:{record:{type:Object,default:function(){return{}}},type:String},data:function(){return{show:!1,pageParams:{stat_date:"",amountList:[],staff_id:-1,department_id:-1,current_page:1,size:99999}}},computed:{columns:_,exportParams:function(){var t="sale";return"total"===this.type?{type:"".concat(t,"/total"),query:this.totalQuery}:{type:t,query:this.query}},showTable:function(){return this.$searchQuery.showTable||"all"},totalQuery:function(){var t=Object(T["a"])(this.$searchQuery);return delete t.showTable,delete t.current_page,delete t.size,D({},t,{current_page:this.pageParams.current_page,size:this.pageParams.size,staff_id:this.pageParams.staff_id,department_id:this.pageParams.department_id,type:"/total"})},query:function(){return{stat_date:this.pageParams.stat_date,staff_id:this.pageParams.staff_id,department_id:this.pageParams.department_id,current_page:this.pageParams.current_page,size:this.pageParams.size}},staffListFilter:function(){var t=this;return-1===this.query.department_id?this.modalStaffList:[{id:-1,name:"所有销售"}].concat(Object(h["a"])(this.modalStaffList.filter((function(e){return t.query.department_id===e.department_id}))))}},methods:{getAmountList:function(t,e){t.pageSize&&(this.pageParams.size=t.pageSize,this.pageParams.current_page=t.current);var a="total"===this.type?this.totalQuery:this.query;"changeDepartment"===e&&(this.pageParams.staff_id=-1,a.staff_id=-1,this.sellAmountervice.getDepartmentStaffList(a).subscribe()),this.sellAmountervice.getSellAmountList(a).subscribe()},filterOption:function(t,e){return e.componentOptions.children[0].text.toLowerCase().indexOf(t.toLowerCase())>=0},init:function(){this.record.staff_id?(this.pageParams.staff_id=this.record.staff_id||-1,this.pageParams.department_id=this.record.department_id||-1,this.pageParams.stat_date=this.record.stat_date):(this.pageParams.staff_id=this.$searchQuery.staff_id||-1,this.pageParams.department_id=this.$searchQuery.department_id||-1,this.pageParams.stat_date=this.record.stat_date);var t="total"===this.type?this.totalQuery:this.query;this.sellAmountervice.init(D({},t)).subscribe()}},mounted:function(){this.init()}},E=P,k=a("2877"),C=Object(k["a"])(E,p,f,!1,null,null,null),A=C.exports,Q=function(t){return[{dataIndex:"member_card_num",title:"".concat(t.$c("member_card"),"成单数")},{title:"".concat(t.$c("member_card"),"购买金额(元)"),dataIndex:"member_card_amount"},{dataIndex:"deposit_card_num",title:"储值卡成单数"},{title:"储值卡购买金额(元)",dataIndex:"deposit_card_amount"},{title:"私教购买节数",dataIndex:"personal_course_num"},{title:"私教购买金额(元)",dataIndex:"personal_course_amount",align:"right"},{title:"课程包购买节数",dataIndex:"package_course_num"},{title:"课程包购买金额(元)",dataIndex:"package_course_amount",align:"right"},{title:"".concat(t.$c("small_course"),"购买节数"),dataIndex:"small_course_num"},{title:"".concat(t.$c("small_course"),"购买金额（元)"),dataIndex:"small_course_amount"},{dataIndex:"total_course_num",title:"总购课节数 "},{dataIndex:"other_amount",title:"其它销售金额(元) "},{dataIndex:"performance_amount",title:"总销售业绩（元) ",scopedSlots:{customRender:"performance_amount"}}]},R=function(t){return[{title:"日期",width:"150px",fixed:"left",dataIndex:"stat_date"},{dataIndex:"member_card_num",align:"right",slots:{title:"memberTitle"}},{title:"".concat(t.$c("member_card"),"购买金额(元)"),dataIndex:"member_card_amount",align:"right"},{dataIndex:"deposit_card_num",align:"right",slots:{title:"depositTitle"}},{title:"储值卡购买金额(元)",dataIndex:"deposit_card_amount",align:"right"},{title:"私教购买节数",dataIndex:"personal_course_num",align:"right"},{title:"私教购买金额(元)",dataIndex:"personal_course_amount",align:"right"},{title:"课程包购买节数",dataIndex:"package_course_num",align:"right"},{title:"课程包购买金额(元)",dataIndex:"package_course_amount",align:"right"},{title:"".concat(t.$c("small_course"),"购买节数"),dataIndex:"small_course_num",align:"right"},{title:"".concat(t.$c("small_course"),"购买金额（元)"),dataIndex:"small_course_amount",align:"right"},{dataIndex:"total_course_num",align:"right",slots:{title:"totalTitle"}},{dataIndex:"other_amount",align:"right",slots:{title:"otherTitle"}},{dataIndex:"performance_amount",align:"right",slots:{title:"performanceTitle"},scopedSlots:{customRender:"performance_amount"}}]},K={mixins:[u["a"]],bem:{bPage:"page-shop-stat-sell-summary"},components:{StTotal:l["a"],StTotalItem:d["a"]},modals:{ShopStatSellAmount:A},serviceInject:function(){return{summaryService:c["SummaryService"]}},rxState:function(){return{loading:this.summaryService.loading$,list:this.summaryService.list$,page:this.summaryService.page$,total$:this.summaryService.total$,auth:this.summaryService.auth$}},computed:{columns:R,totalColumns:Q},methods:{onCLickPerformanceAmount:function(){this.$modalRouter.push({name:"shop-stat-sell-amount",props:{type:"total"}})},getSellTotalAmount:function(t){this.$modalRouter.push({name:"shop-stat-sell-amount",props:{record:t}})},recentChange:function(t){this.onMultiSearch(t)}}},M=K,q=Object(k["a"])(M,s,o,!1,null,null,null);e["default"]=q.exports},"1e7c":function(t,e,a){"use strict";a.r(e),a.d(e,"ProductService",(function(){return b}));var n,i,r,s,o,c=a("d225"),u=a("b0b4"),l=a("9ab4"),d=a("0cd5"),p=a("df29"),f=a("c4cc"),h=a("62dd"),m=a("112a"),_=a("2cbb"),g=a("c170"),y=a("2138"),b=function(){function t(e,a,n,i){Object(c["a"])(this,t),this.salesApi=e,this.userService=a,this.authService=n,this.commonApi=i,this.loading$=new p["d"]({}),this.list$=new p["d"]([]),this.page$=new p["d"]({}),this.total$=new p["d"]({}),this.updateTime$=new p["d"](Date.now()),this.contractType$=this.userService.getOptions$("report.report_contract_type"),this.productType$=this.userService.getOptions$("report.report_product_performance"),this.auth$=this.authService.authMap$({export:"shop:stat:sales:summary|export_product"})}return Object(u["a"])(t,[{key:"getList",value:function(t){var e=this;return this.salesApi.getProductData(t).pipe(Object(f["a"])((function(t){e.list$.commit((function(){return t.list})),e.page$.commit((function(){return t.page})),t.last_update_time&&e.updateTime$.commit((function(){return t.last_update_time}))})))}},{key:"getDataTotal",value:function(t){var e=this;return this.salesApi.getProductDataTotal(t).pipe(Object(f["a"])((function(t){e.total$.commit((function(){return t.info})),t.last_update_time&&e.updateTime$.commit((function(){return t.last_update_time}))})))}},{key:"getDataRefresh",value:function(){var t=this;return this.commonApi.getProductPerformanceRefresh().pipe(Object(f["a"])((function(e){e.last_update_time&&t.updateTime$.commit((function(){return e.last_update_time}))})))}},{key:"beforeEach",value:function(t,e){return Object(g["a"])(this.getList(t.meta.query),this.getDataTotal(t.meta.query))}}]),t}();Object(l["b"])([Object(p["c"])(),Object(l["d"])("design:type",Function),Object(l["d"])("design:paramtypes",["function"===typeof(n="undefined"!==typeof h["SaleDataParams"]&&h["SaleDataParams"])?n:Object]),Object(l["d"])("design:returntype",void 0)],b.prototype,"getList",null),b=Object(l["b"])([Object(d["b"])(),Object(l["d"])("design:paramtypes",["function"===typeof(i="undefined"!==typeof h["b"]&&h["b"])?i:Object,"function"===typeof(r="undefined"!==typeof y["a"]&&y["a"])?r:Object,"function"===typeof(s="undefined"!==typeof _["a"]&&_["a"])?s:Object,"function"===typeof(o="undefined"!==typeof m["a"]&&m["a"])?o:Object])],b)},"2d21":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:t.b()},[a("div",{class:t.b("section")},[a("header",{staticClass:"mg-t16",class:t.bHeader("header")},[a("div",{class:t.bHeader("button-wapper")},[t.auth.export?a("st-button",{directives:[{name:"export-excel",rawName:"v-export-excel",value:{type:"shop/product-performance/export",query:t.$searchQuery},expression:"{\n            type: 'shop/product-performance/export',\n            query: $searchQuery\n          }"}],attrs:{type:"primary"}},[t._v("\n          全部导出\n        ")]):t._e()],1),a("div",{class:t.bHeader("actions")},[a("st-select",{attrs:{width:"140px",options:t.contractType,defaultLabel:"全部合同类型"},on:{change:function(e){return t.onSingleSearch("contract_type",e)}},model:{value:t.$searchQuery.contract_type,callback:function(e){t.$set(t.$searchQuery,"contract_type",e)},expression:"$searchQuery.contract_type"}}),a("st-select",{attrs:{width:"120px",options:t.productType,defaultLabel:"全部类型"},on:{change:function(e){return t.onSingleSearch("product_type",e)}},model:{value:t.$searchQuery.product_type,callback:function(e){t.$set(t.$searchQuery,"product_type",e)},expression:"$searchQuery.product_type"}}),a("st-recent-radio-group",{attrs:{value:t.$searchQuery},on:{change:t.onChangeDataDays}}),a("st-refresh-btn",{attrs:{updateTime:t.updateTime,action:t.refresh}})],1)]),a("st-total",{class:t.b("total"),attrs:{indexs:t.totalColumns,dataSource:t.total,slidesPerView:"auto",hasTitle:""}}),a("st-table",{staticClass:"mg-t16",attrs:{rowKey:"order_id",scroll:{x:1540},loading:t.loading.getList,columns:t.columns,page:t.page,dataSource:t.list},on:{change:t.onTableChange}})],1)])},i=[],r=a("1044"),s=a("1e7c"),o=a("ea3e"),c=function(){return[{title:"商品名称",width:140,dataIndex:"product_name"},{title:"合同类型",width:100,dataIndex:"contract_type_name"},{title:"实收金额(元)",width:120,dataIndex:"pay_price"},{title:"退款(元)",width:100,dataIndex:"refund_price"},{title:"销售",width:100,dataIndex:"sale_name"},{title:"分单比例",width:100,dataIndex:"split_ratio"},{title:"实际业绩(元)",width:120,dataIndex:"real_price"},{title:"合同原价(元)",width:120,dataIndex:"total_price"},{title:"使用定金(元)",width:120,dataIndex:"advance_fee"},{title:"门店名称",width:100,dataIndex:"shop_name"},{title:"会员名",width:100,dataIndex:"member_name"},{title:"手机号",width:120,dataIndex:"mobile"},{title:"完款日期",width:120,dataIndex:"pay_finished_date"},{title:"订单编号",width:100,dataIndex:"order_id"}]},u=function(){return[{title:"实收金额",dataIndex:"total_amount"},{title:"退款金额",dataIndex:"total_refund_amount"},{title:"实际业绩",dataIndex:"total_real_amount"},{title:"合同原价",dataIndex:"total_contract_amount"},{title:"使用定金",dataIndex:"total_earnest_amount"}]},l=a("c32d"),d=a.n(l),p={name:"BrandStatSaleProduct",mixins:[o["a"]],serviceInject:function(){return{productService:s["ProductService"]}},rxState:function(){var t=this.productService,e=t.list$,a=t.page$,n=t.total$,i=t.auth$,r=t.contractType$,s=t.productType$,o=t.updateTime$,c=t.loading$;return{list:e,page:a,total:n,auth:i,contractType:r,productType:s,updateTime:o,loading:c}},bem:{b:"page-shop-stat-sale-product",bHeader:"page-brand-stat-header"},data:function(){return{}},computed:{columns:c,totalColumns:u},created:function(){},methods:{moment:d.a,refresh:function(){return this.productService.getDataRefresh()},onChangeDataDays:function(t){this.$searchQuery.day=t.recently_day||void 0,this.$searchQuery.start_date=t.start_date||void 0,this.$searchQuery.end_date=t.end_date||void 0,this.onSearch()}},components:{StTotal:r["a"]}},f=p,h=a("2877"),m=Object(h["a"])(f,n,i,!1,null,null,null);e["default"]=m.exports},5664:function(t,e,a){"use strict";var n,i;a.d(e,"a",(function(){return n})),a.d(e,"b",(function(){return i})),function(t){t[t["PERSONAL"]=1]="PERSONAL",t[t["PERSONAL_TEAM"]=2]="PERSONAL_TEAM",t[t["TEAM"]=3]="TEAM",t[t["SMALL"]=5]="SMALL"}(n||(n={})),function(t){t[t["SINGLE"]=1]="SINGLE",t[t["CYCLE"]=2]="CYCLE",t[t["ALL_CYCLE"]=3]="ALL_CYCLE"}(i||(i={}))},"60ac":function(t,e,a){"use strict";a.r(e),a.d(e,"StaffService",(function(){return $}));a("8e6e"),a("456d"),a("7f7f");var n,i,r,s,o,c,u=a("bd86"),l=(a("6b54"),a("ac6a"),a("5df3"),a("4f7f"),a("75fc")),d=a("d225"),p=a("b0b4"),f=a("9ab4"),h=a("0cd5"),m=a("df29"),_=a("c4cc"),g=a("62dd"),y=a("2cbb"),b=a("2138"),v=a("c170"),S=a("112a");function O(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function x(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?O(Object(a),!0).forEach((function(e){Object(u["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):O(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var $=function(){function t(e,a,n,i){Object(d["a"])(this,t),this.salesApi=e,this.authService=a,this.userService=n,this.commonApi=i,this.loading$=new m["d"]({}),this.list$=new m["d"]([]),this.childListMap$=new m["d"]({}),this.expendKeys$=new m["d"]([]),this.page$=new m["d"]({}),this.total$=new m["d"]({}),this.departmentList$=new m["d"]([]),this.staffList$=new m["d"]([]),this.updateTime$=new m["d"](Date.now()),this.contractType$=this.userService.getOptions$("report.report_contract_type"),this.auth$=this.authService.authMap$({export:"shop:stat:sales:summary|export_sales"})}return Object(p["a"])(t,[{key:"SET_CHILDLISTMAP",value:function(t){this.childListMap$.commit((function(){return t}))}},{key:"RESET_CHILDITEM",value:function(t){var e=this.childListMap$.getValue();e[t].list=[],e[t].page={current_page:1},this.childListMap$.commit((function(){return e}))}},{key:"ADD_EXPENDKEY",value:function(t){var e=this.expendKeys$.getValue();e.indexOf(t)<0&&this.SET_EXPENDKEYS([].concat(Object(l["a"])(e),[t]))}},{key:"DEL_EXPENDKEY",value:function(t){var e=this.expendKeys$.getValue();e.splice(e.indexOf(t),1),this.SET_EXPENDKEYS(Object(l["a"])(e))}},{key:"SET_EXPENDKEYS",value:function(t){var e=this.expendKeys$.getValue();e=new Set([].concat(Object(l["a"])(e),Object(l["a"])(t))),this.expendKeys$.commit((function(){return Object(l["a"])(e)}))}},{key:"SET_LIST",value:function(t){var e=this,a={},n=this.expendKeys$.getValue();t=t.map((function(t,i){var r=t.staff_id.toString();return i<1&&(n=[].concat(Object(l["a"])(n),[t.staff_id.toString()])),!(i>=1)||t.children.list&&t.children.list.length||(e.DEL_EXPENDKEY(r),n.indexOf(r)>=0&&n.splice(n.indexOf(r),1)),a[r]=x({},t.children),x({},t,{staff_id:r})})),this.SET_CHILDLISTMAP(a),this.SET_EXPENDKEYS(n),this.list$.commit((function(){return t}))}},{key:"getList",value:function(t){var e=this;return this.salesApi.getData(t).pipe(Object(_["a"])((function(t){e.SET_LIST(t.list),e.page$.commit((function(){return t.page})),t.last_update_time&&e.updateTime$.commit((function(){return t.last_update_time}))})))}},{key:"getDataTotal",value:function(t){var e=this;return this.salesApi.getDataTotal(t).pipe(Object(_["a"])((function(t){e.total$.commit((function(){return t.info})),t.last_update_time&&e.updateTime$.commit((function(){return t.last_update_time}))})))}},{key:"getDataRefresh",value:function(){var t=this;return this.commonApi.getSalesRefresh().pipe(Object(_["a"])((function(e){e.last_update_time&&t.updateTime$.commit((function(){return e.last_update_time}))})))}},{key:"getDetailList",value:function(t){var e=this;return this.salesApi.getDetailData(t).pipe(Object(_["a"])((function(a){var n=e.childListMap$.getValue(),i=t.staff_id;n[i]=a,e.SET_CHILDLISTMAP(n)})))}},{key:"getDepartmentList",value:function(){var t=this;return this.commonApi.getDepartmentList().pipe(Object(_["a"])((function(e){var a=[{label:"全部部门",value:-1}],n=function t(e){return e.map((function(e){return{label:e.name,value:e.id,children:e.children&&e.children.length?t(e.children):[]}}))};a=[].concat(Object(l["a"])(a),Object(l["a"])(n(e.department))),t.departmentList$.commit((function(){return a}))})))}},{key:"getStaffList",value:function(t){var e=this;return this.commonApi.getShopStaffList(t).pipe(Object(_["a"])((function(t){var a=[];t.list.map((function(t){a.push({label:t.nickname,value:t.id})})),e.staffList$.commit((function(){return a}))})))}},{key:"beforeEach",value:function(t,e){return Object(v["a"])(this.getList(t.meta.query),this.getDataTotal(t.meta.query))}}]),t}();Object(f["b"])([Object(m["c"])(),Object(f["d"])("design:type",Function),Object(f["d"])("design:paramtypes",["function"===typeof(n="undefined"!==typeof g["SaleDataParams"]&&g["SaleDataParams"])?n:Object]),Object(f["d"])("design:returntype",void 0)],$.prototype,"getList",null),Object(f["b"])([Object(m["c"])(),Object(f["d"])("design:type",Function),Object(f["d"])("design:paramtypes",["function"===typeof(i="undefined"!==typeof g["SaleDataParams"]&&g["SaleDataParams"])?i:Object]),Object(f["d"])("design:returntype",void 0)],$.prototype,"getDetailList",null),$=Object(f["b"])([Object(h["b"])(),Object(f["d"])("design:paramtypes",["function"===typeof(r="undefined"!==typeof g["b"]&&g["b"])?r:Object,"function"===typeof(s="undefined"!==typeof y["a"]&&y["a"])?s:Object,"function"===typeof(o="undefined"!==typeof b["a"]&&b["a"])?o:Object,"function"===typeof(c="undefined"!==typeof S["a"]&&S["a"])?c:Object])],$)},"62dd":function(t,e,a){"use strict";a.d(e,"b",(function(){return d}));a("6b54"),a("2397");var n=a("d225"),i=a("b0b4"),r=a("308d"),s=a("6bb5"),o=a("4e2b"),c=a("de46");function u(t){return function(){var e,a=Object(s["a"])(t);if(l()){var n=Object(s["a"])(this).constructor;e=Reflect.construct(a,arguments,n)}else e=a.apply(this,arguments);return Object(r["a"])(this,e)}}function l(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var d=function(t){Object(o["a"])(a,t);var e=u(a);function a(){return Object(n["a"])(this,a),e.apply(this,arguments)}return Object(i["a"])(a,[{key:"getData",value:function(t){return this.http.get("/v1/report/sales/shop/get-list",{query:t})}},{key:"getDataTotal",value:function(t){return this.http.get("/v1/report/sales/shop/get-total-data",{query:t})}},{key:"getDetailData",value:function(t){return this.http.get("/v1/report/sales/shop/get-order-list",{query:t})}},{key:"getProductData",value:function(t){return this.http.get("/v1/report/product-performance/shop/get-list",{query:t})}},{key:"getProductDataTotal",value:function(t){return this.http.get("/v1/report/product-performance/shop/get-total-data",{query:t})}}]),a}(c["a"])},a58a:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:t.b()},[a("div",{class:t.b("section")},[a("header",{class:t.bHeader("header")},[a("div",{class:t.bHeader("button-wapper")},[t.auth.export?a("st-button",{directives:[{name:"export-excel",rawName:"v-export-excel",value:{type:"sales/shop/export",query:t.$searchQuery},expression:"{\n            type: 'sales/shop/export',\n            query: $searchQuery\n          }"}],attrs:{type:"primary"}},[t._v("\n          全部导出\n        ")]):t._e()],1),a("div",{class:t.bHeader("actions")},[a("st-select",{attrs:{options:t.contractType,defaultLabel:"全部合同类型"},on:{change:function(e){return t.onSingleSearch("contract_type",e)}},model:{value:t.$searchQuery.contract_type,callback:function(e){t.$set(t.$searchQuery,"contract_type",e)},expression:"$searchQuery.contract_type"}}),a("a-cascader",{staticStyle:{width:"120px"},attrs:{allowClear:!1,placeholder:"请选择部门",options:t.departmentList,"change-on-select":""},on:{change:t.onCascaderChange},model:{value:t.departmentId,callback:function(e){t.departmentId=e},expression:"departmentId"}}),a("st-select",{attrs:{"show-search":"",options:t.staffList,defaultLabel:"全部员工",query:{department_id:this.$searchQuery.section_id},"option-filter-prop":"children","filter-option":!0},on:{change:function(e){return t.onSingleSearch("staff_id",e)},refresh:t.onStaffSelectRefresh},model:{value:t.$searchQuery.staff_id,callback:function(e){t.$set(t.$searchQuery,"staff_id",e)},expression:"$searchQuery.staff_id"}}),a("st-recent-radio-group",{attrs:{value:t.$searchQuery},on:{change:t.onChangeDataDays}}),a("st-refresh-btn",{attrs:{updateTime:t.updateTime,action:t.refresh}})],1)]),a("st-total",{class:t.b("total"),attrs:{indexs:t.totalColumns,dataSource:t.total,hasTitle:""}}),a("st-table",{staticClass:"mg-t16",class:!t.list.length&&t.b("table-nodata"),attrs:{loading:t.loading.getList,columns:t.columns,rowKey:"staff_id",expandedRowKeys:t.expendKeys,page:t.page,dataSource:t.list,stripe:!1},on:{change:t.onTableChange,expand:t.expandChange},scopedSlots:t._u([{key:"expandedRowRender",fn:function(e){return a("div",{},[a("st-table",{attrs:{columns:t.childColumns,rowKey:function(t,e){return e},query:{staff_id:e.staff_id},page:t.childListMap[e.staff_id].page,pagination:{simple:!0,hideOnSinglePage:!0},dataSource:t.childListMap[e.staff_id].list,loading:t.activeTableKey===e.staff_id&&t.loading.getDetailList,stripe:!1},on:{change:t.onChildTableChange},scopedSlots:t._u([{key:"pay_date",fn:function(e){return a("span",{},[t._v("\n            "+t._s(t.moment(e).format("YYYY-MM-DD"))+"\n          ")])}}],null,!0)})],1)}}])})],1)])},i=[],r=(a("8e6e"),a("ac6a"),a("456d"),a("6b54"),a("bd86")),s=a("1044"),o=a("60ac"),c=a("ea3e"),u=function(){return[{title:"员工",width:140,dataIndex:"nickname"},{title:"实收(含定金)",width:120,dataIndex:"total_amount"},{title:"退款(元)",width:100,dataIndex:"refund_amount"},{title:"业绩(元)",width:100,dataIndex:"real_amount"},{title:"原价(元)",width:100,dataIndex:"contract_amount"},{title:"使用定金(元)",dataIndex:"earnest_amount"}]},l=function(){return[{title:"商品名称",width:140,dataIndex:"product_name"},{title:"实收(含定金)",width:120,dataIndex:"total_amount"},{title:"退款(元)",width:100,dataIndex:"refund_amount"},{title:"业绩(元)",width:100,dataIndex:"real_amount"},{title:"原价(元)",width:100,dataIndex:"contract_amount"},{title:"使用定金(元)",width:120,dataIndex:"earnest_amount"},{title:"门店名称",dataIndex:"shop_name"},{title:"分单比例",dataIndex:"proportion"},{title:"商品类目",dataIndex:"product_cate_name"},{title:"合同类型",dataIndex:"contract_type_name"},{title:"会员名",dataIndex:"member_name"},{title:"手机号",width:120,dataIndex:"member_mobile"},{title:"完款日期",scopedSlots:{customRender:"pay_date"},width:120,dataIndex:"pay_date"}]},d=function(){return[{title:"实收(含定金)",unit:"¥",dataIndex:"total_amount"},{title:"退款",unit:"¥",dataIndex:"refund_amount"},{title:"业绩",unit:"¥",dataIndex:"real_amount"},{title:"原价",unit:"¥",dataIndex:"contract_amount"},{title:"使用定金",unit:"¥",dataIndex:"earnest_amount"}]},p=a("c32d"),f=a.n(p);function h(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function m(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?h(Object(a),!0).forEach((function(e){Object(r["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):h(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var _={name:"ShopStatSaleStaff",mixins:[c["a"]],serviceInject:function(){return{staffService:o["StaffService"]}},rxState:function(){var t=this.staffService,e=t.list$,a=t.childListMap$,n=t.expendKeys$,i=t.page$,r=t.total$,s=t.auth$,o=t.departmentList$,c=t.staffList$,u=t.contractType$,l=t.updateTime$,d=t.loading$;return{list:e,childListMap:a,expendKeys:n,page:i,total:r,auth:s,departmentList:o,staffList:c,contractType:u,updateTime:l,loading:d}},created:function(){this.staffService.getDepartmentList().subscribe(),this.staffService.getStaffList({department_id:this.$searchQuery.section_id}).subscribe()},bem:{b:"page-shop-stat-staff",bHeader:"page-shop-stat-header"},data:function(){return{chartTodayShop:-1,departmentId:[-1],activeTableKey:null}},computed:{columns:u,childColumns:l,totalColumns:d},methods:{moment:f.a,onCascaderChange:function(t){this.$searchQuery.section_id=t.length?t[t.length-1]:[-1],this.onSearch()},onChangeDataDays:function(t){this.$searchQuery.day=t.recently_day||void 0,this.$searchQuery.start_date=t.start_date||void 0,this.$searchQuery.end_date=t.end_date||void 0,this.onSearch()},refresh:function(){return this.staffService.getDataRefresh()},onStaffSelectRefresh:function(t){this.staffService.getStaffList(t).subscribe()},onChildTableChange:function(t){for(var e=this,a=arguments.length,n=new Array(a>1?a-1:0),i=1;i<a;i++)n[i-1]=arguments[i];this.onChildrenTableChange.apply(this,[t].concat(n)).then((function(t){e.activeTableKey=t.staff_id,e.staffService.getDetailList(m({},e.finalSearchQuery,{},t)).subscribe()}))},expandChange:function(t,e){t?(this.staffService.ADD_EXPENDKEY(e.staff_id.toString()),this.activeTableKey=e.staff_id,this.staffService.getDetailList(m({},this.finalSearchQuery,{staff_id:e.staff_id,current_page:1,size:10})).subscribe()):(this.staffService.DEL_EXPENDKEY(e.staff_id.toString()),this.staffService.RESET_CHILDITEM(e.staff_id.toString()))}},components:{StTotal:s["a"]}},g=_,y=a("2877"),b=Object(y["a"])(g,n,i,!1,null,null,null);e["default"]=b.exports},f4df:function(t,e,a){"use strict";a.r(e),a.d(e,"SummaryService",(function(){return m}));var n,i,r,s=a("d225"),o=a("b0b4"),c=a("9ab4"),u=a("0cd5"),l=a("df29"),d=a("c4cc"),p=a("ece1"),f=a("54da"),h=a("2cbb"),m=function(){function t(e,a){Object(s["a"])(this,t),this.StatApi=e,this.authService=a,this.list$=new l["d"]([]),this.page$=new l["d"]({}),this.loading$=new l["d"]({}),this.total$=new l["d"]({}),this.auth$=this.authService.authMap$({export:"shop:stat:saler_reports|export_summary"})}return Object(o["a"])(t,[{key:"getSellList",value:function(t){var e=this;return this.StatApi.getSellList(t).pipe(Object(d["a"])((function(t){e.list$.commit((function(){return t.list})),e.page$.commit((function(){return t.page})),e.total$.commit((function(){return t.total}))})))}},{key:"init",value:function(t){return Object(f["a"])(this.getSellList(t))}},{key:"beforeEach",value:function(t,e){return this.init(t.meta.query)}}]),t}();Object(c["b"])([Object(l["c"])(),Object(c["d"])("design:type",Function),Object(c["d"])("design:paramtypes",["function"===typeof(n="undefined"!==typeof p["OrderShopListQuery"]&&p["OrderShopListQuery"])?n:Object]),Object(c["d"])("design:returntype",void 0)],m.prototype,"getSellList",null),Object(c["b"])([Object(l["c"])(),Object(c["d"])("design:type",Function),Object(c["d"])("design:paramtypes",[Object]),Object(c["d"])("design:returntype",void 0)],m.prototype,"init",null),m=Object(c["b"])([Object(u["b"])(),Object(c["d"])("design:paramtypes",["function"===typeof(i="undefined"!==typeof p["c"]&&p["c"])?i:Object,"function"===typeof(r="undefined"!==typeof h["a"]&&h["a"])?r:Object])],m)}}]);