{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhigang/Desktop/styd/web/src/views/pages/common/notify/inform.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/pages/common/notify/inform.vue","mtime":1601345845267},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js","mtime":1591062572376}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport ShopSelect from '@/views/biz-components/shop/shop-select'\nimport { columns } from './inform.config'\nimport { InformService } from './inform.service'\nimport { TEMPERATURE_TYPE } from '@/constants/common/notify'\nimport tableMixin from '@/mixins/table.mixin'\n\nexport default {\n  name: 'NotifyInform',\n  mixins: [tableMixin],\n  bem: {\n    b: 'page-notify-inform'\n  },\n  serviceInject() {\n    return {\n      service: InformService\n    }\n  },\n  watch: {\n    // 当一级类型变化则二级分类重置\n    '$searchQuery.notify_type'(oldValue, newValue) {\n      if (oldValue !== newValue) {\n        this.$searchQuery.sub_notify_type = -1\n      }\n    }\n  },\n  components: {\n    ShopSelect\n  },\n  rxState() {\n    const { list$, page$, loading$, informTypeOptions$ } = this.service\n    return { list$, page$, loading$, informTypeOptions$ }\n  },\n  data() {\n    return {\n      date: null,\n      TEMPERATURE_TYPE\n    }\n  },\n  computed: {\n    columns,\n    routerNameSet() {\n      return {\n        'shop-reception-entrance': [1, 2],\n        'shop-reception-reserve': [3, 4, 5],\n        'shop-finance-order-list': [6, 7, 8, 9],\n        'shop-member-list-studio': [10, 11, 12, 13, 14, 15, 16]\n      }\n    },\n    noticeTypeLevel1Options() {\n      return this.informTypeOptions$.map(item => {\n        return {\n          label: item.name,\n          value: item.id\n        }\n      })\n    },\n    noticeTypeLevel2Options() {\n      let options = []\n      for (let item of this.informTypeOptions$) {\n        if (item.id === this.$searchQuery.notify_type) {\n          options = [\n            { label: '全部', value: -1 },\n            ...item.children.map(item => {\n              return {\n                label: item.name,\n                value: item.id\n              }\n            })\n          ]\n        }\n      }\n      return options\n    }\n  },\n  methods: {\n    contentText(record) {\n      const notifyType = this.$searchQuery.notify_type\n      return notifyType === 3\n        ? `<div class=\"page-notify-inform__content\"><img src='${record.image_url}'><span>${record.content}</span></div>`\n        : record.content\n    },\n    onClickDetail(record) {\n      console.log(record)\n      for (let key in this.routerNameSet) {\n        console.log(key)\n        console.log(\n          this.routerNameSet[key].includes(record.sub_notify_type.key)\n        )\n        console.log('this.routerNameSet[key]', this.routerNameSet[key])\n        if (this.routerNameSet[key].includes(record.sub_notify_type.key)) {\n          this.$router.push({ name: key })\n        }\n      }\n    }\n  }\n}\n",{"version":3,"sources":["inform.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiHA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"inform.vue","sourceRoot":"src/views/pages/common/notify","sourcesContent":["<template>\n  <div :class=\"b()\">\n    <st-search-panel @search=\"onSearch\" @reset=\"onSearchReset\">\n      <st-search-panel-item label=\"通知类型：\">\n        <st-search-radio\n          v-model=\"$searchQuery.notify_type\"\n          :options=\"noticeTypeLevel1Options\"\n        />\n      </st-search-panel-item>\n      <st-search-panel-item label=\"二级分类：\">\n        <st-search-radio\n          v-model=\"$searchQuery.sub_notify_type\"\n          :options=\"noticeTypeLevel2Options\"\n        />\n      </st-search-panel-item>\n      <st-search-panel-item label=\"通知门店：\">\n        <shop-select\n          class=\"mg-r8\"\n          style=\"width: 160px\"\n          :defaultValue=\"-1\"\n          v-model=\"$searchQuery.shop_id\"\n        ></shop-select>\n      </st-search-panel-item>\n    </st-search-panel>\n\n    <st-table\n      class=\"pd-24\"\n      @change=\"onTableChange\"\n      rowKey=\"id\"\n      :columns=\"columns\"\n      :dataSource=\"list$\"\n      :loading=\"loading$.getList\"\n      :page=\"page$\"\n    >\n      <template slot=\"notify_type\" slot-scope=\"text, record\">\n        {{ record.notify_type.name }}\n      </template>\n      <template slot=\"sub_notify_type\" slot-scope=\"text, record\">\n        {{ record.sub_notify_type.name }}\n      </template>\n      <template slot=\"content\" slot-scope=\"text, record\">\n        <st-overflow-text maxWidth=\"450px\" :value=\"contentText(record)\">\n          <span v-html=\"text\"></span>\n          <div\n            v-if=\"record.content_detail\"\n            class=\"page-inform-table-member\"\n            slot=\"content\"\n          >\n            <div class=\"page-inform-table__member-img\">\n              <img :src=\"record.image_url\" alt=\"会员图片\" />\n            </div>\n\n            <div class=\"page-inform-table__member-info\">\n              <div class=\"content\">\n                <st-t3>\n                  {{\n                    `${record.content_detail.member_name}(${record.content_detail.level_name})`\n                  }}\n                </st-t3>\n\n                <div class=\"pass\">\n                  <span>{{ record.content_detail.entrance_time }}</span>\n                  使用\n                  <span>{{ record.content_detail.proof_name }}</span>\n                  通过\n                  <span>{{ record.content_detail.hardware_name }}</span>\n                  进入\n                  <span>{{ record.content_detail.area_name }}</span>\n                </div>\n                <div class=\"tip\">\n                  <span>上次入场：</span>\n                  <span>{{ record.content_detail.last_entrance_time }}</span>\n                  <span>跟进会籍：</span>\n                  <span>{{ record.content_detail.sale_name }}</span>\n                  <span>跟进{{ $c('coach') }}：</span>\n                  <span>{{ record.content_detail.coach_name }}</span>\n                </div>\n              </div>\n              <div\n                v-if=\"\n                  record.content_detail.temperature_type_value !==\n                    TEMPERATURE_TYPE.NOTHING\n                \"\n                class=\"page-inform-table__member-temperature-tag\"\n              >\n                <a-tag\n                  :color=\"\n                    record.content_detail.temperature_type_value ===\n                    TEMPERATURE_TYPE.SAFETY\n                      ? '#23D9AD'\n                      : '#FF4B2B'\n                  \"\n                >\n                  {{ record.content_detail.temperature_type_text }}\n                  {{ record.content_detail.temperature }}\n                </a-tag>\n              </div>\n            </div>\n          </div>\n        </st-overflow-text>\n      </template>\n      <template slot=\"actions\" slot-scope=\"text, record\">\n        <st-table-actions>\n          <a @click=\"onClickDetail(record)\">\n            查看\n          </a>\n        </st-table-actions>\n      </template>\n    </st-table>\n  </div>\n</template>\n\n<script>\nimport ShopSelect from '@/views/biz-components/shop/shop-select'\nimport { columns } from './inform.config'\nimport { InformService } from './inform.service'\nimport { TEMPERATURE_TYPE } from '@/constants/common/notify'\nimport tableMixin from '@/mixins/table.mixin'\n\nexport default {\n  name: 'NotifyInform',\n  mixins: [tableMixin],\n  bem: {\n    b: 'page-notify-inform'\n  },\n  serviceInject() {\n    return {\n      service: InformService\n    }\n  },\n  watch: {\n    // 当一级类型变化则二级分类重置\n    '$searchQuery.notify_type'(oldValue, newValue) {\n      if (oldValue !== newValue) {\n        this.$searchQuery.sub_notify_type = -1\n      }\n    }\n  },\n  components: {\n    ShopSelect\n  },\n  rxState() {\n    const { list$, page$, loading$, informTypeOptions$ } = this.service\n    return { list$, page$, loading$, informTypeOptions$ }\n  },\n  data() {\n    return {\n      date: null,\n      TEMPERATURE_TYPE\n    }\n  },\n  computed: {\n    columns,\n    routerNameSet() {\n      return {\n        'shop-reception-entrance': [1, 2],\n        'shop-reception-reserve': [3, 4, 5],\n        'shop-finance-order-list': [6, 7, 8, 9],\n        'shop-member-list-studio': [10, 11, 12, 13, 14, 15, 16]\n      }\n    },\n    noticeTypeLevel1Options() {\n      return this.informTypeOptions$.map(item => {\n        return {\n          label: item.name,\n          value: item.id\n        }\n      })\n    },\n    noticeTypeLevel2Options() {\n      let options = []\n      for (let item of this.informTypeOptions$) {\n        if (item.id === this.$searchQuery.notify_type) {\n          options = [\n            { label: '全部', value: -1 },\n            ...item.children.map(item => {\n              return {\n                label: item.name,\n                value: item.id\n              }\n            })\n          ]\n        }\n      }\n      return options\n    }\n  },\n  methods: {\n    contentText(record) {\n      const notifyType = this.$searchQuery.notify_type\n      return notifyType === 3\n        ? `<div class=\"page-notify-inform__content\"><img src='${record.image_url}'><span>${record.content}</span></div>`\n        : record.content\n    },\n    onClickDetail(record) {\n      console.log(record)\n      for (let key in this.routerNameSet) {\n        console.log(key)\n        console.log(\n          this.routerNameSet[key].includes(record.sub_notify_type.key)\n        )\n        console.log('this.routerNameSet[key]', this.routerNameSet[key])\n        if (this.routerNameSet[key].includes(record.sub_notify_type.key)) {\n          this.$router.push({ name: key })\n        }\n      }\n    }\n  }\n}\n</script>\n"]}]}