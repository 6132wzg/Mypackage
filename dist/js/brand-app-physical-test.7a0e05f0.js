(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["brand-app-physical-test"],{5845:function(t,e,i){"use strict";i.r(e),i.d(e,"ListService",(function(){return b}));var n,a,s=i("d225"),d=i("b0b4"),c=i("9ab4"),o=i("cba1"),r=i("0cd5"),u=i("df29"),l=i("c4cc"),h=i("54da"),p=i("2cbb"),b=function(){function t(e,i){Object(s["a"])(this,t),this.pluginBodyApi=e,this.authService=i,this.loading$=new u["d"]({}),this.list$=new u["d"]([]),this.labelList$=new u["d"]([]),this.auth$=this.authService.authMap$({add:"brand:application:physical_test|add",edit:"brand:application:physical_test|edit",del:"brand:application:physical_test|del"})}return Object(d["a"])(t,[{key:"getBodyIndicatorList",value:function(){var t=this;return this.pluginBodyApi.getBodyTemplateInfo().pipe(Object(l["a"])((function(e){t.list$.commit((function(){var t=e.list;return t.unshift({id:0,isAdd:1}),t}))})))}},{key:"moveBodyIndicators",value:function(t){return this.pluginBodyApi.moveBodyIndicators(t)}},{key:"editBodyIndicator",value:function(t){return this.pluginBodyApi.editBodyIndicator(t)}},{key:"addBodyIndicator",value:function(t){return this.pluginBodyApi.addBodyIndicator(t)}},{key:"deleteBodyIndicator",value:function(t){return this.pluginBodyApi.deleteBodyIndicator(t)}},{key:"getBodyImgLableList",value:function(){var t=this;return this.pluginBodyApi.getBodyAlbumTemplate().pipe(Object(l["a"])((function(e){t.labelList$.commit((function(){return e}))})))}},{key:"removePhysicalTestBodyImgLabel",value:function(t){return this.pluginBodyApi.deleteBodyAlbumTemplate(t)}},{key:"init",value:function(){return Object(h["a"])(this.getBodyImgLableList(),this.getBodyIndicatorList())}},{key:"beforeEach",value:function(t,e){return this.init()}}]),t}();Object(c["b"])([Object(u["c"])(),Object(c["d"])("design:type",Function),Object(c["d"])("design:paramtypes",[]),Object(c["d"])("design:returntype",void 0)],b.prototype,"getBodyIndicatorList",null),b=Object(c["b"])([Object(r["b"])(),Object(c["d"])("design:paramtypes",["function"===typeof(n="undefined"!==typeof o["a"]&&o["a"])?n:Object,"function"===typeof(a="undefined"!==typeof p["a"]&&p["a"])?a:Object])],b)},cba1:function(t,e,i){"use strict";i.d(e,"a",(function(){return l}));i("6b54"),i("2397");var n=i("d225"),a=i("b0b4"),s=i("308d"),d=i("6bb5"),c=i("4e2b"),o=i("de46");function r(t){return function(){var e,i=Object(d["a"])(t);if(u()){var n=Object(d["a"])(this).constructor;e=Reflect.construct(i,arguments,n)}else e=i.apply(this,arguments);return Object(s["a"])(this,e)}}function u(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}var l=function(t){Object(c["a"])(i,t);var e=r(i);function i(){return Object(n["a"])(this,i),e.apply(this,arguments)}return Object(a["a"])(i,[{key:"getBodyTemplateInfo",value:function(){return this.http.get("/v1/plugin/body/brand_items")}},{key:"addBodyIndicator",value:function(t){return this.http.post("/v1/plugin/body/item_add",{params:t})}},{key:"editBodyIndicator",value:function(t){return this.http.post("/v1/plugin/body/item_edit",{params:t})}},{key:"deleteBodyIndicator",value:function(t){return this.http.post("/v1/plugin/body/item_del",{params:{id:t}})}},{key:"moveBodyIndicators",value:function(t){return this.http.post("/v1/plugin/body/item_move",{params:t})}},{key:"getBodyAlbumTemplate",value:function(){return this.http.get("/v1/plugin/body/brand_album_template")}},{key:"addBodyAlbumTemplate",value:function(t){return this.http.post("/v1/plugin/body/image_template_add",{params:{img_name:t}})}},{key:"deleteBodyAlbumTemplate",value:function(t){return this.http.post("/v1/plugin/body/image_template_del",{params:{id:t}})}}]),i}(o["a"])},dbc8:function(t,e,i){"use strict";i.r(e);var n,a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:t.b()},[i("st-panel-layout",{class:t.b("container")},[i("MarkteingPluginTitle",{attrs:{type:t.TYPE.PHYSICALTEST}}),i("div",{class:t.b("main")},[i("div",{class:t.b("bodyImg")},[i("div",{class:t.b("bodyImg-header")},[i("div",{class:t.b("bodyImg-header__title")},[t._v("体态拍照设置")]),i("div",{class:t.b("bodyImg-header__subtitle")},[t._v("\n            您可以新增更多的体态图，最多支持6张\n          ")])]),i("div",{class:t.b("bodyImg-content")},[i("div",{class:t.b("bodyImg-content-tag")},[t._l(t.labels,(function(e){return i("div",{key:e.id},[i("a-tooltip",{key:e.id,attrs:{title:e.img_name}},[i("a-tag",{key:e.img_name,class:t.b("bodyImg-content-tag-item"),attrs:{closable:!e.is_must},on:{close:function(i){return t.handleRemoveTag(e)}}},[t._v("\n                  "+t._s(e.img_name)+"\n                ")])],1)],1)})),t.labels.length<6?i("a",{directives:[{name:"modal-link",rawName:"v-modal-link",value:{name:"brand-app-physical-test-new-label",props:{},on:{success:t.handleReGetBodyImg}},expression:"{\n                name: 'brand-app-physical-test-new-label',\n                props: {},\n                on: { success: handleReGetBodyImg }\n              }"}]},[i("a-tag",{staticStyle:{background:"#fff",borderStyle:"dashed"}},[i("a-icon",{staticStyle:{"margin-right":"8px"},attrs:{type:"plus"}}),t._v("\n                新增体态图\n              ")],1)],1):t._e()],2)])]),i("div",{class:t.b("physicalTestTable")},[i("div",{class:t.b("physicalTestTable-header")},[i("div",{class:t.b("physicalTestTable-header__title")},[t._v("\n            基础体测数据\n          ")]),i("div",{class:t.b("physicalTestTable-header__subtitle")},[t._v("\n            已创建体测数据（"+t._s(t.indicatorsNum)+"/50）\n          ")])]),i("st-form-table",[i("thead",[i("tr",[i("th",{staticStyle:{width:"5%"}}),i("th",{staticStyle:{width:"29%"}},[t._v("数据名称")]),i("th",{staticStyle:{width:"29%"}},[t._v("单位")]),i("th",{staticStyle:{width:"11%"}},[t._v("展示状态")]),i("th",{staticStyle:{width:"11%"}},[t._v("是否必填")]),i("th",{staticStyle:{width:"15%"}},[t._v("操作")])])]),i("draggable",{attrs:{animation:200,move:t.checkMove,draggable:".canDrag",tag:"tbody"},on:{start:t.dragStart,end:t.dragEnd,change:t.handleSortIndicator},model:{value:t.indicators,callback:function(e){t.indicators=e},expression:"indicators"}},[i("tr",[i("td",{staticClass:"st-form-table__add",attrs:{colspan:"12"}},[i("st-button",{attrs:{type:"dashed",icon:"add",block:"",disabled:t.addButtonDisable},on:{click:t.handleAddIndicator}},[t._v("\n                  新增基础数据\n                ")])],1)]),t._l(t.canEditIndicator,(function(e,n){return i("tr",{key:n,class:{canDrag:!t.statusAdd&&!t.statusEdit}},[i("td",[i("st-icon",{attrs:{type:"tuozhuai"}})],1),i("td",[e.isEdit&&!e.is_default?i("div",[i("a-input",{staticStyle:{width:"160px"},attrs:{placeholder:"请输入名称(必填)",maxLength:8},model:{value:t.editIndicator.item_name,callback:function(e){t.$set(t.editIndicator,"item_name",e)},expression:"editIndicator.item_name"}})],1):i("div",[t._v(t._s(e.item_name))])]),i("td",[e.isEdit&&!e.is_default?i("div",[i("a-input",{staticStyle:{width:"160px"},attrs:{placeholder:"请输入单位(必填)",maxLength:8},model:{value:t.editIndicator.item_unit,callback:function(e){t.$set(t.editIndicator,"item_unit",e)},expression:"editIndicator.item_unit"}})],1):i("div",[t._v(t._s(e.item_unit))])]),i("td",[e.isEdit?i("div",[i("st-switch",{model:{value:t.editIndicator.is_show,callback:function(e){t.$set(t.editIndicator,"is_show",e)},expression:"editIndicator.is_show"}})],1):i("div",[i("st-text",{attrs:{status:{success:1===e.is_show,default:0===e.is_show}}},[t._v("\n                    "+t._s(e.show_text[e.is_show])+"\n                  ")])],1)]),i("td",[e.isEdit?i("div",[i("st-switch",{model:{value:t.editIndicator.is_must,callback:function(e){t.$set(t.editIndicator,"is_must",e)},expression:"editIndicator.is_must"}})],1):i("div",[t._v(t._s(e.must_text[e.is_must]))])]),i("td",[e.isEdit?i("div",[i("st-table-actions",[t.statusAdd?t._e():i("a",{on:{click:function(i){return t.handleSaveIndicators(e)}}},[t._v("\n                      保存\n                    ")]),t.statusAdd?i("a",{on:{click:function(i){return t.handleSaveIndicators(e)}}},[t._v("\n                      确认\n                    ")]):t._e(),i("a",{on:{click:function(i){return t.handleCancelEditIndicators(e)}}},[t._v("\n                      取消\n                    ")])])],1):i("div",[i("st-table-actions",[e.can_edit&&t.auth.edit?i("a",{on:{click:function(i){return t.handleEditIndicator(e)}}},[t._v("\n                      编辑\n                    ")]):t._e(),!e.is_default&&t.auth.del?i("a",[i("st-popconfirm",{attrs:{title:"一旦删除则无法恢复，确认删除"},on:{confirm:function(i){return t.handleRemoveIndicators(e)}}},[t._v("\n                        删除\n                      ")])],1):t._e()])],1)])])}))],2)],1)],1)])],1)],1)},s=[],d=(i("310e"),i("aa7d")),c=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("st-modal",{attrs:{title:"新增体态图",width:"500px"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[i("st-form",{attrs:{form:t.form,labelAuto:""}},[i("st-form-item",{attrs:{label:"体态图名称",required:""}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:t.decorators.inputLabel,expression:"decorators.inputLabel"}],attrs:{max:"10"}})],1)],1),i("template",{slot:"footer"},[i("st-button",{on:{click:function(e){t.show=!1}}},[t._v("取消")]),i("st-button",{attrs:{loading:t.loading.addBodyLabel,type:"primary"},on:{click:t.onSubmit}},[t._v("\n      确定\n    ")])],1)],2)},o=[],r=i("d225"),u=i("b0b4"),l=i("9ab4"),h=i("0cd5"),p=i("cba1"),b=i("df29"),m=function(){function t(e){Object(r["a"])(this,t),this.pluginBodyApi=e,this.loading$=new b["d"]({})}return Object(u["a"])(t,[{key:"addBodyLabel",value:function(t){return this.pluginBodyApi.addBodyAlbumTemplate(t)}}]),t}();Object(l["b"])([Object(b["c"])(),Object(l["d"])("design:type",Function),Object(l["d"])("design:paramtypes",[String]),Object(l["d"])("design:returntype",void 0)],m.prototype,"addBodyLabel",null),m=Object(l["b"])([Object(h["b"])(),Object(l["d"])("design:paramtypes",["function"===typeof(n="undefined"!==typeof p["a"]&&p["a"])?n:Object])],m);var y=i("2527"),v=function(t){var e=new y["a"];return{inputLabel:{rules:[{required:!0,pattern:e.CN_EN_NUM("1-8"),message:"请输入1~8个英文，中文字符"}]}}},f={serviceInject:function(){return{Service:m}},rxState:function(){return{loading:this.Service.loading$}},components:{},name:"newLable",props:{selectedRowData:{type:Array}},data:function(){var t=this.$stForm.create(),e=t.decorators(v);return{form:t,decorators:e,show:!1}},methods:{onSubmit:function(){var t=this;this.form.validate().then((function(e){t.Service.addBodyLabel(e.inputLabel).subscribe((function(e){t.show=!1,t.$emit("success",!0)}))}))}}},_=f,g=i("2877"),I=Object(g["a"])(_,c,o,!1,null,null,null),B=I.exports,w=i("5845"),S=i("5c8a"),k=i("6c94"),T={name:"brand-app-physical-test",bem:{b:"brand-app-physical-test"},components:{MarkteingPluginTitle:d["a"]},modals:{BrandAppPhysicalTestNewLabel:B},serviceInject:function(){return{physicalTestService:w["ListService"]}},rxState:function(){return{loading:this.physicalTestService.loading$,indicators:this.physicalTestService.list$,labels:this.physicalTestService.labelList$,auth:this.physicalTestService.auth$}},props:{},data:function(){return{statusAdd:!1,statusEdit:!1,tags:[],editIndicator:{},TYPE:k["a"]}},computed:{indicatorsNum:function(){var t=this.indicators.length;return 1===t?0:this.statusAdd?t-2:t-1},canEditIndicator:function(){return this.indicators.slice(1)},addButtonDisable:function(){return!this.auth.add||this.statusAdd}},methods:{checkMove:function(t){var e=t.draggedContext,i=t.relatedContext,n=(t.dragged,t.from,t.to,e.element),a=i.element;return!this.statusAdd&&(!this.statusEdit&&((!a||!a.isAdd)&&!n.isAdd))},resetIndicator:function(){this.editIndicator={item_name:"",item_unit:"",is_show:1,is_must:1,isEdit:!0}},handleReGetBodyImg:function(){this.$message.success({content:"体态图新增成功"}),this.physicalTestService.getBodyImgLableList().subscribe()},handleRemoveTag:function(t){var e=this;this.physicalTestService.removePhysicalTestBodyImgLabel(t.id).subscribe((function(t){e.$message.success({content:"体态图删除成功"}),e.physicalTestService.getBodyImgLableList().subscribe()}))},handleAddIndicator:function(){this.indicators=this.indicators.map((function(t){return t.isEdit=!1,t})),this.statusAdd=!0,this.resetIndicator(),this.indicators.splice(1,0,this.editIndicator)},handleEditIndicator:function(t){this.statusEdit=!0,this.statusAdd&&(this.indicators.splice(1,1),this.statusAdd=!1),this.editIndicator=Object(S["a"])(t),this.indicators=this.indicators.map((function(e){return e.id===t.id?e.isEdit=!0:e.isEdit=!1,e}))},handleRemoveIndicators:function(t){var e=this;this.physicalTestService.deleteBodyIndicator(t.id).subscribe((function(i){e.statusEdit=!1,e.indicators=e.indicators.filter((function(e){return e.id!==t.id}))}))},handleSaveIndicators:function(t){var e=this;this.statusAdd?this.physicalTestService.addBodyIndicator({item_name:t.item_name,item_unit:t.item_unit,is_show:t.is_show,is_must:t.is_must}).subscribe((function(t){e.statusEdit=!1,e.statusAdd=!1,e.resetIndicator(),e.physicalTestService.getBodyIndicatorList().subscribe()})):this.physicalTestService.editBodyIndicator({id:this.editIndicator.id,item_name:this.editIndicator.item_name,item_unit:this.editIndicator.item_unit,is_show:this.editIndicator.is_show,is_must:this.editIndicator.is_must}).subscribe((function(i){e.statusEdit=!1,e.indicators=e.indicators.map((function(i){return i.id===t.id&&(e.editIndicator.isEdit=!1,i=e.editIndicator,e.resetIndicator()),i}))}))},handleCancelEditIndicators:function(t){this.statusEdit=!1,this.statusAdd?(this.indicators.splice(1,1),this.resetIndicator(),this.statusAdd=!1):this.indicators=this.indicators.map((function(t){return t.isEdit=!1,t}))},handleSortIndicator:function(){var t=this.indicators.slice(1);this.physicalTestService.moveBodyIndicators({item_sort:t}).subscribe()},dragStart:function(t){t.item.classList.add("dragged")},dragEnd:function(t){t.item.classList.remove("dragged")}}},A=T,j=Object(g["a"])(A,a,s,!1,null,"af2fcde8",null);e["default"]=j.exports}}]);