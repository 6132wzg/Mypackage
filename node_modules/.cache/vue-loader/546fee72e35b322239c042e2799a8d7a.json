{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhigang/Desktop/styd/web/src/views/pages/brand/marketing/plugin/invitation/index/components#/invitation-bg-radio.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/pages/brand/marketing/plugin/invitation/index/components#/invitation-bg-radio.vue","mtime":1600926556133},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js","mtime":1591062572376}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport StImageUpload from '@/views/components/image-upload#/image-upload.vue'\nimport { cloneDeep } from 'lodash-es'\nimport { UserService } from '@/services/user.service'\nlet className = [\n  'first custom',\n  'second custom',\n  'third custom',\n  'fourth custom'\n]\nexport default {\n  name: 'StInvitationBgRadio',\n  bem: {\n    cardRadio: 'invitation-bg-radio'\n  },\n  components: {\n    StImageUpload\n  },\n  serviceInject() {\n    return {\n      userService: UserService\n    }\n  },\n  rxState() {\n    return {\n      pluginEnums: this.userService.getOptions$('plugin.invite_poster')\n    }\n  },\n  created() {\n    this.init()\n  },\n  computed: {\n    bgIndex() {\n      return this.radioIndex === 0 ? 4 : this.radioIndex - 1\n    },\n    cardBgList() {\n      let arr = []\n      this.invite_poster.forEach((item, index) => {\n        item.className = className[index]\n        item.index = ++index\n        arr.push(item)\n      })\n      return arr\n    }\n  },\n  data() {\n    return {\n      // 截图参数对象\n      cropperModal: {\n        cropper: {\n          aspectRatio: 3 / 5\n        }\n      },\n      maskOptions: {\n        flag: true,\n        width: 750,\n        height: 1334,\n        maskUrl:\n          'https://styd-saas-test.oss-cn-shanghai.aliyuncs.com/image/default/bg-invitation-4.png'\n      },\n      invite_poster: this.pluginEnums,\n      // 备份\n      list: [],\n      // radioIndex\n      radioIndex: 1,\n      // 选择的cardBg\n      cardBg: {\n        image_id: 0,\n        image_key: this.pluginEnums[0].image_key,\n        image_url: this.pluginEnums[0].image_url,\n        index: 1\n      },\n      // 自定义cardBg\n      customCardBg: {\n        image_id: 0,\n        image_key: '',\n        image_url: '',\n        index: 0\n      },\n      // 回显的自定义bg\n      fileList: []\n    }\n  },\n  watch: {\n    value: {\n      handler(newVal) {\n        this.setdata(newVal)\n      },\n      deep: true\n    },\n    radioIndex(newVal) {\n      if (newVal === 0) {\n        this.cardBg = cloneDeep(this.customCardBg)\n      } else {\n        let i = newVal\n        --i\n        this.cardBg = cloneDeep(this.invite_poster[i])\n        this.cardBg.index = newVal\n      }\n      this.$emit('input', this.cardBg)\n      this.$emit('change', this.cardBg)\n    }\n  },\n  props: {\n    value: {\n      type: Object,\n      default() {\n        return {\n          image_id: 0,\n          image_key: '',\n          image_url: '',\n          index: 1\n        }\n      }\n    }\n  },\n  mounted() {\n    this.setRadioColor()\n  },\n  methods: {\n    init() {\n      this.list = cloneDeep(this.invite_poster)\n      this.setdata(this.value)\n    },\n    setRadioColor() {\n      let innerHTML = ''\n      this.cardBgList.forEach(i => {\n        innerHTML += `\n          .invitation-bg-radio .${i.className.split('custom')[0]}\n          .ant-radio-inner::after {\n            background-color: ${i.color};\n          }\n        `\n      })\n      let style = document.createElement('style')\n      style.innerHTML = innerHTML\n      document.head.appendChild(style)\n    },\n    setdata(data) {\n      this.radioIndex = data.index\n      if (data.index === 0) {\n        this.customCardBg = cloneDeep(data)\n        if (data.image_url) {\n          this.fileList = [\n            {\n              image_id: data.image_id,\n              image_url: data.image_url\n            }\n          ]\n        }\n      } else {\n        this.invite_poster = cloneDeep(this.list)\n        let i = data.index\n        --i\n        this.invite_poster[i].image_id = data.image_id\n      }\n    },\n    imageUploadChange(fileList) {\n      if (fileList.length) {\n        this.customCardBg = {\n          image_id: fileList[0].image_id,\n          image_key: fileList[0].image_key,\n          image_url: fileList[0].image_url,\n          image_host: fileList[0].image_host,\n          index: 0\n        }\n      } else {\n        this.fileList = []\n        this.customCardBg = {\n          image_id: 0,\n          image_key: '',\n          image_url: '',\n          image_host: '',\n          index: 0\n        }\n      }\n      this.cardBg = cloneDeep(this.customCardBg)\n      this.$emit('input', this.cardBg)\n      this.$emit('change', this.cardBg)\n    }\n  }\n}\n",{"version":3,"sources":["invitation-bg-radio.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"invitation-bg-radio.vue","sourceRoot":"src/views/pages/brand/marketing/plugin/invitation/index/components#","sourcesContent":["<template>\n  <div :class=\"cardRadio()\">\n    <a-radio-group v-model=\"radioIndex\">\n      <a-radio\n        v-for=\"(i, index) in cardBgList\"\n        :class=\"i.className\"\n        :key=\"index\"\n        :value=\"i.index\"\n      ></a-radio>\n      <a-radio :value=\"0\">自定义背景</a-radio>\n    </a-radio-group>\n    <div :class=\"cardRadio('image')\">\n      <img\n        v-if=\"radioIndex !== 0 && cardBgList[bgIndex]\"\n        v-viewer=\"{ url: 'data-src', toolbar: false }\"\n        :src=\"cardBgList[bgIndex].image_url | imgFilter({ w: 192, h: 108 })\"\n        :data-src=\"cardBgList[bgIndex].image_url | imgFilter({ w: 1000 })\"\n        width=\"192\"\n        height=\"108\"\n        alt=\"邀请有礼背景\"\n      />\n      <div v-else :class=\"cardRadio('upload')\">\n        <st-image-upload\n          @change=\"imageUploadChange\"\n          width=\"192px\"\n          height=\"108px\"\n          :cropperModal=\"cropperModal\"\n          :maskOptions=\"maskOptions\"\n          :list=\"fileList\"\n          :sizeLimit=\"2\"\n          placeholder=\"上传照片\"\n        ></st-image-upload>\n        <div :class=\"cardRadio('describe')\">\n          <p>\n            <span>1.</span>\n            <span>\n              图片格式必须为：png,bmp,jpeg,jpg,gif,建议使用png格\n              式图片，以保存最佳效果\n            </span>\n          </p>\n          <p>\n            <span>2.</span>\n            <span>建议尺寸为750像素X1334像素， 不可大于2M</span>\n          </p>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n<script>\nimport StImageUpload from '@/views/components/image-upload#/image-upload.vue'\nimport { cloneDeep } from 'lodash-es'\nimport { UserService } from '@/services/user.service'\nlet className = [\n  'first custom',\n  'second custom',\n  'third custom',\n  'fourth custom'\n]\nexport default {\n  name: 'StInvitationBgRadio',\n  bem: {\n    cardRadio: 'invitation-bg-radio'\n  },\n  components: {\n    StImageUpload\n  },\n  serviceInject() {\n    return {\n      userService: UserService\n    }\n  },\n  rxState() {\n    return {\n      pluginEnums: this.userService.getOptions$('plugin.invite_poster')\n    }\n  },\n  created() {\n    this.init()\n  },\n  computed: {\n    bgIndex() {\n      return this.radioIndex === 0 ? 4 : this.radioIndex - 1\n    },\n    cardBgList() {\n      let arr = []\n      this.invite_poster.forEach((item, index) => {\n        item.className = className[index]\n        item.index = ++index\n        arr.push(item)\n      })\n      return arr\n    }\n  },\n  data() {\n    return {\n      // 截图参数对象\n      cropperModal: {\n        cropper: {\n          aspectRatio: 3 / 5\n        }\n      },\n      maskOptions: {\n        flag: true,\n        width: 750,\n        height: 1334,\n        maskUrl:\n          'https://styd-saas-test.oss-cn-shanghai.aliyuncs.com/image/default/bg-invitation-4.png'\n      },\n      invite_poster: this.pluginEnums,\n      // 备份\n      list: [],\n      // radioIndex\n      radioIndex: 1,\n      // 选择的cardBg\n      cardBg: {\n        image_id: 0,\n        image_key: this.pluginEnums[0].image_key,\n        image_url: this.pluginEnums[0].image_url,\n        index: 1\n      },\n      // 自定义cardBg\n      customCardBg: {\n        image_id: 0,\n        image_key: '',\n        image_url: '',\n        index: 0\n      },\n      // 回显的自定义bg\n      fileList: []\n    }\n  },\n  watch: {\n    value: {\n      handler(newVal) {\n        this.setdata(newVal)\n      },\n      deep: true\n    },\n    radioIndex(newVal) {\n      if (newVal === 0) {\n        this.cardBg = cloneDeep(this.customCardBg)\n      } else {\n        let i = newVal\n        --i\n        this.cardBg = cloneDeep(this.invite_poster[i])\n        this.cardBg.index = newVal\n      }\n      this.$emit('input', this.cardBg)\n      this.$emit('change', this.cardBg)\n    }\n  },\n  props: {\n    value: {\n      type: Object,\n      default() {\n        return {\n          image_id: 0,\n          image_key: '',\n          image_url: '',\n          index: 1\n        }\n      }\n    }\n  },\n  mounted() {\n    this.setRadioColor()\n  },\n  methods: {\n    init() {\n      this.list = cloneDeep(this.invite_poster)\n      this.setdata(this.value)\n    },\n    setRadioColor() {\n      let innerHTML = ''\n      this.cardBgList.forEach(i => {\n        innerHTML += `\n          .invitation-bg-radio .${i.className.split('custom')[0]}\n          .ant-radio-inner::after {\n            background-color: ${i.color};\n          }\n        `\n      })\n      let style = document.createElement('style')\n      style.innerHTML = innerHTML\n      document.head.appendChild(style)\n    },\n    setdata(data) {\n      this.radioIndex = data.index\n      if (data.index === 0) {\n        this.customCardBg = cloneDeep(data)\n        if (data.image_url) {\n          this.fileList = [\n            {\n              image_id: data.image_id,\n              image_url: data.image_url\n            }\n          ]\n        }\n      } else {\n        this.invite_poster = cloneDeep(this.list)\n        let i = data.index\n        --i\n        this.invite_poster[i].image_id = data.image_id\n      }\n    },\n    imageUploadChange(fileList) {\n      if (fileList.length) {\n        this.customCardBg = {\n          image_id: fileList[0].image_id,\n          image_key: fileList[0].image_key,\n          image_url: fileList[0].image_url,\n          image_host: fileList[0].image_host,\n          index: 0\n        }\n      } else {\n        this.fileList = []\n        this.customCardBg = {\n          image_id: 0,\n          image_key: '',\n          image_url: '',\n          image_host: '',\n          index: 0\n        }\n      }\n      this.cardBg = cloneDeep(this.customCardBg)\n      this.$emit('input', this.cardBg)\n      this.$emit('change', this.cardBg)\n    }\n  }\n}\n</script>\n"]}]}