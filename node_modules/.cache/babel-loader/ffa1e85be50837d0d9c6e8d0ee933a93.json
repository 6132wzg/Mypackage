{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js!/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhigang/Desktop/styd/web/src/views/pages/brand/marketing/plugin/crowd/add.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/pages/brand/marketing/plugin/crowd/add.vue","mtime":1600926556126},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js","mtime":1591062572376}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/es7.object.values\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.object.keys\";\nimport _toConsumableArray from \"/Users/wangzhigang/Desktop/styd/web/node_modules/@babel/runtime-corejs2/helpers/esm/toConsumableArray\";\nimport \"core-js/modules/es6.regexp.to-string\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport base_info from \"./components#/basic-data\";\nimport base_sex from \"./components#/base_sex\";\nimport base_age from \"./components#/base_age\";\nimport base_birthday from \"./components#/base_birthday\";\nimport regTime from \"./components#/reg-time\";\nimport affiliatedStore from \"./components#/affiliated-store\";\nimport availableIntegral from \"./components#/available-integral\";\nimport availableCoupons from \"./components#/available-coupons\";\nimport accumulateIntegrals from \"./components#/accumulate-integrals\";\nimport membershipExpires from \"./components#/membership-expires\";\nimport cardRemainingNumber from \"./components#/card-remaining-number\";\nimport privateClassNum from \"./components#/private-class-num\";\nimport cardMount from \"./components#/card-mount\";\nimport admissionTimes from \"./components#/admission-times\";\nimport lastAdmissionTime from \"./components#/last-admission-time\";\nimport sourceMode from \"./components#/source-mode.vue\";\nimport inductionTime from \"./components#/induction-time.vue\";\nimport { AddService } from \"./add.service\";\nimport routes from '@/router/routes';\nimport { MessageService } from '@/services/message.service';\nexport default {\n  serviceInject: function serviceInject() {\n    return {\n      addService: AddService,\n      messageService: MessageService\n    };\n  },\n  rxState: function rxState() {\n    return {\n      loading: this.addService.loading$,\n      crowdInfo: this.addService.crowdInfo$\n    };\n  },\n  components: {\n    'basic-data': base_info,\n    // 左侧组件\n    'reg-time': regTime,\n    // 注册时间\n    'source-mode': sourceMode,\n    // 来源方式\n    'induction-time': inductionTime,\n    // 入会时间\n    base_birthday: base_birthday,\n    // 生日\n    base_sex: base_sex,\n    // 性别\n    base_age: base_age,\n    // 年龄\n    'affiliated-store': affiliatedStore,\n    // 所属门店\n    'available-integral': availableIntegral,\n    // 可用积分\n    'available-coupons': availableCoupons,\n    // 可用优惠劵\n    'accumulate-integrals': accumulateIntegrals,\n    // 累计获取积分\n    'membership-expires': membershipExpires,\n    // 会员卡即将到期\n    'card-remaining-number': cardRemainingNumber,\n    // 会员卡剩余次数\n    'admission-times': admissionTimes,\n    // 入场次数\n    'private-class-num': privateClassNum,\n    // 私教课剩余次数\n    cardMount: cardMount,\n    // 储值卡剩余金额\n    lastAdmissionTime: lastAdmissionTime // 最后一次入场时间\n\n  },\n  data: function data() {\n    var self = this;\n    return {\n      // 状态锁\n      flag: true,\n      form: this.$form.createForm(this),\n      basicInfoRuleList: {\n        crowd_name: ['crowd_name', {\n          rules: [{\n            required: true,\n            message: '不超过20字，且不包含“/”'\n          }]\n        }]\n      },\n      selectData: {\n        // 基础资料\n        base_info: {\n          title: '基础资料',\n          value: ['性别', 'base_age', '所属门店', '生日'],\n          selectionData: [],\n          width: 108\n        },\n        // 注册来源\n        source_info: {\n          title: '注册来源',\n          value: ['注册时间', '来源方式', '入会时间'],\n          selectionData: [],\n          width: 108\n        },\n        deal_info: {\n          title: '交易信息',\n          value: [\"\".concat(this.$c('member_card'), \"\\u5373\\u5C06\\u5230\\u671F\"), \"\".concat(this.$c('member_card'), \"\\u5269\\u4F59\\u6B21\\u6570\"), '私教课剩余次数', '储值卡剩余金额'],\n          selectionData: [],\n          width: 170\n        },\n        active_info: {\n          title: '活跃信息',\n          value: ['入场次数', '最后一次入场时间'],\n          selectionData: [],\n          width: 170\n        },\n        discount_info: {\n          title: '优惠奖励',\n          value: ['可用积分', '可用优惠券', '累计获得积分'],\n          selectionData: [],\n          width: 108\n        },\n        arrData: [],\n        getData: {\n          crowd_name: '',\n          base_sex: {\n            name: '',\n            value: ''\n          },\n          base_age: {\n            min: '',\n            max: ''\n          },\n          base_birthday: {\n            min: '',\n            max: '',\n            name: '',\n            value: ''\n          },\n          shop: [],\n          register_time: {\n            min: '',\n            max: '',\n            name: '',\n            value: ''\n          },\n          source_channel: [],\n          member_time: {\n            min: '',\n            max: ''\n          },\n          available_scores: {\n            min: '',\n            max: ''\n          },\n          available_coupon_number: {\n            min: '',\n            max: ''\n          },\n          sum_scores: {\n            min: '',\n            max: ''\n          },\n          member_expiring: {\n            min: '',\n            max: ''\n          },\n          member_card_remain_times: {\n            min: '',\n            max: ''\n          },\n          personal_course_remain_times: {\n            min: '',\n            max: ''\n          },\n          deposit_remain_money: {\n            min: '',\n            max: ''\n          },\n          remain_enter_times: {\n            select_time: {\n              min: '',\n              max: ''\n            },\n            remain_times: {\n              min: '',\n              max: ''\n            }\n          },\n          final_enter_time: {\n            min: '',\n            max: ''\n          }\n        },\n        info: {}\n      }\n    };\n  },\n  created: function created() {\n    if (this.$searchQuery.id) {\n      this.getCrowdBrand(this.$searchQuery.id);\n    }\n\n    this.getFilterData();\n  },\n  filters: {\n    componentFun: function componentFun(value) {\n      var obj = {\n        base_sex: 'base_sex',\n        base_age: 'base_age',\n        base_birthday: 'base_birthday',\n        shop: 'affiliated-store',\n        register_time: 'reg-time',\n        source_channel: 'source-mode',\n        member_time: 'induction-time',\n        available_scores: 'available-integral',\n        available_coupon_number: 'available-coupons',\n        sum_scores: 'accumulate-integrals',\n        member_expiring: 'membership-expires',\n        member_card_remain_times: 'card-remaining-number',\n        personal_course_remain_times: 'private-class-num',\n        deposit_remain_money: 'cardMount',\n        remain_enter_times: 'admission-times',\n        final_enter_time: 'lastAdmissionTime'\n      };\n      return obj[value];\n    }\n  },\n  methods: {\n    getCrowdBrand: function getCrowdBrand(id) {\n      var _this = this;\n\n      this.addService.getCrowdBrand(id).subscribe(function (status) {\n        _this.selectData.arrData = status.info.array_index;\n        _this.selectData.getData.crowd_name = status.info.crowd_name;\n        status.info.array_index.map(function (item) {\n          _this.selectData.getData[item] = status.info[item];\n        });\n      });\n    },\n    conserve: function conserve() {\n      var _this2 = this;\n\n      this.form.validateFields(function (err, values) {\n        if (!err) {\n          var obj = {};\n\n          _this2.selectData.arrData.map(function (item) {\n            obj[item] = _this2.selectData.getData[item];\n          });\n\n          var arrKey = [],\n              arrValue = [];\n\n          _this2.selectData.arrData.map(function (item) {\n            obj[item] = _this2.selectData.getData[item];\n\n            if (Object.prototype.toString.call(_this2.selectData.getData[item]).slice(8, -1) === 'Object') {\n              arrKey.push.apply(arrKey, _toConsumableArray(Object.keys(_this2.selectData.getData[item])));\n              arrValue.push.apply(arrValue, _toConsumableArray(Object.values(_this2.selectData.getData[item])));\n            } else {\n              arrKey.push(item);\n              arrValue.push(_this2.selectData.getData[item]);\n            }\n          });\n\n          obj.crowd_name = values.basicInfoRuleList.crowd_name;\n          obj.array_index = _this2.selectData.arrData;\n\n          if (obj.remain_enter_times && (!obj.remain_enter_times.remain_times.min || !obj.remain_enter_times.select_time.min && !obj.remain_enter_times.select_time.name)) {\n            _this2.messageService.error({\n              content: '入场次数和时间范围必填!'\n            });\n\n            return;\n          }\n\n          if (_this2.$searchQuery.id) {\n            _this2.addService.updateCrowdBrandCrowd(_this2.$searchQuery.id, obj).subscribe(function (status) {\n              _this2.$router.push({\n                name: 'brand-marketing-plugin-crowd-index'\n              });\n            });\n          } else {\n            _this2.addService.setCrowdBrandField(obj).subscribe(function (status) {\n              _this2.$router.push({\n                name: 'brand-marketing-plugin-crowd-index'\n              });\n            });\n          }\n        }\n      });\n    },\n    getFilterData: function getFilterData() {\n      var _this3 = this;\n\n      Object.keys(this.crowdInfo.info).map(function (item) {\n        Object.assign(_this3.selectData.info, _this3.crowdInfo.info[item].value);\n        _this3.selectData[item].value = Object.keys(_this3.crowdInfo.info[item].value);\n      });\n    },\n    deleteIcon: function deleteIcon(data, item) {\n      var k = Object.keys(data);\n      k.map(function (item1) {\n        if (item1 !== 'arrData' && item1 !== 'getData' && item1 !== 'info') {\n          if (data[item1].selectionData.indexOf(item) >= 0) {\n            data[item1].selectionData.splice(data[item1].selectionData.indexOf(item), 1);\n          }\n        } else {\n          if (data.arrData.indexOf(item) >= 0) {\n            data.arrData.splice(data.arrData.indexOf(item), 1);\n          }\n        }\n      });\n    },\n    save: function save(e) {\n      e.preventDefault();\n      this.form.validateFields(function (err, values) {\n        console.log(err, values);\n      });\n    },\n    // 校验格式\n    physicalId: function physicalId(rule, value, callback) {\n      if (value === undefined || value === '') {\n        // eslint-disable-next-line\n        callback('请填写人群名称');\n      } else if (value && /\\//.test(value)) {\n        // eslint-disable-next-line\n        callback('输入的人群名称格式错误，请重新输入');\n      } else {\n        // eslint-disable-next-line\n        callback();\n      }\n    }\n  },\n  mounted: function mounted() {},\n  watch: {\n    selectData: {\n      handler: function handler() {\n        var k = Object.keys(this.selectData);\n        var arr = [];\n        arr.push.apply(arr, _toConsumableArray(this.selectData.arrData));\n\n        if (arr.length >= 5) {\n          this.flag = false;\n        } else {\n          this.flag = true;\n        }\n      },\n      deep: true\n    }\n  }\n};",{"version":3,"sources":["add.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"shop-member-crowd-add\">\n    <div class=\"shop-member-crowd-add__box\">\n      <div class=\"shop-member-crowd-add__left\">\n        <st-t2>人群定义维度</st-t2>\n        <div class=\"shop-member-crowd-add__tip\">\n          单个人群最多可新增5个条件\n        </div>\n        <basic-data v-model=\"selectData\" :flag=\"flag\"></basic-data>\n      </div>\n      <div class=\"shop-member-crowd-add__right\">\n        <st-t2 class=\"mg-b24\">\n          {{ $searchQuery.id ? '编辑人群' : '新增人群' }}\n        </st-t2>\n        <st-form\n          :form=\"form\"\n          @submit=\"save\"\n          style=\"height:72px\"\n          labelWidth=\"75px\"\n        >\n          <st-form-item label=\"人群名称\" required>\n            <a-input\n              style=\"width:404px\"\n              placeholder=\"不超过20字，且不包含“/”\"\n              maxlength=\"20\"\n              v-decorator=\"[\n                'basicInfoRuleList.crowd_name',\n                {\n                  initialValue: selectData.getData.crowd_name,\n                  rules: [{ validator: physicalId }]\n                }\n              ]\"\n            />\n          </st-form-item>\n        </st-form>\n        <div class=\"shop-member-crowd-add__right-condition\">\n          <div>创建的人群同时满足以下条件</div>\n\n          <div class=\"shop-member-crowd-add__right-tip\">\n            已选\n            <label>{{ selectData.arrData.length }}/5</label>\n            个条件\n          </div>\n        </div>\n        <template v-for=\"(item, index) in selectData.arrData\">\n          <div\n            :key=\"index\"\n            class=\"shop-member-crowd-add__right-condition-box\"\n            v-if=\"selectData.arrData.indexOf(item) >= 0\"\n          >\n            <div\n              class=\"shop-member-crowd-add__right-condition-box-delete\"\n              @click=\"deleteIcon(selectData, item)\"\n            >\n              <st-icon\n                type=\"delete\"\n                class=\"shop-member-crowd-add__icon\"\n                color=\"#ff5e41\"\n              />\n            </div>\n            <component\n              v-bind:is=\"item | componentFun\"\n              v-model=\"selectData\"\n            ></component>\n          </div>\n        </template>\n        <div class=\"shop-member-crowd-add__button-group\">\n          <st-button\n            v-if=\"selectData.arrData.length\"\n            type=\"primary\"\n            class=\"mg-l16 shop-member-crowd-add__button-save\"\n            @click=\"conserve\"\n            :loading=\"\n              loading.setCrowdBrandField || loading.updateCrowdBrandCrowd\n            \"\n          >\n            保存\n          </st-button>\n          <st-button\n            v-else\n            disabled\n            type=\"primary\"\n            class=\"mg-l16 shop-member-crowd-add__button-save\"\n          >\n            保存\n          </st-button>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n<script>\nimport base_info from './components#/basic-data'\nimport base_sex from './components#/base_sex'\nimport base_age from './components#/base_age'\nimport base_birthday from './components#/base_birthday'\nimport regTime from './components#/reg-time'\nimport affiliatedStore from './components#/affiliated-store'\nimport availableIntegral from './components#/available-integral'\nimport availableCoupons from './components#/available-coupons'\nimport accumulateIntegrals from './components#/accumulate-integrals'\nimport membershipExpires from './components#/membership-expires'\nimport cardRemainingNumber from './components#/card-remaining-number'\nimport privateClassNum from './components#/private-class-num'\nimport cardMount from './components#/card-mount'\nimport admissionTimes from './components#/admission-times'\nimport lastAdmissionTime from './components#/last-admission-time'\nimport sourceMode from './components#/source-mode.vue'\nimport inductionTime from './components#/induction-time.vue'\nimport { AddService } from './add.service'\nimport routes from '@/router/routes'\nimport { MessageService } from '@/services/message.service'\nexport default {\n  serviceInject() {\n    return {\n      addService: AddService,\n      messageService: MessageService\n    }\n  },\n  rxState() {\n    return {\n      loading: this.addService.loading$,\n      crowdInfo: this.addService.crowdInfo$\n    }\n  },\n  components: {\n    'basic-data': base_info, // 左侧组件\n    'reg-time': regTime, // 注册时间\n    'source-mode': sourceMode, // 来源方式\n    'induction-time': inductionTime, // 入会时间\n    base_birthday: base_birthday, // 生日\n    base_sex: base_sex, // 性别\n    base_age: base_age, // 年龄\n    'affiliated-store': affiliatedStore, // 所属门店\n    'available-integral': availableIntegral, // 可用积分\n    'available-coupons': availableCoupons, // 可用优惠劵\n    'accumulate-integrals': accumulateIntegrals, // 累计获取积分\n    'membership-expires': membershipExpires, // 会员卡即将到期\n    'card-remaining-number': cardRemainingNumber, // 会员卡剩余次数\n    'admission-times': admissionTimes, // 入场次数\n    'private-class-num': privateClassNum, // 私教课剩余次数\n    cardMount, // 储值卡剩余金额\n    lastAdmissionTime // 最后一次入场时间\n  },\n  data() {\n    let self = this\n    return {\n      // 状态锁\n      flag: true,\n      form: this.$form.createForm(this),\n      basicInfoRuleList: {\n        crowd_name: [\n          'crowd_name',\n          {\n            rules: [\n              {\n                required: true,\n                message: '不超过20字，且不包含“/”'\n              }\n            ]\n          }\n        ]\n      },\n      selectData: {\n        // 基础资料\n        base_info: {\n          title: '基础资料',\n          value: ['性别', 'base_age', '所属门店', '生日'],\n          selectionData: [],\n          width: 108\n        },\n        // 注册来源\n        source_info: {\n          title: '注册来源',\n          value: ['注册时间', '来源方式', '入会时间'],\n          selectionData: [],\n          width: 108\n        },\n\n        deal_info: {\n          title: '交易信息',\n          value: [\n            `${this.$c('member_card')}即将到期`,\n            `${this.$c('member_card')}剩余次数`,\n            '私教课剩余次数',\n            '储值卡剩余金额'\n          ],\n          selectionData: [],\n          width: 170\n        },\n        active_info: {\n          title: '活跃信息',\n          value: ['入场次数', '最后一次入场时间'],\n          selectionData: [],\n          width: 170\n        },\n        discount_info: {\n          title: '优惠奖励',\n          value: ['可用积分', '可用优惠券', '累计获得积分'],\n          selectionData: [],\n          width: 108\n        },\n        arrData: [],\n        getData: {\n          crowd_name: '',\n          base_sex: {\n            name: '',\n            value: ''\n          },\n          base_age: {\n            min: '',\n            max: ''\n          },\n          base_birthday: {\n            min: '',\n            max: '',\n            name: '',\n            value: ''\n          },\n          shop: [],\n          register_time: {\n            min: '',\n            max: '',\n            name: '',\n            value: ''\n          },\n          source_channel: [],\n          member_time: {\n            min: '',\n            max: ''\n          },\n          available_scores: {\n            min: '',\n            max: ''\n          },\n          available_coupon_number: {\n            min: '',\n            max: ''\n          },\n          sum_scores: {\n            min: '',\n            max: ''\n          },\n          member_expiring: {\n            min: '',\n            max: ''\n          },\n          member_card_remain_times: {\n            min: '',\n            max: ''\n          },\n          personal_course_remain_times: {\n            min: '',\n            max: ''\n          },\n          deposit_remain_money: {\n            min: '',\n            max: ''\n          },\n          remain_enter_times: {\n            select_time: {\n              min: '',\n              max: ''\n            },\n            remain_times: {\n              min: '',\n              max: ''\n            }\n          },\n          final_enter_time: {\n            min: '',\n            max: ''\n          }\n        },\n        info: {}\n      }\n    }\n  },\n  created() {\n    if (this.$searchQuery.id) {\n      this.getCrowdBrand(this.$searchQuery.id)\n    }\n    this.getFilterData()\n  },\n  filters: {\n    componentFun(value) {\n      let obj = {\n        base_sex: 'base_sex',\n        base_age: 'base_age',\n        base_birthday: 'base_birthday',\n        shop: 'affiliated-store',\n        register_time: 'reg-time',\n        source_channel: 'source-mode',\n        member_time: 'induction-time',\n        available_scores: 'available-integral',\n        available_coupon_number: 'available-coupons',\n        sum_scores: 'accumulate-integrals',\n        member_expiring: 'membership-expires',\n        member_card_remain_times: 'card-remaining-number',\n        personal_course_remain_times: 'private-class-num',\n        deposit_remain_money: 'cardMount',\n        remain_enter_times: 'admission-times',\n        final_enter_time: 'lastAdmissionTime'\n      }\n      return obj[value]\n    }\n  },\n  methods: {\n    getCrowdBrand(id) {\n      this.addService.getCrowdBrand(id).subscribe(status => {\n        this.selectData.arrData = status.info.array_index\n        this.selectData.getData.crowd_name = status.info.crowd_name\n        status.info.array_index.map(item => {\n          this.selectData.getData[item] = status.info[item]\n        })\n      })\n    },\n    conserve() {\n      this.form.validateFields((err, values) => {\n        if (!err) {\n          let obj = {}\n          this.selectData.arrData.map(item => {\n            obj[item] = this.selectData.getData[item]\n          })\n          let [arrKey, arrValue] = [[], []]\n          this.selectData.arrData.map(item => {\n            obj[item] = this.selectData.getData[item]\n            if (\n              Object.prototype.toString\n                .call(this.selectData.getData[item])\n                .slice(8, -1) === 'Object'\n            ) {\n              arrKey.push(...Object.keys(this.selectData.getData[item]))\n              arrValue.push(...Object.values(this.selectData.getData[item]))\n            } else {\n              arrKey.push(item)\n              arrValue.push(this.selectData.getData[item])\n            }\n          })\n          obj.crowd_name = values.basicInfoRuleList.crowd_name\n          obj.array_index = this.selectData.arrData\n          if (\n            obj.remain_enter_times &&\n            (!obj.remain_enter_times.remain_times.min ||\n              (!obj.remain_enter_times.select_time.min &&\n                !obj.remain_enter_times.select_time.name))\n          ) {\n            this.messageService.error({\n              content: '入场次数和时间范围必填!'\n            })\n            return\n          }\n          if (this.$searchQuery.id) {\n            this.addService\n              .updateCrowdBrandCrowd(this.$searchQuery.id, obj)\n              .subscribe(status => {\n                this.$router.push({\n                  name: 'brand-marketing-plugin-crowd-index'\n                })\n              })\n          } else {\n            this.addService.setCrowdBrandField(obj).subscribe(status => {\n              this.$router.push({ name: 'brand-marketing-plugin-crowd-index' })\n            })\n          }\n        }\n      })\n    },\n    getFilterData() {\n      Object.keys(this.crowdInfo.info).map(item => {\n        Object.assign(this.selectData.info, this.crowdInfo.info[item].value)\n        this.selectData[item].value = Object.keys(\n          this.crowdInfo.info[item].value\n        )\n      })\n    },\n    deleteIcon(data, item) {\n      let k = Object.keys(data)\n      k.map(item1 => {\n        if (item1 !== 'arrData' && item1 !== 'getData' && item1 !== 'info') {\n          if (data[item1].selectionData.indexOf(item) >= 0) {\n            data[item1].selectionData.splice(\n              data[item1].selectionData.indexOf(item),\n              1\n            )\n          }\n        } else {\n          if (data.arrData.indexOf(item) >= 0) {\n            data.arrData.splice(data.arrData.indexOf(item), 1)\n          }\n        }\n      })\n    },\n    save(e) {\n      e.preventDefault()\n      this.form.validateFields((err, values) => {\n        console.log(err, values)\n      })\n    },\n    // 校验格式\n    physicalId(rule, value, callback) {\n      if (value === undefined || value === '') {\n        // eslint-disable-next-line\n        callback('请填写人群名称')\n      } else if (value && /\\//.test(value)) {\n        // eslint-disable-next-line\n        callback('输入的人群名称格式错误，请重新输入')\n      } else {\n        // eslint-disable-next-line\n        callback()\n      }\n    }\n  },\n  mounted() {},\n  watch: {\n    selectData: {\n      handler() {\n        let k = Object.keys(this.selectData)\n        let arr = []\n        arr.push(...this.selectData.arrData)\n        if (arr.length >= 5) {\n          this.flag = false\n        } else {\n          this.flag = true\n        }\n      },\n      deep: true\n    }\n  }\n}\n</script>\n"],"sourceRoot":"src/views/pages/brand/marketing/plugin/crowd"}]}