{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhigang/Desktop/styd/web/src/views/pages/shop/reception/components#/shortcut-model.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/pages/shop/reception/components#/shortcut-model.vue","mtime":1600926556423},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js","mtime":1591062572376}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { ShortcutModelService } from './shortcut-model.service'\n\nimport FrontAddReserve from '@/views/biz-modals/front/add-reserve'\nimport ShopFinanceGatheringEarnestAdd from '@/views/biz-modals/shop/finance/gathering/earnest/add'\nimport ShopReceptionEditShortcuts from '@/views/biz-modals/shop/reception/edit-shortcuts'\nimport SoldTransaction from '@/views/biz-components/sold/transaction'\nimport { cloneDeep } from 'lodash-es'\nimport { PRODUCT_TYPE } from '@/constants/sold/transaction'\nexport default {\n  name: '',\n\n  bem: {},\n\n  components: { SoldTransaction },\n\n  serviceInject() {\n    return {\n      shortcutModelService: ShortcutModelService\n    }\n  },\n  rxState() {\n    return {\n      auth: this.shortcutModelService.auth$,\n      list: this.shortcutModelService.list$,\n      loading: this.shortcutModelService.loading$\n    }\n  },\n\n  modals: {\n    FrontAddReserve,\n    ShopFinanceGatheringEarnestAdd,\n    ShopReceptionEditShortcuts\n  },\n\n  props: {},\n\n  data() {\n    return {\n      // 根据权限处理后的快捷操作列表\n      filterShortcutList: [],\n      PRODUCT_TYPE\n    }\n  },\n\n  computed: {\n    isAllShow() {\n      const len = this.list.length\n      const fLen = this.filterShortcutList.length\n      return len === fLen\n    }\n  },\n\n  async: {},\n\n  mounted() {\n    this.getShortCutList()\n  },\n\n  methods: {\n    getShortCutList() {\n      this.shortcutModelService.getIcons().subscribe(res => {\n        this.formatShortcutList()\n      })\n    },\n    handleRemoveModels(id) {\n      let icons = this.list.map(i => {\n        if (i.id === id) i.is_show = 0\n        return i\n      })\n      console.log('icons', icons)\n      this.shortcutModelService\n        .setIcons({\n          icons\n        })\n        .subscribe(res => {\n          this.show = false\n          this.getShortCutList()\n        })\n    },\n    // 快捷操作\n    onShortcut(data) {\n      if (data === 'reserveAdd' || data === 'earnestAdd') {\n        switch (data) {\n          case 'reserveAdd':\n            this.$modalRouter.push({\n              name: 'front-add-reserve',\n              on: {\n                success: result => {\n                  this.$router.reload()\n                }\n              }\n            })\n            break\n          case 'earnestAdd':\n            this.$modalRouter.push({\n              name: 'shop-finance-gathering-earnest-add',\n              props: {},\n              on: {\n                success: res => {\n                  this.$router.reload()\n                  this.$refs.soldTransaction.payCallBack(\n                    res.orderId,\n                    '',\n                    res.type,\n                    res\n                  )\n                }\n              }\n            })\n            break\n        }\n      } else {\n        let typeMap = {\n          memberBill: this.PRODUCT_TYPE.MEMBER_CARD,\n          depositBill: this.PRODUCT_TYPE.DEPOSIT_CARD,\n          personalBill: this.PRODUCT_TYPE.PERSONAL_COURSE,\n          packageBill: this.PRODUCT_TYPE.PACKAGE,\n          smallCourseBill: this.PRODUCT_TYPE.SMALL_COURSE,\n          cabinetBill: this.PRODUCT_TYPE.CABINET\n        }\n        this.$refs.soldTransaction.onTransaction('', typeMap[data])\n      }\n    },\n    formatShortcutList() {\n      console.log('list', this.list)\n      this.filterShortcutList = this.list\n        .map(i => {\n          i.auth = this.auth[i.id]\n          return i\n        })\n        .filter(i => i.auth && i.is_show)\n    },\n    onAddShortcut() {\n      this.$modalRouter.push({\n        name: 'shop-reception-edit-shortcuts',\n        on: {\n          done: () => {\n            this.getShortCutList()\n          }\n        }\n      })\n    }\n  }\n}\n",{"version":3,"sources":["shortcut-model.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwCA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"shortcut-model.vue","sourceRoot":"src/views/pages/shop/reception/components#","sourcesContent":["<template>\n  <div class=\"shortcut-models-wrapper\">\n    <div class=\"shortcut-models\">\n      <div\n        class=\"shortcut-model\"\n        @click=\"onShortcut(item.id)\"\n        :disabled=\"!item.auth\"\n        :key=\"index\"\n        v-for=\"(item, index) in filterShortcutList\"\n      >\n        <div class=\"shortcut-model-icon\" :class=\"item.icon\"></div>\n        <div class=\"shortcut-model-label\">{{ item.name }}</div>\n        <div\n          class=\"shortcut-model-del\"\n          v-if=\"auth.modelSetting\"\n          @click.stop=\"handleRemoveModels(item.id)\"\n        >\n          <st-icon type=\"modal-close\" size=\"12px\"></st-icon>\n        </div>\n      </div>\n      <div\n        class=\"shortcut-model add\"\n        @click=\"onAddShortcut\"\n        v-if=\"!isAllShow && auth.modelSetting\"\n      >\n        <div class=\"icon\">\n          <a-icon\n            type=\"plus-circle\"\n            theme=\"filled\"\n            :style=\"{ fontSize: '36px', color: '#9BACB9' }\"\n          />\n        </div>\n        <div class=\"tip\">新增常用功能</div>\n      </div>\n    </div>\n    <sold-transaction ref=\"soldTransaction\"></sold-transaction>\n  </div>\n</template>\n\n<script>\nimport { ShortcutModelService } from './shortcut-model.service'\n\nimport FrontAddReserve from '@/views/biz-modals/front/add-reserve'\nimport ShopFinanceGatheringEarnestAdd from '@/views/biz-modals/shop/finance/gathering/earnest/add'\nimport ShopReceptionEditShortcuts from '@/views/biz-modals/shop/reception/edit-shortcuts'\nimport SoldTransaction from '@/views/biz-components/sold/transaction'\nimport { cloneDeep } from 'lodash-es'\nimport { PRODUCT_TYPE } from '@/constants/sold/transaction'\nexport default {\n  name: '',\n\n  bem: {},\n\n  components: { SoldTransaction },\n\n  serviceInject() {\n    return {\n      shortcutModelService: ShortcutModelService\n    }\n  },\n  rxState() {\n    return {\n      auth: this.shortcutModelService.auth$,\n      list: this.shortcutModelService.list$,\n      loading: this.shortcutModelService.loading$\n    }\n  },\n\n  modals: {\n    FrontAddReserve,\n    ShopFinanceGatheringEarnestAdd,\n    ShopReceptionEditShortcuts\n  },\n\n  props: {},\n\n  data() {\n    return {\n      // 根据权限处理后的快捷操作列表\n      filterShortcutList: [],\n      PRODUCT_TYPE\n    }\n  },\n\n  computed: {\n    isAllShow() {\n      const len = this.list.length\n      const fLen = this.filterShortcutList.length\n      return len === fLen\n    }\n  },\n\n  async: {},\n\n  mounted() {\n    this.getShortCutList()\n  },\n\n  methods: {\n    getShortCutList() {\n      this.shortcutModelService.getIcons().subscribe(res => {\n        this.formatShortcutList()\n      })\n    },\n    handleRemoveModels(id) {\n      let icons = this.list.map(i => {\n        if (i.id === id) i.is_show = 0\n        return i\n      })\n      console.log('icons', icons)\n      this.shortcutModelService\n        .setIcons({\n          icons\n        })\n        .subscribe(res => {\n          this.show = false\n          this.getShortCutList()\n        })\n    },\n    // 快捷操作\n    onShortcut(data) {\n      if (data === 'reserveAdd' || data === 'earnestAdd') {\n        switch (data) {\n          case 'reserveAdd':\n            this.$modalRouter.push({\n              name: 'front-add-reserve',\n              on: {\n                success: result => {\n                  this.$router.reload()\n                }\n              }\n            })\n            break\n          case 'earnestAdd':\n            this.$modalRouter.push({\n              name: 'shop-finance-gathering-earnest-add',\n              props: {},\n              on: {\n                success: res => {\n                  this.$router.reload()\n                  this.$refs.soldTransaction.payCallBack(\n                    res.orderId,\n                    '',\n                    res.type,\n                    res\n                  )\n                }\n              }\n            })\n            break\n        }\n      } else {\n        let typeMap = {\n          memberBill: this.PRODUCT_TYPE.MEMBER_CARD,\n          depositBill: this.PRODUCT_TYPE.DEPOSIT_CARD,\n          personalBill: this.PRODUCT_TYPE.PERSONAL_COURSE,\n          packageBill: this.PRODUCT_TYPE.PACKAGE,\n          smallCourseBill: this.PRODUCT_TYPE.SMALL_COURSE,\n          cabinetBill: this.PRODUCT_TYPE.CABINET\n        }\n        this.$refs.soldTransaction.onTransaction('', typeMap[data])\n      }\n    },\n    formatShortcutList() {\n      console.log('list', this.list)\n      this.filterShortcutList = this.list\n        .map(i => {\n          i.auth = this.auth[i.id]\n          return i\n        })\n        .filter(i => i.auth && i.is_show)\n    },\n    onAddShortcut() {\n      this.$modalRouter.push({\n        name: 'shop-reception-edit-shortcuts',\n        on: {\n          done: () => {\n            this.getShortCutList()\n          }\n        }\n      })\n    }\n  }\n}\n</script>\n\n<style lang=\"less\" scoped></style>\n"]}]}