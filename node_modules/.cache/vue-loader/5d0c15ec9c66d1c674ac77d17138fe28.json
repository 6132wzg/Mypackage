{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhigang/Desktop/styd/web/src/views/pages/brand/setting/general/brand.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/pages/brand/setting/general/brand.vue","mtime":1596188219696},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js","mtime":1591062572376}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { BrandService } from './brand.service'\nimport { MessageService } from '@/services/message.service'\nimport { UserService } from '@/services/user.service'\nimport { PatternService } from '@/services/pattern.service'\nimport StImageUpload from '@/views/biz-components/st/image-upload/image-upload.vue'\nexport default {\n  bem: {\n    b: 'page-setting-brand'\n  },\n  components: {\n    StImageUpload\n  },\n  serviceInject() {\n    return {\n      brandService: BrandService,\n      messageService: MessageService,\n      userService: UserService,\n      pattern: PatternService\n    }\n  },\n  rxState() {\n    return {\n      brandInfo: this.brandService.brandInfo$,\n      systemInfo: this.brandService.systemInfo$,\n      loading: this.brandService.loading$\n    }\n  },\n  data() {\n    return {\n      imageList: []\n    }\n  },\n  computed: {\n    isEdit() {\n      return this.$searchQuery.type === 'edit'\n    }\n  },\n  created() {\n    this.imageList = [this.brandInfo.image]\n  },\n  methods: {\n    onEdit() {\n      this.$router.push({\n        query: {\n          type: 'edit'\n        }\n      })\n    },\n    onSave() {\n      if (!this.inputCheck()) {\n        return\n      }\n      const info = this.brandInfo\n      const params = {\n        brand_name: info.brand_name,\n        album_id: info.album_id,\n        image: this.imageList[0],\n        description: info.description\n      }\n      this.brandService.update(params).subscribe(() => {\n        this.messageService.success({\n          content: '保存成功'\n        })\n        this.$router.push({})\n        this.userService.fetchStaffInfo().subscribe()\n      })\n    },\n    onCancel() {\n      this.$router.push({\n        query: {}\n      })\n    },\n    onImgChange(list) {\n      this.imageList = list\n    },\n    inputCheck() {\n      const info = this.brandInfo\n      const brandName = info.brand_name\n      const { pattern } = this\n      if (!pattern.CN_EN_NUM_SPACE('1-20').test(brandName)) {\n        this.tip('品牌名称支持20字以内的中英文和数字')\n        return false\n      }\n      return true\n    },\n    tip(msg) {\n      this.messageService.error({\n        content: msg\n      })\n    }\n  }\n}\n",{"version":3,"sources":["brand.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"brand.vue","sourceRoot":"src/views/pages/brand/setting/general","sourcesContent":["<template>\n  <st-panel app>\n    <a-row>\n      <a-col :span=\"12\">\n        <st-t2>品牌信息</st-t2>\n      </a-col>\n      <a-col v-if=\"!isEdit\" :span=\"12\" class=\"ta-r\">\n        <st-info-action icon=\"edit\" text=\"编辑\" @click=\"onEdit\" />\n      </a-col>\n    </a-row>\n    <div class=\"mg-t24\" :class=\"b()\">\n      <div :class=\"b('logo-wrap')\">\n        <st-image-upload\n          v-if=\"isEdit\"\n          width=\"90px\"\n          height=\"90px\"\n          :list=\"imageList\"\n          placeholder=\"上传logo\"\n          :cropperModal=\"{ title: '标题', cropper: { aspectRatio: 1 / 1 } }\"\n          @change=\"onImgChange\"\n        ></st-image-upload>\n        <span v-else v-viewer=\"{ url: 'data-src', toolbar: false }\">\n          <img\n            :class=\"b('logo')\"\n            :data-src=\"brandInfo.image.image_url | imgFilter({ w: 1000 })\"\n            :src=\"brandInfo.image.image_url | imgFilter({ w: 180, h: 180 })\"\n            alt=\"brand logo\"\n          />\n        </span>\n      </div>\n      <div>\n        <div>\n          <h2>\n            <a-input\n              v-if=\"isEdit\"\n              v-model=\"brandInfo.brand_name\"\n              maxlength=\"20\"\n            />\n            <span v-else>{{ brandInfo.brand_name }}</span>\n            <!-- <span v-if=\"brandInfo.is_authentic\" :class=\"b('certify-status')\">\n              <i class=\"st-icon-certified\"></i>\n              <span :class=\"b('certify-des')\">已认证</span>\n            </span> -->\n          </h2>\n        </div>\n        <div>\n          <span>\n            <st-icon type=\"contact\" :class=\"b('icon')\" />\n            {{ brandInfo.contact }}\n          </span>\n          <span :class=\"b('mobile')\">\n            <st-icon :class=\"b('icon')\" type=\"mobile\" />\n            {{ brandInfo.mobile }}\n          </span>\n        </div>\n      </div>\n    </div>\n    <a-row :gutter=\"24\" class=\"mg-t24\">\n      <a-col :lg=\"12\">\n        <st-info :isWeakenLabel=\"true\">\n          <st-info-item label=\"当前系统版本\">\n            {{ systemInfo.brand_type | enumFilter('setting.brand_type') }}\n          </st-info-item>\n          <st-info-item label=\"首次开通时间\">\n            {{ systemInfo.first_time }}\n          </st-info-item>\n          <st-info-item label=\"品牌介绍\"></st-info-item>\n        </st-info>\n      </a-col>\n      <a-col :lg=\"12\">\n        <st-info :isWeakenLabel=\"true\">\n          <st-info-item label=\"有效门店数\">\n            共{{ systemInfo.valid_shop_number }}家门店\n          </st-info-item>\n          <st-info-item label=\"有效插件数\">\n            共{{ systemInfo.valid_plugin_number }}个插件\n          </st-info-item>\n        </st-info>\n      </a-col>\n    </a-row>\n    <div v-if=\"isEdit\">\n      <st-textarea\n        v-model=\"brandInfo.description\"\n        maxlength=\"300\"\n        placeholder=\"这个人很懒，什么都没留下\"\n      />\n      <div class=\"mg-t24 ta-c\">\n        <st-button type=\"primary\" @click=\"onSave\" :loading=\"loading.update\">\n          确定\n        </st-button>\n        <st-button class=\"mg-l8\" @click=\"onCancel\">取消</st-button>\n      </div>\n    </div>\n    <st-container\n      v-if=\"!isEdit && brandInfo.description\"\n      type=\"2\"\n      :class=\"b('text-style')\"\n      v-html=\"brandInfo.description\"\n    ></st-container>\n  </st-panel>\n</template>\n<script>\nimport { BrandService } from './brand.service'\nimport { MessageService } from '@/services/message.service'\nimport { UserService } from '@/services/user.service'\nimport { PatternService } from '@/services/pattern.service'\nimport StImageUpload from '@/views/biz-components/st/image-upload/image-upload.vue'\nexport default {\n  bem: {\n    b: 'page-setting-brand'\n  },\n  components: {\n    StImageUpload\n  },\n  serviceInject() {\n    return {\n      brandService: BrandService,\n      messageService: MessageService,\n      userService: UserService,\n      pattern: PatternService\n    }\n  },\n  rxState() {\n    return {\n      brandInfo: this.brandService.brandInfo$,\n      systemInfo: this.brandService.systemInfo$,\n      loading: this.brandService.loading$\n    }\n  },\n  data() {\n    return {\n      imageList: []\n    }\n  },\n  computed: {\n    isEdit() {\n      return this.$searchQuery.type === 'edit'\n    }\n  },\n  created() {\n    this.imageList = [this.brandInfo.image]\n  },\n  methods: {\n    onEdit() {\n      this.$router.push({\n        query: {\n          type: 'edit'\n        }\n      })\n    },\n    onSave() {\n      if (!this.inputCheck()) {\n        return\n      }\n      const info = this.brandInfo\n      const params = {\n        brand_name: info.brand_name,\n        album_id: info.album_id,\n        image: this.imageList[0],\n        description: info.description\n      }\n      this.brandService.update(params).subscribe(() => {\n        this.messageService.success({\n          content: '保存成功'\n        })\n        this.$router.push({})\n        this.userService.fetchStaffInfo().subscribe()\n      })\n    },\n    onCancel() {\n      this.$router.push({\n        query: {}\n      })\n    },\n    onImgChange(list) {\n      this.imageList = list\n    },\n    inputCheck() {\n      const info = this.brandInfo\n      const brandName = info.brand_name\n      const { pattern } = this\n      if (!pattern.CN_EN_NUM_SPACE('1-20').test(brandName)) {\n        this.tip('品牌名称支持20字以内的中英文和数字')\n        return false\n      }\n      return true\n    },\n    tip(msg) {\n      this.messageService.error({\n        content: msg\n      })\n    }\n  }\n}\n</script>\n"]}]}