{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhigang/Desktop/styd/web/src/views/fragments/shop/switch.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/fragments/shop/switch.vue","mtime":1591147717282},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js","mtime":1591062572376}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { fromEvent } from 'rxjs'\nimport { tap, debounceTime } from 'rxjs/operators'\nimport { MessageService } from '@/services/message.service'\nimport { SwitchService } from './switch.service'\nimport { UserService } from '@/services/user.service'\n\nexport default {\n  name: 'SwtichShopDrawer',\n  serviceProvider() {\n    return [SwitchService]\n  },\n  serviceInject() {\n    return {\n      messageService: MessageService,\n      switchService: SwitchService,\n      userService: UserService\n    }\n  },\n  rxState() {\n    const { shopList$, loading$ } = this.switchService\n    return {\n      shopList: shopList$,\n      loading: loading$,\n      shop: this.userService.shop$,\n      isShop: this.userService.isShop$\n    }\n  },\n  data() {\n    return {\n      /**\n       * Drawer 是否可见\n       */\n      visible: false,\n      /**\n       * 是否显示右上角的关闭按钮\n       */\n      closable: false,\n      keyword: '',\n      list: [],\n      isShowShadow: false\n    }\n  },\n  props: {\n    value: {\n      type: Boolean,\n      default: false\n    }\n  },\n  watch: {\n    value(val) {\n      this.visible = val\n      this.onSearch()\n    }\n  },\n  computed: {\n    currentShopId() {\n      return this.shop.id\n    }\n  },\n  methods: {\n    onClose() {\n      this.visible = false\n      this.$emit('input', false)\n    },\n    onSwitchShop(shop) {\n      const params = {\n        shop_id: shop.shop_id\n      }\n      this.switchService.switchShop(params).subscribe(this.onClose)\n    },\n    switchBackToBrand() {\n      this.switchService.switchBackToBrand().subscribe(this.onClose)\n    },\n    onSearch() {\n      let { shopList } = this\n      const list = []\n      shopList.forEach(item => {\n        if (item.shop_name.toLowerCase().includes(this.keyword.toLowerCase())) {\n          list.push(item)\n        }\n      })\n      this.list = list\n    },\n    onChange() {\n      this.onSearch(this.keyword)\n    }\n  }\n}\n",{"version":3,"sources":["switch.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6DA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"switch.vue","sourceRoot":"src/views/fragments/shop","sourcesContent":["<template>\n  <a-drawer\n    placement=\"left\"\n    width=\"340\"\n    wrapClassName=\"drawer-switch-shop-wrap\"\n    :visible=\"visible\"\n    :closable=\"closable\"\n    @close=\"onClose\"\n  >\n    <div class=\"drawer-switch-shop\">\n      <section class=\"header\" :class=\"{ 'header--show': isShowShadow }\">\n        <div class=\"header__title\">\n          <st-t3>切换门店</st-t3>\n          <st-button\n            v-if=\"isShop\"\n            pill\n            type=\"primary\"\n            icon=\"entry\"\n            @click=\"switchBackToBrand\"\n          >\n            进入品牌\n          </st-button>\n        </div>\n        <st-input-search\n          placeholder=\"搜索门店\"\n          width=\"100%\"\n          v-model=\"keyword\"\n          @search=\"onSearch\"\n          @change=\"onChange\"\n        />\n      </section>\n      <section class=\"body\">\n        <a-spin :spinning=\"!!loading.switchShop\">\n          <ul class=\"drawer-shops\" v-if=\"list.length\">\n            <li\n              class=\"drawer-shops__item\"\n              :class=\"{ current: currentShopId === shop.shop_id }\"\n              v-for=\"(shop, index) in list\"\n              :key=\"index\"\n              @click=\"onSwitchShop(shop)\"\n            >\n              <img\n                class=\"drawer-shops__img\"\n                :src=\"shop.image_url | imgFilter({ w: 128, h: 128 })\"\n                alt=\"店招\"\n              />\n              <div>\n                <div class=\"drawer-shops__name\">{{ shop.shop_name }}</div>\n                <div class=\"drawer-shops__address\">{{ shop.address }}</div>\n                <div class=\"drawer-shops__tel\">{{ shop.link_phone }}</div>\n              </div>\n            </li>\n          </ul>\n          <st-no-data text=\"空空如也~\" v-else />\n        </a-spin>\n      </section>\n    </div>\n  </a-drawer>\n</template>\n\n<script>\nimport { fromEvent } from 'rxjs'\nimport { tap, debounceTime } from 'rxjs/operators'\nimport { MessageService } from '@/services/message.service'\nimport { SwitchService } from './switch.service'\nimport { UserService } from '@/services/user.service'\n\nexport default {\n  name: 'SwtichShopDrawer',\n  serviceProvider() {\n    return [SwitchService]\n  },\n  serviceInject() {\n    return {\n      messageService: MessageService,\n      switchService: SwitchService,\n      userService: UserService\n    }\n  },\n  rxState() {\n    const { shopList$, loading$ } = this.switchService\n    return {\n      shopList: shopList$,\n      loading: loading$,\n      shop: this.userService.shop$,\n      isShop: this.userService.isShop$\n    }\n  },\n  data() {\n    return {\n      /**\n       * Drawer 是否可见\n       */\n      visible: false,\n      /**\n       * 是否显示右上角的关闭按钮\n       */\n      closable: false,\n      keyword: '',\n      list: [],\n      isShowShadow: false\n    }\n  },\n  props: {\n    value: {\n      type: Boolean,\n      default: false\n    }\n  },\n  watch: {\n    value(val) {\n      this.visible = val\n      this.onSearch()\n    }\n  },\n  computed: {\n    currentShopId() {\n      return this.shop.id\n    }\n  },\n  methods: {\n    onClose() {\n      this.visible = false\n      this.$emit('input', false)\n    },\n    onSwitchShop(shop) {\n      const params = {\n        shop_id: shop.shop_id\n      }\n      this.switchService.switchShop(params).subscribe(this.onClose)\n    },\n    switchBackToBrand() {\n      this.switchService.switchBackToBrand().subscribe(this.onClose)\n    },\n    onSearch() {\n      let { shopList } = this\n      const list = []\n      shopList.forEach(item => {\n        if (item.shop_name.toLowerCase().includes(this.keyword.toLowerCase())) {\n          list.push(item)\n        }\n      })\n      this.list = list\n    },\n    onChange() {\n      this.onSearch(this.keyword)\n    }\n  }\n}\n</script>\n"]}]}