{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js!/Users/wangzhigang/Desktop/styd/web/src/views/pages/brand/setting/mina/components#/h5/form-components#/mixin.js","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/pages/brand/setting/mina/components#/h5/form-components#/mixin.js","mtime":1600926556208},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.number.constructor\";\nimport CustomDecorateProductTableSelect from '@/views/biz-modals/custom-decorate/product-table-select';\nimport { cloneDeep } from 'lodash';\nexport default {\n  modals: {\n    CustomDecorateProductTableSelect: CustomDecorateProductTableSelect\n  },\n  props: {\n    value: {\n      type: Object,\n      default: function _default() {\n        return {};\n      }\n    },\n\n    /**\n     * 模块名称\n     */\n    moduleName: {\n      type: String,\n      default: ''\n    },\n\n    /**\n     * 模块类型\n     */\n    moduleType: {\n      type: [Number, String],\n      default: 1\n    },\n\n    /**\n     * 门店 id\n     */\n    shopId: {\n      type: [Number, String],\n      default: 0\n    },\n\n    /**\n     * 限制数量\n     */\n    maxNum: {\n      type: Number,\n      default: 5\n    }\n  },\n  data: function data() {\n    return {\n      draggableOptions: {\n        filter: '.ignore-elements'\n      },\n      DATA_SOURCE_CUSTOM: 99,\n      flexibleKeys: ['show_direction', 'data_source', 'show_content'],\n      idKeyName: 'id',\n      customList: []\n    };\n  },\n  computed: {\n    isShowCustom: function isShowCustom() {\n      return this.data_source === this.DATA_SOURCE_CUSTOM;\n    },\n    selectedRowKeys: function selectedRowKeys() {\n      var _this = this;\n\n      var selectedRowKeys = [];\n      this.value.list.forEach(function (item) {\n        selectedRowKeys.push(item[_this.idKeyName]);\n      });\n      return selectedRowKeys;\n    }\n  },\n  watch: {\n    value: function value(val) {\n      this.init();\n    },\n    data_source: function data_source(newVal, oldVal) {\n      /**\n       * 缓存自定义数据\n       */\n      var DATA_SOURCE_CUSTOM = this.DATA_SOURCE_CUSTOM;\n\n      if (oldVal === DATA_SOURCE_CUSTOM) {\n        this.customList = this.value.list;\n      }\n\n      if (newVal === DATA_SOURCE_CUSTOM && oldVal !== null) {\n        this.value.list = this.customList;\n      }\n    }\n  },\n  created: function created() {\n    this.init();\n  },\n  methods: {\n    init: function init() {\n      var _this2 = this;\n\n      this.flexibleKeys.forEach(function (key) {\n        if (_this2.hasOwnProperty(key)) {\n          _this2[key] = _this2.value[key];\n        }\n      });\n    },\n    onDel: function onDel(index) {\n      this.value.list.splice(index, 1);\n      this.onChange();\n    },\n    onImageChange: function onImageChange(images, index) {\n      this.value.list[index].image = images.length ? images.pop() : [];\n      this.onChange();\n    },\n    onChange: function onChange() {\n      var _this3 = this;\n\n      var list = this.value.list;\n      var data = {\n        list: list\n      };\n      this.flexibleKeys.forEach(function (key) {\n        if (_this3.hasOwnProperty(key)) {\n          data[key] = _this3[key];\n        }\n      });\n      this.$emit('input', data);\n      this.$emit('change');\n      console.log('change', data);\n    },\n\n    /**\n     * 触发定义选择\n     */\n    onCustomAction: function onCustomAction() {\n      var _this4 = this;\n\n      var _this$modalConfig = this.modalConfig,\n          title = _this$modalConfig.title,\n          max = _this$modalConfig.max;\n      this.$modalRouter.push({\n        name: 'custom-decorate-product-table-select',\n        props: {\n          module_type: this.moduleType,\n          defaultSelectedRowKeys: this.selectedRowKeys,\n          defaultSelectedRows: this.value.list,\n          idKeyName: this.idKeyName,\n          shopId: this.shopId,\n          title: title,\n          max: max\n        },\n        on: {\n          complete: function complete(res) {\n            if (typeof _this4.adaptor === 'function') {\n              _this4.value.list = _this4.adaptor(res.selectedRows);\n\n              _this4.onChange();\n            }\n          }\n        }\n      });\n    },\n    selectedRowKeysFilter: function selectedRowKeysFilter() {\n      var _this5 = this;\n\n      var selectedRowKeys = [];\n      this.value.list.forEach(function (item) {\n        selectedRowKeys.push(item[_this5.idKeyName]);\n      });\n      return selectedRowKeys;\n    }\n  }\n};",{"version":3,"sources":["/Users/wangzhigang/Desktop/styd/web/src/views/pages/brand/setting/mina/components#/h5/form-components#/mixin.js"],"names":["CustomDecorateProductTableSelect","cloneDeep","modals","props","value","type","Object","default","moduleName","String","moduleType","Number","shopId","maxNum","data","draggableOptions","filter","DATA_SOURCE_CUSTOM","flexibleKeys","idKeyName","customList","computed","isShowCustom","data_source","selectedRowKeys","list","forEach","item","push","watch","val","init","newVal","oldVal","created","methods","key","hasOwnProperty","onDel","index","splice","onChange","onImageChange","images","image","length","pop","$emit","console","log","onCustomAction","modalConfig","title","max","$modalRouter","name","module_type","defaultSelectedRowKeys","defaultSelectedRows","on","complete","res","adaptor","selectedRows","selectedRowKeysFilter"],"mappings":"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","sourcesContent":["import CustomDecorateProductTableSelect from '@/views/biz-modals/custom-decorate/product-table-select'\nimport { cloneDeep } from 'lodash'\nexport default {\n  modals: {\n    CustomDecorateProductTableSelect\n  },\n  props: {\n    value: {\n      type: Object,\n      default() {\n        return {}\n      }\n    },\n    /**\n     * 模块名称\n     */\n    moduleName: {\n      type: String,\n      default: ''\n    },\n    /**\n     * 模块类型\n     */\n    moduleType: {\n      type: [Number, String],\n      default: 1\n    },\n    /**\n     * 门店 id\n     */\n    shopId: {\n      type: [Number, String],\n      default: 0\n    },\n    /**\n     * 限制数量\n     */\n    maxNum: {\n      type: Number,\n      default: 5\n    }\n  },\n  data() {\n    return {\n      draggableOptions: {\n        filter: '.ignore-elements'\n      },\n      DATA_SOURCE_CUSTOM: 99,\n      flexibleKeys: ['show_direction', 'data_source', 'show_content'],\n      idKeyName: 'id',\n      customList: []\n    }\n  },\n  computed: {\n    isShowCustom() {\n      return this.data_source === this.DATA_SOURCE_CUSTOM\n    },\n    selectedRowKeys() {\n      const selectedRowKeys = []\n      this.value.list.forEach(item => {\n        selectedRowKeys.push(item[this.idKeyName])\n      })\n      return selectedRowKeys\n    }\n  },\n  watch: {\n    value(val) {\n      this.init()\n    },\n    data_source(newVal, oldVal) {\n      /**\n       * 缓存自定义数据\n       */\n      const { DATA_SOURCE_CUSTOM } = this\n      if (oldVal === DATA_SOURCE_CUSTOM) {\n        this.customList = this.value.list\n      }\n      if (newVal === DATA_SOURCE_CUSTOM && oldVal !== null) {\n        this.value.list = this.customList\n      }\n    }\n  },\n  created() {\n    this.init()\n  },\n  methods: {\n    init() {\n      this.flexibleKeys.forEach(key => {\n        if (this.hasOwnProperty(key)) {\n          this[key] = this.value[key]\n        }\n      })\n    },\n    onDel(index) {\n      this.value.list.splice(index, 1)\n      this.onChange()\n    },\n    onImageChange(images, index) {\n      this.value.list[index].image = images.length ? images.pop() : []\n      this.onChange()\n    },\n    onChange() {\n      const { list } = this.value\n      const data = {\n        list\n      }\n      this.flexibleKeys.forEach(key => {\n        if (this.hasOwnProperty(key)) {\n          data[key] = this[key]\n        }\n      })\n      this.$emit('input', data)\n      this.$emit('change')\n      console.log('change', data)\n    },\n    /**\n     * 触发定义选择\n     */\n    onCustomAction() {\n      const { title, max } = this.modalConfig\n      this.$modalRouter.push({\n        name: 'custom-decorate-product-table-select',\n        props: {\n          module_type: this.moduleType,\n          defaultSelectedRowKeys: this.selectedRowKeys,\n          defaultSelectedRows: this.value.list,\n          idKeyName: this.idKeyName,\n          shopId: this.shopId,\n          title,\n          max\n        },\n        on: {\n          complete: res => {\n            if (typeof this.adaptor === 'function') {\n              this.value.list = this.adaptor(res.selectedRows)\n              this.onChange()\n            }\n          }\n        }\n      })\n    },\n    selectedRowKeysFilter() {\n      const selectedRowKeys = []\n      this.value.list.forEach(item => {\n        selectedRowKeys.push(item[this.idKeyName])\n      })\n      return selectedRowKeys\n    }\n  }\n}\n"]}]}