{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js!/Users/wangzhigang/Desktop/styd/web/node_modules/ts-loader/index.js??ref--13-2!/Users/wangzhigang/Desktop/styd/web/src/views/biz-modals/sold/course/package/upgrade.service.ts","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/biz-modals/sold/course/package/upgrade.service.ts","mtime":1600926555952},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/ts-loader/index.js","mtime":1591062571609}],"contextDependencies":[],"result":["import _classCallCheck from \"/Users/wangzhigang/Desktop/styd/web/node_modules/@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/wangzhigang/Desktop/styd/web/node_modules/@babel/runtime-corejs2/helpers/esm/createClass\";\n\nvar _a, _b, _c, _d, _e, _f, _g;\n\nimport { __decorate, __metadata } from \"tslib\";\nimport { CourseApi } from '@/api/v1/sold/course';\nimport { Injectable } from 'vue-service-app';\nimport { State, Effect } from 'rx-state';\nimport { TransactionApi, MemberCouponParams, TransactionPriceInput } from '@/api/v1/sold/transaction';\nimport { tap } from 'rxjs/operators';\nimport { ContractApi } from '@/api/v1/setting/contract';\nimport { UserService } from '@/services/user.service';\nimport { anyAll } from '@/operators';\nimport { MessageService } from '@/services/message.service';\n\nvar UpgradeService = /*#__PURE__*/function () {\n  function UpgradeService(contractApi, api, transactionApi, userService, msg) {\n    _classCallCheck(this, UpgradeService);\n\n    this.contractApi = contractApi;\n    this.api = api;\n    this.transactionApi = transactionApi;\n    this.userService = userService;\n    this.msg = msg;\n    this.loading$ = new State({});\n    this.info$ = new State({});\n    this.saleList$ = new State([]);\n    this.advanceList$ = new State([]);\n    this.couponList$ = new State([]);\n    this.newPackageInfo$ = new State({});\n    this.packageOptions$ = new State([]);\n    this.currentPrice$ = new State('0');\n    this.effectiveWayOptions$ = this.userService.getOptions$('package_course.effective_way');\n  }\n\n  _createClass(UpgradeService, [{\n    key: \"SET_INFO\",\n    value: function SET_INFO(info) {\n      info.pay_price = \"\".concat(info.pay_price, \"\\u5143\");\n      this.info$.commit(function () {\n        return info;\n      });\n    }\n  }, {\n    key: \"SET_UPGRADE_PACKAGE_LIST\",\n    value: function SET_UPGRADE_PACKAGE_LIST(list) {\n      this.packageOptions$.commit(function () {\n        return list.map(function (item) {\n          return {\n            product_name: item.course_name,\n            id: item.id\n          };\n        });\n      });\n    }\n  }, {\n    key: \"SET_NEW_PACKAGE_INFO\",\n    value: function SET_NEW_PACKAGE_INFO(info) {\n      info.courseInfo = info.is_limit ? info.is_total ? \"\\u56E2\\u4F53\\u8BFE&\\u79C1\\u6559\\u8BFE\".concat(info.total_times, \"\\u6B21\") : info.is_team && !info.is_personal ? \"\\u56E2\\u4F53\\u8BFE\".concat(info.team_times, \"\\u6B21\") : info.is_team && !info.is_personal ? \"\\u79C1\\u6559\\u8BFE\".concat(info.personal_times, \"\\u6B21\") : info.is_team && info.is_personal ? \"\\u56E2\\u4F53\\u8BFE\".concat(info.team_times, \"\\u6B21/\\u79C1\\u6559\\u8BFE\").concat(info.personal_times, \"\\u6B21\") : '' : '不限制';\n      info.shopList = info.shop_list.join(',');\n      this.newPackageInfo$.commit(function () {\n        return info;\n      });\n    }\n  }, {\n    key: \"REST_COUPONLIST\",\n    value: function REST_COUPONLIST() {\n      this.couponList$.commit(function () {\n        return [];\n      });\n    }\n  }, {\n    key: \"SET_SALE_LIST\",\n    value: function SET_SALE_LIST(list) {\n      list = list.map(function (item) {\n        var id = item.id,\n            staff_name = item.staff_name;\n        return {\n          value: id,\n          label: staff_name\n        };\n      });\n      this.saleList$.commit(function () {\n        return list;\n      });\n    }\n  }, {\n    key: \"getInfo\",\n    value: function getInfo(id) {\n      var _this = this;\n\n      return this.api.getPackageUpgradeInfo(id).pipe(tap(function (res) {\n        _this.SET_INFO(res.info);\n      }));\n    }\n  }, {\n    key: \"getUpgradePackageList\",\n    value: function getUpgradePackageList(query) {\n      var _this2 = this;\n\n      return this.api.getUpgradePackageList(query).pipe(tap(function (res) {\n        _this2.SET_UPGRADE_PACKAGE_LIST(res.list);\n      }));\n    }\n  }, {\n    key: \"getNewUpgradePackageInfo\",\n    value: function getNewUpgradePackageInfo(id) {\n      var _this3 = this;\n\n      return this.api.getNewUpgradePackageInfo(id).pipe(tap(function (res) {\n        _this3.SET_NEW_PACKAGE_INFO(res.info);\n      }));\n    }\n  }, {\n    key: \"getSaleList\",\n    value: function getSaleList() {\n      var _this4 = this;\n\n      return this.transactionApi.getTransactionSaleList().pipe(tap(function (res) {\n        _this4.SET_SALE_LIST(res.list);\n      }));\n    } // 优惠券列表\n\n  }, {\n    key: \"getCouponList\",\n    value: function getCouponList(query) {\n      return this.transactionApi.getTransactionCouponList(query, 'member');\n    }\n  }, {\n    key: \"resetCouponList\",\n    value: function resetCouponList() {\n      this.couponList$.commit(function () {\n        return [];\n      });\n    } // 定金\n\n  }, {\n    key: \"getAdvanceList\",\n    value: function getAdvanceList(id) {\n      var _this5 = this;\n\n      return this.transactionApi.getTransactionAdvanceList(id).pipe(tap(function (res) {\n        _this5.advanceList$.commit(function () {\n          return res.list;\n        });\n      }));\n    }\n  }, {\n    key: \"resetAdvanceList\",\n    value: function resetAdvanceList() {\n      this.advanceList$.commit(function () {\n        return [];\n      });\n    }\n  }, {\n    key: \"upgrade\",\n    value: function upgrade(params) {\n      var _this6 = this;\n\n      return this.api.upgradePackage(params).pipe(tap(function (res) {\n        _this6.msg.success({\n          content: '课程包升级成功'\n        });\n      }));\n    }\n  }, {\n    key: \"getPrice\",\n    value: function getPrice(params) {\n      var _this7 = this;\n\n      return this.transactionApi.getTransactionPrice(params).pipe(tap(function (res) {\n        _this7.currentPrice$.commit(function () {\n          return res.info.price;\n        });\n      }));\n    }\n  }, {\n    key: \"init\",\n    value: function init(id) {\n      return anyAll(this.getInfo(id), this.getSaleList());\n    }\n  }]);\n\n  return UpgradeService;\n}();\n\n__decorate([Effect(), __metadata(\"design:type\", Function), __metadata(\"design:paramtypes\", [Object]), __metadata(\"design:returntype\", void 0)], UpgradeService.prototype, \"getInfo\", null);\n\n__decorate([Effect(), __metadata(\"design:type\", Function), __metadata(\"design:paramtypes\", [Object]), __metadata(\"design:returntype\", void 0)], UpgradeService.prototype, \"getUpgradePackageList\", null);\n\n__decorate([Effect(), __metadata(\"design:type\", Function), __metadata(\"design:paramtypes\", [typeof (_a = typeof MemberCouponParams !== \"undefined\" && MemberCouponParams) === \"function\" ? _a : Object]), __metadata(\"design:returntype\", void 0)], UpgradeService.prototype, \"getCouponList\", null);\n\n__decorate([Effect(), __metadata(\"design:type\", Function), __metadata(\"design:paramtypes\", [Object]), __metadata(\"design:returntype\", void 0)], UpgradeService.prototype, \"getAdvanceList\", null);\n\n__decorate([Effect(), __metadata(\"design:type\", Function), __metadata(\"design:paramtypes\", [typeof (_b = typeof TransactionPriceInput !== \"undefined\" && TransactionPriceInput) === \"function\" ? _b : Object]), __metadata(\"design:returntype\", void 0)], UpgradeService.prototype, \"getPrice\", null);\n\nUpgradeService = __decorate([Injectable(), __metadata(\"design:paramtypes\", [typeof (_c = typeof ContractApi !== \"undefined\" && ContractApi) === \"function\" ? _c : Object, typeof (_d = typeof CourseApi !== \"undefined\" && CourseApi) === \"function\" ? _d : Object, typeof (_e = typeof TransactionApi !== \"undefined\" && TransactionApi) === \"function\" ? _e : Object, typeof (_f = typeof UserService !== \"undefined\" && UserService) === \"function\" ? _f : Object, typeof (_g = typeof MessageService !== \"undefined\" && MessageService) === \"function\" ? _g : Object])], UpgradeService);\nexport { UpgradeService };",{"version":3,"sources":["/Users/wangzhigang/Desktop/styd/web/src/views/biz-modals/sold/course/package/upgrade.service.ts"],"names":[],"mappings":"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","sourcesContent":["import { CourseApi } from '@/api/v1/sold/course'\nimport { Injectable } from 'vue-service-app'\nimport { State, Effect, Action } from 'rx-state'\nimport {\n  TransactionApi,\n  MemberCouponParams,\n  TransactionPriceInput\n} from '@/api/v1/sold/transaction'\nimport { tap, switchMap, catchError, debounceTime } from 'rxjs/operators'\nimport { ContractApi } from '@/api/v1/setting/contract'\nimport { UserService } from '@/services/user.service'\nimport { anyAll } from '@/operators'\nimport { MessageService } from '@/services/message.service'\n@Injectable()\nexport class UpgradeService {\n  loading$ = new State({})\n  info$ = new State({})\n  saleList$ = new State([])\n  advanceList$ = new State([])\n  couponList$ = new State([])\n  newPackageInfo$ = new State({})\n  packageOptions$ = new State([])\n  currentPrice$ = new State('0')\n  effectiveWayOptions$ = this.userService.getOptions$(\n    'package_course.effective_way'\n  )\n  constructor(\n    private contractApi: ContractApi,\n    private api: CourseApi,\n    private transactionApi: TransactionApi,\n    private userService: UserService,\n    private msg: MessageService\n  ) {}\n  SET_INFO(info: any) {\n    info.pay_price = `${info.pay_price}元`\n    this.info$.commit(() => info)\n  }\n  SET_UPGRADE_PACKAGE_LIST(list: any) {\n    this.packageOptions$.commit(() =>\n      list.map(item => {\n        return {\n          product_name: item.course_name,\n          id: item.id\n        }\n      })\n    )\n  }\n  SET_NEW_PACKAGE_INFO(info) {\n    info.courseInfo = info.is_limit\n      ? info.is_total\n        ? `团体课&私教课${info.total_times}次`\n        : info.is_team && !info.is_personal\n        ? `团体课${info.team_times}次`\n        : info.is_team && !info.is_personal\n        ? `私教课${info.personal_times}次`\n        : info.is_team && info.is_personal\n        ? `团体课${info.team_times}次/私教课${info.personal_times}次`\n        : ''\n      : '不限制'\n    info.shopList = info.shop_list.join(',')\n    this.newPackageInfo$.commit(() => info)\n  }\n  REST_COUPONLIST() {\n    this.couponList$.commit(() => [])\n  }\n  SET_SALE_LIST(list) {\n    list = list.map(item => {\n      const { id, staff_name } = item\n      return {\n        value: id,\n        label: staff_name\n      }\n    })\n    this.saleList$.commit(() => list)\n  }\n  @Effect()\n  getInfo(id: string | number) {\n    return this.api.getPackageUpgradeInfo(id).pipe(\n      tap((res: any) => {\n        this.SET_INFO(res.info)\n      })\n    )\n  }\n  @Effect()\n  getUpgradePackageList(query: any) {\n    return this.api.getUpgradePackageList(query).pipe(\n      tap(res => {\n        this.SET_UPGRADE_PACKAGE_LIST(res.list)\n      })\n    )\n  }\n  getNewUpgradePackageInfo(id: number | string) {\n    return this.api.getNewUpgradePackageInfo(id).pipe(\n      tap(res => {\n        this.SET_NEW_PACKAGE_INFO(res.info)\n      })\n    )\n  }\n  getSaleList() {\n    return this.transactionApi.getTransactionSaleList().pipe(\n      tap((res: any) => {\n        this.SET_SALE_LIST(res.list)\n      })\n    )\n  }\n  // 优惠券列表\n  @Effect()\n  getCouponList(query: MemberCouponParams) {\n    return this.transactionApi.getTransactionCouponList(query, 'member')\n  }\n  resetCouponList() {\n    this.couponList$.commit(() => [])\n  }\n  // 定金\n  @Effect()\n  getAdvanceList(id: string | number) {\n    return this.transactionApi.getTransactionAdvanceList(id).pipe(\n      tap((res: any) => {\n        this.advanceList$.commit(() => res.list)\n      })\n    )\n  }\n  resetAdvanceList() {\n    this.advanceList$.commit(() => [])\n  }\n  upgrade(params: any) {\n    return this.api.upgradePackage(params).pipe(\n      tap(res => {\n        this.msg.success({ content: '课程包升级成功' })\n      })\n    )\n  }\n  @Effect()\n  getPrice(params: TransactionPriceInput) {\n    return this.transactionApi.getTransactionPrice(params).pipe(\n      tap(res => {\n        this.currentPrice$.commit(() => res.info.price)\n      })\n    )\n  }\n  init(id: string | number) {\n    return anyAll(this.getInfo(id), this.getSaleList())\n  }\n}\n"],"sourceRoot":""}]}