{"remainingRequest":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js!/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhigang/Desktop/styd/web/src/views/biz-components/st/editor/editor.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangzhigang/Desktop/styd/web/src/views/biz-components/st/editor/editor.vue","mtime":1600926382183},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/babel-loader/lib/index.js","mtime":1591062567418},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/cache-loader/dist/cjs.js","mtime":1591062571898},{"path":"/Users/wangzhigang/Desktop/styd/web/node_modules/vue-loader/lib/index.js","mtime":1591062572376}],"contextDependencies":[],"result":["//\n//\n//\n//\nimport { AppConfig } from '@/constants/config';\nimport { ImportService } from '@/services/import.service.ts';\nimport EditorImage from \"./editor-image\";\nimport Vue from 'vue';\nvar editorEvents = ['activate', 'addUndo', 'beforeAddUndo', 'beforeExecCommand', 'beforeGetContent', 'beforeRenderUI', 'beforeSetContent', 'beforePaste', 'blur', 'change', 'clearUndos', 'click', 'contextMenu', 'copy', 'cut', 'dblclick', 'deactivate', 'dirty', 'drag', 'dragDrop', 'dragEnd', 'dragGesture', 'dragOver', 'drop', 'execCommand', 'focus', 'focusIn', 'focusOut', 'getContent', 'hide', 'init', 'keyDown', 'keyPress', 'keyUp', 'loadContent', 'mouseDown', 'mouseEnter', 'mouseLeave', 'mouseMove', 'mouseOut', 'mouseOver', 'mouseUp', 'nodeChange', 'objectResizeStart', 'objectResized', 'objectSelected', 'paste', 'postProcess', 'postRender', 'preProcess', 'progressState', 'redo', 'remove', 'reset', 'saveContent', 'selectionChange', 'setAttrib', 'setContent', 'show', 'submit', 'undo', 'visualAid'];\nexport default {\n  name: 'StEditor',\n  props: {\n    value: {\n      type: String,\n      default: ''\n    }\n  },\n  model: {\n    prop: 'value',\n    event: 'change'\n  },\n  serviceInject: function serviceInject() {\n    return {\n      appConfig: AppConfig,\n      importService: ImportService\n    };\n  },\n  computed: {\n    editorId: function editorId() {\n      return 'st-editor-' + this._uid;\n    }\n  },\n  methods: {\n    onChangeGetFile: function onChangeGetFile(_ref) {\n      var image = _ref.image,\n          editor = _ref.editor;\n      editor.insertContent(\"<img src=\\\"\".concat(image.url, \"\\\">\"));\n      this.$emit('ready', editor);\n    }\n  },\n  mounted: function mounted() {\n    var _this = this;\n\n    var h = this.$createElement;\n    this.importService.load(['tinymce/5.0.3/tinymce.min.js']).then(function () {\n      return _this.importService.load(['tinymce/5.0.3/themes/silver/theme.min.js']);\n    }).then(function () {\n      var ctx = _this;\n      window.tinyMCE.remove();\n      window.tinyMCE.init({\n        selector: '.' + _this.editorId,\n        language: 'zh_CN',\n        // 右键菜单\n        contextmenu: ['paste'],\n        // 隐藏右下角技术支持\n        branding: false,\n        // 隐藏底栏的元素路径\n        elementpath: false,\n        menubar: false,\n        body_class: 'st-editor',\n        plugins: ['link', 'image'],\n        min_height: 153,\n        toolbar: 'undo redo | styleselect bold italic forecolor backcolor | bullist numlist | alignleft aligncenter alignright',\n        language_url: _this.appConfig.BASE_URL + 'tinymce/5.0.3/zh_CN.js',\n        // 图片上传\n        images_upload_handler: function images_upload_handler(blobInfo, success, failure) {\n          var formData = new FormData();\n          formData.append('img', blobInfo.blob());\n          ctx.$modalRouter.push({\n            name: 'face-recognition'\n          });\n        },\n        setup: function setup(editor) {\n          editor.on('change keyup undo redo', function (value) {\n            var currentContent = editor.getContent();\n            ctx.$emit('input', currentContent);\n            ctx.$emit('change', currentContent);\n          });\n        },\n        init_instance_callback: function init_instance_callback(editor) {\n          var h = this.$createElement;\n          var editorToolbarEl = document.querySelector('.tox-toolbar');\n          var ele = document.createElement('div');\n          ele.id = 'editorImageUpload';\n          editorToolbarEl.appendChild(ele);\n          new Vue({\n            components: {\n              EditorImage: EditorImage\n            },\n            render: function render(h) {\n              return h(\"editor-image\", {\n                \"attrs\": {\n                  \"editor\": editor\n                },\n                \"on\": {\n                  \"change\": ctx.onChangeGetFile\n                }\n              });\n            }\n          }).$mount('#editorImageUpload');\n          editor.setContent(ctx.value);\n          ctx.$emit('ready', editor);\n        }\n      });\n    });\n  }\n};",{"version":3,"sources":["editor.vue"],"names":[],"mappings":";;;;AAKA,SAAA,SAAA,QAAA,oBAAA;AACA,SAAA,aAAA,QAAA,8BAAA;AACA,OAAA,WAAA;AACA,OAAA,GAAA,MAAA,KAAA;AAEA,IAAA,YAAA,GAAA,CACA,UADA,EAEA,SAFA,EAGA,eAHA,EAIA,mBAJA,EAKA,kBALA,EAMA,gBANA,EAOA,kBAPA,EAQA,aARA,EASA,MATA,EAUA,QAVA,EAWA,YAXA,EAYA,OAZA,EAaA,aAbA,EAcA,MAdA,EAeA,KAfA,EAgBA,UAhBA,EAiBA,YAjBA,EAkBA,OAlBA,EAmBA,MAnBA,EAoBA,UApBA,EAqBA,SArBA,EAsBA,aAtBA,EAuBA,UAvBA,EAwBA,MAxBA,EAyBA,aAzBA,EA0BA,OA1BA,EA2BA,SA3BA,EA4BA,UA5BA,EA6BA,YA7BA,EA8BA,MA9BA,EA+BA,MA/BA,EAgCA,SAhCA,EAiCA,UAjCA,EAkCA,OAlCA,EAmCA,aAnCA,EAoCA,WApCA,EAqCA,YArCA,EAsCA,YAtCA,EAuCA,WAvCA,EAwCA,UAxCA,EAyCA,WAzCA,EA0CA,SA1CA,EA2CA,YA3CA,EA4CA,mBA5CA,EA6CA,eA7CA,EA8CA,gBA9CA,EA+CA,OA/CA,EAgDA,aAhDA,EAiDA,YAjDA,EAkDA,YAlDA,EAmDA,eAnDA,EAoDA,MApDA,EAqDA,QArDA,EAsDA,OAtDA,EAuDA,aAvDA,EAwDA,iBAxDA,EAyDA,WAzDA,EA0DA,YA1DA,EA2DA,MA3DA,EA4DA,QA5DA,EA6DA,MA7DA,EA8DA,WA9DA,CAAA;AAiEA,eAAA;AACA,EAAA,IAAA,EAAA,UADA;AAEA,EAAA,KAAA,EAAA;AACA,IAAA,KAAA,EAAA;AACA,MAAA,IAAA,EAAA,MADA;AAEA,MAAA,OAAA,EAAA;AAFA;AADA,GAFA;AAQA,EAAA,KAAA,EAAA;AACA,IAAA,IAAA,EAAA,OADA;AAEA,IAAA,KAAA,EAAA;AAFA,GARA;AAYA,EAAA,aAZA,2BAYA;AACA,WAAA;AACA,MAAA,SAAA,EAAA,SADA;AAEA,MAAA,aAAA,EAAA;AAFA,KAAA;AAIA,GAjBA;AAkBA,EAAA,QAAA,EAAA;AACA,IAAA,QADA,sBACA;AACA,aAAA,eAAA,KAAA,IAAA;AACA;AAHA,GAlBA;AAuBA,EAAA,OAAA,EAAA;AACA,IAAA,eADA,iCACA;AAAA,UAAA,KAAA,QAAA,KAAA;AAAA,UAAA,MAAA,QAAA,MAAA;AACA,MAAA,MAAA,CAAA,aAAA,sBAAA,KAAA,CAAA,GAAA;AACA,WAAA,KAAA,CAAA,OAAA,EAAA,MAAA;AACA;AAJA,GAvBA;AA6BA,EAAA,OA7BA,qBA6BA;AAAA;;AAAA;AACA,SAAA,aAAA,CACA,IADA,CACA,CAAA,8BAAA,CADA,EAEA,IAFA,CAEA;AAAA,aACA,KAAA,CAAA,aAAA,CAAA,IAAA,CAAA,CAAA,0CAAA,CAAA,CADA;AAAA,KAFA,EAKA,IALA,CAKA,YAAA;AACA,UAAA,GAAA,GAAA,KAAA;AACA,MAAA,MAAA,CAAA,OAAA,CAAA,MAAA;AACA,MAAA,MAAA,CAAA,OAAA,CAAA,IAAA,CAAA;AACA,QAAA,QAAA,EAAA,MAAA,KAAA,CAAA,QADA;AAEA,QAAA,QAAA,EAAA,OAFA;AAGA;AACA,QAAA,WAAA,EAAA,CAAA,OAAA,CAJA;AAKA;AACA,QAAA,QAAA,EAAA,KANA;AAOA;AACA,QAAA,WAAA,EAAA,KARA;AASA,QAAA,OAAA,EAAA,KATA;AAUA,QAAA,UAAA,EAAA,WAVA;AAWA,QAAA,OAAA,EAAA,CAAA,MAAA,EAAA,OAAA,CAXA;AAYA,QAAA,UAAA,EAAA,GAZA;AAaA,QAAA,OAAA,EACA,8GAdA;AAeA,QAAA,YAAA,EAAA,KAAA,CAAA,SAAA,CAAA,QAAA,GAAA,wBAfA;AAgBA;AACA,QAAA,qBAAA,EAAA,+BAAA,QAAA,EAAA,OAAA,EAAA,OAAA,EAAA;AACA,cAAA,QAAA,GAAA,IAAA,QAAA,EAAA;AACA,UAAA,QAAA,CAAA,MAAA,CAAA,KAAA,EAAA,QAAA,CAAA,IAAA,EAAA;AACA,UAAA,GAAA,CAAA,YAAA,CAAA,IAAA,CAAA;AACA,YAAA,IAAA,EAAA;AADA,WAAA;AAGA,SAvBA;AAwBA,QAAA,KAxBA,iBAwBA,MAxBA,EAwBA;AACA,UAAA,MAAA,CAAA,EAAA,CAAA,wBAAA,EAAA,UAAA,KAAA,EAAA;AACA,gBAAA,cAAA,GAAA,MAAA,CAAA,UAAA,EAAA;AACA,YAAA,GAAA,CAAA,KAAA,CAAA,OAAA,EAAA,cAAA;AACA,YAAA,GAAA,CAAA,KAAA,CAAA,QAAA,EAAA,cAAA;AACA,WAJA;AAKA,SA9BA;AA+BA,QAAA,sBA/BA,kCA+BA,MA/BA,EA+BA;AAAA;AACA,cAAA,eAAA,GAAA,QAAA,CAAA,aAAA,CAAA,cAAA,CAAA;AACA,cAAA,GAAA,GAAA,QAAA,CAAA,aAAA,CAAA,KAAA,CAAA;AACA,UAAA,GAAA,CAAA,EAAA,GAAA,mBAAA;AACA,UAAA,eAAA,CAAA,WAAA,CAAA,GAAA;AACA,cAAA,GAAA,CAAA;AACA,YAAA,UAAA,EAAA;AACA,cAAA,WAAA,EAAA;AADA,aADA;AAIA,YAAA,MAAA,EAAA,gBAAA,CAAA;AAAA;AAAA;AAAA,4BACA;AADA;AAAA;AAAA,4BACA,GAAA,CAAA;AADA;AAAA;AAAA;AAJA,WAAA,EAOA,MAPA,CAOA,oBAPA;AAQA,UAAA,MAAA,CAAA,UAAA,CAAA,GAAA,CAAA,KAAA;AACA,UAAA,GAAA,CAAA,KAAA,CAAA,OAAA,EAAA,MAAA;AACA;AA9CA,OAAA;AAgDA,KAxDA;AAyDA;AAvFA,CAAA","sourcesContent":["<template>\n  <textarea :class=\"editorId\"></textarea>\n</template>\n\n<script>\nimport { AppConfig } from '@/constants/config'\nimport { ImportService } from '@/services/import.service.ts'\nimport EditorImage from './editor-image'\nimport Vue from 'vue'\n\nconst editorEvents = [\n  'activate',\n  'addUndo',\n  'beforeAddUndo',\n  'beforeExecCommand',\n  'beforeGetContent',\n  'beforeRenderUI',\n  'beforeSetContent',\n  'beforePaste',\n  'blur',\n  'change',\n  'clearUndos',\n  'click',\n  'contextMenu',\n  'copy',\n  'cut',\n  'dblclick',\n  'deactivate',\n  'dirty',\n  'drag',\n  'dragDrop',\n  'dragEnd',\n  'dragGesture',\n  'dragOver',\n  'drop',\n  'execCommand',\n  'focus',\n  'focusIn',\n  'focusOut',\n  'getContent',\n  'hide',\n  'init',\n  'keyDown',\n  'keyPress',\n  'keyUp',\n  'loadContent',\n  'mouseDown',\n  'mouseEnter',\n  'mouseLeave',\n  'mouseMove',\n  'mouseOut',\n  'mouseOver',\n  'mouseUp',\n  'nodeChange',\n  'objectResizeStart',\n  'objectResized',\n  'objectSelected',\n  'paste',\n  'postProcess',\n  'postRender',\n  'preProcess',\n  'progressState',\n  'redo',\n  'remove',\n  'reset',\n  'saveContent',\n  'selectionChange',\n  'setAttrib',\n  'setContent',\n  'show',\n  'submit',\n  'undo',\n  'visualAid'\n]\n\nexport default {\n  name: 'StEditor',\n  props: {\n    value: {\n      type: String,\n      default: ''\n    }\n  },\n  model: {\n    prop: 'value',\n    event: 'change'\n  },\n  serviceInject() {\n    return {\n      appConfig: AppConfig,\n      importService: ImportService\n    }\n  },\n  computed: {\n    editorId() {\n      return 'st-editor-' + this._uid\n    }\n  },\n  methods: {\n    onChangeGetFile({ image, editor }) {\n      editor.insertContent(`<img src=\"${image.url}\">`)\n      this.$emit('ready', editor)\n    }\n  },\n  mounted() {\n    this.importService\n      .load(['tinymce/5.0.3/tinymce.min.js'])\n      .then(() =>\n        this.importService.load(['tinymce/5.0.3/themes/silver/theme.min.js'])\n      )\n      .then(() => {\n        const ctx = this\n        window.tinyMCE.remove()\n        window.tinyMCE.init({\n          selector: '.' + this.editorId,\n          language: 'zh_CN',\n          // 右键菜单\n          contextmenu: ['paste'],\n          // 隐藏右下角技术支持\n          branding: false,\n          // 隐藏底栏的元素路径\n          elementpath: false,\n          menubar: false,\n          body_class: 'st-editor',\n          plugins: ['link', 'image'],\n          min_height: 153,\n          toolbar:\n            'undo redo | styleselect bold italic forecolor backcolor | bullist numlist | alignleft aligncenter alignright',\n          language_url: this.appConfig.BASE_URL + 'tinymce/5.0.3/zh_CN.js',\n          // 图片上传\n          images_upload_handler: function(blobInfo, success, failure) {\n            let formData = new FormData()\n            formData.append('img', blobInfo.blob())\n            ctx.$modalRouter.push({\n              name: 'face-recognition'\n            })\n          },\n          setup(editor) {\n            editor.on('change keyup undo redo', value => {\n              const currentContent = editor.getContent()\n              ctx.$emit('input', currentContent)\n              ctx.$emit('change', currentContent)\n            })\n          },\n          init_instance_callback(editor) {\n            const editorToolbarEl = document.querySelector('.tox-toolbar')\n            let ele = document.createElement('div')\n            ele.id = 'editorImageUpload'\n            editorToolbarEl.appendChild(ele)\n            new Vue({\n              components: {\n                EditorImage\n              },\n              render: h => (\n                <editor-image editor={editor} onChange={ctx.onChangeGetFile} />\n              )\n            }).$mount('#editorImageUpload')\n            editor.setContent(ctx.value)\n            ctx.$emit('ready', editor)\n          }\n        })\n      })\n  }\n}\n</script>\n"],"sourceRoot":"src/views/biz-components/st/editor"}]}